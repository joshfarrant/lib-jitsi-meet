!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.JitsiMeetJS=t():e.JitsiMeetJS=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";e.exports=n(165).default},function(e,t,n){var r=n(58),i=n(141),o={},a=[],s=r.levels.TRACE;e.exports={addGlobalTransport:function(e){r.addGlobalTransport(e)},removeGlobalTransport:function(e){r.removeGlobalTransport(e)},getLogger:function(e,t,n){var i=new r(s,e,t,n);return e?(o[e]=o[e]||[],o[e].push(i)):a.push(i),i},setLogLevelById:function(e,t){for(var n=t?o[t]||[]:a,r=0;r<n.length;r++)n[r].setLevel(e)},setLogLevel:function(e){s=e;for(var t=0;t<a.length;t++)a[t].setLevel(e);for(var n in o){var r=o[n]||[];for(t=0;t<r.length;t++)r[t].setLevel(e)}},levels:r.levels,LogCollector:i}},function(e,t,n){(function(e){"use strict";function r(){if(navigator.webkitGetUserMedia){m=g.RTC_BROWSER_CHROME;var e=navigator.userAgent.toLowerCase(),t=parseInt(e.match(/chrome\/(\d+)\./)[1],10);return v.log("This appears to be Chrome, ver: "+t),t}return null}function i(){var e=navigator.userAgent;if(e.match(/Opera|OPR/)){m=g.RTC_BROWSER_OPERA;var t=e.match(/(Opera|OPR) ?\/?(\d+)\.?/)[2];return v.info("This appears to be Opera, ver: "+t),t}return null}function o(){if(navigator.mozGetUserMedia){m=g.RTC_BROWSER_FIREFOX;var e=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10);return v.log("This appears to be Firefox, ver: "+e),e}return null}function a(){return/^((?!chrome).)*safari/i.test(navigator.userAgent)?(m=g.RTC_BROWSER_SAFARI,v.info("This appears to be Safari"),1):null}function s(){var e=void 0,t=window.navigator.userAgent,n=t.indexOf("MSIE ");n>0&&(e=parseInt(t.substring(n+5,t.indexOf(".",n)),10));var r=t.indexOf("Trident/");if(!e&&r>0){var i=t.indexOf("rv:");e=parseInt(t.substring(i+3,t.indexOf(".",i)),10)}return e&&(m=g.RTC_BROWSER_IEXPLORER,v.info("This appears to be IExplorer, ver: "+e)),e}function c(){var e=void 0,t=window.navigator.userAgent,n=t.indexOf("Edge/");return!e&&n>0&&(e=parseInt(t.substring(n+5,t.indexOf(".",n)),10)),e&&(m=g.RTC_BROWSER_EDGE,v.info("This appears to be Edge, ver: "+e)),e}function u(){var e=navigator.userAgent;if(e.match(/Electron/)){m=g.RTC_BROWSER_ELECTRON;var t=e.match(/Electron\/([\d.]+)/)[1];return v.info("This appears to be Electron, ver: "+t),t}return null}function l(){var e=navigator.userAgent;if(e.match(/JitsiMeetNW/)){m=g.RTC_BROWSER_NWJS;var t=e.match(/JitsiMeetNW\/([\d.]+)/)[1];return v.info("This appears to be JitsiMeetNW, ver: "+t),t}return null}function d(){var e=navigator.userAgent.match(/\b(react[ \t_-]*native)(?:\/(\S+))?/i),t=void 0;if(e||"ReactNative"===navigator.product){m=g.RTC_BROWSER_REACT_NATIVE;var n=void 0;e&&e.length>2&&(n=e[1],t=e[2]),n||(n="react-native"),t||(t="unknown"),console.info("This appears to be "+n+", ver: "+t)}else t=null;return t}function f(){for(var e=void 0,t=[d,u,l,i,r,o,c,s,a],n=0;n<t.length;n++)if(e=t[n]())return e;return v.warn("Browser type defaults to Safari ver 1"),m=g.RTC_BROWSER_SAFARI,1}Object.defineProperty(t,"__esModule",{value:!0});var p=n(1),h=void 0,m=void 0,v=(0,p.getLogger)(e),g={RTC_BROWSER_CHROME:"rtc_browser.chrome",RTC_BROWSER_OPERA:"rtc_browser.opera",RTC_BROWSER_FIREFOX:"rtc_browser.firefox",RTC_BROWSER_IEXPLORER:"rtc_browser.iexplorer",RTC_BROWSER_EDGE:"rtc_browser.edge",RTC_BROWSER_SAFARI:"rtc_browser.safari",RTC_BROWSER_NWJS:"rtc_browser.nwjs",RTC_BROWSER_ELECTRON:"rtc_browser.electron",RTC_BROWSER_REACT_NATIVE:"rtc_browser.react-native",doesVideoMuteByStreamRemove:function(){return!g.isFirefox()},getBrowserType:function(){return m},getBrowserName:function(){var e=navigator.userAgent.indexOf("Android")!==-1;return e?"android":m.split("rtc_browser.")[1]},isChrome:function(){return m===g.RTC_BROWSER_CHROME},isOpera:function(){return m===g.RTC_BROWSER_OPERA},isFirefox:function(){return m===g.RTC_BROWSER_FIREFOX},isIExplorer:function(){return m===g.RTC_BROWSER_IEXPLORER},isEdge:function(){return m===g.RTC_BROWSER_EDGE},isSafari:function(){return m===g.RTC_BROWSER_SAFARI},isNWJS:function(){return m===g.RTC_BROWSER_NWJS},isElectron:function(){return m===g.RTC_BROWSER_ELECTRON},isP2PSupported:function(){return!g.isReactNative()},isReactNative:function(){return m===g.RTC_BROWSER_REACT_NATIVE},isTemasysPluginUsed:function(){return g.isSafari()||g.isIExplorer()&&g.getIExplorerVersion()<12},isVideoMuteOnConnInterruptedSupported:function(){return g.isChrome()},getFirefoxVersion:function(){return g.isFirefox()?h:null},getChromeVersion:function(){return g.isChrome()?h:null},getIExplorerVersion:function(){return g.isIExplorer()?h:null},getEdgeVersion:function(){return g.isEdge()?h:null},usesPlanB:function(){return!g.usesUnifiedPlan()},usesUnifiedPlan:function(){return g.isFirefox()},supportsBandwidthStatistics:function(){return!g.isFirefox()},supportsRTTStatistics:function(){return!g.isFirefox()},supportsSimulcast:function(){return g.isChrome()||g.isElectron()||g.isNWJS()},supportsRtx:function(){return!g.isFirefox()}};h=f(),t.default=g}).call(t,"modules/RTC/RTCBrowserType.js")},function(e,t){"use strict";function n(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.forEach(function(e){return e.apply(void 0,t)}),o&&o.apply(void 0,t)}function r(e){i.forEach(function(t){return t(null,null,null,null,e.reason)}),a&&a(e)}var i=[],o=window.onerror,a=window.onunhandledrejection;window.onerror=n,window.onunhandledrejection=r;var s={addHandler:function(e){i.push(e)},callErrorHandler:function(e){var t=window.onerror;t&&t(null,null,null,null,e)},callUnhandledRejectionHandler:function(e){var t=window.onunhandledrejection;t&&t(e)}};e.exports=s},function(e,t,n){var r,i;/*!
	 * jQuery JavaScript Library v3.2.1
	 * https://jquery.com/
	 *
	 * Includes Sizzle.js
	 * https://sizzlejs.com/
	 *
	 * Copyright JS Foundation and other contributors
	 * Released under the MIT license
	 * https://jquery.org/license
	 *
	 * Date: 2017-03-20T18:59Z
	 */
!function(t,n){"use strict";"object"==typeof e&&"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,function(n,o){"use strict";function a(e,t){t=t||ae;var n=t.createElement("script");n.text=e,t.head.appendChild(n).parentNode.removeChild(n)}function s(e){var t=!!e&&"length"in e&&e.length,n=be.type(e);return"function"!==n&&!be.isWindow(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function c(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}function u(e,t,n){return be.isFunction(t)?be.grep(e,function(e,r){return!!t.call(e,r,e)!==n}):t.nodeType?be.grep(e,function(e){return e===t!==n}):"string"!=typeof t?be.grep(e,function(e){return de.call(t,e)>-1!==n}):Oe.test(t)?be.filter(t,e,n):(t=be.filter(t,e),be.grep(e,function(e){return de.call(t,e)>-1!==n&&1===e.nodeType}))}function l(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function d(e){var t={};return be.each(e.match(Le)||[],function(e,n){t[n]=!0}),t}function f(e){return e}function p(e){throw e}function h(e,t,n,r){var i;try{e&&be.isFunction(i=e.promise)?i.call(e).done(t).fail(n):e&&be.isFunction(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}function m(){ae.removeEventListener("DOMContentLoaded",m),n.removeEventListener("load",m),be.ready()}function v(){this.expando=be.expando+v.uid++}function g(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:He.test(e)?JSON.parse(e):e)}function y(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(Ge,"-$&").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n=g(n)}catch(e){}Je.set(e,t,n)}else n=void 0;return n}function b(e,t,n,r){var i,o=1,a=20,s=r?function(){return r.cur()}:function(){return be.css(e,t,"")},c=s(),u=n&&n[3]||(be.cssNumber[t]?"":"px"),l=(be.cssNumber[t]||"px"!==u&&+c)&&We.exec(be.css(e,t));if(l&&l[3]!==u){u=u||l[3],n=n||[],l=+c||1;do o=o||".5",l/=o,be.style(e,t,l+u);while(o!==(o=s()/c)&&1!==o&&--a)}return n&&(l=+l||+c||0,i=n[1]?l+(n[1]+1)*n[2]:+n[2],r&&(r.unit=u,r.start=l,r.end=i)),i}function E(e){var t,n=e.ownerDocument,r=e.nodeName,i=Xe[r];return i?i:(t=n.body.appendChild(n.createElement(r)),i=be.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),Xe[r]=i,i)}function S(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)r=e[o],r.style&&(n=r.style.display,t?("none"===n&&(i[o]=Be.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&qe(r)&&(i[o]=E(r))):"none"!==n&&(i[o]="none",Be.set(r,"display",n)));for(o=0;o<a;o++)null!=i[o]&&(e[o].style.display=i[o]);return e}function T(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&c(e,t)?be.merge([e],n):n}function C(e,t){for(var n=0,r=e.length;n<r;n++)Be.set(e[n],"globalEval",!t||Be.get(t[n],"globalEval"))}function w(e,t,n,r,i){for(var o,a,s,c,u,l,d=t.createDocumentFragment(),f=[],p=0,h=e.length;p<h;p++)if(o=e[p],o||0===o)if("object"===be.type(o))be.merge(f,o.nodeType?[o]:o);else if(et.test(o)){for(a=a||d.appendChild(t.createElement("div")),s=(Qe.exec(o)||["",""])[1].toLowerCase(),c=Ze[s]||Ze._default,a.innerHTML=c[1]+be.htmlPrefilter(o)+c[2],l=c[0];l--;)a=a.lastChild;be.merge(f,a.childNodes),a=d.firstChild,a.textContent=""}else f.push(t.createTextNode(o));for(d.textContent="",p=0;o=f[p++];)if(r&&be.inArray(o,r)>-1)i&&i.push(o);else if(u=be.contains(o.ownerDocument,o),a=T(d.appendChild(o),"script"),u&&C(a),n)for(l=0;o=a[l++];)Ye.test(o.type||"")&&n.push(o);return d}function _(){return!0}function R(){return!1}function A(){try{return ae.activeElement}catch(e){}}function k(e,t,n,r,i,o){var a,s;if("object"==typeof t){"string"!=typeof n&&(r=r||n,n=void 0);for(s in t)k(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),i===!1)i=R;else if(!i)return e;return 1===o&&(a=i,i=function(e){return be().off(e),a.apply(this,arguments)},i.guid=a.guid||(a.guid=be.guid++)),e.each(function(){be.event.add(this,t,i,r,n)})}function O(e,t){return c(e,"table")&&c(11!==t.nodeType?t:t.firstChild,"tr")?be(">tbody",e)[0]||e:e}function I(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function P(e){var t=ct.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function D(e,t){var n,r,i,o,a,s,c,u;if(1===t.nodeType){if(Be.hasData(e)&&(o=Be.access(e),a=Be.set(t,o),u=o.events)){delete a.handle,a.events={};for(i in u)for(n=0,r=u[i].length;n<r;n++)be.event.add(t,i,u[i][n])}Je.hasData(e)&&(s=Je.access(e),c=be.extend({},s),Je.set(t,c))}}function N(e,t){var n=t.nodeName.toLowerCase();"input"===n&&$e.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function x(e,t,n,r){t=ue.apply([],t);var i,o,s,c,u,l,d=0,f=e.length,p=f-1,h=t[0],m=be.isFunction(h);if(m||f>1&&"string"==typeof h&&!ge.checkClone&&st.test(h))return e.each(function(i){var o=e.eq(i);m&&(t[0]=h.call(this,i,o.html())),x(o,t,n,r)});if(f&&(i=w(t,e[0].ownerDocument,!1,e,r),o=i.firstChild,1===i.childNodes.length&&(i=o),o||r)){for(s=be.map(T(i,"script"),I),c=s.length;d<f;d++)u=i,d!==p&&(u=be.clone(u,!0,!0),c&&be.merge(s,T(u,"script"))),n.call(e[d],u,d);if(c)for(l=s[s.length-1].ownerDocument,be.map(s,P),d=0;d<c;d++)u=s[d],Ye.test(u.type||"")&&!Be.access(u,"globalEval")&&be.contains(l,u)&&(u.src?be._evalUrl&&be._evalUrl(u.src):a(u.textContent.replace(ut,""),l))}return e}function L(e,t,n){for(var r,i=t?be.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||be.cleanData(T(r)),r.parentNode&&(n&&be.contains(r.ownerDocument,r)&&C(T(r,"script")),r.parentNode.removeChild(r));return e}function M(e,t,n){var r,i,o,a,s=e.style;return n=n||ft(e),n&&(a=n.getPropertyValue(t)||n[t],""!==a||be.contains(e.ownerDocument,e)||(a=be.style(e,t)),!ge.pixelMarginRight()&&dt.test(a)&&lt.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function j(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function F(e){if(e in yt)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=gt.length;n--;)if(e=gt[n]+t,e in yt)return e}function U(e){var t=be.cssProps[e];return t||(t=be.cssProps[e]=F(e)||e),t}function B(e,t,n){var r=We.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function J(e,t,n,r,i){var o,a=0;for(o=n===(r?"border":"content")?4:"width"===t?1:0;o<4;o+=2)"margin"===n&&(a+=be.css(e,n+Ke[o],!0,i)),r?("content"===n&&(a-=be.css(e,"padding"+Ke[o],!0,i)),"margin"!==n&&(a-=be.css(e,"border"+Ke[o]+"Width",!0,i))):(a+=be.css(e,"padding"+Ke[o],!0,i),"padding"!==n&&(a+=be.css(e,"border"+Ke[o]+"Width",!0,i)));return a}function H(e,t,n){var r,i=ft(e),o=M(e,t,i),a="border-box"===be.css(e,"boxSizing",!1,i);return dt.test(o)?o:(r=a&&(ge.boxSizingReliable()||o===e.style[t]),"auto"===o&&(o=e["offset"+t[0].toUpperCase()+t.slice(1)]),o=parseFloat(o)||0,o+J(e,t,n||(a?"border":"content"),r,i)+"px")}function G(e,t,n,r,i){return new G.prototype.init(e,t,n,r,i)}function V(){Et&&(ae.hidden===!1&&n.requestAnimationFrame?n.requestAnimationFrame(V):n.setTimeout(V,be.fx.interval),be.fx.tick())}function W(){return n.setTimeout(function(){bt=void 0}),bt=be.now()}function K(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)n=Ke[r],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function q(e,t,n){for(var r,i=($.tweeners[t]||[]).concat($.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function z(e,t,n){var r,i,o,a,s,c,u,l,d="width"in t||"height"in t,f=this,p={},h=e.style,m=e.nodeType&&qe(e),v=Be.get(e,"fxshow");n.queue||(a=be._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,f.always(function(){f.always(function(){a.unqueued--,be.queue(e,"fx").length||a.empty.fire()})}));for(r in t)if(i=t[r],St.test(i)){if(delete t[r],o=o||"toggle"===i,i===(m?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;m=!0}p[r]=v&&v[r]||be.style(e,r)}if(c=!be.isEmptyObject(t),c||!be.isEmptyObject(p)){d&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],u=v&&v.display,null==u&&(u=Be.get(e,"display")),l=be.css(e,"display"),"none"===l&&(u?l=u:(S([e],!0),u=e.style.display||u,l=be.css(e,"display"),S([e]))),("inline"===l||"inline-block"===l&&null!=u)&&"none"===be.css(e,"float")&&(c||(f.done(function(){h.display=u}),null==u&&(l=h.display,u="none"===l?"":l)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",f.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),c=!1;for(r in p)c||(v?"hidden"in v&&(m=v.hidden):v=Be.access(e,"fxshow",{display:u}),o&&(v.hidden=!m),m&&S([e],!0),f.done(function(){m||S([e]),Be.remove(e,"fxshow");for(r in p)be.style(e,r,p[r])})),c=q(m?v[r]:0,r,f),r in v||(v[r]=c.start,m&&(c.end=c.start,c.start=0))}}function X(e,t){var n,r,i,o,a;for(n in e)if(r=be.camelCase(n),i=t[r],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),a=be.cssHooks[r],a&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}function $(e,t,n){var r,i,o=0,a=$.prefilters.length,s=be.Deferred().always(function(){delete c.elem}),c=function(){if(i)return!1;for(var t=bt||W(),n=Math.max(0,u.startTime+u.duration-t),r=n/u.duration||0,o=1-r,a=0,c=u.tweens.length;a<c;a++)u.tweens[a].run(o);return s.notifyWith(e,[u,o,n]),o<1&&c?n:(c||s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:be.extend({},t),opts:be.extend(!0,{specialEasing:{},easing:be.easing._default},n),originalProperties:t,originalOptions:n,startTime:bt||W(),duration:n.duration,tweens:[],createTween:function(t,n){var r=be.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)u.tweens[n].run(1);return t?(s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u,t])):s.rejectWith(e,[u,t]),this}}),l=u.props;for(X(l,u.opts.specialEasing);o<a;o++)if(r=$.prefilters[o].call(u,e,l,u.opts))return be.isFunction(r.stop)&&(be._queueHooks(u.elem,u.opts.queue).stop=be.proxy(r.stop,r)),r;return be.map(l,q,u),be.isFunction(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),be.fx.timer(be.extend(c,{elem:e,anim:u,queue:u.opts.queue})),u}function Q(e){var t=e.match(Le)||[];return t.join(" ")}function Y(e){return e.getAttribute&&e.getAttribute("class")||""}function Z(e,t,n,r){var i;if(Array.isArray(t))be.each(t,function(t,i){n||Dt.test(e)?r(e,i):Z(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)});else if(n||"object"!==be.type(t))r(e,t);else for(i in t)Z(e+"["+i+"]",t[i],n,r)}function ee(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(Le)||[];if(be.isFunction(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function te(e,t,n,r){function i(s){var c;return o[s]=!0,be.each(e[s]||[],function(e,s){var u=s(t,n,r);return"string"!=typeof u||a||o[u]?a?!(c=u):void 0:(t.dataTypes.unshift(u),i(u),!1)}),c}var o={},a=e===Vt;return i(t.dataTypes[0])||!o["*"]&&i("*")}function ne(e,t){var n,r,i=be.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&be.extend(!0,e,r),e}function re(e,t,n){for(var r,i,o,a,s=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){c.unshift(i);break}if(c[0]in n)o=c[0];else{for(i in n){if(!c[0]||e.converters[i+" "+c[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==c[0]&&c.unshift(o),n[o]}function ie(e,t,n,r){var i,o,a,s,c,u={},l=e.dataTypes.slice();if(l[1])for(a in e.converters)u[a.toLowerCase()]=e.converters[a];for(o=l.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!c&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=o,o=l.shift())if("*"===o)o=c;else if("*"!==c&&c!==o){if(a=u[c+" "+o]||u["* "+o],!a)for(i in u)if(s=i.split(" "),s[1]===o&&(a=u[c+" "+s[0]]||u["* "+s[0]])){a===!0?a=u[i]:u[i]!==!0&&(o=s[0],l.unshift(s[1]));break}if(a!==!0)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+c+" to "+o}}}return{state:"success",data:t}}var oe=[],ae=n.document,se=Object.getPrototypeOf,ce=oe.slice,ue=oe.concat,le=oe.push,de=oe.indexOf,fe={},pe=fe.toString,he=fe.hasOwnProperty,me=he.toString,ve=me.call(Object),ge={},ye="3.2.1",be=function(e,t){return new be.fn.init(e,t)},Ee=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Se=/^-ms-/,Te=/-([a-z])/g,Ce=function(e,t){return t.toUpperCase()};be.fn=be.prototype={jquery:ye,constructor:be,length:0,toArray:function(){return ce.call(this)},get:function(e){return null==e?ce.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=be.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return be.each(this,e)},map:function(e){return this.pushStack(be.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(ce.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:le,sort:oe.sort,splice:oe.splice},be.extend=be.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,c=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[s]||{},s++),"object"==typeof a||be.isFunction(a)||(a={}),s===c&&(a=this,s--);s<c;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],r=e[t],a!==r&&(u&&r&&(be.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=n&&Array.isArray(n)?n:[]):o=n&&be.isPlainObject(n)?n:{},a[t]=be.extend(u,o,r)):void 0!==r&&(a[t]=r));return a},be.extend({expando:"jQuery"+(ye+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===be.type(e)},isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=be.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==pe.call(e)||(t=se(e))&&(n=he.call(t,"constructor")&&t.constructor,"function"!=typeof n||me.call(n)!==ve))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?fe[pe.call(e)]||"object":typeof e},globalEval:function(e){a(e)},camelCase:function(e){return e.replace(Se,"ms-").replace(Te,Ce)},each:function(e,t){var n,r=0;if(s(e))for(n=e.length;r<n&&t.call(e[r],r,e[r])!==!1;r++);else for(r in e)if(t.call(e[r],r,e[r])===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(Ee,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(s(Object(e))?be.merge(n,"string"==typeof e?[e]:e):le.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:de.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],o=0,a=e.length,s=!n;o<a;o++)r=!t(e[o],o),r!==s&&i.push(e[o]);return i},map:function(e,t,n){var r,i,o=0,a=[];if(s(e))for(r=e.length;o<r;o++)i=t(e[o],o,n),null!=i&&a.push(i);else for(o in e)i=t(e[o],o,n),null!=i&&a.push(i);return ue.apply([],a)},guid:1,proxy:function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),be.isFunction(e))return r=ce.call(arguments,2),i=function(){return e.apply(t||this,r.concat(ce.call(arguments)))},i.guid=e.guid=e.guid||be.guid++,i},now:Date.now,support:ge}),"function"==typeof Symbol&&(be.fn[Symbol.iterator]=oe[Symbol.iterator]),be.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){fe["[object "+t+"]"]=t.toLowerCase()});var we=/*!
	 * Sizzle CSS Selector Engine v2.3.3
	 * https://sizzlejs.com/
	 *
	 * Copyright jQuery Foundation and other contributors
	 * Released under the MIT license
	 * http://jquery.org/license
	 *
	 * Date: 2016-08-08
	 */
function(e){function t(e,t,n,r){var i,o,a,s,c,u,l,f=t&&t.ownerDocument,h=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==h&&9!==h&&11!==h)return n;if(!r&&((t?t.ownerDocument||t:J)!==N&&D(t),t=t||N,L)){if(11!==h&&(c=ge.exec(e)))if(i=c[1]){if(9===h){if(!(a=t.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&U(t,a)&&a.id===i)return n.push(a),n}else{if(c[2])return Y.apply(n,t.getElementsByTagName(e)),n;if((i=c[3])&&T.getElementsByClassName&&t.getElementsByClassName)return Y.apply(n,t.getElementsByClassName(i)),n}if(T.qsa&&!K[e+" "]&&(!M||!M.test(e))){if(1!==h)f=t,l=e;else if("object"!==t.nodeName.toLowerCase()){for((s=t.getAttribute("id"))?s=s.replace(Se,Te):t.setAttribute("id",s=B),u=R(e),o=u.length;o--;)u[o]="#"+s+" "+p(u[o]);l=u.join(","),f=ye.test(e)&&d(t.parentNode)||t}if(l)try{return Y.apply(n,f.querySelectorAll(l)),n}catch(e){}finally{s===B&&t.removeAttribute("id")}}}return k(e.replace(se,"$1"),t,n,r)}function n(){function e(n,r){return t.push(n+" ")>C.cacheLength&&delete e[t.shift()],e[n+" "]=r}var t=[];return e}function r(e){return e[B]=!0,e}function i(e){var t=N.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var n=e.split("|"),r=n.length;r--;)C.attrHandle[n[r]]=t}function a(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function s(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function c(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function u(e){return function(t){return"form"in t?t.parentNode&&t.disabled===!1?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&we(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function l(e){return r(function(t){return t=+t,r(function(n,r){for(var i,o=e([],n.length,t),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function d(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function f(){}function p(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function h(e,t,n){var r=t.dir,i=t.next,o=i||r,a=n&&"parentNode"===o,s=G++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||a)return e(t,n,i);return!1}:function(t,n,c){var u,l,d,f=[H,s];if(c){for(;t=t[r];)if((1===t.nodeType||a)&&e(t,n,c))return!0}else for(;t=t[r];)if(1===t.nodeType||a)if(d=t[B]||(t[B]={}),l=d[t.uniqueID]||(d[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((u=l[o])&&u[0]===H&&u[1]===s)return f[2]=u[2];if(l[o]=f,f[2]=e(t,n,c))return!0}return!1}}function m(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function v(e,n,r){for(var i=0,o=n.length;i<o;i++)t(e,n[i],r);return r}function g(e,t,n,r,i){for(var o,a=[],s=0,c=e.length,u=null!=t;s<c;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),u&&t.push(s)));return a}function y(e,t,n,i,o,a){return i&&!i[B]&&(i=y(i)),o&&!o[B]&&(o=y(o,a)),r(function(r,a,s,c){var u,l,d,f=[],p=[],h=a.length,m=r||v(t||"*",s.nodeType?[s]:s,[]),y=!e||!r&&t?m:g(m,f,e,s,c),b=n?o||(r?e:h||i)?[]:a:y;if(n&&n(y,b,s,c),i)for(u=g(b,p),i(u,[],s,c),l=u.length;l--;)(d=u[l])&&(b[p[l]]=!(y[p[l]]=d));if(r){if(o||e){if(o){for(u=[],l=b.length;l--;)(d=b[l])&&u.push(y[l]=d);o(null,b=[],u,c)}for(l=b.length;l--;)(d=b[l])&&(u=o?ee(r,d):f[l])>-1&&(r[u]=!(a[u]=d))}}else b=g(b===a?b.splice(h,b.length):b),o?o(null,a,b,c):Y.apply(a,b)})}function b(e){for(var t,n,r,i=e.length,o=C.relative[e[0].type],a=o||C.relative[" "],s=o?1:0,c=h(function(e){return e===t},a,!0),u=h(function(e){return ee(t,e)>-1},a,!0),l=[function(e,n,r){var i=!o&&(r||n!==O)||((t=n).nodeType?c(e,n,r):u(e,n,r));return t=null,i}];s<i;s++)if(n=C.relative[e[s].type])l=[h(m(l),n)];else{if(n=C.filter[e[s].type].apply(null,e[s].matches),n[B]){for(r=++s;r<i&&!C.relative[e[r].type];r++);return y(s>1&&m(l),s>1&&p(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(se,"$1"),n,s<r&&b(e.slice(s,r)),r<i&&b(e=e.slice(r)),r<i&&p(e))}l.push(n)}return m(l)}function E(e,n){var i=n.length>0,o=e.length>0,a=function(r,a,s,c,u){var l,d,f,p=0,h="0",m=r&&[],v=[],y=O,b=r||o&&C.find.TAG("*",u),E=H+=null==y?1:Math.random()||.1,S=b.length;for(u&&(O=a===N||a||u);h!==S&&null!=(l=b[h]);h++){if(o&&l){for(d=0,a||l.ownerDocument===N||(D(l),s=!L);f=e[d++];)if(f(l,a||N,s)){c.push(l);break}u&&(H=E)}i&&((l=!f&&l)&&p--,r&&m.push(l))}if(p+=h,i&&h!==p){for(d=0;f=n[d++];)f(m,v,a,s);if(r){if(p>0)for(;h--;)m[h]||v[h]||(v[h]=$.call(c));v=g(v)}Y.apply(c,v),u&&!r&&v.length>0&&p+n.length>1&&t.uniqueSort(c)}return u&&(H=E,O=y),m};return i?r(a):a}var S,T,C,w,_,R,A,k,O,I,P,D,N,x,L,M,j,F,U,B="sizzle"+1*new Date,J=e.document,H=0,G=0,V=n(),W=n(),K=n(),q=function(e,t){return e===t&&(P=!0),0},z={}.hasOwnProperty,X=[],$=X.pop,Q=X.push,Y=X.push,Z=X.slice,ee=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",re="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",ie="\\["+ne+"*("+re+")(?:"+ne+"*([*^$|!~]?=)"+ne+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+re+"))|)"+ne+"*\\]",oe=":("+re+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ie+")*)|.*)\\)|)",ae=new RegExp(ne+"+","g"),se=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),ce=new RegExp("^"+ne+"*,"+ne+"*"),ue=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),le=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),de=new RegExp(oe),fe=new RegExp("^"+re+"$"),pe={ID:new RegExp("^#("+re+")"),CLASS:new RegExp("^\\.("+re+")"),TAG:new RegExp("^("+re+"|[*])"),ATTR:new RegExp("^"+ie),PSEUDO:new RegExp("^"+oe),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},he=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,ve=/^[^{]+\{\s*\[native \w/,ge=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ye=/[+~]/,be=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),Ee=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},Se=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Te=function(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},Ce=function(){D()},we=h(function(e){return e.disabled===!0&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{Y.apply(X=Z.call(J.childNodes),J.childNodes),X[J.childNodes.length].nodeType}catch(e){Y={apply:X.length?function(e,t){Q.apply(e,Z.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}T=t.support={},_=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},D=t.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:J;return r!==N&&9===r.nodeType&&r.documentElement?(N=r,x=N.documentElement,L=!_(N),J!==N&&(n=N.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",Ce,!1):n.attachEvent&&n.attachEvent("onunload",Ce)),T.attributes=i(function(e){return e.className="i",!e.getAttribute("className")}),T.getElementsByTagName=i(function(e){return e.appendChild(N.createComment("")),!e.getElementsByTagName("*").length}),T.getElementsByClassName=ve.test(N.getElementsByClassName),T.getById=i(function(e){return x.appendChild(e).id=B,!N.getElementsByName||!N.getElementsByName(B).length}),T.getById?(C.filter.ID=function(e){var t=e.replace(be,Ee);return function(e){return e.getAttribute("id")===t}},C.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&L){var n=t.getElementById(e);return n?[n]:[]}}):(C.filter.ID=function(e){var t=e.replace(be,Ee);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},C.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&L){var n,r,i,o=t.getElementById(e);if(o){if(n=o.getAttributeNode("id"),n&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if(n=o.getAttributeNode("id"),n&&n.value===e)return[o]}return[]}}),C.find.TAG=T.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):T.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},C.find.CLASS=T.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&L)return t.getElementsByClassName(e)},j=[],M=[],(T.qsa=ve.test(N.querySelectorAll))&&(i(function(e){x.appendChild(e).innerHTML="<a id='"+B+"'></a><select id='"+B+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&M.push("[*^$]="+ne+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||M.push("\\["+ne+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+B+"-]").length||M.push("~="),e.querySelectorAll(":checked").length||M.push(":checked"),e.querySelectorAll("a#"+B+"+*").length||M.push(".#.+[+~]")}),i(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=N.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&M.push("name"+ne+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&M.push(":enabled",":disabled"),x.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&M.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),M.push(",.*:")})),(T.matchesSelector=ve.test(F=x.matches||x.webkitMatchesSelector||x.mozMatchesSelector||x.oMatchesSelector||x.msMatchesSelector))&&i(function(e){T.disconnectedMatch=F.call(e,"*"),F.call(e,"[s!='']:x"),j.push("!=",oe)}),M=M.length&&new RegExp(M.join("|")),j=j.length&&new RegExp(j.join("|")),t=ve.test(x.compareDocumentPosition),U=t||ve.test(x.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},q=t?function(e,t){if(e===t)return P=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!T.sortDetached&&t.compareDocumentPosition(e)===n?e===N||e.ownerDocument===J&&U(J,e)?-1:t===N||t.ownerDocument===J&&U(J,t)?1:I?ee(I,e)-ee(I,t):0:4&n?-1:1)}:function(e,t){if(e===t)return P=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,s=[e],c=[t];if(!i||!o)return e===N?-1:t===N?1:i?-1:o?1:I?ee(I,e)-ee(I,t):0;if(i===o)return a(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)c.unshift(n);for(;s[r]===c[r];)r++;return r?a(s[r],c[r]):s[r]===J?-1:c[r]===J?1:0},N):N},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==N&&D(e),n=n.replace(le,"='$1']"),T.matchesSelector&&L&&!K[n+" "]&&(!j||!j.test(n))&&(!M||!M.test(n)))try{var r=F.call(e,n);if(r||T.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return t(n,N,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==N&&D(e),U(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==N&&D(e);var n=C.attrHandle[t.toLowerCase()],r=n&&z.call(C.attrHandle,t.toLowerCase())?n(e,t,!L):void 0;return void 0!==r?r:T.attributes||!L?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},t.escape=function(e){return(e+"").replace(Se,Te)},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],r=0,i=0;if(P=!T.detectDuplicates,I=!T.sortStable&&e.slice(0),e.sort(q),P){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return I=null,e},w=t.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=w(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=w(t);return n},C=t.selectors={cacheLength:50,createPseudo:r,match:pe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(be,Ee),e[3]=(e[3]||e[4]||e[5]||"").replace(be,Ee),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return pe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&de.test(n)&&(t=R(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(be,Ee).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=V[e+" "];return t||(t=new RegExp("(^|"+ne+")"+e+"("+ne+"|$)"))&&V(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,r){return function(i){var o=t.attr(i,e);return null==o?"!="===n:!n||(o+="","="===n?o===r:"!="===n?o!==r:"^="===n?r&&0===o.indexOf(r):"*="===n?r&&o.indexOf(r)>-1:"$="===n?r&&o.slice(-r.length)===r:"~="===n?(" "+o.replace(ae," ")+" ").indexOf(r)>-1:"|="===n&&(o===r||o.slice(0,r.length+1)===r+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,c){var u,l,d,f,p,h,m=o!==a?"nextSibling":"previousSibling",v=t.parentNode,g=s&&t.nodeName.toLowerCase(),y=!c&&!s,b=!1;if(v){if(o){for(;m;){for(f=t;f=f[m];)if(s?f.nodeName.toLowerCase()===g:1===f.nodeType)return!1;h=m="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?v.firstChild:v.lastChild],a&&y){for(f=v,d=f[B]||(f[B]={}),l=d[f.uniqueID]||(d[f.uniqueID]={}),u=l[e]||[],p=u[0]===H&&u[1],b=p&&u[2],f=p&&v.childNodes[p];f=++p&&f&&f[m]||(b=p=0)||h.pop();)if(1===f.nodeType&&++b&&f===t){l[e]=[H,p,b];break}}else if(y&&(f=t,d=f[B]||(f[B]={}),l=d[f.uniqueID]||(d[f.uniqueID]={}),u=l[e]||[],p=u[0]===H&&u[1],b=p),b===!1)for(;(f=++p&&f&&f[m]||(b=p=0)||h.pop())&&((s?f.nodeName.toLowerCase()!==g:1!==f.nodeType)||!++b||(y&&(d=f[B]||(f[B]={}),l=d[f.uniqueID]||(d[f.uniqueID]={}),l[e]=[H,b]),f!==t)););return b-=i,b===r||b%r===0&&b/r>=0}}},PSEUDO:function(e,n){var i,o=C.pseudos[e]||C.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[B]?o(n):o.length>1?(i=[e,e,"",n],C.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,t){for(var r,i=o(e,n),a=i.length;a--;)r=ee(e,i[a]),e[r]=!(t[r]=i[a])}):function(e){return o(e,0,i)}):o}},pseudos:{not:r(function(e){var t=[],n=[],i=A(e.replace(se,"$1"));return i[B]?r(function(e,t,n,r){for(var o,a=i(e,null,r,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,r,o){return t[0]=e,i(t,null,o,n),t[0]=null,!n.pop()}}),has:r(function(e){return function(n){return t(e,n).length>0}}),contains:r(function(e){return e=e.replace(be,Ee),function(t){return(t.textContent||t.innerText||w(t)).indexOf(e)>-1}}),lang:r(function(e){return fe.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(be,Ee).toLowerCase(),function(t){var n;do if(n=L?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===x},focus:function(e){return e===N.activeElement&&(!N.hasFocus||N.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:u(!1),disabled:u(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!C.pseudos.empty(e)},header:function(e){return me.test(e.nodeName)},input:function(e){return he.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,n){return[n<0?n+t:n]}),even:l(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:l(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:l(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:l(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},C.pseudos.nth=C.pseudos.eq;for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[S]=s(S);for(S in{submit:!0,reset:!0})C.pseudos[S]=c(S);return f.prototype=C.filters=C.pseudos,C.setFilters=new f,R=t.tokenize=function(e,n){var r,i,o,a,s,c,u,l=W[e+" "];if(l)return n?0:l.slice(0);for(s=e,c=[],u=C.preFilter;s;){r&&!(i=ce.exec(s))||(i&&(s=s.slice(i[0].length)||s),c.push(o=[])),r=!1,(i=ue.exec(s))&&(r=i.shift(),o.push({value:r,type:i[0].replace(se," ")}),s=s.slice(r.length));for(a in C.filter)!(i=pe[a].exec(s))||u[a]&&!(i=u[a](i))||(r=i.shift(),o.push({value:r,type:a,matches:i}),s=s.slice(r.length));if(!r)break}return n?s.length:s?t.error(e):W(e,c).slice(0)},A=t.compile=function(e,t){var n,r=[],i=[],o=K[e+" "];if(!o){for(t||(t=R(e)),n=t.length;n--;)o=b(t[n]),o[B]?r.push(o):i.push(o);o=K(e,E(i,r)),o.selector=e}return o},k=t.select=function(e,t,n,r){var i,o,a,s,c,u="function"==typeof e&&e,l=!r&&R(e=u.selector||e);if(n=n||[],1===l.length){if(o=l[0]=l[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&9===t.nodeType&&L&&C.relative[o[1].type]){if(t=(C.find.ID(a.matches[0].replace(be,Ee),t)||[])[0],!t)return n;u&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=pe.needsContext.test(e)?0:o.length;i--&&(a=o[i],!C.relative[s=a.type]);)if((c=C.find[s])&&(r=c(a.matches[0].replace(be,Ee),ye.test(o[0].type)&&d(t.parentNode)||t))){if(o.splice(i,1),e=r.length&&p(o),!e)return Y.apply(n,r),n;break}}return(u||A(e,l))(r,t,!L,n,!t||ye.test(e)&&d(t.parentNode)||t),n},T.sortStable=B.split("").sort(q).join("")===B,T.detectDuplicates=!!P,D(),T.sortDetached=i(function(e){return 1&e.compareDocumentPosition(N.createElement("fieldset"))}),i(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),T.attributes&&i(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),i(function(e){return null==e.getAttribute("disabled")})||o(te,function(e,t,n){var r;if(!n)return e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),t}(n);be.find=we,be.expr=we.selectors,be.expr[":"]=be.expr.pseudos,be.uniqueSort=be.unique=we.uniqueSort,be.text=we.getText,be.isXMLDoc=we.isXML,be.contains=we.contains,be.escapeSelector=we.escape;var _e=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&be(e).is(n))break;r.push(e)}return r},Re=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},Ae=be.expr.match.needsContext,ke=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,Oe=/^.[^:#\[\.,]*$/;be.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?be.find.matchesSelector(r,e)?[r]:[]:be.find.matches(e,be.grep(t,function(e){return 1===e.nodeType}))},be.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(be(e).filter(function(){for(t=0;t<r;t++)if(be.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)be.find(e,i[t],n);return r>1?be.uniqueSort(n):n},filter:function(e){return this.pushStack(u(this,e||[],!1))},not:function(e){return this.pushStack(u(this,e||[],!0))},is:function(e){return!!u(this,"string"==typeof e&&Ae.test(e)?be(e):e||[],!1).length}});var Ie,Pe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,De=be.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||Ie,"string"==typeof e){if(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:Pe.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof be?t[0]:t,be.merge(this,be.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:ae,!0)),ke.test(r[1])&&be.isPlainObject(t))for(r in t)be.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=ae.getElementById(r[2]),i&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):be.isFunction(e)?void 0!==n.ready?n.ready(e):e(be):be.makeArray(e,this)};De.prototype=be.fn,Ie=be(ae);var Ne=/^(?:parents|prev(?:Until|All))/,xe={children:!0,contents:!0,next:!0,prev:!0};be.fn.extend({has:function(e){var t=be(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(be.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&be(e);if(!Ae.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&be.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?be.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?de.call(be(e),this[0]):de.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(be.uniqueSort(be.merge(this.get(),be(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),be.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return _e(e,"parentNode")},parentsUntil:function(e,t,n){return _e(e,"parentNode",n)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return _e(e,"nextSibling")},prevAll:function(e){return _e(e,"previousSibling")},nextUntil:function(e,t,n){return _e(e,"nextSibling",n)},prevUntil:function(e,t,n){return _e(e,"previousSibling",n)},siblings:function(e){return Re((e.parentNode||{}).firstChild,e)},children:function(e){return Re(e.firstChild)},contents:function(e){return c(e,"iframe")?e.contentDocument:(c(e,"template")&&(e=e.content||e),be.merge([],e.childNodes))}},function(e,t){be.fn[e]=function(n,r){var i=be.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=be.filter(r,i)),this.length>1&&(xe[e]||be.uniqueSort(i),Ne.test(e)&&i.reverse()),this.pushStack(i)}});var Le=/[^\x20\t\r\n\f]+/g;be.Callbacks=function(e){e="string"==typeof e?d(e):be.extend({},e);var t,n,r,i,o=[],a=[],s=-1,c=function(){for(i=i||e.once,r=t=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)o[s].apply(n[0],n[1])===!1&&e.stopOnFalse&&(s=o.length,n=!1);e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},u={add:function(){return o&&(n&&!t&&(s=o.length-1,a.push(n)),function t(n){be.each(n,function(n,r){be.isFunction(r)?e.unique&&u.has(r)||o.push(r):r&&r.length&&"string"!==be.type(r)&&t(r)})}(arguments),n&&!t&&c()),this},remove:function(){return be.each(arguments,function(e,t){for(var n;(n=be.inArray(t,o,n))>-1;)o.splice(n,1),n<=s&&s--}),this},has:function(e){return e?be.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||t||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=n||[],n=[e,n.slice?n.slice():n],a.push(n),t||c()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!r}};return u},be.extend({Deferred:function(e){var t=[["notify","progress",be.Callbacks("memory"),be.Callbacks("memory"),2],["resolve","done",be.Callbacks("once memory"),be.Callbacks("once memory"),0,"resolved"],["reject","fail",be.Callbacks("once memory"),be.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return i.then(null,e)},pipe:function(){var e=arguments;return be.Deferred(function(n){be.each(t,function(t,r){var i=be.isFunction(e[r[4]])&&e[r[4]];o[r[1]](function(){var e=i&&i.apply(this,arguments);e&&be.isFunction(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[r[0]+"With"](this,i?[e]:arguments)})}),e=null}).promise()},then:function(e,r,i){function o(e,t,r,i){return function(){var s=this,c=arguments,u=function(){var n,u;if(!(e<a)){if(n=r.apply(s,c),n===t.promise())throw new TypeError("Thenable self-resolution");u=n&&("object"==typeof n||"function"==typeof n)&&n.then,be.isFunction(u)?i?u.call(n,o(a,t,f,i),o(a,t,p,i)):(a++,u.call(n,o(a,t,f,i),o(a,t,p,i),o(a,t,f,t.notifyWith))):(r!==f&&(s=void 0,c=[n]),(i||t.resolveWith)(s,c))}},l=i?u:function(){try{u()}catch(n){be.Deferred.exceptionHook&&be.Deferred.exceptionHook(n,l.stackTrace),e+1>=a&&(r!==p&&(s=void 0,c=[n]),t.rejectWith(s,c))}};e?l():(be.Deferred.getStackHook&&(l.stackTrace=be.Deferred.getStackHook()),n.setTimeout(l))}}var a=0;return be.Deferred(function(n){t[0][3].add(o(0,n,be.isFunction(i)?i:f,n.notifyWith)),t[1][3].add(o(0,n,be.isFunction(e)?e:f)),t[2][3].add(o(0,n,be.isFunction(r)?r:p))}).promise()},promise:function(e){return null!=e?be.extend(e,i):i}},o={};return be.each(t,function(e,n){var a=n[2],s=n[5];i[n[1]]=a.add,s&&a.add(function(){r=s},t[3-e][2].disable,t[0][2].lock),a.add(n[3].fire),o[n[0]]=function(){return o[n[0]+"With"](this===o?void 0:this,arguments),this},o[n[0]+"With"]=a.fireWith}),i.promise(o),e&&e.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),i=ce.call(arguments),o=be.Deferred(),a=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?ce.call(arguments):n,--t||o.resolveWith(r,i)}};if(t<=1&&(h(e,o.done(a(n)).resolve,o.reject,!t),"pending"===o.state()||be.isFunction(i[n]&&i[n].then)))return o.then();for(;n--;)h(i[n],a(n),o.reject);return o.promise()}});var Me=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;be.Deferred.exceptionHook=function(e,t){n.console&&n.console.warn&&e&&Me.test(e.name)&&n.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},be.readyException=function(e){n.setTimeout(function(){throw e})};var je=be.Deferred();be.fn.ready=function(e){return je.then(e).catch(function(e){be.readyException(e)}),this},be.extend({isReady:!1,readyWait:1,ready:function(e){(e===!0?--be.readyWait:be.isReady)||(be.isReady=!0,e!==!0&&--be.readyWait>0||je.resolveWith(ae,[be]))}}),be.ready.then=je.then,"complete"===ae.readyState||"loading"!==ae.readyState&&!ae.documentElement.doScroll?n.setTimeout(be.ready):(ae.addEventListener("DOMContentLoaded",m),n.addEventListener("load",m));var Fe=function(e,t,n,r,i,o,a){var s=0,c=e.length,u=null==n;if("object"===be.type(n)){i=!0;for(s in n)Fe(e,t,s,n[s],!0,o,a)}else if(void 0!==r&&(i=!0,be.isFunction(r)||(a=!0),u&&(a?(t.call(e,r),t=null):(u=t,t=function(e,t,n){return u.call(be(e),n)})),t))for(;s<c;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:u?t.call(e):c?t(e[0],n):o},Ue=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};v.uid=1,v.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Ue(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[be.camelCase(t)]=n;else for(r in t)i[be.camelCase(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][be.camelCase(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){Array.isArray(t)?t=t.map(be.camelCase):(t=be.camelCase(t),t=t in r?[t]:t.match(Le)||[]),n=t.length;for(;n--;)delete r[t[n]]}(void 0===t||be.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!be.isEmptyObject(t)}};var Be=new v,Je=new v,He=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ge=/[A-Z]/g;be.extend({hasData:function(e){return Je.hasData(e)||Be.hasData(e)},data:function(e,t,n){return Je.access(e,t,n)},removeData:function(e,t){Je.remove(e,t)},_data:function(e,t,n){return Be.access(e,t,n)},_removeData:function(e,t){Be.remove(e,t)}}),be.fn.extend({data:function(e,t){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(i=Je.get(o),1===o.nodeType&&!Be.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&(r=a[n].name,0===r.indexOf("data-")&&(r=be.camelCase(r.slice(5)),y(o,r,i[r])));Be.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){Je.set(this,e)}):Fe(this,function(t){var n;if(o&&void 0===t){if(n=Je.get(o,e),void 0!==n)return n;if(n=y(o,e),void 0!==n)return n}else this.each(function(){Je.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Je.remove(this,e)})}}),be.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Be.get(e,t),n&&(!r||Array.isArray(n)?r=Be.access(e,t,be.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=be.queue(e,t),r=n.length,i=n.shift(),o=be._queueHooks(e,t),a=function(){be.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Be.get(e,n)||Be.access(e,n,{empty:be.Callbacks("once memory").add(function(){Be.remove(e,[t+"queue",n])})})}}),be.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?be.queue(this[0],e):void 0===t?this:this.each(function(){var n=be.queue(this,e,t);be._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&be.dequeue(this,e)})},dequeue:function(e){return this.each(function(){be.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=be.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)n=Be.get(o[a],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var Ve=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,We=new RegExp("^(?:([+-])=|)("+Ve+")([a-z%]*)$","i"),Ke=["Top","Right","Bottom","Left"],qe=function(e,t){return e=t||e,"none"===e.style.display||""===e.style.display&&be.contains(e.ownerDocument,e)&&"none"===be.css(e,"display")},ze=function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i},Xe={};be.fn.extend({show:function(){return S(this,!0)},hide:function(){return S(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){qe(this)?be(this).show():be(this).hide()})}});var $e=/^(?:checkbox|radio)$/i,Qe=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Ye=/^$|\/(?:java|ecma)script/i,Ze={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ze.optgroup=Ze.option,Ze.tbody=Ze.tfoot=Ze.colgroup=Ze.caption=Ze.thead,
Ze.th=Ze.td;var et=/<|&#?\w+;/;!function(){var e=ae.createDocumentFragment(),t=e.appendChild(ae.createElement("div")),n=ae.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),ge.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",ge.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var tt=ae.documentElement,nt=/^key/,rt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,it=/^([^.]*)(?:\.(.+)|)/;be.event={global:{},add:function(e,t,n,r,i){var o,a,s,c,u,l,d,f,p,h,m,v=Be.get(e);if(v)for(n.handler&&(o=n,n=o.handler,i=o.selector),i&&be.find.matchesSelector(tt,i),n.guid||(n.guid=be.guid++),(c=v.events)||(c=v.events={}),(a=v.handle)||(a=v.handle=function(t){return"undefined"!=typeof be&&be.event.triggered!==t.type?be.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(Le)||[""],u=t.length;u--;)s=it.exec(t[u])||[],p=m=s[1],h=(s[2]||"").split(".").sort(),p&&(d=be.event.special[p]||{},p=(i?d.delegateType:d.bindType)||p,d=be.event.special[p]||{},l=be.extend({type:p,origType:m,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&be.expr.match.needsContext.test(i),namespace:h.join(".")},o),(f=c[p])||(f=c[p]=[],f.delegateCount=0,d.setup&&d.setup.call(e,r,h,a)!==!1||e.addEventListener&&e.addEventListener(p,a)),d.add&&(d.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),i?f.splice(f.delegateCount++,0,l):f.push(l),be.event.global[p]=!0)},remove:function(e,t,n,r,i){var o,a,s,c,u,l,d,f,p,h,m,v=Be.hasData(e)&&Be.get(e);if(v&&(c=v.events)){for(t=(t||"").match(Le)||[""],u=t.length;u--;)if(s=it.exec(t[u])||[],p=m=s[1],h=(s[2]||"").split(".").sort(),p){for(d=be.event.special[p]||{},p=(r?d.delegateType:d.bindType)||p,f=c[p]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=f.length;o--;)l=f[o],!i&&m!==l.origType||n&&n.guid!==l.guid||s&&!s.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(f.splice(o,1),l.selector&&f.delegateCount--,d.remove&&d.remove.call(e,l));a&&!f.length&&(d.teardown&&d.teardown.call(e,h,v.handle)!==!1||be.removeEvent(e,p,v.handle),delete c[p])}else for(p in c)be.event.remove(e,p+t[u],n,r,!0);be.isEmptyObject(c)&&Be.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=be.event.fix(e),c=new Array(arguments.length),u=(Be.get(this,"events")||{})[s.type]||[],l=be.event.special[s.type]||{};for(c[0]=s,t=1;t<arguments.length;t++)c[t]=arguments[t];if(s.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,s)!==!1){for(a=be.event.handlers.call(this,s,u),t=0;(i=a[t++])&&!s.isPropagationStopped();)for(s.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!s.rnamespace.test(o.namespace)||(s.handleObj=o,s.data=o.data,r=((be.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,c),void 0!==r&&(s.result=r)===!1&&(s.preventDefault(),s.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,s),s.result}},handlers:function(e,t){var n,r,i,o,a,s=[],c=t.delegateCount,u=e.target;if(c&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||u.disabled!==!0)){for(o=[],a={},n=0;n<c;n++)r=t[n],i=r.selector+" ",void 0===a[i]&&(a[i]=r.needsContext?be(i,this).index(u)>-1:be.find(i,this,null,[u]).length),a[i]&&o.push(r);o.length&&s.push({elem:u,handlers:o})}return u=this,c<t.length&&s.push({elem:u,handlers:t.slice(c)}),s},addProp:function(e,t){Object.defineProperty(be.Event.prototype,e,{enumerable:!0,configurable:!0,get:be.isFunction(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[be.expando]?e:new be.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==A()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===A()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&c(this,"input"))return this.click(),!1},_default:function(e){return c(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},be.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},be.Event=function(e,t){return this instanceof be.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?_:R,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&be.extend(this,t),this.timeStamp=e&&e.timeStamp||be.now(),void(this[be.expando]=!0)):new be.Event(e,t)},be.Event.prototype={constructor:be.Event,isDefaultPrevented:R,isPropagationStopped:R,isImmediatePropagationStopped:R,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=_,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=_,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=_,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},be.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&nt.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&rt.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},be.event.addProp),be.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){be.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return i&&(i===r||be.contains(r,i))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),be.fn.extend({on:function(e,t,n,r){return k(this,e,t,n,r)},one:function(e,t,n,r){return k(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,be(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return t!==!1&&"function"!=typeof t||(n=t,t=void 0),n===!1&&(n=R),this.each(function(){be.event.remove(this,e,n,t)})}});var ot=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,at=/<script|<style|<link/i,st=/checked\s*(?:[^=]|=\s*.checked.)/i,ct=/^true\/(.*)/,ut=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;be.extend({htmlPrefilter:function(e){return e.replace(ot,"<$1></$2>")},clone:function(e,t,n){var r,i,o,a,s=e.cloneNode(!0),c=be.contains(e.ownerDocument,e);if(!(ge.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||be.isXMLDoc(e)))for(a=T(s),o=T(e),r=0,i=o.length;r<i;r++)N(o[r],a[r]);if(t)if(n)for(o=o||T(e),a=a||T(s),r=0,i=o.length;r<i;r++)D(o[r],a[r]);else D(e,s);return a=T(s,"script"),a.length>0&&C(a,!c&&T(e,"script")),s},cleanData:function(e){for(var t,n,r,i=be.event.special,o=0;void 0!==(n=e[o]);o++)if(Ue(n)){if(t=n[Be.expando]){if(t.events)for(r in t.events)i[r]?be.event.remove(n,r):be.removeEvent(n,r,t.handle);n[Be.expando]=void 0}n[Je.expando]&&(n[Je.expando]=void 0)}}}),be.fn.extend({detach:function(e){return L(this,e,!0)},remove:function(e){return L(this,e)},text:function(e){return Fe(this,function(e){return void 0===e?be.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return x(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=O(this,e);t.appendChild(e)}})},prepend:function(){return x(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=O(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return x(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return x(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(be.cleanData(T(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return be.clone(this,e,t)})},html:function(e){return Fe(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!at.test(e)&&!Ze[(Qe.exec(e)||["",""])[1].toLowerCase()]){e=be.htmlPrefilter(e);try{for(;n<r;n++)t=this[n]||{},1===t.nodeType&&(be.cleanData(T(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return x(this,arguments,function(t){var n=this.parentNode;be.inArray(this,e)<0&&(be.cleanData(T(this)),n&&n.replaceChild(t,this))},e)}}),be.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){be.fn[e]=function(e){for(var n,r=[],i=be(e),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),be(i[a])[t](n),le.apply(r,n.get());return this.pushStack(r)}});var lt=/^margin/,dt=new RegExp("^("+Ve+")(?!px)[a-z%]+$","i"),ft=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=n),t.getComputedStyle(e)};!function(){function e(){if(s){s.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",s.innerHTML="",tt.appendChild(a);var e=n.getComputedStyle(s);t="1%"!==e.top,o="2px"===e.marginLeft,r="4px"===e.width,s.style.marginRight="50%",i="4px"===e.marginRight,tt.removeChild(a),s=null}}var t,r,i,o,a=ae.createElement("div"),s=ae.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",ge.clearCloneStyle="content-box"===s.style.backgroundClip,a.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",a.appendChild(s),be.extend(ge,{pixelPosition:function(){return e(),t},boxSizingReliable:function(){return e(),r},pixelMarginRight:function(){return e(),i},reliableMarginLeft:function(){return e(),o}}))}();var pt=/^(none|table(?!-c[ea]).+)/,ht=/^--/,mt={position:"absolute",visibility:"hidden",display:"block"},vt={letterSpacing:"0",fontWeight:"400"},gt=["Webkit","Moz","ms"],yt=ae.createElement("div").style;be.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=M(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=be.camelCase(t),c=ht.test(t),u=e.style;return c||(t=U(s)),a=be.cssHooks[t]||be.cssHooks[s],void 0===n?a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:u[t]:(o=typeof n,"string"===o&&(i=We.exec(n))&&i[1]&&(n=b(e,t,i),o="number"),void(null!=n&&n===n&&("number"===o&&(n+=i&&i[3]||(be.cssNumber[s]?"":"px")),ge.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(c?u.setProperty(t,n):u[t]=n))))}},css:function(e,t,n,r){var i,o,a,s=be.camelCase(t),c=ht.test(t);return c||(t=U(s)),a=be.cssHooks[t]||be.cssHooks[s],a&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=M(e,t,r)),"normal"===i&&t in vt&&(i=vt[t]),""===n||n?(o=parseFloat(i),n===!0||isFinite(o)?o||0:i):i}}),be.each(["height","width"],function(e,t){be.cssHooks[t]={get:function(e,n,r){if(n)return!pt.test(be.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?H(e,t,r):ze(e,mt,function(){return H(e,t,r)})},set:function(e,n,r){var i,o=r&&ft(e),a=r&&J(e,t,r,"border-box"===be.css(e,"boxSizing",!1,o),o);return a&&(i=We.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=be.css(e,t)),B(e,n,a)}}}),be.cssHooks.marginLeft=j(ge.reliableMarginLeft,function(e,t){if(t)return(parseFloat(M(e,"marginLeft"))||e.getBoundingClientRect().left-ze(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),be.each({margin:"",padding:"",border:"Width"},function(e,t){be.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+Ke[r]+t]=o[r]||o[r-2]||o[0];return i}},lt.test(e)||(be.cssHooks[e+t].set=B)}),be.fn.extend({css:function(e,t){return Fe(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=ft(e),i=t.length;a<i;a++)o[t[a]]=be.css(e,t[a],!1,r);return o}return void 0!==n?be.style(e,t,n):be.css(e,t)},e,t,arguments.length>1)}}),be.Tween=G,G.prototype={constructor:G,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||be.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(be.cssNumber[n]?"":"px")},cur:function(){var e=G.propHooks[this.prop];return e&&e.get?e.get(this):G.propHooks._default.get(this)},run:function(e){var t,n=G.propHooks[this.prop];return this.options.duration?this.pos=t=be.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):G.propHooks._default.set(this),this}},G.prototype.init.prototype=G.prototype,G.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=be.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){be.fx.step[e.prop]?be.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[be.cssProps[e.prop]]&&!be.cssHooks[e.prop]?e.elem[e.prop]=e.now:be.style(e.elem,e.prop,e.now+e.unit)}}},G.propHooks.scrollTop=G.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},be.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},be.fx=G.prototype.init,be.fx.step={};var bt,Et,St=/^(?:toggle|show|hide)$/,Tt=/queueHooks$/;be.Animation=be.extend($,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return b(n.elem,e,We.exec(t),n),n}]},tweener:function(e,t){be.isFunction(e)?(t=e,e=["*"]):e=e.match(Le);for(var n,r=0,i=e.length;r<i;r++)n=e[r],$.tweeners[n]=$.tweeners[n]||[],$.tweeners[n].unshift(t)},prefilters:[z],prefilter:function(e,t){t?$.prefilters.unshift(e):$.prefilters.push(e)}}),be.speed=function(e,t,n){var r=e&&"object"==typeof e?be.extend({},e):{complete:n||!n&&t||be.isFunction(e)&&e,duration:e,easing:n&&t||t&&!be.isFunction(t)&&t};return be.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in be.fx.speeds?r.duration=be.fx.speeds[r.duration]:r.duration=be.fx.speeds._default),null!=r.queue&&r.queue!==!0||(r.queue="fx"),r.old=r.complete,r.complete=function(){be.isFunction(r.old)&&r.old.call(this),r.queue&&be.dequeue(this,r.queue)},r},be.fn.extend({fadeTo:function(e,t,n,r){return this.filter(qe).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=be.isEmptyObject(e),o=be.speed(t,n,r),a=function(){var t=$(this,be.extend({},e),o);(i||Be.get(this,"finish"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=be.timers,a=Be.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&Tt.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||be.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=Be.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=be.timers,a=r?r.length:0;for(n.finish=!0,be.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),be.each(["toggle","show","hide"],function(e,t){var n=be.fn[t];be.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(K(t,!0),e,r,i)}}),be.each({slideDown:K("show"),slideUp:K("hide"),slideToggle:K("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){be.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),be.timers=[],be.fx.tick=function(){var e,t=0,n=be.timers;for(bt=be.now();t<n.length;t++)e=n[t],e()||n[t]!==e||n.splice(t--,1);n.length||be.fx.stop(),bt=void 0},be.fx.timer=function(e){be.timers.push(e),be.fx.start()},be.fx.interval=13,be.fx.start=function(){Et||(Et=!0,V())},be.fx.stop=function(){Et=null},be.fx.speeds={slow:600,fast:200,_default:400},be.fn.delay=function(e,t){return e=be.fx?be.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,r){var i=n.setTimeout(t,e);r.stop=function(){n.clearTimeout(i)}})},function(){var e=ae.createElement("input"),t=ae.createElement("select"),n=t.appendChild(ae.createElement("option"));e.type="checkbox",ge.checkOn=""!==e.value,ge.optSelected=n.selected,e=ae.createElement("input"),e.value="t",e.type="radio",ge.radioValue="t"===e.value}();var Ct,wt=be.expr.attrHandle;be.fn.extend({attr:function(e,t){return Fe(this,be.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){be.removeAttr(this,e)})}}),be.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?be.prop(e,t,n):(1===o&&be.isXMLDoc(e)||(i=be.attrHooks[t.toLowerCase()]||(be.expr.match.bool.test(t)?Ct:void 0)),void 0!==n?null===n?void be.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:(r=be.find.attr(e,t),null==r?void 0:r))},attrHooks:{type:{set:function(e,t){if(!ge.radioValue&&"radio"===t&&c(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(Le);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),Ct={set:function(e,t,n){return t===!1?be.removeAttr(e,n):e.setAttribute(n,n),n}},be.each(be.expr.match.bool.source.match(/\w+/g),function(e,t){var n=wt[t]||be.find.attr;wt[t]=function(e,t,r){var i,o,a=t.toLowerCase();return r||(o=wt[a],wt[a]=i,i=null!=n(e,t,r)?a:null,wt[a]=o),i}});var _t=/^(?:input|select|textarea|button)$/i,Rt=/^(?:a|area)$/i;be.fn.extend({prop:function(e,t){return Fe(this,be.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[be.propFix[e]||e]})}}),be.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&be.isXMLDoc(e)||(t=be.propFix[t]||t,i=be.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=be.find.attr(e,"tabindex");return t?parseInt(t,10):_t.test(e.nodeName)||Rt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),ge.optSelected||(be.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),be.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){be.propFix[this.toLowerCase()]=this}),be.fn.extend({addClass:function(e){var t,n,r,i,o,a,s,c=0;if(be.isFunction(e))return this.each(function(t){be(this).addClass(e.call(this,t,Y(this)))});if("string"==typeof e&&e)for(t=e.match(Le)||[];n=this[c++];)if(i=Y(n),r=1===n.nodeType&&" "+Q(i)+" "){for(a=0;o=t[a++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");s=Q(r),i!==s&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,i,o,a,s,c=0;if(be.isFunction(e))return this.each(function(t){be(this).removeClass(e.call(this,t,Y(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(Le)||[];n=this[c++];)if(i=Y(n),r=1===n.nodeType&&" "+Q(i)+" "){for(a=0;o=t[a++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");s=Q(r),i!==s&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):be.isFunction(e)?this.each(function(n){be(this).toggleClass(e.call(this,n,Y(this),t),t)}):this.each(function(){var t,r,i,o;if("string"===n)for(r=0,i=be(this),o=e.match(Le)||[];t=o[r++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==e&&"boolean"!==n||(t=Y(this),t&&Be.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||e===!1?"":Be.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+Q(Y(n))+" ").indexOf(t)>-1)return!0;return!1}});var At=/\r/g;be.fn.extend({val:function(e){var t,n,r,i=this[0];return arguments.length?(r=be.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,be(this).val()):e,null==i?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=be.map(i,function(e){return null==e?"":e+""})),t=be.valHooks[this.type]||be.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))})):i?(t=be.valHooks[i.type]||be.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:(n=i.value,"string"==typeof n?n.replace(At,""):null==n?"":n)):void 0}}),be.extend({valHooks:{option:{get:function(e){var t=be.find.attr(e,"value");return null!=t?t:Q(be.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(n=i[r],(n.selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!c(n.parentNode,"optgroup"))){if(t=be(n).val(),a)return t;s.push(t)}return s},set:function(e,t){for(var n,r,i=e.options,o=be.makeArray(t),a=i.length;a--;)r=i[a],(r.selected=be.inArray(be.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),be.each(["radio","checkbox"],function(){be.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=be.inArray(be(e).val(),t)>-1}},ge.checkOn||(be.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var kt=/^(?:focusinfocus|focusoutblur)$/;be.extend(be.event,{trigger:function(e,t,r,i){var o,a,s,c,u,l,d,f=[r||ae],p=he.call(e,"type")?e.type:e,h=he.call(e,"namespace")?e.namespace.split("."):[];if(a=s=r=r||ae,3!==r.nodeType&&8!==r.nodeType&&!kt.test(p+be.event.triggered)&&(p.indexOf(".")>-1&&(h=p.split("."),p=h.shift(),h.sort()),u=p.indexOf(":")<0&&"on"+p,e=e[be.expando]?e:new be.Event(p,"object"==typeof e&&e),e.isTrigger=i?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),t=null==t?[e]:be.makeArray(t,[e]),d=be.event.special[p]||{},i||!d.trigger||d.trigger.apply(r,t)!==!1)){if(!i&&!d.noBubble&&!be.isWindow(r)){for(c=d.delegateType||p,kt.test(c+p)||(a=a.parentNode);a;a=a.parentNode)f.push(a),s=a;s===(r.ownerDocument||ae)&&f.push(s.defaultView||s.parentWindow||n)}for(o=0;(a=f[o++])&&!e.isPropagationStopped();)e.type=o>1?c:d.bindType||p,l=(Be.get(a,"events")||{})[e.type]&&Be.get(a,"handle"),l&&l.apply(a,t),l=u&&a[u],l&&l.apply&&Ue(a)&&(e.result=l.apply(a,t),e.result===!1&&e.preventDefault());return e.type=p,i||e.isDefaultPrevented()||d._default&&d._default.apply(f.pop(),t)!==!1||!Ue(r)||u&&be.isFunction(r[p])&&!be.isWindow(r)&&(s=r[u],s&&(r[u]=null),be.event.triggered=p,r[p](),be.event.triggered=void 0,s&&(r[u]=s)),e.result}},simulate:function(e,t,n){var r=be.extend(new be.Event,n,{type:e,isSimulated:!0});be.event.trigger(r,null,t)}}),be.fn.extend({trigger:function(e,t){return this.each(function(){be.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return be.event.trigger(e,t,n,!0)}}),be.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){be.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),be.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),ge.focusin="onfocusin"in n,ge.focusin||be.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){be.event.simulate(t,e.target,be.event.fix(e))};be.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=Be.access(r,t);i||r.addEventListener(e,n,!0),Be.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=Be.access(r,t)-1;i?Be.access(r,t,i):(r.removeEventListener(e,n,!0),Be.remove(r,t))}}});var Ot=n.location,It=be.now(),Pt=/\?/;be.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new n.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||be.error("Invalid XML: "+e),t};var Dt=/\[\]$/,Nt=/\r?\n/g,xt=/^(?:submit|button|image|reset|file)$/i,Lt=/^(?:input|select|textarea|keygen)/i;be.param=function(e,t){var n,r=[],i=function(e,t){var n=be.isFunction(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(e)||e.jquery&&!be.isPlainObject(e))be.each(e,function(){i(this.name,this.value)});else for(n in e)Z(n,e[n],t,i);return r.join("&")},be.fn.extend({serialize:function(){return be.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=be.prop(this,"elements");return e?be.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!be(this).is(":disabled")&&Lt.test(this.nodeName)&&!xt.test(e)&&(this.checked||!$e.test(e))}).map(function(e,t){var n=be(this).val();return null==n?null:Array.isArray(n)?be.map(n,function(e){return{name:t.name,value:e.replace(Nt,"\r\n")}}):{name:t.name,value:n.replace(Nt,"\r\n")}}).get()}});var Mt=/%20/g,jt=/#.*$/,Ft=/([?&])_=[^&]*/,Ut=/^(.*?):[ \t]*([^\r\n]*)$/gm,Bt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Jt=/^(?:GET|HEAD)$/,Ht=/^\/\//,Gt={},Vt={},Wt="*/".concat("*"),Kt=ae.createElement("a");Kt.href=Ot.href,be.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ot.href,type:"GET",isLocal:Bt.test(Ot.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Wt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":be.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ne(ne(e,be.ajaxSettings),t):ne(be.ajaxSettings,e)},ajaxPrefilter:ee(Gt),ajaxTransport:ee(Vt),ajax:function(e,t){function r(e,t,r,s){var u,f,p,E,S,T=t;l||(l=!0,c&&n.clearTimeout(c),i=void 0,a=s||"",C.readyState=e>0?4:0,u=e>=200&&e<300||304===e,r&&(E=re(h,C,r)),E=ie(h,E,C,u),u?(h.ifModified&&(S=C.getResponseHeader("Last-Modified"),S&&(be.lastModified[o]=S),S=C.getResponseHeader("etag"),S&&(be.etag[o]=S)),204===e||"HEAD"===h.type?T="nocontent":304===e?T="notmodified":(T=E.state,f=E.data,p=E.error,u=!p)):(p=T,!e&&T||(T="error",e<0&&(e=0))),C.status=e,C.statusText=(t||T)+"",u?g.resolveWith(m,[f,T,C]):g.rejectWith(m,[C,T,p]),C.statusCode(b),b=void 0,d&&v.trigger(u?"ajaxSuccess":"ajaxError",[C,h,u?f:p]),y.fireWith(m,[C,T]),d&&(v.trigger("ajaxComplete",[C,h]),--be.active||be.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,o,a,s,c,u,l,d,f,p,h=be.ajaxSetup({},t),m=h.context||h,v=h.context&&(m.nodeType||m.jquery)?be(m):be.event,g=be.Deferred(),y=be.Callbacks("once memory"),b=h.statusCode||{},E={},S={},T="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(l){if(!s)for(s={};t=Ut.exec(a);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return l?a:null},setRequestHeader:function(e,t){return null==l&&(e=S[e.toLowerCase()]=S[e.toLowerCase()]||e,E[e]=t),this},overrideMimeType:function(e){return null==l&&(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(l)C.always(e[C.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||T;return i&&i.abort(t),r(0,t),this}};if(g.promise(C),h.url=((e||h.url||Ot.href)+"").replace(Ht,Ot.protocol+"//"),h.type=t.method||t.type||h.method||h.type,h.dataTypes=(h.dataType||"*").toLowerCase().match(Le)||[""],null==h.crossDomain){u=ae.createElement("a");try{u.href=h.url,u.href=u.href,h.crossDomain=Kt.protocol+"//"+Kt.host!=u.protocol+"//"+u.host}catch(e){h.crossDomain=!0}}if(h.data&&h.processData&&"string"!=typeof h.data&&(h.data=be.param(h.data,h.traditional)),te(Gt,h,t,C),l)return C;d=be.event&&h.global,d&&0===be.active++&&be.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Jt.test(h.type),o=h.url.replace(jt,""),h.hasContent?h.data&&h.processData&&0===(h.contentType||"").indexOf("application/x-www-form-urlencoded")&&(h.data=h.data.replace(Mt,"+")):(p=h.url.slice(o.length),h.data&&(o+=(Pt.test(o)?"&":"?")+h.data,delete h.data),h.cache===!1&&(o=o.replace(Ft,"$1"),p=(Pt.test(o)?"&":"?")+"_="+It++ +p),h.url=o+p),h.ifModified&&(be.lastModified[o]&&C.setRequestHeader("If-Modified-Since",be.lastModified[o]),be.etag[o]&&C.setRequestHeader("If-None-Match",be.etag[o])),(h.data&&h.hasContent&&h.contentType!==!1||t.contentType)&&C.setRequestHeader("Content-Type",h.contentType),C.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Wt+"; q=0.01":""):h.accepts["*"]);for(f in h.headers)C.setRequestHeader(f,h.headers[f]);if(h.beforeSend&&(h.beforeSend.call(m,C,h)===!1||l))return C.abort();if(T="abort",y.add(h.complete),C.done(h.success),C.fail(h.error),i=te(Vt,h,t,C)){if(C.readyState=1,d&&v.trigger("ajaxSend",[C,h]),l)return C;h.async&&h.timeout>0&&(c=n.setTimeout(function(){C.abort("timeout")},h.timeout));try{l=!1,i.send(E,r)}catch(e){if(l)throw e;r(-1,e)}}else r(-1,"No Transport");return C},getJSON:function(e,t,n){return be.get(e,t,n,"json")},getScript:function(e,t){return be.get(e,void 0,t,"script")}}),be.each(["get","post"],function(e,t){be[t]=function(e,n,r,i){return be.isFunction(n)&&(i=i||r,r=n,n=void 0),be.ajax(be.extend({url:e,type:t,dataType:i,data:n,success:r},be.isPlainObject(e)&&e))}}),be._evalUrl=function(e){return be.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},be.fn.extend({wrapAll:function(e){var t;return this[0]&&(be.isFunction(e)&&(e=e.call(this[0])),t=be(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return be.isFunction(e)?this.each(function(t){be(this).wrapInner(e.call(this,t))}):this.each(function(){var t=be(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=be.isFunction(e);return this.each(function(n){be(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){be(this).replaceWith(this.childNodes)}),this}}),be.expr.pseudos.hidden=function(e){return!be.expr.pseudos.visible(e)},be.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length);
},be.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(e){}};var qt={0:200,1223:204},zt=be.ajaxSettings.xhr();ge.cors=!!zt&&"withCredentials"in zt,ge.ajax=zt=!!zt,be.ajaxTransport(function(e){var t,r;if(ge.cors||zt&&!e.crossDomain)return{send:function(i,o){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(a in i)s.setRequestHeader(a,i[a]);t=function(e){return function(){t&&(t=r=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(qt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=t(),r=s.onerror=t("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&n.setTimeout(function(){t&&r()})},t=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}}),be.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),be.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return be.globalEval(e),e}}}),be.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),be.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=be("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),ae.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Xt=[],$t=/(=)\?(?=&|$)|\?\?/;be.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Xt.pop()||be.expando+"_"+It++;return this[e]=!0,e}}),be.ajaxPrefilter("json jsonp",function(e,t,r){var i,o,a,s=e.jsonp!==!1&&($t.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&$t.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=be.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace($t,"$1"+i):e.jsonp!==!1&&(e.url+=(Pt.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return a||be.error(i+" was not called"),a[0]},e.dataTypes[0]="json",o=n[i],n[i]=function(){a=arguments},r.always(function(){void 0===o?be(n).removeProp(i):n[i]=o,e[i]&&(e.jsonpCallback=t.jsonpCallback,Xt.push(i)),a&&be.isFunction(o)&&o(a[0]),a=o=void 0}),"script"}),ge.createHTMLDocument=function(){var e=ae.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),be.parseHTML=function(e,t,n){if("string"!=typeof e)return[];"boolean"==typeof t&&(n=t,t=!1);var r,i,o;return t||(ge.createHTMLDocument?(t=ae.implementation.createHTMLDocument(""),r=t.createElement("base"),r.href=ae.location.href,t.head.appendChild(r)):t=ae),i=ke.exec(e),o=!n&&[],i?[t.createElement(i[1])]:(i=w([e],t,o),o&&o.length&&be(o).remove(),be.merge([],i.childNodes))},be.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return s>-1&&(r=Q(e.slice(s)),e=e.slice(0,s)),be.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),a.length>0&&be.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?be("<div>").append(be.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},be.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){be.fn[t]=function(e){return this.on(t,e)}}),be.expr.pseudos.animated=function(e){return be.grep(be.timers,function(t){return e===t.elem}).length},be.offset={setOffset:function(e,t,n){var r,i,o,a,s,c,u,l=be.css(e,"position"),d=be(e),f={};"static"===l&&(e.style.position="relative"),s=d.offset(),o=be.css(e,"top"),c=be.css(e,"left"),u=("absolute"===l||"fixed"===l)&&(o+c).indexOf("auto")>-1,u?(r=d.position(),a=r.top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(c)||0),be.isFunction(t)&&(t=t.call(e,n,be.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):d.css(f)}},be.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){be.offset.setOffset(this,e,t)});var t,n,r,i,o=this[0];return o?o.getClientRects().length?(r=o.getBoundingClientRect(),t=o.ownerDocument,n=t.documentElement,i=t.defaultView,{top:r.top+i.pageYOffset-n.clientTop,left:r.left+i.pageXOffset-n.clientLeft}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===be.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),c(e[0],"html")||(r=e.offset()),r={top:r.top+be.css(e[0],"borderTopWidth",!0),left:r.left+be.css(e[0],"borderLeftWidth",!0)}),{top:t.top-r.top-be.css(n,"marginTop",!0),left:t.left-r.left-be.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===be.css(e,"position");)e=e.offsetParent;return e||tt})}}),be.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;be.fn[e]=function(r){return Fe(this,function(e,r,i){var o;return be.isWindow(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===i?o?o[t]:e[r]:void(o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i)},e,r,arguments.length)}}),be.each(["top","left"],function(e,t){be.cssHooks[t]=j(ge.pixelPosition,function(e,n){if(n)return n=M(e,t),dt.test(n)?be(e).position()[t]+"px":n})}),be.each({Height:"height",Width:"width"},function(e,t){be.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){be.fn[r]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(i===!0||o===!0?"margin":"border");return Fe(this,function(t,n,i){var o;return be.isWindow(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?be.css(t,n,s):be.style(t,n,i,s)},t,a?i:void 0,a)}})}),be.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),be.holdReady=function(e){e?be.readyWait++:be.ready(!0)},be.isArray=Array.isArray,be.parseJSON=JSON.parse,be.nodeName=c,r=[],i=function(){return be}.apply(t,r),!(void 0!==i&&(e.exports=i));var Qt=n.jQuery,Yt=n.$;return be.noConflict=function(e){return n.$===be&&(n.$=Yt),e&&n.jQuery===be&&(n.jQuery=Qt),be},o||(n.jQuery=n.$=be),be})},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AUDIO="audio",t.VIDEO="video"},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e){R||(w.loadScript(e?e:"https://api.callstats.io/static/callstats-ws.min.js",!0,!0),R=!0)}function a(e){var t=new Error;return t.stack=e.stack,t.name=(e.name||"Unknown error")+(e.gum&&e.gum.error&&e.gum.error.name?" - "+e.gum.error.name:""),t.constraintName=e.gum&&e.gum.constraints?JSON.stringify(e.gum.constraints):"",t.message=e.message,t}function s(e,t){this.rtpStats=null,this.eventEmitter=new T,this.xmpp=e,this.options=t||{},this.callStatsIntegrationEnabled=this.options.callStatsID&&this.options.callStatsSecret&&s.disableThirdPartyRequests!==!0,this.callStatsIntegrationEnabled&&(o(this.options.callStatsCustomScriptUrl),this.options.callStatsConfIDNamespace||C.warn('"callStatsConfIDNamespace" is not defined')),this.callsStatsInstances=new Map,s.instances.add(this)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var c=n(90),u=i(c),l=n(92),d=i(l),f=n(12),p=i(f),h=n(45),m=i(h),v=n(93),g=i(v),y=n(52),b=r(y),E=n(31),S=i(E),T=n(17),C=n(1).getLogger(e),w=n(47),_=void 0,R=!1;s.init=function(e){s.audioLevelsEnabled=!e.disableAudioLevels,"number"==typeof e.audioLevelsInterval&&(s.audioLevelsInterval=e.audioLevelsInterval),s.disableThirdPartyRequests=e.disableThirdPartyRequests},s.audioLevelsEnabled=!1,s.audioLevelsInterval=200,s.disableThirdPartyRequests=!1,s.analytics=u.default,Object.defineProperty(s,"instances",{get:function(){return _||(_=new Set),_}}),s.prototype.startRemoteStats=function(e){this.stopRemoteStats();try{this.rtpStats=new g.default(e,s.audioLevelsInterval,2e3,this.eventEmitter),this.rtpStats.start(s.audioLevelsEnabled)}catch(e){this.rtpStats=null,C.error("Failed to start collecting remote statistics: "+e)}},s.localStats=[],s.startLocalStats=function(e,t){if(s.audioLevelsEnabled){var n=new m.default(e,s.audioLevelsInterval,t);this.localStats.push(n),n.start()}},s.prototype.addAudioLevelListener=function(e){s.audioLevelsEnabled&&this.eventEmitter.on(b.AUDIO_LEVEL,e)},s.prototype.removeAudioLevelListener=function(e){s.audioLevelsEnabled&&this.eventEmitter.removeListener(b.AUDIO_LEVEL,e)},s.prototype.addBeforeDisposedListener=function(e){this.eventEmitter.on(b.BEFORE_DISPOSED,e)},s.prototype.removeBeforeDisposedListener=function(e){this.eventEmitter.removeListener(b.BEFORE_DISPOSED,e)},s.prototype.addConnectionStatsListener=function(e){this.eventEmitter.on(b.CONNECTION_STATS,e)},s.prototype.removeConnectionStatsListener=function(e){this.eventEmitter.removeListener(b.CONNECTION_STATS,e)},s.prototype.addByteSentStatsListener=function(e){this.eventEmitter.on(b.BYTE_SENT_STATS,e)},s.prototype.removeByteSentStatsListener=function(e){this.eventEmitter.removeListener(b.BYTE_SENT_STATS,e)},s.prototype.dispose=function(){try{this.callsStatsInstances.size||this.eventEmitter.emit(b.BEFORE_DISPOSED);var e=!0,t=!1,n=void 0;try{for(var r,i=this.callsStatsInstances.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this.stopCallStats(o.tpc)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this.stopRemoteStats(),this.eventEmitter&&this.eventEmitter.removeAllListeners()}finally{s.instances.delete(this)}},s.stopLocalStats=function(e){if(s.audioLevelsEnabled)for(var t=0;t<s.localStats.length;t++)if(s.localStats[t].stream===e){var n=s.localStats.splice(t,1);n[0].stop();break}},s.prototype.stopRemoteStats=function(){this.rtpStats&&(this.rtpStats.stop(),this.rtpStats=null)},s.prototype.startCallStats=function(e,t){if(this.callStatsIntegrationEnabled){if(this.callsStatsInstances.has(e.id))return void C.error("CallStats instance for ${tpc} exists already");if(!d.default.isBackendInitialized()){var n=S.default.getCallStatsUserName();if(!d.default.initBackend({callStatsID:this.options.callStatsID,callStatsSecret:this.options.callStatsSecret,userName:n,aliasName:this.options.callStatsAliasName}))return}C.info("Starting CallStats for "+e+"...");var r=new d.default(e,{confID:this._getCallStatsConfID(),remoteUserID:t});this.callsStatsInstances.set(e.id,r)}},s._getAllCallStatsInstances=function(){var e=new Set,t=!0,n=!1,r=void 0;try{for(var i,o=s.instances[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,c=!0,u=!1,l=void 0;try{for(var d,f=a.callsStatsInstances.values()[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var p=d.value;e.add(p)}}catch(e){u=!0,l=e}finally{try{!c&&f.return&&f.return()}finally{if(u)throw l}}}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return e},s.prototype._getCallStatsConfID=function(){return this.options.callStatsConfIDNamespace?this.options.callStatsConfIDNamespace+"/"+this.options.roomName:this.options.roomName},s.prototype.stopCallStats=function(e){var t=this.callsStatsInstances.get(e.id);t&&(1===this.callsStatsInstances.size&&this.eventEmitter.emit(b.BEFORE_DISPOSED),this.callsStatsInstances.delete(e.id),t.sendTerminateEvent())},s.prototype.isCallstatsEnabled=function(){return this.callStatsIntegrationEnabled},s.prototype.sendConnectionResumeOrHoldEvent=function(e,t){var n=this.callsStatsInstances.get(e.id);n&&n.sendResumeOrHoldEvent(t)},s.prototype.sendIceConnectionFailedEvent=function(e){var t=this.callsStatsInstances.get(e.id);t&&t.sendIceConnectionFailedEvent(),s.analytics.sendEvent("connection.ice_failed")},s.prototype.sendMuteEvent=function(e,t,n){var r=e&&this.callsStatsInstances.get(e.id);d.default.sendMuteEvent(t,n,r)},s.prototype.sendScreenSharingEvent=function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.callsStatsInstances.values()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.sendScreenSharingEvent(e)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}},s.prototype.sendDominantSpeakerEvent=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.callsStatsInstances.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;o.sendDominantSpeakerEvent()}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}},s.sendActiveDeviceListEvent=function(e){var t=s._getAllCallStatsInstances();if(t.size){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var c=o.value;d.default.sendActiveDeviceListEvent(e,c)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}else d.default.sendActiveDeviceListEvent(e,null)},s.prototype.associateStreamWithVideoTag=function(e,t,n,r,i,o){var a=this.callsStatsInstances.get(e.id);a&&a.associateStreamWithVideoTag(t,n,r,i,o)},s.sendGetUserMediaFailed=function(e){var t=e instanceof p.default?a(e):e,n=s._getAllCallStatsInstances();if(n.size){var r=!0,i=!1,o=void 0;try{for(var c,u=n[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var l=c.value;d.default.sendGetUserMediaFailed(t,l)}}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}}else d.default.sendGetUserMediaFailed(t,null)},s.prototype.sendCreateOfferFailed=function(e,t){var n=this.callsStatsInstances.get(t.id);n&&n.sendCreateOfferFailed(e)},s.prototype.sendCreateAnswerFailed=function(e,t){var n=this.callsStatsInstances.get(t.id);n&&n.sendCreateAnswerFailed(e)},s.prototype.sendSetLocalDescFailed=function(e,t){var n=this.callsStatsInstances.get(t.id);n&&n.sendSetLocalDescFailed(e)},s.prototype.sendSetRemoteDescFailed=function(e,t){var n=this.callsStatsInstances.get(t.id);n&&n.sendSetRemoteDescFailed(e)},s.prototype.sendAddIceCandidateFailed=function(e,t){var n=this.callsStatsInstances.get(t.id);n&&n.sendAddIceCandidateFailed(e)},s.sendLog=function(e){var t=new Set,n=!0,r=!1,i=void 0;try{for(var o,a=s.instances[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var c=o.value;c.callsStatsInstances.size&&t.add(c.callsStatsInstances.values().next().value)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}if(t.size){var u=!0,l=!1,f=void 0;try{for(var p,h=t[Symbol.iterator]();!(u=(p=h.next()).done);u=!0){var m=p.value;d.default.sendApplicationLog(e,m)}}catch(e){l=!0,f=e}finally{try{!u&&h.return&&h.return()}finally{if(l)throw f}}}else d.default.sendApplicationLog(e,null)},s.prototype.sendFeedback=function(e,t){d.default.sendFeedback(this._getCallStatsConfID(),e,t),s.analytics.sendEvent("feedback.rating",{value:e,detailed:t})},s.LOCAL_JID=n(125).LOCAL_JID,s.reportGlobalError=function(e){e instanceof p.default&&e.gum?s.sendGetUserMediaFailed(e):s.sendLog(e)},s.sendEventToAll=function(e,t){this.analytics.sendEvent(e,t),s.sendLog(JSON.stringify({name:e,data:t}))}}).call(t,"modules/statistics/statistics.js")},function(e,t){"use strict";var n={ADD_ICE_CANDIDATE_FAILED:"xmpp.add_ice_candidate_failed",AUDIO_MUTED_BY_FOCUS:"xmpp.audio_muted_by_focus",AUTHENTICATION_REQUIRED:"xmpp.authentication_required",BRIDGE_DOWN:"xmpp.bridge_down",CALL_ACCEPTED:"xmpp.callaccepted.jingle",CALL_INCOMING:"xmpp.callincoming.jingle",CALL_ENDED:"xmpp.callended.jingle",CHAT_ERROR_RECEIVED:"xmpp.chat_error_received",CONFERENCE_SETUP_FAILED:"xmpp.conference_setup_failed",CONNECTION_ESTABLISHED:"xmpp.connection.connected",CONNECTION_FAILED:"xmpp.connection.failed",CONNECTION_INTERRUPTED:"xmpp.connection.interrupted",CONNECTION_RESTORED:"xmpp.connection.restored",CONNECTION_ICE_FAILED:"xmpp.connection.ice.failed",DISPLAY_NAME_CHANGED:"xmpp.display_name_changed",EMUC_ROOM_ADDED:"xmpp.emuc_room_added",EMUC_ROOM_REMOVED:"xmpp.emuc_room_removed",ETHERPAD:"xmpp.etherpad",FOCUS_DISCONNECTED:"xmpp.focus_disconnected",FOCUS_LEFT:"xmpp.focus_left",GRACEFUL_SHUTDOWN:"xmpp.graceful_shutdown",ICE_RESTARTING:"rtc.ice_restarting",JINGLE_ERROR:"xmpp.jingle_error",JINGLE_FATAL_ERROR:"xmpp.jingle_fatal_error",KICKED:"xmpp.kicked",LOCAL_ROLE_CHANGED:"xmpp.localrole_changed",MESSAGE_RECEIVED:"xmpp.message_received",MUC_DESTROYED:"xmpp.muc_destroyed",MUC_JOINED:"xmpp.muc_joined",MUC_MEMBER_JOINED:"xmpp.muc_member_joined",MUC_MEMBER_LEFT:"xmpp.muc_member_left",MUC_LEFT:"xmpp.muc_left",MUC_ROLE_CHANGED:"xmpp.muc_role_changed",MUC_LOCK_CHANGED:"xmpp.muc_lock_changed",PARTICIPANT_AUDIO_MUTED:"xmpp.audio_muted",PARTICIPANT_VIDEO_MUTED:"xmpp.video_muted",PARTICIPANT_VIDEO_TYPE_CHANGED:"xmpp.video_type",PARTCIPANT_FEATURES_CHANGED:"xmpp.partcipant_features_changed",PASSWORD_REQUIRED:"xmpp.password_required",PEERCONNECTION_READY:"xmpp.peerconnection_ready",PHONE_NUMBER_CHANGED:"conference.phoneNumberChanged",PRESENCE_STATUS:"xmpp.presence_status",PROMPT_FOR_LOGIN:"xmpp.prompt_for_login",READY_TO_JOIN:"xmpp.ready_to_join",RECORDER_STATE_CHANGED:"xmpp.recorderStateChanged",REMOTE_STATS:"xmpp.remote_stats",RESERVATION_ERROR:"xmpp.room_reservation_error",ROOM_CONNECT_ERROR:"xmpp.room_connect_error",ROOM_CONNECT_NOT_ALLOWED_ERROR:"xmpp.room_connect_error.not_allowed",ROOM_JOIN_ERROR:"xmpp.room_join_error",ROOM_MAX_USERS_ERROR:"xmpp.room_max_users_error",SENDING_CHAT_MESSAGE:"xmpp.sending_chat_message",SESSION_ACCEPT_TIMEOUT:"xmpp.session_accept_timeout",START_MUTED_FROM_FOCUS:"xmpp.start_muted_from_focus",SUBJECT_CHANGED:"xmpp.subject_changed",SUSPEND_DETECTED:"xmpp.suspend_detected",TRANSPORT_INFO:"xmpp.transportinfo.jingle",VIDEO_SIP_GW_AVAILABILITY_CHANGED:"xmpp.videoSIPGWAvailabilityChanged",ICE_CONNECTION_STATE_CHANGED:"xmpp.ice_connection_state_changed"};e.exports=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AUTH_STATUS_CHANGED="conference.auth_status_changed",t.AVAILABLE_DEVICES_CHANGED="conference.availableDevicesChanged",t.AVATAR_CHANGED="conference.avatarChanged",t.BEFORE_STATISTICS_DISPOSED="conference.beforeStatisticsDisposed",t.CONFERENCE_ERROR="conference.error",t.CONFERENCE_FAILED="conference.failed",t.CONFERENCE_JOINED="conference.joined",t.CONFERENCE_LEFT="conference.left",t.CONNECTION_INTERRUPTED="conference.connectionInterrupted",t.CONNECTION_RESTORED="conference.connectionRestored",t.CONNECTION_STATS="conference.connectionStats",t.DISPLAY_NAME_CHANGED="conference.displayNameChanged",t.DOMINANT_SPEAKER_CHANGED="conference.dominantSpeaker",t.DTMF_SUPPORT_CHANGED="conference.dtmfSupportChanged",t.ENDPOINT_MESSAGE_RECEIVED="conference.endpoint_message_received",t.KICKED="conferenece.kicked",t.LAST_N_ENDPOINTS_CHANGED="conference.lastNEndpointsChanged",t.LOCK_STATE_CHANGED="conference.lock_state_changed",t.MESSAGE_RECEIVED="conference.messageReceived",t.PARTICIPANT_CONN_STATUS_CHANGED="conference.participant_conn_status_changed",t.PARTCIPANT_FEATURES_CHANGED="conference.partcipant_features_changed",t.PARTICIPANT_PROPERTY_CHANGED="conference.participant_property_changed",t.P2P_STATUS="conference.p2pStatus",t.PHONE_NUMBER_CHANGED="conference.phoneNumberChanged",t.RECORDER_STATE_CHANGED="conference.recorderStateChanged",t.VIDEO_SIP_GW_AVAILABILITY_CHANGED="conference.videoSIPGWAvailabilityChanged",t.START_MUTED_POLICY_CHANGED="conference.start_muted_policy_changed",t.STARTED_MUTED="conference.started_muted",t.SUBJECT_CHANGED="conference.subjectChanged",t.SUSPEND_DETECTED="conference.suspendDetected",t.TALK_WHILE_MUTED="conference.talk_while_muted",t.TRACK_ADDED="conference.trackAdded",t.TRACK_AUDIO_LEVEL_CHANGED="conference.audioLevelsChanged",t.TRACK_MUTE_CHANGED="conference.trackMuteChanged",t.TRACK_REMOVED="conference.trackRemoved",t.USER_JOINED="conference.userJoined",t.USER_LEFT="conference.userLeft",t.USER_ROLE_CHANGED="conference.roleChanged",t.USER_STATUS_CHANGED="conference.statusChanged"},function(e,t){"use strict";var n={CREATE_ANSWER_FAILED:"rtc.create_answer_failed",CREATE_OFFER_FAILED:"rtc.create_offer_failed",RTC_READY:"rtc.ready",DATA_CHANNEL_OPEN:"rtc.data_channel_open",ENDPOINT_CONN_STATUS_CHANGED:"rtc.endpoint_conn_status_changed",DOMINANT_SPEAKER_CHANGED:"rtc.dominant_speaker_changed",LASTN_ENDPOINT_CHANGED:"rtc.lastn_endpoint_changed",AVAILABLE_DEVICES_CHANGED:"rtc.available_devices_changed",TRACK_ATTACHED:"rtc.track_attached",REMOTE_TRACK_ADDED:"rtc.remote_track_added",REMOTE_TRACK_MUTE:"rtc.remote_track_mute",REMOTE_TRACK_REMOVED:"rtc.remote_track_removed",REMOTE_TRACK_UNMUTE:"rtc.remote_track_unmute",SET_LOCAL_DESCRIPTION_FAILED:"rtc.set_local_description_failed",SET_REMOTE_DESCRIPTION_FAILED:"rtc.set_remote_description_failed",AUDIO_OUTPUT_DEVICE_CHANGED:"rtc.audio_output_device_changed",DEVICE_LIST_CHANGED:"rtc.device_list_changed",DEVICE_LIST_AVAILABLE:"rtc.device_list_available",ENDPOINT_MESSAGE_RECEIVED:"rtc.endpoint_message_received",LOCAL_UFRAG_CHANGED:"rtc.local_ufrag_changed",REMOTE_UFRAG_CHANGED:"rtc.remote_ufrag_changed"};e.exports=n},function(e,t,n){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function i(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,r),e}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function s(){var e;try{e=t.storage.debug}catch(e){}return e}function c(){try{return window.localStorage}catch(e){}}t=e.exports=n(130),t.log=o,t.formatArgs=i,t.save=a,t.load=s,t.useColors=r,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(s())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(17),s=r(a),c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s.default;i(this,e),this.eventEmitter=t,this.addEventListener=this.on=this.addListener,this.removeEventListener=this.off=this.removeListener}return o(e,[{key:"addListener",value:function(e,t){this.eventEmitter.addListener(e,t)}},{key:"removeListener",value:function(e,t){this.eventEmitter.removeListener(e,t)}}]),e}();t.default=c},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n){if("object"===("undefined"==typeof e?"undefined":a(e))&&"undefined"!=typeof e.name)switch(this.gum={error:e,constraints:t,devices:n&&Array.isArray(n)?n.slice(0):void 0},e.name){case"PermissionDeniedError":case"SecurityError":this.name=c.PERMISSION_DENIED,this.message=u[this.name]+(this.gum.devices||[]).join(", ");break;case"DevicesNotFoundError":case"NotFoundError":this.name=c.NOT_FOUND,this.message=u[this.name]+(this.gum.devices||[]).join(", ");break;case"ConstraintNotSatisfiedError":case"OverconstrainedError":var r=e.constraintName;t&&t.video&&(!n||n.indexOf("video")>-1)&&("minWidth"===r||"maxWidth"===r||"minHeight"===r||"maxHeight"===r||"width"===r||"height"===r)?(this.name=c.UNSUPPORTED_RESOLUTION,this.message=u[this.name]+o(r,t)):(this.name=c.CONSTRAINT_FAILED,this.message=u[this.name]+e.constraintName);break;default:this.name=c.GENERAL,this.message=e.message||u[this.name]}else{if("string"!=typeof e)throw new Error("Invalid arguments");u[e]?(this.name=e,this.message=t||u[e]):this.message=e}this.stack=e.stack||(new Error).stack}function o(e,t){if(t&&t.video&&t.video.mandatory)switch(e){case"width":return t.video.mandatory.minWidth;case"height":return t.video.mandatory.minHeight;default:return t.video.mandatory[e]||""}return""}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(13),c=r(s),u={};u[c.UNSUPPORTED_RESOLUTION]="Video resolution is not supported: ",u[c.FIREFOX_EXTENSION_NEEDED]="Firefox extension is not installed",u[c.CHROME_EXTENSION_INSTALLATION_ERROR]="Failed to install Chrome extension",u[c.CHROME_EXTENSION_USER_CANCELED]="User canceled Chrome's screen sharing prompt",u[c.CHROME_EXTENSION_GENERIC_ERROR]="Unknown error from Chrome extension",u[c.ELECTRON_DESKTOP_PICKER_ERROR]="Unkown error from desktop picker",u[c.ELECTRON_DESKTOP_PICKER_NOT_FOUND]="Failed to detect desktop picker",u[c.GENERAL]="Generic getUserMedia error",u[c.PERMISSION_DENIED]="User denied permission to use device(s): ",u[c.NOT_FOUND]="Requested device(s) was/were not found: ",u[c.CONSTRAINT_FAILED]="Constraint could not be satisfied: ",u[c.TRACK_IS_DISPOSED]="Track has been already disposed",u[c.TRACK_NO_STREAM_FOUND]="Track does not have an associated Media Stream",u[c.TRACK_MUTE_UNMUTE_IN_PROGRESS]="Track mute/unmute process is currently in progress",u[c.NO_DATA_FROM_SOURCE]="The track has stopped receiving data from it's source",i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,t.default=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CHROME_EXTENSION_GENERIC_ERROR="gum.chrome_extension_generic_error",t.CHROME_EXTENSION_INSTALLATION_ERROR="gum.chrome_extension_installation_error",t.CHROME_EXTENSION_USER_CANCELED="gum.chrome_extension_user_canceled",t.CONSTRAINT_FAILED="gum.constraint_failed",t.ELECTRON_DESKTOP_PICKER_ERROR="gum.electron_desktop_picker_error",t.ELECTRON_DESKTOP_PICKER_NOT_FOUND="gum.electron_desktop_picker_not_found",t.FIREFOX_EXTENSION_NEEDED="gum.firefox_extension_needed",t.GENERAL="gum.general",t.NOT_FOUND="gum.not_found",t.PERMISSION_DENIED="gum.permission_denied",t.TRACK_IS_DISPOSED="track.track_is_disposed",t.TRACK_MUTE_UNMUTE_IN_PROGRESS="track.mute_unmute_inprogress",t.TRACK_NO_STREAM_FOUND="track.no_stream_found",t.UNSUPPORTED_RESOLUTION="gum.unsupported_resolution",t.NO_DATA_FROM_SOURCE="track.no_data_from_source"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LOCAL_TRACK_STOPPED="track.stopped",t.TRACK_AUDIO_LEVEL_CHANGED="track.audioLevelsChanged",t.TRACK_AUDIO_OUTPUT_CHANGED="track.audioOutputChanged",t.TRACK_MUTE_CHANGED="track.trackMuteChanged",t.TRACK_VIDEOTYPE_CHANGED="track.videoTypeChanged",t.NO_DATA_FROM_SOURCE="track.no_data_from_source"},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=n(22),a=r(o),s=n(2),c=r(s),u=(0,i.getLogger)(e),l={filterSpecialChars:function(e){return e?e.replace(/[\\\/\{,\}\+]/g,""):e},iceparams:function(e,t){var n=null,r=void 0,i=void 0;return(i=l.findLine(e,"a=ice-ufrag:",t))&&(r=l.findLine(e,"a=ice-pwd:",t))&&(n={ufrag:l.parseICEUfrag(i),pwd:l.parseICEPwd(r)}),n},parseICEUfrag:function(e){return e.substring(12)},buildICEUfrag:function(e){return"a=ice-ufrag:"+e},parseICEPwd:function(e){return e.substring(10)},buildICEPwd:function(e){return"a=ice-pwd:"+e},parseMID:function(e){return e.substring(6)},parseMLine:function(e){var t={},n=e.substring(2).split(" ");return t.media=n.shift(),t.port=n.shift(),t.proto=n.shift(),""===n[n.length-1]&&n.pop(),t.fmt=n,t},buildMLine:function(e){return"m="+e.media+" "+e.port+" "+e.proto+" "+e.fmt.join(" ")},parseRTPMap:function(e){var t={},n=e.substring(9).split(" ");return t.id=n.shift(),n=n[0].split("/"),t.name=n.shift(),t.clockrate=n.shift(),t.channels=n.length?n.shift():"1",t},parseSCTPMap:function(e){var t=e.substring(10).split(" "),n=t[0],r=t[1],i=t.length>2?t[2]:null;return[n,r,i]},buildRTPMap:function(e){var t="a=rtpmap:"+e.getAttribute("id")+" "+e.getAttribute("name")+"/"+e.getAttribute("clockrate");return e.getAttribute("channels")&&"1"!==e.getAttribute("channels")&&(t+="/"+e.getAttribute("channels")),t},parseCrypto:function(e){var t={},n=e.substring(9).split(" ");return t.tag=n.shift(),t["crypto-suite"]=n.shift(),t["key-params"]=n.shift(),n.length&&(t["session-params"]=n.join(" ")),t},parseFingerprint:function(e){var t={},n=e.substring(14).split(" ");return t.hash=n.shift(),t.fingerprint=n.shift(),t},parseFmtp:function(e){var t=[],n=e.split(" ");n.shift(),n=n.join(" ").split(";");for(var r=0;r<n.length;r++){for(var i=n[r].split("=")[0];i.length&&" "===i[0];)i=i.substring(1);var o=n[r].split("=")[1];i&&o?t.push({name:i,value:o}):i&&t.push({name:"",value:i})}return t},parseICECandidate:function(e){var t={},n=e.split(" ");t.foundation=n[0].substring(12),t.component=n[1],t.protocol=n[2].toLowerCase(),t.priority=n[3],t.ip=n[4],t.port=n[5],t.type=n[7],t.generation=0;for(var r=8;r<n.length;r+=2)switch(n[r]){case"raddr":t["rel-addr"]=n[r+1];break;case"rport":t["rel-port"]=n[r+1];break;case"generation":t.generation=n[r+1];break;case"tcptype":t.tcptype=n[r+1];break;default:u.log('parseICECandidate not translating "'+n[r]+'" = "'+n[r+1]+'"')}return t.network="1",t.id=Math.random().toString(36).substr(2,10),t},buildICECandidate:function(e){var t=["a=candidate:"+e.foundation,e.component,e.protocol,e.priority,e.ip,e.port,"typ",e.type].join(" ");switch(t+=" ",e.type){case"srflx":case"prflx":case"relay":e.hasOwnAttribute("rel-addr")&&e.hasOwnAttribute("rel-port")&&(t+="raddr",t+=" ",t+=e["rel-addr"],t+=" ",t+="rport",t+=" ",t+=e["rel-port"],t+=" ")}return e.hasOwnAttribute("tcptype")&&(t+="tcptype",t+=" ",t+=e.tcptype,t+=" "),t+="generation",t+=" ",t+=e.hasOwnAttribute("generation")?e.generation:"0"},parseSSRC:function(e){for(var t={},n=e.split("\r\n"),r=0;r<n.length;r++)if("a=ssrc:"===n[r].substring(0,7)){var i=n[r].indexOf(" ");t[n[r].substr(i+1).split(":",2)[0]]=n[r].substr(i+1).split(":",2)[1]}return t},parseRTCPFB:function(e){var t=e.substr(10).split(" "),n={};return n.pt=t.shift(),n.type=t.shift(),n.params=t,n},parseExtmap:function(e){var t=e.substr(9).split(" "),n={};return n.value=t.shift(),n.value.indexOf("/")===-1?n.direction="both":(n.direction=n.value.substr(n.value.indexOf("/")+1),n.value=n.value.substr(0,n.value.indexOf("/"))),n.uri=t.shift(),n.params=t,n},findLine:function(e,t,n){for(var r=e.split("\r\n"),i=0;i<r.length;i++)if(r[i].substring(0,t.length)===t)return r[i];if(!n)return!1;r=n.split("\r\n");for(var o=0;o<r.length;o++)if(r[o].substring(0,t.length)===t)return r[o];return!1},findLines:function(e,t,n){for(var r=e.split("\r\n"),i=[],o=0;o<r.length;o++)r[o].substring(0,t.length)===t&&i.push(r[o]);if(i.length||!n)return i;r=n.split("\r\n");for(var a=0;a<r.length;a++)r[a].substring(0,t.length)===t&&i.push(r[a]);
return i},candidateToJingle:function(e){if(0===e.indexOf("candidate:"))e="a="+e;else if("a=candidate:"!==e.substring(0,12))return u.log("parseCandidate called with a line that is not a candidate line"),u.log(e),null;"\r\n"===e.substring(e.length-2)&&(e=e.substring(0,e.length-2));var t={},n=e.split(" ");if("typ"!==n[6])return u.log("did not find typ in the right place"),u.log(e),null;t.foundation=n[0].substring(12),t.component=n[1],t.protocol=n[2].toLowerCase(),t.priority=n[3],t.ip=n[4],t.port=n[5],t.type=n[7],t.generation="0";for(var r=8;r<n.length;r+=2)switch(n[r]){case"raddr":t["rel-addr"]=n[r+1];break;case"rport":t["rel-port"]=n[r+1];break;case"generation":t.generation=n[r+1];break;case"tcptype":t.tcptype=n[r+1];break;default:u.log('not translating "'+n[r]+'" = "'+n[r+1]+'"')}return t.network="1",t.id=Math.random().toString(36).substr(2,10),t},candidateFromJingle:function(e){var t="a=candidate:";t+=e.getAttribute("foundation"),t+=" ",t+=e.getAttribute("component"),t+=" ";var n=e.getAttribute("protocol");switch(c.default.isFirefox()&&"ssltcp"===n.toLowerCase()&&(n="tcp"),t+=n,t+=" ",t+=e.getAttribute("priority"),t+=" ",t+=e.getAttribute("ip"),t+=" ",t+=e.getAttribute("port"),t+=" ",t+="typ",t+=" "+e.getAttribute("type"),t+=" ",e.getAttribute("type")){case"srflx":case"prflx":case"relay":e.getAttribute("rel-addr")&&e.getAttribute("rel-port")&&(t+="raddr",t+=" ",t+=e.getAttribute("rel-addr"),t+=" ",t+="rport",t+=" ",t+=e.getAttribute("rel-port"),t+=" ")}return"tcp"===n.toLowerCase()&&(t+="tcptype",t+=" ",t+=e.getAttribute("tcptype"),t+=" "),t+="generation",t+=" ",t+=e.getAttribute("generation")||"0",t+"\r\n"},parsePrimaryVideoSsrc:function(e){var t=e.ssrcs.map(function(e){return e.id}).filter(function(e,t,n){return n.indexOf(e)===t}).length,n=e.ssrcGroups&&e.ssrcGroups.length||0;if(!(t>1&&0===n)){var r=null;if(1===t)r=e.ssrcs[0].id;else if(2===t){var i=e.ssrcGroups.find(function(e){return"FID"===e.semantics});i&&(r=i.ssrcs.split(" ")[0])}else if(t>=3){var o=e.ssrcGroups.find(function(e){return"SIM"===e.semantics});o&&(r=o.ssrcs.split(" ")[0])}return r}},generateSsrc:function(){return a.default.randomInt(1,4294967295)},getSsrcAttribute:function(e,t,n){for(var r=0;r<e.ssrcs.length;++r){var i=e.ssrcs[r];if(i.id===t&&i.attribute===n)return i.value}},parseGroupSsrcs:function(e){return e.ssrcs.split(" ").map(function(e){return parseInt(e,10)})},getMedia:function(e,t){return e.media.find(function(e){return e.type===t})},getUfrag:function(e){var t=e.split("\n").filter(function(e){return e.startsWith("a=ice-ufrag:")});if(t.length>0)return t[0].substr("a=ice-ufrag:".length)},preferVideoCodec:function(e,t){for(var n=null,r=0;r<e.rtp.length;++r){var i=e.rtp[r];if(i.codec===t){n=i.payload;break}}if(n){var o=e.payloads.split(" ").map(function(e){return parseInt(e,10)}),a=o.indexOf(n);o.splice(a,1),o.unshift(n),e.payloads=o.join(" ")}}};t.default=l}).call(t,"modules/xmpp/SDPUtil.js")},function(e,t,n){(function(e){function r(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}function i(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=e.data,o=new Uint8Array(i),a=new Uint8Array(1+i.byteLength);a[0]=g[e.type];for(var s=0;s<o.length;s++)a[s+1]=o[s];return r(a.buffer)}function o(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){e.data=i.result,t.encodePacket(e,n,!0,r)},i.readAsArrayBuffer(e.data)}function a(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(v)return o(e,n,r);var i=new Uint8Array(1);i[0]=g[e.type];var a=new E([i.buffer,e.data]);return r(a)}function s(e,t,n){for(var r=new Array(e.length),i=f(e.length,n),o=function(e,n,i){t(n,function(t,n){r[e]=n,i(t,r)})},a=0;a<e.length;a++)o(a,e[a],i)}var c=n(137),u=n(138),l=n(71),d=n(127),f=n(70),p=n(168),h=navigator.userAgent.match(/Android/i),m=/PhantomJS/i.test(navigator.userAgent),v=h||m;t.protocol=3;var g=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},y=c(g),b={type:"error",data:"parser error"},E=n(128);t.encodePacket=function(t,n,o,s){"function"==typeof n&&(s=n,n=!1),"function"==typeof o&&(s=o,o=null);var c=void 0===t.data?void 0:t.data.buffer||t.data;if(e.ArrayBuffer&&c instanceof ArrayBuffer)return i(t,n,s);if(E&&c instanceof e.Blob)return a(t,n,s);if(c&&c.base64)return r(t,s);var u=g[t.type];return void 0!==t.data&&(u+=o?p.encode(String(t.data)):String(t.data)),s(""+u)},t.encodeBase64Packet=function(n,r){var i="b"+t.packets[n.type];if(E&&n.data instanceof e.Blob){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];r(i+e)},o.readAsDataURL(n.data)}var a;try{a=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(e){for(var s=new Uint8Array(n.data),c=new Array(s.length),u=0;u<s.length;u++)c[u]=s[u];a=String.fromCharCode.apply(null,c)}return i+=e.btoa(a),r(i)},t.decodePacket=function(e,n,r){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r)try{e=p.decode(e)}catch(e){return b}var i=e.charAt(0);return Number(i)==i&&y[i]?e.length>1?{type:y[i],data:e.substring(1)}:{type:y[i]}:b}var o=new Uint8Array(e),i=o[0],a=l(e,1);return E&&"blob"===n&&(a=new E([a])),{type:y[i],data:a}},t.decodeBase64Packet=function(t,n){var r=y[t.charAt(0)];if(!e.ArrayBuffer)return{type:r,data:{base64:!0,data:t.substr(1)}};var i=d.decode(t.substr(1));return"blob"===n&&E&&(i=new E([i])),{type:r,data:i}},t.encodePayload=function(e,n,r){function i(e){return e.length+":"+e}function o(e,r){t.encodePacket(e,!!a&&n,!0,function(e){r(null,i(e))})}"function"==typeof n&&(r=n,n=null);var a=u(e);return n&&a?E&&!v?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void s(e,o,function(e,t){return r(t.join(""))}):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);"function"==typeof n&&(r=n,n=null);var i;if(""==e)return r(b,0,1);for(var o,a,s="",c=0,u=e.length;c<u;c++){var l=e.charAt(c);if(":"!=l)s+=l;else{if(""==s||s!=(o=Number(s)))return r(b,0,1);if(a=e.substr(c+1,o),s!=a.length)return r(b,0,1);if(a.length){if(i=t.decodePacket(a,n,!0),b.type==i.type&&b.data==i.data)return r(b,0,1);var d=r(i,c+o,u);if(!1===d)return}c+=o,s=""}}return""!=s?r(b,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){function r(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})}return e.length?void s(e,r,function(e,t){var r=t.reduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+n.toString().length+n+2},0),i=new Uint8Array(r),o=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);n=r.buffer}t?i[o++]=0:i[o++]=1;for(var s=n.byteLength.toString(),a=0;a<s.length;a++)i[o++]=parseInt(s[a]);i[o++]=255;for(var r=new Uint8Array(n),a=0;a<r.length;a++)i[o++]=r[a]}),n(i.buffer)}):n(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,n){function r(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,t[0]=0}for(var o=e instanceof ArrayBuffer?e.byteLength:e.size,a=o.toString(),s=new Uint8Array(a.length+1),i=0;i<a.length;i++)s[i]=parseInt(a[i]);if(s[a.length]=255,E){var c=new E([t.buffer,s.buffer,e]);n(null,c)}})}s(e,r,function(e,t){return n(new E(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var i=e,o=[],a=!1;i.byteLength>0;){for(var s=new Uint8Array(i),c=0===s[0],u="",d=1;255!=s[d];d++){if(u.length>310){a=!0;break}u+=s[d]}if(a)return r(b,0,1);i=l(i,2+u.length),u=parseInt(u);var f=l(i,0,u);if(c)try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch(e){var p=new Uint8Array(f);f="";for(var d=0;d<p.length;d++)f+=String.fromCharCode(p[d])}o.push(f),i=l(i,u)}var h=o.length;o.forEach(function(e,i){r(t.decodePacket(e,n,!0),i,h)})}}).call(t,function(){return this}())},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,s,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(n=this._events[e],a(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(o(n))for(s=Array.prototype.slice.call(arguments,1),u=n.slice(),i=u.length,c=0;c<i;c++)u[c].apply(this,s);return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,a,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){function e(){a(this,e)}return e}();return function(e){function t(){var e;a(this,t);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];var s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return s.connection=null,s}return o(t,e),c(t,[{key:"init",value:function(e){this.connection=e}}]),t}(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionPluginListenable=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),l=r(u);t.default=s(),t.ConnectionPluginListenable=s(l.default)},function(e,t){"use strict";var n={CAMERA:"camera",DESKTOP:"desktop"};e.exports=n},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e,t){var n=[],r=null;return e.forEach(function(e){e.mediaType===R.AUDIO?r=t.micDeviceId:e.videoType===x.default.CAMERA&&(r=t.cameraDeviceId),M+=1;var i=new y.default(M,e.stream,e.track,e.mediaType,e.videoType,e.resolution,r,t.facingMode);n.push(i)}),n}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),d=n(79),f=i(d),p=n(3),h=i(p),m=n(8),v=r(m),g=n(80),y=i(g),b=n(12),E=i(b),S=n(13),T=r(S),C=n(11),w=i(C),_=n(5),R=r(_),A=n(9),k=i(A),O=n(21),I=i(O),P=n(85),D=i(P),N=n(19),x=i(N),L=(0,l.getLogger)(e),M=0,j=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.conference=e,r.peerConnections=new Map,r.peerConnectionIdCounter=1,r.localTracks=[],r.options=n,r.dataChannelsOpen=!1,r._lastN=null,r._lastNEndpoints=null,r._lastNChangeListener=r._onLastNChanged.bind(r),I.default.isDeviceChangeAvailable("output")&&I.default.addListener(k.default.AUDIO_OUTPUT_DEVICE_CHANGED,function(e){var t=r.getRemoteTracks(R.AUDIO),n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var c=a.value;c.setAudioOutput(e)}}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}}),r}return s(t,e),u(t,[{key:"initializeDataChannels",value:function(e){var t=this;this.options.config.openSctp&&(this.dataChannels=new f.default(e,this.eventEmitter),this._dataChannelOpenListener=function(){t.dataChannelsOpen=!0;try{t.dataChannels.sendSelectedEndpointMessage(t.selectedEndpoint)}catch(e){h.default.callErrorHandler(e),L.error("Cannot sendSelectedEndpointMessage ",t.selectedEndpoint,". Error: ",e)}t.removeListener(k.default.DATA_CHANNEL_OPEN,t._dataChannelOpenListener),t._dataChannelOpenListener=null,null!==t._lastN&&(t.setLastN(t._lastN),t._lastN=null)},this.addListener(k.default.DATA_CHANNEL_OPEN,this._dataChannelOpenListener),this.addListener(k.default.LASTN_ENDPOINT_CHANGED,this._lastNChangeListener))}},{key:"_onLastNChanged",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this._lastNEndpoints||[],r=[],i=[];this._lastNEndpoints=t,r=n.filter(function(t){return!e.isInLastN(t)}),i=t.filter(function(e){return n.indexOf(e)===-1}),this.conference.eventEmitter.emit(v.LAST_N_ENDPOINTS_CHANGED,r,i)}},{key:"onCallEnded",value:function(){this.dataChannels&&(this.dataChannels=null,this.dataChannelsOpen=!1)}},{key:"selectEndpoint",value:function(e){this.selectedEndpoint=e,this.dataChannels&&this.dataChannelsOpen&&this.dataChannels.sendSelectedEndpointMessage(e)}},{key:"pinEndpoint",value:function(e){if(!this.dataChannels)throw new Error("Data channels support is disabled!");this.dataChannels.sendPinnedEndpointMessage(e)}},{key:"createPeerConnection",value:function(e,n,r,i){var o=new D.default(this,this.peerConnectionIdCounter,e,n,t.getPCConstraints(),r,i);return this.peerConnections.set(o.id,o),this.peerConnectionIdCounter+=1,o}},{key:"_removePeerConnection",value:function(e){var t=e.id;return!!this.peerConnections.has(t)&&(this.peerConnections.delete(t),!0)}},{key:"addLocalTrack",value:function(e){if(!e)throw new Error("track must not be null nor undefined");this.localTracks.push(e),e.conference=this.conference}},{key:"getLocalVideoTrack",value:function(){var e=this.getLocalTracks(R.VIDEO);return e.length?e[0]:void 0}},{key:"getLocalAudioTrack",value:function(){var e=this.getLocalTracks(R.AUDIO);return e.length?e[0]:void 0}},{key:"getLocalTracks",value:function(e){var t=this.localTracks.slice();return void 0!==e&&(t=t.filter(function(t){return t.getType()===e})),t}},{key:"getRemoteTracks",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=this.peerConnections.values()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=s.getRemoteTracks(void 0,e);c&&(t=t.concat(c))}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return t}},{key:"setAudioMute",value:function(e){var t=[];return this.getLocalTracks(R.AUDIO).forEach(function(n){t.push(e?n.mute():n.unmute())}),Promise.all(t)}},{key:"removeLocalTrack",value:function(e){var t=this.localTracks.indexOf(e);t!==-1&&this.localTracks.splice(t,1)}},{key:"removeRemoteTracks",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=this.peerConnections.values()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=s.removeRemoteTracks(e);t=t.concat(c)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return L.debug("Removed remote tracks for "+e+(" count: "+t.length)),t}},{key:"closeAllDataChannels",value:function(){this.dataChannels&&(this.dataChannels.closeAllChannels(),this.dataChannelsOpen=!1,this.removeListener(k.default.LASTN_ENDPOINT_CHANGED,this._lastNChangeListener))}},{key:"setAudioLevel",value:function(e,t){var n=this._getTrackBySSRC(e);if(n)return n.isAudioTrack()?void n.setAudioLevel(t):void L.warn("Received audio level for non-audio track: "+e)}},{key:"getResourceBySSRC",value:function(e){var t=this._getTrackBySSRC(e);return t?t.getParticipantId():null}},{key:"_getTrackBySSRC",value:function(e){var t=this,n=this.getLocalTracks().find(function(n){return Array.from(t.peerConnections.values()).find(function(t){return t.getLocalSSRC(n)==e})});return n||(n=this._getRemoteTrackBySSRC(e)),n}},{key:"_getRemoteTrackBySSRC",value:function(e){return this.getRemoteTracks().find(function(t){return e==t.getSSRC()})}},{key:"sendDataChannelMessage",value:function(e,t){if(!this.dataChannels)throw new Error("Data channels support is disabled!");this.dataChannels.sendDataChannelMessage(e,t)}},{key:"setLastN",value:function(e){this.dataChannels&&this.dataChannelsOpen?this.dataChannels.sendSetLastNMessage(e):this._lastN=e}},{key:"isInLastN",value:function(e){return!this._lastNEndpoints||this._lastNEndpoints.indexOf(e)>-1}}],[{key:"obtainAudioAndVideoPermissions",value:function(e){return I.default.obtainAudioAndVideoPermissions(e).then(function(t){var n=c(t,e);return n.some(function(e){return!e._isReceivingData()})?Promise.reject(new E.default(T.NO_DATA_FROM_SOURCE)):n})}},{key:"addListener",value:function(e,t){I.default.addListener(e,t)}},{key:"removeListener",value:function(e,t){I.default.removeListener(e,t)}},{key:"isRTCReady",value:function(){return I.default.isRTCReady()}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.options=e,I.default.init(this.options)}},{key:"getDeviceAvailability",value:function(){return I.default.getDeviceAvailability()}},{key:"getPCConstraints",value:function(){return I.default.pcConstraints}},{key:"attachMediaStream",value:function(e,t){return I.default.attachMediaStream(e,t)}},{key:"getStreamID",value:function(e){return I.default.getStreamID(e)}},{key:"isDeviceListAvailable",value:function(){return I.default.isDeviceListAvailable()}},{key:"isDeviceChangeAvailable",value:function(e){return I.default.isDeviceChangeAvailable(e)}},{key:"getAudioOutputDevice",value:function(){return I.default.getAudioOutputDevice()}},{key:"getCurrentlyAvailableMediaDevices",value:function(){return I.default.getCurrentlyAvailableMediaDevices()}},{key:"getEventDataForActiveDevice",value:function(e){return I.default.getEventDataForActiveDevice(e)}},{key:"setAudioOutputDevice",value:function(e){return I.default.setAudioOutputDevice(e)}},{key:"isUserStream",value:function(e){return t.isUserStreamById(I.default.getStreamID(e))}},{key:"isUserStreamById",value:function(e){return e&&"mixedmslabel"!==e&&"default"!==e}},{key:"enumerateDevices",value:function(e){I.default.enumerateDevices(e)}},{key:"stopMediaStream",value:function(e){I.default.stopMediaStream(e)}},{key:"isDesktopSharingEnabled",value:function(){return I.default.isDesktopSharingEnabled()}}]),t}(w.default);t.default=j}).call(t,"modules/RTC/RTC.js")},function(e,t,n){(function(e,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function l(){ve=navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?function(e){navigator.mediaDevices.enumerateDevices().then(e,function(){return e([])})}:MediaStreamTrack&&MediaStreamTrack.getSources?function(e){MediaStreamTrack.getSources(function(t){return e(t.map(T))})}:void 0}function d(e,t,n){V.default[n]&&(t&&(e.video.width={exact:V.default[n].width},e.video.height={exact:V.default[n].height}),e.video.mandatory.minWidth=V.default[n].width,e.video.mandatory.minHeight=V.default[n].height),e.video.mandatory.minWidth&&(e.video.mandatory.maxWidth=e.video.mandatory.minWidth),e.video.mandatory.minHeight&&(e.video.mandatory.maxHeight=e.video.mandatory.minHeight)}function f(e,t){var n={audio:!1,video:!1},r=K.default.isFirefox()||K.default.isEdge()||K.default.isReactNative()||K.default.isTemasysPluginUsed();if(e.indexOf("video")>=0){if(n.video={mandatory:{},optional:[]},t.cameraDeviceId)r&&(n.video.deviceId=t.cameraDeviceId),n.video.optional.push({sourceId:t.cameraDeviceId});else{var i=t.facingMode||P.default.USER;r&&(n.video.facingMode=i),n.video.optional.push({facingMode:i})}(t.minFps||t.maxFps||t.fps)&&((t.minFps||t.fps)&&(t.minFps=t.minFps||t.fps,n.video.mandatory.minFrameRate=t.minFps),t.maxFps&&(n.video.mandatory.maxFrameRate=t.maxFps)),d(n,r,t.resolution)}if(e.indexOf("audio")>=0&&(K.default.isReactNative()?n.audio=!0:K.default.isFirefox()?t.micDeviceId?n.audio={mandatory:{},deviceId:t.micDeviceId,optional:[{sourceId:t.micDeviceId}]}:n.audio=!0:(n.audio={mandatory:{},optional:[]},t.micDeviceId&&(r&&(n.audio.deviceId=t.micDeviceId),n.audio.optional.push({sourceId:t.micDeviceId})),n.audio.optional.push({googEchoCancellation:!de},{googAutoGainControl:!0},{googNoiseSupression:!fe},{googHighpassFilter:!0},{googNoiseSuppression2:!fe},{googEchoCancellation2:!de},{googAutoGainControl2:!0}))),e.indexOf("screen")>=0)if(K.default.isChrome())n.video={mandatory:{chromeMediaSource:"screen",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[]};else if(K.default.isTemasysPluginUsed())n.video={optional:[{sourceId:oe.WebRTCPlugin.plugin.screensharingKey}]};else if(K.default.isFirefox())n.video={mozMediaSource:"window",mediaSource:"window"};else{var o="'screen' WebRTC media source is supported only in Chrome and with Temasys plugin";M.default.callErrorHandler(new Error(o)),re.error(o)}return e.indexOf("desktop")>=0&&(n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t.desktopStream,maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[]}),t.bandwidth&&(n.video||(n.video={mandatory:{},optional:[]}),n.video.optional.push({bandwidth:t.bandwidth})),K.default.isFirefox()&&t.firefox_fake_device&&(n.fake=!0),n}function p(e,t){var n=t&&t.getAudioTracks().length>0,r=t&&t.getVideoTracks().length>0;e.indexOf("video")!==-1&&(ce.video=r),e.indexOf("audio")!==-1&&(ce.audio=n),ae.emit(z.default.AVAILABLE_DEVICES_CHANGED,ce)}function h(e){function t(e){return JSON.stringify({kind:e.kind,deviceId:e.deviceId,groupId:e.groupId,label:e.label,facing:e.facing})}return e.length!==me.length||e.map(t).sort().join("")!==me.map(t).sort().join("")}function m(){ve&&ve(function(e){"undefined"==typeof me?me=e.slice(0):h(e)&&v(e),window.setTimeout(m,se)})}function v(e){me=e.slice(0),re.info("list of media devices has changed:",me);var t=me.filter(function(e){return"videoinput"===e.kind}),n=me.filter(function(e){return"audioinput"===e.kind}),r=t.filter(function(e){return""===e.label}),i=n.filter(function(e){return""===e.label});t.length&&t.length===r.length&&(ce.video=!1),n.length&&n.length===i.length&&(ce.audio=!1),ae.emit(z.default.DEVICE_LIST_CHANGED,e)}function g(e,t){e&&e.apply(void 0,u(t))}function y(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=void 0;return n=t?function(t,n,r){return e(t).then(function(e){return g(n,[e]),be.initialized||(be.initialized=!0,be.callbacks.forEach(function(e){return e()}),be.callbacks.length=0),e}).catch(function(e){throw g(r,[e]),e})}:function(t,n,r){e(t,function(e){g(n,[e]),be.initialized||(be.initialized=!0,be.callbacks.forEach(function(e){return e()}),be.callbacks.length=0)},function(e){g(r,[e])})}}function b(e){be.initialized?e():be.callbacks.push(e)}function E(e){return function(t){b(function(){e().then(t,function(e){re.error("cannot enumerate devices: ",e),t([])})})}}function S(e){MediaStreamTrack.getSources(function(t){return e(t.map(T))})}function T(e){var t=(e.kind||"").toLowerCase();return{facing:e.facing||null,label:e.label,kind:t?"audiooutput"===t?t:t+"input":null,deviceId:e.id,groupId:e.groupId||null}}function C(e,t){var n=void 0,r=void 0,i=void 0,o=[];if(e){var a=e.audioVideo;if(a){var s=window.webkitMediaStream||window.MediaStream,c=a.getAudioTracks();if(c.length){n=new s;for(var u=0;u<c.length;u++)n.addTrack(c[u])}var l=a.getVideoTracks();if(l.length){i=new s;for(var d=0;d<l.length;d++)i.addTrack(l[d])}}else n=e.audio,i=e.video;r=e.desktopStream||e.desktop}return r&&o.push({stream:r,track:r.getVideoTracks()[0],mediaType:H.VIDEO,videoType:ne.default.DESKTOP}),n&&o.push({stream:n,track:n.getAudioTracks()[0],mediaType:H.AUDIO,videoType:null}),i&&o.push({stream:i,track:i.getVideoTracks()[0],mediaType:H.VIDEO,videoType:ne.default.CAMERA,resolution:t}),o}function w(e,t){var n="srcObject";if(n in e||(n="mozSrcObject",n in e||(n=null)),n)return void(e[n]=t);var r=void 0;t&&(r=t.jitsiObjectURL,r||(t.jitsiObjectURL=r=(URL||webkitURL).createObjectURL(t))),e.src=r||""}function _(e,t){var n=new Error(e);n.name="WEBRTC_NOT_SUPPORTED",re.error(e),t(n)}function R(e){if(!e.devices||0===e.devices.length)return e.successCallback(e.streams||{});var t=e.devices.splice(0,1);e.deviceGUM[t](function(n){e.streams=e.streams||{},e.streams[t]=n,R(e)},function(n){Object.keys(e.streams).forEach(function(t){return Se.stopMediaStream(e.streams[t])}),re.error("failed to obtain "+t+" stream - stop",n),e.errorCallback(n)})}function A(e,t){ye=!0,ae.emit(z.default.RTC_READY,!0),Y.default.init(e,t),l(),Se.isDeviceListAvailable()&&ve&&ve(function(e){me=e.splice(0),ae.emit(z.default.DEVICE_LIST_AVAILABLE,me),ge?navigator.mediaDevices.addEventListener("devicechange",function(){return Se.enumerateDevices(v)}):m()})}function k(e){return function(t,n){var r=e.apply(Se,arguments);return n&&Se.isDeviceChangeAvailable("output")&&n.getAudioTracks&&n.getAudioTracks().length&&le&&t.setSinkId(Se.getAudioOutputDevice()).catch(function(e){var n=new F.default(e,null,["audiooutput"]);M.default.callUnhandledRejectionHandler({promise:this,reason:n}),re.warn("Failed to set audio output device for the element. Default audio output device will be used instead",t,n)}),r}}Object.defineProperty(t,"__esModule",{value:!0});var O=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),I=n(49),P=o(I),D=n(17),N=o(D),x=n(1),L=n(3),M=o(L),j=n(12),F=o(j),U=n(11),B=o(U),J=n(5),H=i(J),G=n(33),V=o(G),W=n(2),K=o(W),q=n(9),z=o(q),X=n(86),$=o(X),Q=n(84),Y=o(Q),Z=n(15),ee=o(Z),te=n(19),ne=o(te),re=(0,x.getLogger)(e),ie=!1,oe=K.default.isTemasysPluginUsed()?n(27):void 0,ae=new N.default,se=3e3,ce={audio:!1,video:!1},ue="default",le=!1,de=!1,fe=!1,pe=document.createElement("audio"),he="undefined"!=typeof pe.setSinkId,me=void 0,ve=void 0,ge=!1,ye=!1,be={initialized:!1,callbacks:[]},Ee=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,ae))}return c(t,e),O(t,[{key:"init",value:function(e){var t=this;return"boolean"==typeof e.disableAEC&&(de=e.disableAEC,re.info("Disable AEC: "+de)),"boolean"==typeof e.disableNS&&(fe=e.disableNS,re.info("Disable NS: "+fe)),new Promise(function(n,i){if(K.default.isFirefox()){var o=K.default.getFirefoxVersion();if(o<40)return void _("Firefox version too old: "+o+". Required >= 40.",i);t.RTCPeerConnectionType=mozRTCPeerConnection,t.getUserMedia=y(navigator.mozGetUserMedia.bind(navigator)),t.enumerateDevices=E(navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices)),t.pcConstraints={},t.attachMediaStream=k(function(e,t){return e&&(w(e,t),t&&e.play()),e}),t.getStreamID=function(e){var t=e.id;if(!t){var n=e.getVideoTracks();n&&0!==n.length||(n=e.getAudioTracks()),t=n[0].id}return ee.default.filterSpecialChars(t)},RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate}else if(K.default.isChrome()||K.default.isOpera()||K.default.isNWJS()||K.default.isElectron()||K.default.isReactNative()){t.RTCPeerConnectionType=webkitRTCPeerConnection;var a=navigator.webkitGetUserMedia.bind(navigator);navigator.mediaDevices?(t.getUserMedia=y(a),t.enumerateDevices=E(navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices))):(t.getUserMedia=a,t.enumerateDevices=S),t.attachMediaStream=k(function(e,t){return w(e,t),e}),t.getStreamID=function(e){var t=e.id;return"number"==typeof t?t:ee.default.filterSpecialChars(t)},t.pcConstraints={optional:[]},e.disableSuspendVideo||t.pcConstraints.optional.push({googSuspendBelowMinBitrate:!0}),e.useIPv6&&t.pcConstraints.optional.push({
googIPv6:!0}),webkitMediaStream.prototype.getVideoTracks||(webkitMediaStream.prototype.getVideoTracks=function(){return this.videoTracks}),webkitMediaStream.prototype.getAudioTracks||(webkitMediaStream.prototype.getAudioTracks=function(){return this.audioTracks})}else if(K.default.isEdge()){if(!ie)return void _("Microsoft Edge not yet supported",i);t.RTCPeerConnectionType=$.default,t.getUserMedia=y(navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices),!0),t.enumerateDevices=E(navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices)),t.attachMediaStream=k(function(e,t){return w(e,t),e}),t.getStreamID=function(e){var t=e.id;return"number"==typeof t?t:ee.default.filterSpecialChars(t)}}else{if(!K.default.isTemasysPluginUsed())return void _("Browser does not appear to be WebRTC-capable",i);var s=function(){t.RTCPeerConnectionType=RTCPeerConnection,t.getUserMedia=window.getUserMedia,t.enumerateDevices=S,t.attachMediaStream=k(function(e,t){if(t){if("dummyAudio"===t.id||"dummyVideo"===t.id)return;var n=r(e);K.default.isTemasysPluginUsed()&&!n.is(":visible")&&n.show();var i=t.getVideoTracks().length>0;if(i&&!r(e).is(":visible"))throw new Error("video element must be visible to attach video stream")}return attachMediaStream(e,t)}),t.getStreamID=function(e){return ee.default.filterSpecialChars(e.label)},A(e,t.getUserMediaWithConstraints.bind(t))},c=new Promise(function(e){return oe.webRTCReady(e)});oe.WebRTCPlugin.isPluginInstalled(oe.WebRTCPlugin.pluginInfo.prefix,oe.WebRTCPlugin.pluginInfo.plugName,oe.WebRTCPlugin.pluginInfo.type,function(){c.then(function(){s(),n()})},function(){var e=new Error("Temasys plugin is not installed");e.name="WEBRTC_NOT_READY",e.webRTCReadyPromise=c,i(e)})}K.default.isTemasysPluginUsed()||(A(e,t.getUserMediaWithConstraints.bind(t)),n())})}},{key:"getUserMediaWithConstraints",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=f(e,r);re.info("Get media constraints",i);try{this.getUserMedia(i,function(n){re.log("onUserMediaSuccess"),p(e,n),t(n)},function(t){p(e,void 0),re.warn("Failed to get access to local media. Error ",t,i),n&&n(new F.default(t,i,e))})}catch(t){re.error("GUM failed: ",t),n&&n(new F.default(t,i,e))}}},{key:"obtainAudioAndVideoPermissions",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,r=t.desktopSharingExtensionExternalInstallation;return new Promise(function(i,o){var a=function(e){i(C(e,t.resolution))};if(t.devices=t.devices||["audio","video"],Y.default.isSupported()||t.devices.indexOf("desktop")===-1||o(new Error("Desktop sharing is not supported!")),K.default.isFirefox()||K.default.isReactNative()||K.default.isTemasysPluginUsed()){var s=function(e,n,r){this.getUserMediaWithConstraints(e,n,r,t)},c={audio:s.bind(n,["audio"]),video:s.bind(n,["video"])};Y.default.isSupported()&&(c.desktop=Y.default.obtainStream.bind(Y.default,r)),R({devices:t.devices,streams:[],successCallback:a,errorCallback:o,deviceGUM:c})}else{var u=t.devices.indexOf("desktop")>-1;u&&t.devices.splice(t.devices.indexOf("desktop"),1),t.resolution=t.resolution||"360",t.devices.length?e.getUserMediaWithConstraints(t.devices,function(e){var i=t.devices.indexOf("audio")!==-1,s=t.devices.indexOf("video")!==-1,c=e.getAudioTracks().length>0,l=e.getVideoTracks().length>0;if(i&&!c||s&&!l){n.stopMediaStream(e);var d=[];return i&&!c&&d.push("audio"),s&&!l&&d.push("video"),void n.getUserMediaWithConstraints(d,function(){o(new F.default({name:"UnknownError"},f(t.devices,t),d))},function(e){o(e)},t)}u?Y.default.obtainStream(r,function(t){a({audioVideo:e,desktopStream:t})},function(t){n.stopMediaStream(e),o(t)}):a({audioVideo:e})},function(e){return o(e)},t):u&&Y.default.obtainStream(r,function(e){return a({desktopStream:e})},function(e){return o(e)})}})}},{key:"getDeviceAvailability",value:function(){return ce}},{key:"isRTCReady",value:function(){return ye}},{key:"_isDeviceListAvailable",value:function(){if(!ye)throw new Error("WebRTC not ready yet");return Boolean(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices||"undefined"!=typeof MediaStreamTrack&&MediaStreamTrack.getSources)}},{key:"onRTCReady",value:function(){return ye?Promise.resolve():new Promise(function(e){var t=function t(){ae.removeListener(z.default.RTC_READY,t),e()};ae.addListener(z.default.RTC_READY,t)})}},{key:"isDeviceListAvailable",value:function(){return this.onRTCReady().then(this._isDeviceListAvailable.bind(this))}},{key:"isDeviceChangeAvailable",value:function(e){return"output"===e||"audiooutput"===e?he:K.default.isChrome()||K.default.isFirefox()||K.default.isOpera()||K.default.isTemasysPluginUsed()||K.default.isNWJS()||K.default.isElectron()}},{key:"stopMediaStream",value:function(e){e.getTracks().forEach(function(e){!K.default.isTemasysPluginUsed()&&e.stop&&e.stop()}),e.stop&&e.stop(),e.release&&e.release();var t=e.jitsiObjectURL;t&&(delete e.jitsiObjectURL,(URL||webkitURL).revokeObjectURL(t))}},{key:"isDesktopSharingEnabled",value:function(){return Y.default.isSupported()}},{key:"setAudioOutputDevice",value:function(e){return this.isDeviceChangeAvailable("output")||Promise.reject(new Error("Audio output device change is not supported")),pe.setSinkId(e).then(function(){ue=e,le=!0,re.log("Audio output device set to "+e),ae.emit(z.default.AUDIO_OUTPUT_DEVICE_CHANGED,e)})}},{key:"getAudioOutputDevice",value:function(){return ue}},{key:"getCurrentlyAvailableMediaDevices",value:function(){return me}},{key:"getEventDataForActiveDevice",value:function(e){var t=[],n={deviceId:e.deviceId,kind:e.kind,label:e.label,groupId:e.groupId};return t.push(n),{deviceList:t}}}]),t}(B.default),Se=new Ee;t.default=Se}).call(t,"modules/RTC/RTCUtils.js",n(4))},function(e,t){"use strict";function n(e,t){return Math.floor(Math.random()*(t-e+1))+e}function r(e){return e[n(0,e.length-1)]}function i(e){for(var t="",n=0;n<e;n+=1)t+=r(o);return t}var o="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",a="0123456789abcdef",s={randomHexDigit:function(){return r(a)},randomHexString:function(e){for(var t="";e--;)t+=this.randomHexDigit();return t},randomElement:r,randomAlphanumStr:i,randomInt:n};e.exports=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PENDING="pending",t.ACTIVE="active",t.ENDED="ended"},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return parseInt(e.ssrcs.split(" ")[0],10)}function a(e){return parseInt(e.ssrcs.split(" ")[1],10)}function s(e){return e.ssrcs?e.ssrcs.map(function(e){return e.id}).filter(function(e,t,n){return n.indexOf(e)===t}).length:0}Object.defineProperty(t,"__esModule",{value:!0}),t.SdpTransformWrap=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.parsePrimarySSRC=o,t.parseSecondarySSRC=a;var u=n(39),l=r(u),d=function(){function e(t){if(i(this,e),!t)throw new Error("mLine is undefined");this.mLine=t}return c(e,[{key:"getSSRCAttrValue",value:function(e,t){var n=this.ssrcs.find(function(n){return n.id===e&&n.attribute===t});return n&&n.value}},{key:"removeSSRC",value:function(e){this.mLine.ssrcs&&this.mLine.ssrcs.length&&(this.mLine.ssrcs=this.mLine.ssrcs.filter(function(t){return t.id!==e}))}},{key:"addSSRCAttribute",value:function(e){this.ssrcs.push(e)}},{key:"findGroup",value:function(e,t){return this.ssrcGroups.find(function(n){return n.semantics===e&&(!t||t===n.ssrcs)})}},{key:"findGroups",value:function(e){return this.ssrcGroups.filter(function(t){return t.semantics===e})}},{key:"findGroupByPrimarySSRC",value:function(e,t){return this.ssrcGroups.find(function(n){return n.semantics===e&&o(n)===t})}},{key:"findSSRCByMSID",value:function(e){return this.ssrcs.find(function(t){return"msid"===t.attribute&&(null===e||t.value===e)})}},{key:"getSSRCCount",value:function(){return s(this.mLine)}},{key:"containsAnySSRCGroups",value:function(){return void 0!==this.mLine.ssrcGroups}},{key:"getPrimaryVideoSsrc",value:function(){var e=this.mLine.type;if("video"!==e)throw new Error("getPrimarySsrc doesn't work with '"+e+"'");var t=s(this.mLine);if(1===t)return this.mLine.ssrcs[0].id;if(this.mLine.ssrcGroups){var n=this.findGroup("SIM");if(n)return o(n);var r=this.findGroup("FID");if(r)return o(r)}}},{key:"getRtxSSRC",value:function(e){var t=this.findGroupByPrimarySSRC("FID",e);return t&&a(t)}},{key:"getSSRCs",value:function(){return this.ssrcs.map(function(e){return e.id}).filter(function(e,t,n){return n.indexOf(e)===t})}},{key:"getPrimaryVideoSSRCs",value:function(){var e=this.mLine.type;if("video"!==e)throw new Error("getPrimaryVideoSSRCs doesn't work with "+e);var t=this.getSSRCs(),n=!0,r=!1,i=void 0;try{for(var o,s=this.ssrcGroups[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var c=o.value;if("FID"===c.semantics){var u=a(c);t.splice(t.indexOf(u),1)}}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}return t}},{key:"dumpSSRCGroups",value:function(){return JSON.stringify(this.mLine.ssrcGroups)}},{key:"removeGroupsWithSSRC",value:function(e){this.mLine.ssrcGroups&&(this.mLine.ssrcGroups=this.mLine.ssrcGroups.filter(function(t){return t.ssrcs.indexOf(""+e)===-1}))}},{key:"removeGroupsBySemantics",value:function(e){this.mLine.ssrcGroups&&(this.mLine.ssrcGroups=this.mLine.ssrcGroups.filter(function(t){return t.semantics!==e}))}},{key:"replaceSSRC",value:function(e,t){this.mLine.ssrcs&&this.mLine.ssrcs.forEach(function(n){n.id===e&&(n.id=t)})}},{key:"addSSRCGroup",value:function(e){this.ssrcGroups.push(e)}},{key:"ssrcs",get:function(){return this.mLine.ssrcs||(this.mLine.ssrcs=[]),this.mLine.ssrcs},set:function(e){this.mLine.ssrcs=e}},{key:"direction",get:function(){return this.mLine.direction},set:function(e){this.mLine.direction=e}},{key:"ssrcGroups",get:function(){return this.mLine.ssrcGroups||(this.mLine.ssrcGroups=[]),this.mLine.ssrcGroups},set:function(e){this.mLine.ssrcGroups=e}}]),e}();t.SdpTransformWrap=function(){function e(t){i(this,e),this.parsedSDP=l.parse(t)}return c(e,[{key:"selectMedia",value:function(e){var t=this.parsedSDP.media.find(function(t){return t.type===e});return t?new d(t):null}},{key:"toRawSDP",value:function(){return l.write(this.parsedSDP)}}]),e}()},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){var r,r;(function(t){/*! adapterjs - v0.14.0 - 2016-10-03 */
var o=n(1).getLogger(t),a=a||{};e.exports=a,a.options=a.options||{},a.VERSION="0.14.0",a.onwebrtcready=a.onwebrtcready||function(e){},a._onwebrtcreadies=[],a.webRTCReady=function(e){if("function"!=typeof e)throw new Error("Callback provided is not a function");!0===a.onwebrtcreadyDone?e(null!==a.WebRTCPlugin.plugin):a._onwebrtcreadies.push(e)},a.WebRTCPlugin=a.WebRTCPlugin||{},a.WebRTCPlugin.pluginInfo=a.WebRTCPlugin.pluginInfo||{prefix:"Tem",plugName:"TemWebRTCPlugin",pluginId:"plugin0",type:"application/x-temwebrtcplugin",onload:"__TemWebRTCReady0",portalLink:"http://skylink.io/plugin/",downloadLink:null,companyName:"Temasys",downloadLinks:{mac:"http://bit.ly/webrtcpluginpkg",win:"http://bit.ly/webrtcpluginmsi"}},"undefined"!=typeof a.WebRTCPlugin.pluginInfo.downloadLinks&&null!==a.WebRTCPlugin.pluginInfo.downloadLinks&&(navigator.platform.match(/^Mac/i)?a.WebRTCPlugin.pluginInfo.downloadLink=a.WebRTCPlugin.pluginInfo.downloadLinks.mac:navigator.platform.match(/^Win/i)&&(a.WebRTCPlugin.pluginInfo.downloadLink=a.WebRTCPlugin.pluginInfo.downloadLinks.win)),a.WebRTCPlugin.TAGS={NONE:"none",AUDIO:"audio",VIDEO:"video"},a.WebRTCPlugin.pageId=Math.random().toString(36).slice(2),a.WebRTCPlugin.plugin=null,a.WebRTCPlugin.setLogLevel=null,a.WebRTCPlugin.defineWebRTCInterface=null,a.WebRTCPlugin.isPluginInstalled=null,a.WebRTCPlugin.pluginInjectionInterval=null,a.WebRTCPlugin.injectPlugin=null,a.WebRTCPlugin.PLUGIN_STATES={NONE:0,INITIALIZING:1,INJECTING:2,INJECTED:3,READY:4},a.WebRTCPlugin.pluginState=a.WebRTCPlugin.PLUGIN_STATES.NONE,a.onwebrtcreadyDone=!1,a.WebRTCPlugin.PLUGIN_LOG_LEVELS={NONE:"NONE",ERROR:"ERROR",WARNING:"WARNING",INFO:"INFO",VERBOSE:"VERBOSE",SENSITIVE:"SENSITIVE"},a.WebRTCPlugin.WaitForPluginReady=null,a.WebRTCPlugin.callWhenPluginReady=null,__TemWebRTCReady0=function(){if("complete"===document.readyState)a.WebRTCPlugin.pluginState=a.WebRTCPlugin.PLUGIN_STATES.READY,a.maybeThroughWebRTCReady();else var e=setInterval(function(){"complete"===document.readyState&&(clearInterval(e),a.WebRTCPlugin.pluginState=a.WebRTCPlugin.PLUGIN_STATES.READY,a.maybeThroughWebRTCReady())},100)},a.maybeThroughWebRTCReady=function(){a.onwebrtcreadyDone||(a.onwebrtcreadyDone=!0,a._onwebrtcreadies.length?a._onwebrtcreadies.forEach(function(e){"function"==typeof e&&e(null!==a.WebRTCPlugin.plugin)}):"function"==typeof a.onwebrtcready&&a.onwebrtcready(null!==a.WebRTCPlugin.plugin))},a.TEXT={PLUGIN:{REQUIRE_INSTALLATION:"This website requires you to install a WebRTC-enabling plugin to work on this browser.",NOT_SUPPORTED:"Your browser does not support WebRTC.",BUTTON:"Install Now"},REFRESH:{REQUIRE_REFRESH:"Please refresh page",BUTTON:"Refresh Page"}},a._iceConnectionStates={starting:"starting",checking:"checking",connected:"connected",completed:"connected",done:"completed",disconnected:"disconnected",failed:"failed",closed:"closed"},a._iceConnectionFiredStates=[],a.isDefined=null,a.parseWebrtcDetectedBrowser=function(){var e=null;if(window.opr&&opr.addons||window.opera||navigator.userAgent.indexOf(" OPR/")>=0)e=navigator.userAgent.match(/OPR\/(\d+)/i)||[],webrtcDetectedBrowser="opera",webrtcDetectedVersion=parseInt(e[1]||"0",10),webrtcMinimumVersion=26,webrtcDetectedType="webkit",webrtcDetectedDCSupport="SCTP";else if(navigator.userAgent.match(/Bowser\/[0-9.]*/g)){e=navigator.userAgent.match(/Bowser\/[0-9.]*/g)||[];var t=parseInt((navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./i)||[])[2]||"0",10);webrtcDetectedBrowser="bowser",webrtcDetectedVersion=parseFloat((e[0]||"0/0").split("/")[1],10),webrtcMinimumVersion=0,webrtcDetectedType="webkit",webrtcDetectedDCSupport=t>30?"SCTP":"RTP"}else if(navigator.userAgent.indexOf("OPiOS")>0)e=navigator.userAgent.match(/OPiOS\/([0-9]+)\./),webrtcDetectedBrowser="opera",webrtcDetectedVersion=parseInt(e[1]||"0",10),webrtcMinimumVersion=0,webrtcDetectedType=null,webrtcDetectedDCSupport=null;else if(navigator.userAgent.indexOf("CriOS")>0)e=navigator.userAgent.match(/CriOS\/([0-9]+)\./)||[],webrtcDetectedBrowser="chrome",webrtcDetectedVersion=parseInt(e[1]||"0",10),webrtcMinimumVersion=0,webrtcDetectedType=null,webrtcDetectedDCSupport=null;else if(navigator.userAgent.indexOf("FxiOS")>0)e=navigator.userAgent.match(/FxiOS\/([0-9]+)\./)||[],webrtcDetectedBrowser="firefox",webrtcDetectedVersion=parseInt(e[1]||"0",10),webrtcMinimumVersion=0,webrtcDetectedType=null,webrtcDetectedDCSupport=null;else if(document.documentMode)e=/\brv[ :]+(\d+)/g.exec(navigator.userAgent)||[],webrtcDetectedBrowser="IE",webrtcDetectedVersion=parseInt(e[1],10),webrtcMinimumVersion=9,webrtcDetectedType="plugin",webrtcDetectedDCSupport="SCTP",webrtcDetectedVersion||(e=/\bMSIE[ :]+(\d+)/g.exec(navigator.userAgent)||[],webrtcDetectedVersion=parseInt(e[1]||"0",10));else if(window.StyleMedia||navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))e=navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)||[],webrtcDetectedBrowser="edge",webrtcDetectedVersion=parseFloat((e[0]||"0/0").split("/")[1],10),webrtcMinimumVersion=13.10547,webrtcDetectedType="ms",webrtcDetectedDCSupport=null;else if("undefined"!=typeof InstallTrigger||navigator.userAgent.indexOf("irefox")>0)e=navigator.userAgent.match(/Firefox\/([0-9]+)\./)||[],webrtcDetectedBrowser="firefox",webrtcDetectedVersion=parseInt(e[1]||"0",10),webrtcMinimumVersion=31,webrtcDetectedType="moz",webrtcDetectedDCSupport="SCTP";else if(window.chrome&&window.chrome.webstore||navigator.userAgent.indexOf("Chrom")>0)e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./i)||[],webrtcDetectedBrowser="chrome",webrtcDetectedVersion=parseInt(e[2]||"0",10),webrtcMinimumVersion=38,webrtcDetectedType="webkit",webrtcDetectedDCSupport=webrtcDetectedVersion>30?"SCTP":"RTP";else if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){e=navigator.userAgent.match(/version\/(\d+)/i)||[];var n=navigator.userAgent.match(/(iPhone|iPad)/gi)||[];webrtcDetectedBrowser="safari",webrtcDetectedVersion=parseInt(e[1]||"0",10),webrtcMinimumVersion=7,webrtcDetectedType=0===n.length?"plugin":null,webrtcDetectedDCSupport=0===n.length?"SCTP":null}window.webrtcDetectedBrowser=webrtcDetectedBrowser,window.webrtcDetectedVersion=webrtcDetectedVersion,window.webrtcMinimumVersion=webrtcMinimumVersion,window.webrtcDetectedType=webrtcDetectedType,window.webrtcDetectedDCSupport=webrtcDetectedDCSupport},a.addEvent=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e[t]=n},a.renderNotificationBar=function(e,t,n,r,i){if("complete"===document.readyState){var o=window,s=document.createElement("iframe");s.name="adapterjs-alert",s.style.position="fixed",s.style.top="-41px",s.style.left=0,s.style.right=0,s.style.width="100%",s.style.height="40px",s.style.backgroundColor="#ffffe1",s.style.border="none",s.style.borderBottom="1px solid #888888",s.style.zIndex="9999999","string"==typeof s.style.webkitTransition?s.style.webkitTransition="all .5s ease-out":"string"==typeof s.style.transition&&(s.style.transition="all .5s ease-out"),document.body.appendChild(s);var c=s.contentWindow?s.contentWindow:s.contentDocument.document?s.contentDocument.document:s.contentDocument;c.document.open(),c.document.write('<span style="display: inline-block; font-family: Helvetica, Arial,sans-serif; font-size: .9rem; padding: 4px; vertical-align: middle; cursor: default;">'+e+"</span>"),t&&n?(c.document.write('<button id="okay">'+t+'</button><button id="cancel">Cancel</button>'),c.document.close(),a.addEvent(c.document.getElementById("okay"),"click",function(e){i&&a.renderNotificationBar(a.TEXT.EXTENSION?a.TEXT.EXTENSION.REQUIRE_REFRESH:a.TEXT.REFRESH.REQUIRE_REFRESH,a.TEXT.REFRESH.BUTTON,"javascript:location.reload()"),window.open(n,r?"_blank":"_top"),e.preventDefault();try{e.cancelBubble=!0}catch(e){}var t=setInterval(function(){isIE||navigator.plugins.refresh(!1),a.WebRTCPlugin.isPluginInstalled(a.WebRTCPlugin.pluginInfo.prefix,a.WebRTCPlugin.pluginInfo.plugName,a.WebRTCPlugin.pluginInfo.type,function(){clearInterval(t),a.WebRTCPlugin.defineWebRTCInterface()},function(){})},500)}),a.addEvent(c.document.getElementById("cancel"),"click",function(e){o.document.body.removeChild(s)})):c.document.close(),setTimeout(function(){"string"==typeof s.style.webkitTransform?s.style.webkitTransform="translateY(40px)":"string"==typeof s.style.transform?s.style.transform="translateY(40px)":s.style.top="0px"},300)}},webrtcDetectedType=null,checkMediaDataChannelSettings=function(e,t,n,r){if("function"==typeof n){var i=!0,a="firefox"===webrtcDetectedBrowser,s="moz"===webrtcDetectedType&&webrtcDetectedVersion>30,c="firefox"===e;if(a&&c||s)try{delete r.mandatory.MozDontOfferDataChannel}catch(e){o.error("Failed deleting MozDontOfferDataChannel"),o.error(e)}else a&&!c&&(r.mandatory.MozDontOfferDataChannel=!0);if(!a)for(var u in r.mandatory)r.mandatory.hasOwnProperty(u)&&u.indexOf("Moz")!==-1&&delete r.mandatory[u];!a||c||s||(i=!1),n(i,r)}},checkIceConnectionState=function(e,t,n){return"function"!=typeof n?void o.warn("No callback specified in checkIceConnectionState. Aborted."):(e=e?e:"peer",a._iceConnectionFiredStates[e]&&t!==a._iceConnectionStates.disconnected&&t!==a._iceConnectionStates.failed&&t!==a._iceConnectionStates.closed||(a._iceConnectionFiredStates[e]=[]),t=a._iceConnectionStates[t],void(a._iceConnectionFiredStates[e].indexOf(t)<0&&(a._iceConnectionFiredStates[e].push(t),t===a._iceConnectionStates.connected&&setTimeout(function(){a._iceConnectionFiredStates[e].push(a._iceConnectionStates.done),n(a._iceConnectionStates.done)},1e3),n(t))))},createIceServer=null,createIceServers=null,RTCPeerConnection=null,RTCSessionDescription="function"==typeof RTCSessionDescription?RTCSessionDescription:null,RTCIceCandidate="function"==typeof RTCIceCandidate?RTCIceCandidate:null,getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null,webrtcMinimumVersion=null,!(navigator.mozGetUserMedia||navigator.webkitGetUserMedia||navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))||0===(navigator.userAgent.match(/android/gi)||[]).length&&0===(navigator.userAgent.match(/chrome/gi)||[]).length&&navigator.userAgent.indexOf("Safari/")>0?("object"==typeof o&&"function"==typeof o.log||(o={}||o,o.log=function(e){},o.info=function(e){},o.error=function(e){},o.dir=function(e){},o.exception=function(e){},o.trace=function(e){},o.warn=function(e){},o.count=function(e){},o.debug=function(e){},o.count=function(e){},o.time=function(e){},o.timeEnd=function(e){},o.group=function(e){},o.groupCollapsed=function(e){},o.groupEnd=function(e){}),a.parseWebrtcDetectedBrowser(),isIE="IE"===webrtcDetectedBrowser,a.WebRTCPlugin.WaitForPluginReady=function(){for(;a.WebRTCPlugin.pluginState!==a.WebRTCPlugin.PLUGIN_STATES.READY;);},a.WebRTCPlugin.callWhenPluginReady=function(e){if(a.WebRTCPlugin.pluginState===a.WebRTCPlugin.PLUGIN_STATES.READY)e();else var t=setInterval(function(){a.WebRTCPlugin.pluginState===a.WebRTCPlugin.PLUGIN_STATES.READY&&(clearInterval(t),e())},100)},a.WebRTCPlugin.setLogLevel=function(e){a.WebRTCPlugin.callWhenPluginReady(function(){a.WebRTCPlugin.plugin.setLogLevel(e)})},a.WebRTCPlugin.injectPlugin=function(){if("complete"===document.readyState&&a.WebRTCPlugin.pluginState===a.WebRTCPlugin.PLUGIN_STATES.INITIALIZING){if(a.WebRTCPlugin.pluginState=a.WebRTCPlugin.PLUGIN_STATES.INJECTING,"IE"===webrtcDetectedBrowser&&webrtcDetectedVersion<=10){var e=document.createDocumentFragment();for(a.WebRTCPlugin.plugin=document.createElement("div"),a.WebRTCPlugin.plugin.innerHTML='<object id="'+a.WebRTCPlugin.pluginInfo.pluginId+'" type="'+a.WebRTCPlugin.pluginInfo.type+'" width="1" height="1"><param name="pluginId" value="'+a.WebRTCPlugin.pluginInfo.pluginId+'" /> <param name="windowless" value="false" /> <param name="pageId" value="'+a.WebRTCPlugin.pageId+'" /> <param name="onload" value="'+a.WebRTCPlugin.pluginInfo.onload+'" /><param name="tag" value="'+a.WebRTCPlugin.TAGS.NONE+'" />'+(a.options.getAllCams?'<param name="forceGetAllCams" value="True" />':"")+"</object>";a.WebRTCPlugin.plugin.firstChild;)e.appendChild(a.WebRTCPlugin.plugin.firstChild);document.body.appendChild(e),a.WebRTCPlugin.plugin=document.getElementById(a.WebRTCPlugin.pluginInfo.pluginId)}else a.WebRTCPlugin.plugin=document.createElement("object"),a.WebRTCPlugin.plugin.id=a.WebRTCPlugin.pluginInfo.pluginId,isIE?(a.WebRTCPlugin.plugin.width="1px",a.WebRTCPlugin.plugin.height="1px"):(a.WebRTCPlugin.plugin.width="0px",a.WebRTCPlugin.plugin.height="0px"),a.WebRTCPlugin.plugin.type=a.WebRTCPlugin.pluginInfo.type,a.WebRTCPlugin.plugin.innerHTML='<param name="onload" value="'+a.WebRTCPlugin.pluginInfo.onload+'"><param name="pluginId" value="'+a.WebRTCPlugin.pluginInfo.pluginId+'"><param name="windowless" value="false" /> '+(a.options.getAllCams?'<param name="forceGetAllCams" value="True" />':"")+'<param name="pageId" value="'+a.WebRTCPlugin.pageId+'"><param name="tag" value="'+a.WebRTCPlugin.TAGS.NONE+'" />',document.body.appendChild(a.WebRTCPlugin.plugin);a.WebRTCPlugin.pluginState=a.WebRTCPlugin.PLUGIN_STATES.INJECTED}},a.WebRTCPlugin.isPluginInstalled=function(e,t,n,r,i){if(isIE){try{new ActiveXObject(e+"."+t)}catch(e){return void i()}r()}else{for(var o=navigator.mimeTypes,a=0;a<o.length;a++)if(o[a].type.indexOf(n)>=0)return void r();i()}},a.WebRTCPlugin.defineWebRTCInterface=function(){if(a.WebRTCPlugin.pluginState===a.WebRTCPlugin.PLUGIN_STATES.READY)return void o.error("AdapterJS - WebRTC interface has already been defined");a.WebRTCPlugin.pluginState=a.WebRTCPlugin.PLUGIN_STATES.INITIALIZING,a.isDefined=function(e){return null!==e&&void 0!==e},createIceServer=function(e,t,n){var r=null,i=e.split(":");return 0===i[0].indexOf("stun")?r={url:e,hasCredentials:!1}:0===i[0].indexOf("turn")&&(r={url:e,hasCredentials:!0,credential:n,username:t}),r},createIceServers=function(e,t,n){for(var r=[],i=0;i<e.length;++i)r.push(createIceServer(e[i],t,n));return r},RTCSessionDescription=function(e){return a.WebRTCPlugin.WaitForPluginReady(),a.WebRTCPlugin.plugin.ConstructSessionDescription(e.type,e.sdp)},RTCPeerConnection=function(e,t){if(void 0!==e&&null!==e&&!Array.isArray(e.iceServers))throw new Error("Failed to construct 'RTCPeerConnection': Malformed RTCConfiguration");if("undefined"!=typeof t&&null!==t){var n=!1;if(n|="object"!=typeof t,n|=t.hasOwnProperty("mandatory")&&void 0!==t.mandatory&&null!==t.mandatory&&t.mandatory.constructor!==Object,n|=t.hasOwnProperty("optional")&&void 0!==t.optional&&null!==t.optional&&!Array.isArray(t.optional))throw new Error("Failed to construct 'RTCPeerConnection': Malformed constraints object")}a.WebRTCPlugin.WaitForPluginReady();var r=null;if(e&&Array.isArray(e.iceServers)){r=e.iceServers;for(var i=0;i<r.length;i++)r[i].urls&&!r[i].url&&(r[i].url=r[i].urls),r[i].hasCredentials=a.isDefined(r[i].username)&&a.isDefined(r[i].credential)}if(a.WebRTCPlugin.plugin.PEER_CONNECTION_VERSION&&a.WebRTCPlugin.plugin.PEER_CONNECTION_VERSION>1)return r&&(e.iceServers=r),a.WebRTCPlugin.plugin.PeerConnection(e);var o=t&&t.mandatory?t.mandatory:null,s=t&&t.optional?t.optional:null;return a.WebRTCPlugin.plugin.PeerConnection(a.WebRTCPlugin.pageId,r,o,s)},MediaStreamTrack=function(){},MediaStreamTrack.getSources=function(e){a.WebRTCPlugin.callWhenPluginReady(function(){a.WebRTCPlugin.plugin.GetSources(e)})};var e=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),o={},o[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t};getUserMedia=function(t,n,r){var i={};i.audio=!!t.audio&&e(t.audio),i.video=!!t.video&&e(t.video),a.WebRTCPlugin.callWhenPluginReady(function(){a.WebRTCPlugin.plugin.getUserMedia(i,n,r)})},window.navigator.getUserMedia=getUserMedia,navigator.mediaDevices||"undefined"==typeof Promise||(requestUserMedia=function(e){return new Promise(function(t,n){getUserMedia(e,t,n)})},navigator.mediaDevices={getUserMedia:requestUserMedia,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],id:e.id,deviceId:e.id,groupId:""}}))})})}}),attachMediaStream=function(e,t){if(e&&e.parentNode){var n;null===t?n="":("undefined"!=typeof t.enableSoundTracks&&t.enableSoundTracks(!0),n=t.id);var r=0===e.id.length?Math.random().toString(36).slice(2):e.id,i=e.nodeName.toLowerCase();if("object"!==i){var o;switch(i){case"audio":o=a.WebRTCPlugin.TAGS.AUDIO;break;case"video":o=a.WebRTCPlugin.TAGS.VIDEO;break;default:o=a.WebRTCPlugin.TAGS.NONE}var s=document.createDocumentFragment(),c=document.createElement("div"),u="";for(e.className?u='class="'+e.className+'" ':e.attributes&&e.attributes.class&&(u='class="'+e.attributes.class.value+'" '),c.innerHTML='<object id="'+r+'" '+u+'type="'+a.WebRTCPlugin.pluginInfo.type+'"><param name="pluginId" value="'+r+'" /> <param name="pageId" value="'+a.WebRTCPlugin.pageId+'" /> <param name="windowless" value="true" /> <param name="streamId" value="'+n+'" /> <param name="tag" value="'+o+'" /> </object>';c.firstChild;)s.appendChild(c.firstChild);var l="",d="";e.clientWidth||e.clientHeight?(d=e.clientWidth,l=e.clientHeight):(e.width||e.height)&&(d=e.width,l=e.height),e.parentNode.insertBefore(s,e),s=document.getElementById(r),s.width=d,s.height=l,e.parentNode.removeChild(e)}else{for(var f=e.children,p=0;p!==f.length;++p)if("streamId"===f[p].name){f[p].value=n;break}e.setStreamId(n)}var h=document.getElementById(r);return a.forwardEventHandlers(h,e,Object.getPrototypeOf(e)),h}},reattachMediaStream=function(e,t){for(var n=null,r=t.children,i=0;i!==r.length;++i)if("streamId"===r[i].name){a.WebRTCPlugin.WaitForPluginReady(),n=a.WebRTCPlugin.plugin.getStreamWithId(a.WebRTCPlugin.pageId,r[i].value);break}return null!==n?attachMediaStream(e,n):void o.log("Could not find the stream associated with this element")},window.attachMediaStream=attachMediaStream,window.reattachMediaStream=reattachMediaStream,window.getUserMedia=getUserMedia,a.attachMediaStream=attachMediaStream,a.reattachMediaStream=reattachMediaStream,a.getUserMedia=getUserMedia,a.forwardEventHandlers=function(e,t,n){properties=Object.getOwnPropertyNames(n);for(var r in properties)r&&(propName=properties[r],"function"==typeof propName.slice&&"on"===propName.slice(0,2)&&"function"==typeof t[propName]&&a.addEvent(e,propName.slice(2),t[propName]));var i=Object.getPrototypeOf(n);i&&a.forwardEventHandlers(e,t,i)},RTCIceCandidate=function(e){return e.sdpMid||(e.sdpMid=""),a.WebRTCPlugin.WaitForPluginReady(),a.WebRTCPlugin.plugin.ConstructIceCandidate(e.sdpMid,e.sdpMLineIndex,e.candidate)},a.addEvent(document,"readystatechange",a.WebRTCPlugin.injectPlugin),a.WebRTCPlugin.injectPlugin()},a.WebRTCPlugin.pluginNeededButNotInstalledCb=a.WebRTCPlugin.pluginNeededButNotInstalledCb||function(){a.addEvent(document,"readystatechange",a.WebRTCPlugin.pluginNeededButNotInstalledCbPriv),a.WebRTCPlugin.pluginNeededButNotInstalledCbPriv()},a.WebRTCPlugin.pluginNeededButNotInstalledCbPriv=function(){if(!a.options.hidePluginInstallPrompt){var e=a.WebRTCPlugin.pluginInfo.downloadLink;if(e){var t;t=a.WebRTCPlugin.pluginInfo.portalLink?'This website requires you to install the  <a href="'+a.WebRTCPlugin.pluginInfo.portalLink+'" target="_blank">'+a.WebRTCPlugin.pluginInfo.companyName+" WebRTC Plugin</a> to work on this browser.":a.TEXT.PLUGIN.REQUIRE_INSTALLATION,a.renderNotificationBar(t,a.TEXT.PLUGIN.BUTTON,e)}else a.renderNotificationBar(a.TEXT.PLUGIN.NOT_SUPPORTED)}},a.WebRTCPlugin.isPluginInstalled(a.WebRTCPlugin.pluginInfo.prefix,a.WebRTCPlugin.pluginInfo.plugName,a.WebRTCPlugin.pluginInfo.type,a.WebRTCPlugin.defineWebRTCInterface,a.WebRTCPlugin.pluginNeededButNotInstalledCb)):(!function(t){e.exports=t()}(function(){return function e(t,n,i){function o(s,c){if(!n[s]){if(!t[s]){var u="function"==typeof r&&r;if(!c&&u)return r(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return o(n?n:e)},d,d.exports,e,t,n,i)}return n[s].exports}for(var a="function"==typeof r&&r,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,t,n){"use strict";var r={};r.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},r.splitSections=function(e){var t=e.split("\nm=");return t.map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},r.parseCandidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),"candidate:"+t.join(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.numChannels=3===t.length?parseInt(t[2],10):1,n},r.writeRtpMap=function(e){var t=e.payloadType;return void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==e.numChannels?"/"+e.numChannels:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)t=r[i].trim().split("="),n[t[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){r.push(t+"="+e.parameters[t])}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.getDtlsParameters=function(e,t){var n=r.splitLines(e);n=n.concat(r.splitLines(t));var i=n.filter(function(e){return 0===e.indexOf("a=fingerprint:")})[0].substr(14),o={role:"auto",fingerprints:[{algorithm:i.split(" ")[0],value:i.split(" ")[1]}]};return o},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);n=n.concat(r.splitLines(t));var i={usernameFragment:n.filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)};return i},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e),i=n[0].split(" "),o=3;o<i.length;o++){var a=i[o],s=r.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(s){var c=r.parseRtpMap(s),u=r.matchPrefix(e,"a=fmtp:"+a+" ");switch(c.parameters=u.length?r.parseFmtp(u[0]):{},c.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(r.parseRtcpFb),t.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(c.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n="";return n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}),n+="a=rtcp-mux\r\n"},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=i.fecMechanisms.indexOf("RED")!==-1,a=i.fecMechanisms.indexOf("ULPFEC")!==-1,s=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.split(" ");return t.shift(),t.map(function(e){return parseInt(e,10)})});u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10),rtx:{payloadType:e.payloadType,ssrc:t}};n.push(r),o&&(r=JSON.parse(JSON.stringify(r)),r.fec={ssrc:t,mechanism:a?"red+ulpfec":"red"},n.push(r))}}),0===n.length&&c&&n.push({ssrc:c});var l=r.matchPrefix(e,"b=");return l.length&&(0===l[0].indexOf("b=TIAS:")?l=parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")&&(l=parseInt(l[0].substr(5),10)),n.forEach(function(e){e.maxBitrate=l})),n},r.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",o+=e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n"},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},t.exports=r},{}],2:[function(e,t,n){"use strict";!function(){var n=e("./utils").log,r=e("./utils").browserDetails;t.exports.browserDetails=r,t.exports.extractVersion=e("./utils").extractVersion,t.exports.disableLog=e("./utils").disableLog;var i=e("./chrome/chrome_shim")||null,o=e("./edge/edge_shim")||null,a=e("./firefox/firefox_shim")||null,s=e("./safari/safari_shim")||null;switch(r.browser){case"opera":case"chrome":if(!i||!i.shimPeerConnection)return void n("Chrome shim is not included in this adapter release.");n("adapter.js shimming chrome."),t.exports.browserShim=i,i.shimGetUserMedia(),i.shimMediaStream(),i.shimSourceObject(),i.shimPeerConnection(),i.shimOnTrack();break;case"firefox":if(!a||!a.shimPeerConnection)return void n("Firefox shim is not included in this adapter release.");n("adapter.js shimming firefox."),t.exports.browserShim=a,a.shimGetUserMedia(),a.shimSourceObject(),a.shimPeerConnection(),a.shimOnTrack();break;case"edge":if(!o||!o.shimPeerConnection)return void n("MS edge shim is not included in this adapter release.");n("adapter.js shimming edge."),t.exports.browserShim=o,o.shimGetUserMedia(),o.shimPeerConnection();break;case"safari":if(!s)return void n("Safari shim is not included in this adapter release.");n("adapter.js shimming safari."),t.exports.browserShim=s,s.shimGetUserMedia();break;default:n("Unsupported browser!")}}()},{"./chrome/chrome_shim":3,"./edge/edge_shim":5,"./firefox/firefox_shim":7,"./safari/safari_shim":9,"./utils":10}],3:[function(e,t,n){"use strict";var r=e("../utils.js").log,i=e("../utils.js").browserDetails,o={shimMediaStream:function(){window.MediaStream=window.MediaStream||window.webkitMediaStream},shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){var t=this;this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",function(n){var r=new Event("track");r.track=n.track,r.receiver={track:n.track},r.streams=[e.stream],t.dispatchEvent(r)}),e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var t=this;return this._srcObject=e,this.src&&URL.revokeObjectURL(this.src),e?(this.src=URL.createObjectURL(e),e.addEventListener("addtrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)}),void e.addEventListener("removetrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)})):void(this.src="")}}))},shimPeerConnection:function(){window.RTCPeerConnection=function(e,t){r("PeerConnection"),e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new webkitRTCPeerConnection(e,t),i=n.getStats.bind(n);return n.getStats=function(e,t,n){var r=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return i(e,t);var a=function(e){var t={},n=e.result();return n.forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},s=function(e,t){var n=new Map(Object.keys(e).map(function(t){return[t,e[t]]}));return t=t||e,Object.keys(t).forEach(function(e){n[e]=t[e]}),n};if(arguments.length>=2){var c=function(e){o[1](s(a(e)))};return i.apply(this,[c,arguments[0]])}return new Promise(function(t,n){1===o.length&&"object"==typeof e?i.apply(r,[function(e){t(s(a(e)))},n]):i.apply(r,[function(e){t(s(a(e),e.result()))},n])}).then(t,n)},n},window.RTCPeerConnection.prototype=webkitRTCPeerConnection.prototype,webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return webkitRTCPeerConnection.generateCertificate}}),["createOffer","createAnswer"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){
var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var n=1===arguments.length?arguments[0]:void 0;return new Promise(function(r,i){t.apply(e,[r,i,n])})}return t.apply(this,arguments)}}),i.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this,r=new Promise(function(r,i){t.apply(n,[e[0],r,i])});return e.length<2?r:r.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return null===arguments[0]?Promise.resolve():e.apply(this,arguments)}}};t.exports={shimMediaStream:o.shimMediaStream,shimOnTrack:o.shimOnTrack,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils.js":10,"./getusermedia":4}],4:[function(e,t,n){"use strict";var r=e("../utils.js").log;t.exports=function(){var e=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),o={},o[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},t=function(t,n){if(t=JSON.parse(JSON.stringify(t)),t&&t.audio&&(t.audio=e(t.audio)),t&&"object"==typeof t.video){var i=t.video.facingMode;if(i=i&&("object"==typeof i?i:{ideal:i}),i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!navigator.mediaDevices.getSupportedConstraints||!navigator.mediaDevices.getSupportedConstraints().facingMode)&&(delete t.video.facingMode,"environment"===i.exact||"environment"===i.ideal))return navigator.mediaDevices.enumerateDevices().then(function(o){o=o.filter(function(e){return"videoinput"===e.kind});var a=o.find(function(e){return e.label.toLowerCase().indexOf("back")!==-1})||o.length&&o[o.length-1];return a&&(t.video.deviceId=i.exact?{exact:a.deviceId}:{ideal:a.deviceId}),t.video=e(t.video),r("chrome: "+JSON.stringify(t)),n(t)});t.video=e(t.video)}return r("chrome: "+JSON.stringify(t)),n(t)},n=function(e){return{name:{PermissionDeniedError:"NotAllowedError",ConstraintNotSatisfiedError:"OverconstrainedError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},i=function(e,r,i){t(e,function(e){navigator.webkitGetUserMedia(e,r,function(e){i(n(e))})})};navigator.getUserMedia=i;var o=function(e){return new Promise(function(t,n){navigator.getUserMedia(e,t,n)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:o,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var a=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return t(e,function(e){return a(e).catch(function(e){return Promise.reject(n(e))})})}}else navigator.mediaDevices.getUserMedia=function(e){return o(e)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){r("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){r("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":10}],5:[function(e,t,n){"use strict";var r=e("sdp"),i=e("../utils").browserDetails,o={shimPeerConnection:function(){window.RTCIceGatherer&&(window.RTCIceCandidate||(window.RTCIceCandidate=function(e){return e}),window.RTCSessionDescription||(window.RTCSessionDescription=function(e){return e})),window.RTCPeerConnection=function(e){var t=this,n=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=n[e].bind(n)}),this.onicecandidate=null,this.onaddstream=null,this.ontrack=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return t.localStreams},this.getRemoteStreams=function(){return t.remoteStreams},this.localDescription=new RTCSessionDescription({type:"",sdp:""}),this.remoteDescription=new RTCSessionDescription({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]},e&&e.iceTransportPolicy)switch(e.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=e.iceTransportPolicy;break;case"none":throw new TypeError('iceTransportPolicy "none" not supported')}if(this.usingBundle=e&&"max-bundle"===e.bundlePolicy,e&&e.iceServers){var r=JSON.parse(JSON.stringify(e.iceServers));this.iceOptions.iceServers=r.filter(function(e){if(e&&e.urls){var t=e.urls;return"string"==typeof t&&(t=[t]),t=t.filter(function(e){return 0===e.indexOf("turn:")&&e.indexOf("transport=udp")!==-1&&e.indexOf("turn:[")===-1||0===e.indexOf("stun:")&&i.version>=14393})[0],!!t}return!1})}this.transceivers=[],this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var e=this,t=r.splitSections(e.localDescription.sdp);this._localIceCandidatesBuffer.forEach(function(n){var r=!n.candidate||0===Object.keys(n.candidate).length;if(r)for(var i=1;i<t.length;i++)t[i].indexOf("\r\na=end-of-candidates\r\n")===-1&&(t[i]+="a=end-of-candidates\r\n");else n.candidate.candidate.indexOf("typ endOfCandidates")===-1&&(t[n.candidate.sdpMLineIndex+1]+="a="+n.candidate.candidate+"\r\n");if(e.localDescription.sdp=t.join(""),e.dispatchEvent(n),null!==e.onicecandidate&&e.onicecandidate(n),!n.candidate&&"complete"!==e.iceGatheringState){var o=e.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});o&&(e.iceGatheringState="complete")}}),this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype.addStream=function(e){this.localStreams.push(e.clone()),this._maybeFireNegotiationNeeded()},window.RTCPeerConnection.prototype.removeStream=function(e){var t=this.localStreams.indexOf(e);t>-1&&(this.localStreams.splice(t,1),this._maybeFireNegotiationNeeded())},window.RTCPeerConnection.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},window.RTCPeerConnection.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},window.RTCPeerConnection.prototype._getCommonCapabilities=function(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]};return e.codecs.forEach(function(e){for(var r=0;r<t.codecs.length;r++){var i=t.codecs[r];if(e.name.toLowerCase()===i.name.toLowerCase()&&e.clockRate===i.clockRate&&e.numChannels===i.numChannels){n.codecs.push(i),i.rtcpFeedback=i.rtcpFeedback.filter(function(t){for(var n=0;n<e.rtcpFeedback.length;n++)if(e.rtcpFeedback[n].type===t.type&&e.rtcpFeedback[n].parameter===t.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n},window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(e,t){var n=this,i=new RTCIceGatherer(n.iceOptions),o=new RTCIceTransport(i);i.onlocalcandidate=function(a){var s=new Event("icecandidate");s.candidate={sdpMid:e,sdpMLineIndex:t};var c=a.candidate,u=!c||0===Object.keys(c).length;u?(void 0===i.state&&(i.state="completed"),s.candidate.candidate="candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates"):(c.component="RTCP"===o.component?2:1,s.candidate.candidate=r.writeCandidate(c));var l=r.splitSections(n.localDescription.sdp);s.candidate.candidate.indexOf("typ endOfCandidates")===-1?l[s.candidate.sdpMLineIndex+1]+="a="+s.candidate.candidate+"\r\n":l[s.candidate.sdpMLineIndex+1]+="a=end-of-candidates\r\n",n.localDescription.sdp=l.join("");var d=n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});switch(n.iceGatheringState){case"new":n._localIceCandidatesBuffer.push(s),u&&d&&n._localIceCandidatesBuffer.push(new Event("icecandidate"));break;case"gathering":n._emitBufferedCandidates(),n.dispatchEvent(s),null!==n.onicecandidate&&n.onicecandidate(s),d&&(n.dispatchEvent(new Event("icecandidate")),null!==n.onicecandidate&&n.onicecandidate(new Event("icecandidate")),n.iceGatheringState="complete");break;case"complete":}},o.onicestatechange=function(){n._updateConnectionState()};var a=new RTCDtlsTransport(o);return a.ondtlsstatechange=function(){n._updateConnectionState()},a.onerror=function(){a.state="failed",n._updateConnectionState()},{iceGatherer:i,iceTransport:o,dtlsTransport:a}},window.RTCPeerConnection.prototype._transceive=function(e,t,n){var i=this._getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:r.localCName},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),n&&e.rtpReceiver&&(i.encodings=e.recvEncodingParameters,i.rtcp={cname:e.cname},e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},window.RTCPeerConnection.prototype.setLocalDescription=function(e){var t,n,i=this;if("offer"===e.type)this._pendingOffer&&(t=r.splitSections(e.sdp),n=t.shift(),t.forEach(function(e,t){var n=r.parseRtpParameters(e);i._pendingOffer[t].localCapabilities=n}),this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===e.type){t=r.splitSections(i.remoteDescription.sdp),n=t.shift();var o=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach(function(e,t){var a=i.transceivers[t],s=a.iceGatherer,c=a.iceTransport,u=a.dtlsTransport,l=a.localCapabilities,d=a.remoteCapabilities,f="0"===e.split("\n",1)[0].split(" ",2)[1];if(!f&&!a.isDatachannel){var p=r.getIceParameters(e,n);if(o){var h=r.matchPrefix(e,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component});h.length&&c.setRemoteCandidates(h)}var m=r.getDtlsParameters(e,n);o&&(m.role="server"),i.usingBundle&&0!==t||(c.start(s,p,o?"controlling":"controlled"),u.start(m));var v=i._getCommonCapabilities(l,d);i._transceive(a,v.codecs.length>0,!1)}})}switch(this.localDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}var a=arguments.length>1&&"function"==typeof arguments[1];if(a){var s=arguments[1];window.setTimeout(function(){s(),"new"===i.iceGatheringState&&(i.iceGatheringState="gathering"),i._emitBufferedCandidates()},0)}var c=Promise.resolve();return c.then(function(){a||("new"===i.iceGatheringState&&(i.iceGatheringState="gathering"),window.setTimeout(i._emitBufferedCandidates.bind(i),500))}),c},window.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t=this,n=new MediaStream,i=[],o=r.splitSections(e.sdp),a=o.shift(),s=r.matchPrefix(a,"a=ice-lite").length>0;switch(this.usingBundle=r.matchPrefix(a,"a=group:BUNDLE ").length>0,o.forEach(function(o,c){var u=r.splitLines(o),l=u[0].substr(2).split(" "),d=l[0],f="0"===l[1],p=r.getDirection(o,a),h=r.matchPrefix(o,"a=mid:");if(h=h.length?h[0].substr(6):r.generateIdentifier(),"application"===d&&"DTLS/SCTP"===l[2])return void(t.transceivers[c]={mid:h,isDatachannel:!0});var m,v,g,y,b,E,S,T,C,w,_,R,A=r.parseRtpParameters(o);f||(_=r.getIceParameters(o,a),R=r.getDtlsParameters(o,a),R.role="client"),T=r.parseRtpEncodingParameters(o);var k,O=r.matchPrefix(o,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];O&&(k=O.value);var I=r.matchPrefix(o,"a=end-of-candidates",a).length>0,P=r.matchPrefix(o,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component});if("offer"!==e.type||f)"answer"!==e.type||f||(m=t.transceivers[c],v=m.iceGatherer,g=m.iceTransport,y=m.dtlsTransport,b=m.rtpSender,E=m.rtpReceiver,S=m.sendEncodingParameters,C=m.localCapabilities,t.transceivers[c].recvEncodingParameters=T,t.transceivers[c].remoteCapabilities=A,t.transceivers[c].cname=k,(s||I)&&P.length&&g.setRemoteCandidates(P),t.usingBundle&&0!==c||(g.start(v,_,"controlling"),y.start(R)),t._transceive(m,"sendrecv"===p||"recvonly"===p,"sendrecv"===p||"sendonly"===p),!E||"sendrecv"!==p&&"sendonly"!==p?delete m.rtpReceiver:(w=E.track,i.push([w,E]),n.addTrack(w)));else{var D=t.usingBundle&&c>0?{iceGatherer:t.transceivers[0].iceGatherer,iceTransport:t.transceivers[0].iceTransport,dtlsTransport:t.transceivers[0].dtlsTransport}:t._createIceAndDtlsTransports(h,c);if(I&&D.iceTransport.setRemoteCandidates(P),C=RTCRtpReceiver.getCapabilities(d),S=[{ssrc:1001*(2*c+2)}],E=new RTCRtpReceiver(D.dtlsTransport,d),w=E.track,i.push([w,E]),n.addTrack(w),t.localStreams.length>0&&t.localStreams[0].getTracks().length>=c){var N;"audio"===d?N=t.localStreams[0].getAudioTracks()[0]:"video"===d&&(N=t.localStreams[0].getVideoTracks()[0]),N&&(b=new RTCRtpSender(N,D.dtlsTransport))}t.transceivers[c]={iceGatherer:D.iceGatherer,iceTransport:D.iceTransport,dtlsTransport:D.dtlsTransport,localCapabilities:C,remoteCapabilities:A,rtpSender:b,rtpReceiver:E,kind:d,mid:h,cname:k,sendEncodingParameters:S,recvEncodingParameters:T},t._transceive(t.transceivers[c],!1,"sendrecv"===p||"sendonly"===p)}}),this.remoteDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}return n.getTracks().length&&(t.remoteStreams.push(n),window.setTimeout(function(){var e=new Event("addstream");e.stream=n,t.dispatchEvent(e),null!==t.onaddstream&&window.setTimeout(function(){t.onaddstream(e)},0),i.forEach(function(r){var i=r[0],o=r[1],a=new Event("track");a.track=i,a.receiver=o,a.streams=[n],t.dispatchEvent(e),null!==t.ontrack&&window.setTimeout(function(){t.ontrack(a)},0)})},0)),arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._updateSignalingState("closed")},window.RTCPeerConnection.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this.dispatchEvent(t),null!==this.onsignalingstatechange&&this.onsignalingstatechange(t)},window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){var e=new Event("negotiationneeded");this.dispatchEvent(e),null!==this.onnegotiationneeded&&this.onnegotiationneeded(e)},window.RTCPeerConnection.prototype._updateConnectionState=function(){var e,t=this,n={new:0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};if(this.transceivers.forEach(function(e){n[e.iceTransport.state]++,n[e.dtlsTransport.state]++}),n.connected+=n.completed,e="new",n.failed>0?e="failed":n.connecting>0||n.checking>0?e="connecting":n.disconnected>0?e="disconnected":n.new>0?e="new":(n.connected>0||n.completed>0)&&(e="connected"),e!==t.iceConnectionState){t.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this.dispatchEvent(r),null!==this.oniceconnectionstatechange&&this.oniceconnectionstatechange(r)}},window.RTCPeerConnection.prototype.createOffer=function(){var e=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");var t;1===arguments.length&&"function"!=typeof arguments[0]?t=arguments[0]:3===arguments.length&&(t=arguments[2]);var n=[],i=0,o=0;if(this.localStreams.length&&(i=this.localStreams[0].getAudioTracks().length,o=this.localStreams[0].getVideoTracks().length),t){if(t.mandatory||t.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==t.offerToReceiveAudio&&(i=t.offerToReceiveAudio),void 0!==t.offerToReceiveVideo&&(o=t.offerToReceiveVideo)}for(this.localStreams.length&&this.localStreams[0].getTracks().forEach(function(e){n.push({kind:e.kind,track:e,wantReceive:"audio"===e.kind?i>0:o>0}),"audio"===e.kind?i--:"video"===e.kind&&o--});i>0||o>0;)i>0&&(n.push({kind:"audio",wantReceive:!0}),i--),o>0&&(n.push({kind:"video",wantReceive:!0}),o--);var a=r.writeSessionBoilerplate(),s=[];n.forEach(function(t,n){var i,o,a=t.track,c=t.kind,u=r.generateIdentifier(),l=e.usingBundle&&n>0?{iceGatherer:s[0].iceGatherer,iceTransport:s[0].iceTransport,dtlsTransport:s[0].dtlsTransport}:e._createIceAndDtlsTransports(u,n),d=RTCRtpSender.getCapabilities(c),f=[{ssrc:1001*(2*n+1)}];a&&(i=new RTCRtpSender(a,l.dtlsTransport)),t.wantReceive&&(o=new RTCRtpReceiver(l.dtlsTransport,c)),s[n]={iceGatherer:l.iceGatherer,iceTransport:l.iceTransport,dtlsTransport:l.dtlsTransport,localCapabilities:d,remoteCapabilities:null,rtpSender:i,rtpReceiver:o,kind:c,mid:u,sendEncodingParameters:f,recvEncodingParameters:null}}),this.usingBundle&&(a+="a=group:BUNDLE "+s.map(function(e){return e.mid}).join(" ")+"\r\n"),n.forEach(function(t,n){var i=s[n];a+=r.writeMediaSection(i,i.localCapabilities,"offer",e.localStreams[0])}),this._pendingOffer=s;var c=new RTCSessionDescription({type:"offer",sdp:a});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,c),Promise.resolve(c)},window.RTCPeerConnection.prototype.createAnswer=function(){var e=this,t=r.writeSessionBoilerplate();this.usingBundle&&(t+="a=group:BUNDLE "+this.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),this.transceivers.forEach(function(n){if(n.isDatachannel)return void(t+="m=application 0 DTLS/SCTP 5000\r\nc=IN IP4 0.0.0.0\r\na=mid:"+n.mid+"\r\n");var i=e._getCommonCapabilities(n.localCapabilities,n.remoteCapabilities);t+=r.writeMediaSection(n,i,"answer",e.localStreams[0])});var n=new RTCSessionDescription({type:"answer",sdp:t});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,n),Promise.resolve(n)},window.RTCPeerConnection.prototype.addIceCandidate=function(e){if(null===e)this.transceivers.forEach(function(e){e.iceTransport.addRemoteCandidate({})});else{var t=e.sdpMLineIndex;if(e.sdpMid)for(var n=0;n<this.transceivers.length;n++)if(this.transceivers[n].mid===e.sdpMid){t=n;break}var i=this.transceivers[t];if(i){var o=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===o.protocol&&(0===o.port||9===o.port))return;if("1"!==o.component)return;"endOfCandidates"===o.type&&(o={}),i.iceTransport.addRemoteCandidate(o);var a=r.splitSections(this.remoteDescription.sdp);a[t+1]+=(o.type?e.candidate.trim():"a=end-of-candidates")+"\r\n",this.remoteDescription.sdp=a.join("")}}return arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.getStats=function(){var e=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(n){t[n]&&e.push(t[n].getStats())})});var t=arguments.length>1&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(n){var r=new Map;Promise.all(e).then(function(e){e.forEach(function(e){Object.keys(e).forEach(function(t){r.set(t,e[t]),r[t]=e[t]})}),t&&window.setTimeout(t,0,r),n(r)})})}}};t.exports={shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":10,"./getusermedia":6,sdp:1}],6:[function(e,t,n){"use strict";t.exports=function(){var e=function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}},t=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(n){return t(n).catch(function(t){return Promise.reject(e(t))})}}},{}],7:[function(e,t,n){"use strict";var r=e("../utils").browserDetails,i={shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(){if("object"==typeof window&&(window.RTCPeerConnection||window.mozRTCPeerConnection)){window.RTCPeerConnection||(window.RTCPeerConnection=function(e,t){if(r.version<38&&e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];if(o.hasOwnProperty("urls"))for(var a=0;a<o.urls.length;a++){var s={url:o.urls[a]};0===o.urls[a].indexOf("turn")&&(s.username=o.username,s.credential=o.credential),n.push(s)}else n.push(e.iceServers[i])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},window.RTCPeerConnection.prototype=mozRTCPeerConnection.prototype,mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return null===arguments[0]?Promise.resolve():e.apply(this,arguments)};var t=function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n]),t[n]=e[n]}),t},n=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(e,r,i){return n.apply(this,[e||null]).then(function(e){return t(e)}).then(r,i)}}}};t.exports={shimOnTrack:i.shimOnTrack,shimSourceObject:i.shimSourceObject,shimPeerConnection:i.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":10,"./getusermedia":8}],8:[function(e,t,n){"use strict";var r=e("../utils").log,i=e("../utils").browserDetails;t.exports=function(){var e=function(e){return{name:{SecurityError:"NotAllowedError",PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},t=function(t,n,o){var a=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var i={};"number"==typeof r.ideal?i[n]={min:r.ideal,max:r.ideal}:i[n]=r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}}),t.length&&(e.require=t),e};return t=JSON.parse(JSON.stringify(t)),i.version<38&&(r("spec: "+JSON.stringify(t)),t.audio&&(t.audio=a(t.audio)),t.video&&(t.video=a(t.video)),r("ff37: "+JSON.stringify(t))),navigator.mozGetUserMedia(t,n,function(t){o(e(t))})},n=function(e){return new Promise(function(n,r){t(e,n,r)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:n,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})},i.version<41){var a=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return a().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(i.version<49){var s=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(t){return s(t).catch(function(t){return Promise.reject(e(t))})}}navigator.getUserMedia=function(e,n,r){return i.version<44?t(e,n,r):(o.warn("navigator.getUserMedia has been replaced by navigator.mediaDevices.getUserMedia"),void navigator.mediaDevices.getUserMedia(e).then(n,r))}}},{"../utils":10}],9:[function(e,t,n){"use strict";var r={shimGetUserMedia:function(){navigator.getUserMedia=navigator.webkitGetUserMedia}};t.exports={shimGetUserMedia:r.shimGetUserMedia}},{}],10:[function(e,t,n){"use strict";var r=!0,i={disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(r=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},log:function(){if("object"==typeof window){if(r)return;"undefined"!=typeof o&&"function"==typeof o.log&&o.log.apply(o,arguments)}},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)},detectBrowser:function(){var e={};if(e.browser=null,e.version=null,"undefined"==typeof window||!window.navigator)return e.browser="Not a browser.",e;if(navigator.mozGetUserMedia)e.browser="firefox",e.version=this.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1);else if(navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)e.browser="chrome",e.version=this.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2);else{if(!navigator.userAgent.match(/Version\/(\d+).(\d+)/))return e.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",e;e.browser="safari",e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/([0-9]+)\./,1)}else{if(!navigator.mediaDevices||!navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))return e.browser="Not a supported browser.",e;e.browser="edge",e.version=this.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2)}return e}};t.exports={log:i.log,disableLog:i.disableLog,browserDetails:i.detectBrowser(),extractVersion:i.extractVersion}},{}]},{},[2])(2)}),a.parseWebrtcDetectedBrowser(),navigator.mozGetUserMedia?(MediaStreamTrack.getSources=function(e){setTimeout(function(){var t=[{kind:"audio",id:"default",label:"",facing:""},{kind:"video",id:"default",label:"",facing:""}];e(t)},0)},attachMediaStream=function(e,t){return e.srcObject=t,e},reattachMediaStream=function(e,t){return e.srcObject=t.srcObject,e},createIceServer=function(e,t,n){o.warn("createIceServer is deprecated. It should be replaced with an application level implementation.");var r=null,i=e.split(":");if(0===i[0].indexOf("stun"))r={urls:[e]};else if(0===i[0].indexOf("turn"))if(webrtcDetectedVersion<27){var a=e.split("?");1!==a.length&&0!==a[1].indexOf("transport=udp")||(r={urls:[a[0]],credential:n,username:t})}else r={urls:[e],credential:n,username:t};return r},createIceServers=function(e,t,n){o.warn("createIceServers is deprecated. It should be replaced with an application level implementation.");var r=[];for(i=0;i<e.length;i++){var a=createIceServer(e[i],t,n);null!==a&&r.push(a)}return r}):navigator.webkitGetUserMedia?(attachMediaStream=function(e,t){return webrtcDetectedVersion>=43?e.srcObject=t:"undefined"!=typeof e.src?e.src=URL.createObjectURL(t):o.error("Error attaching stream to element."),e},reattachMediaStream=function(e,t){return webrtcDetectedVersion>=43?e.srcObject=t.srcObject:e.src=t.src,e},createIceServer=function(e,t,n){o.warn("createIceServer is deprecated. It should be replaced with an application level implementation.");var r=null,i=e.split(":");return 0===i[0].indexOf("stun")?r={url:e}:0===i[0].indexOf("turn")&&(r={url:e,credential:n,username:t}),r},createIceServers=function(e,t,n){o.warn("createIceServers is deprecated. It should be replaced with an application level implementation.");var r=[];if(webrtcDetectedVersion>=34)r={urls:e,credential:n,username:t};else for(i=0;i<e.length;i++){var a=createIceServer(e[i],t,n);null!==a&&r.push(a)}return r}):navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)&&(attachMediaStream=function(e,t){return e.srcObject=t,e},reattachMediaStream=function(e,t){return e.srcObject=t.srcObject,e}),attachMediaStream_base=attachMediaStream,"opera"===webrtcDetectedBrowser&&(attachMediaStream_base=function(e,t){webrtcDetectedVersion>38?e.srcObject=t:"undefined"!=typeof e.src&&(e.src=URL.createObjectURL(t))}),attachMediaStream=function(e,t){return"chrome"!==webrtcDetectedBrowser&&"opera"!==webrtcDetectedBrowser||t?attachMediaStream_base(e,t):e.src="",e},reattachMediaStream_base=reattachMediaStream,reattachMediaStream=function(e,t){return reattachMediaStream_base(e,t),e},window.attachMediaStream=attachMediaStream,window.reattachMediaStream=reattachMediaStream,window.getUserMedia=function(e,t,n){navigator.getUserMedia(e,t,n)},a.attachMediaStream=attachMediaStream,a.reattachMediaStream=reattachMediaStream,a.getUserMedia=getUserMedia,"undefined"==typeof Promise&&(requestUserMedia=null),a.maybeThroughWebRTCReady()),function(){"use strict";var e=null;a.TEXT.EXTENSION={REQUIRE_INSTALLATION_FF:"To enable screensharing you need to install the Skylink WebRTC tools Firefox Add-on.",REQUIRE_INSTALLATION_CHROME:"To enable screensharing you need to install the Skylink WebRTC tools Chrome Extension.",REQUIRE_REFRESH:"Please refresh this page after the Skylink WebRTC tools extension has been installed.",BUTTON_FF:"Install Now",BUTTON_CHROME:"Go to Chrome Web Store"};var t=function(e){if(null===e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t};if(window.navigator.mozGetUserMedia?(e=window.navigator.getUserMedia,navigator.getUserMedia=function(n,r,i){if(n&&n.video&&n.video.mediaSource){if("screen"!==n.video.mediaSource&&"window"!==n.video.mediaSource)return void i(new Error('GetUserMedia: Only "screen" and "window" are supported as mediaSource constraints'));
var o=t(n);o.video.mozMediaSource=o.video.mediaSource;var s=setInterval(function(){"complete"===document.readyState&&(clearInterval(s),e(o,r,function(e){["PermissionDeniedError","SecurityError"].indexOf(e.name)>-1&&"https:"===window.parent.location.protocol?a.renderNotificationBar(a.TEXT.EXTENSION.REQUIRE_INSTALLATION_FF,a.TEXT.EXTENSION.BUTTON_FF,"https://addons.mozilla.org/en-US/firefox/addon/skylink-webrtc-tools/",!0,!0):i(e)}))},1)}else e(n,r,i)},a.getUserMedia=window.getUserMedia=navigator.getUserMedia):window.navigator.webkitGetUserMedia&&"safari"!==window.webrtcDetectedBrowser?(e=window.navigator.getUserMedia,navigator.getUserMedia=function(n,i,o){if(n&&n.video&&n.video.mediaSource){if("chrome"!==window.webrtcDetectedBrowser)return void o(new Error("Current browser does not support screensharing"));var s=t(n),c=function(t,n){t?o("permission-denied"===t?new Error("Permission denied for screen retrieval"):new Error("Failed retrieving selected screen")):(s.video.mandatory=s.video.mandatory||{},s.video.mandatory.chromeMediaSource="desktop",s.video.mandatory.maxWidth=window.screen.width>1920?window.screen.width:1920,s.video.mandatory.maxHeight=window.screen.height>1080?window.screen.height:1080,n&&(s.video.mandatory.chromeMediaSourceId=n),delete s.video.mediaSource,e(s,i,o))},u=function(e){e.data&&(e.data.chromeMediaSourceId&&("PermissionDeniedError"===e.data.chromeMediaSourceId?c("permission-denied"):c(null,e.data.chromeMediaSourceId)),e.data.chromeExtensionStatus&&("not-installed"===e.data.chromeExtensionStatus?a.renderNotificationBar(a.TEXT.EXTENSION.REQUIRE_INSTALLATION_CHROME,a.TEXT.EXTENSION.BUTTON_CHROME,e.data.data,!0,!0):c(e.data.chromeExtensionStatus,null)),window.removeEventListener("message",u))};window.addEventListener("message",u),r({captureSourceId:!0})}else e(n,i,o)},a.getUserMedia=window.getUserMedia=navigator.getUserMedia,navigator.mediaDevices.getUserMedia=function(e){return new Promise(function(t,n){window.getUserMedia(e,t,n)})}):navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?o.warn("Edge does not support screensharing feature in getUserMedia"):(e=window.navigator.getUserMedia,navigator.getUserMedia=function(n,r,i){if(n&&n.video&&n.video.mediaSource){var o=t(n);a.WebRTCPlugin.callWhenPluginReady(function(){return a.WebRTCPlugin.plugin.HasScreensharingFeature&&a.WebRTCPlugin.plugin.isScreensharingAvailable?(o.video.optional=o.video.optional||[],o.video.optional.push({sourceId:a.WebRTCPlugin.plugin.screensharingKey||"Screensharing"}),delete o.video.mediaSource,void e(o,r,i)):void i(new Error("Your version of the WebRTC plugin does not support screensharing"))})}else e(n,r,i)},a.getUserMedia=getUserMedia=window.getUserMedia=navigator.getUserMedia,navigator.mediaDevices&&"undefined"!=typeof Promise&&(navigator.mediaDevices.getUserMedia=requestUserMedia)),"chrome"===window.webrtcDetectedBrowser){var n=document.createElement("iframe");n.onload=function(){n.isLoaded=!0},n.src="https://cdn.temasys.com.sg/skylink/extensions/detectRTC.html",n.style.display="none",(document.body||document.documentElement).appendChild(n);var r=function(e){return e=e||{},n.isLoaded?void n.contentWindow.postMessage(e,"*"):void setTimeout(function(){n.contentWindow.postMessage(e,"*")},100)}}else"opera"===window.webrtcDetectedBrowser&&o.warn("Opera does not support screensharing feature in getUserMedia")}()}).call(t,"modules/RTC/adapter.screenshare.js")},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AUTHENTICATION_REQUIRED="conference.authenticationRequired",t.CHAT_ERROR="conference.chatError",t.CONFERENCE_DESTROYED="conference.destroyed",t.CONFERENCE_MAX_USERS="conference.max_users",t.CONNECTION_ERROR="conference.connectionError",t.NOT_ALLOWED_ERROR="conference.connectionError.notAllowed",t.FOCUS_DISCONNECTED="conference.focusDisconnected",t.FOCUS_LEFT="conference.focusLeft",t.GRACEFUL_SHUTDOWN="conference.gracefulShutdown",t.INCOMPATIBLE_SERVER_VERSIONS="conference.incompatible_server_versions",t.JINGLE_FATAL_ERROR="conference.jingleFatalError",t.PASSWORD_NOT_SUPPORTED="conference.passwordNotSupported",t.PASSWORD_REQUIRED="conference.passwordRequired",t.RESERVATION_ERROR="conference.reservationError",t.SETUP_FAILED="conference.setup_failed",t.VIDEOBRIDGE_NOT_AVAILABLE="conference.videobridgeNotAvailable"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CONNECTION_DISCONNECTED="connection.connectionDisconnected",t.CONNECTION_ESTABLISHED="connection.connectionEstablished",t.CONNECTION_FAILED="connection.connectionFailed",t.WRONG_STATE="connection.wrongState"},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ParticipantConnectionStatus=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),c=n(8),u=i(c),l=n(14),d=i(l),f=n(5),p=i(f),h=n(2),m=r(h),v=n(9),g=r(v),y=n(6),b=r(y),E=(0,s.getLogger)(e),S=2e3,T=5e3,C=t.ParticipantConnectionStatus={ACTIVE:"active",INACTIVE:"inactive",INTERRUPTED:"interrupted",RESTORING:"restoring"},w=function(){function e(t,n,r){o(this,e),this.rtc=t,this.conference=n,this.trackTimers={},this.connStatusFromJvb={},this.rtcMuteTimeout="number"==typeof r?r:S,this.rtcMutedTimestamp={},E.info("RtcMuteTimeout set to: "+this.rtcMuteTimeout),this.enteredLastNTimestamp=new Map,this.restoringTimers=new Map}return a(e,null,[{key:"_getNewStateForJvbMode",value:function(e,t,n,r,i){return e?r?C.ACTIVE:m.default.isVideoMuteOnConnInterruptedSupported()?i?t?n?C.INTERRUPTED:C.RESTORING:C.INACTIVE:C.ACTIVE:t?C.ACTIVE:C.INACTIVE:C.INTERRUPTED}},{key:"_getNewStateForP2PMode",value:function(e,t){return m.default.isVideoMuteOnConnInterruptedSupported()?e||!t?C.ACTIVE:C.INACTIVE:C.ACTIVE}}]),a(e,[{key:"init",value:function(){this._onEndpointConnStatusChanged=this.onEndpointConnStatusChanged.bind(this),this.rtc.addListener(g.default.ENDPOINT_CONN_STATUS_CHANGED,this._onEndpointConnStatusChanged),this._onP2PStatus=this.refreshConnectionStatusForAll.bind(this),this.conference.on(u.P2P_STATUS,this._onP2PStatus),m.default.isVideoMuteOnConnInterruptedSupported()&&(this._onTrackRtcMuted=this.onTrackRtcMuted.bind(this),this.rtc.addListener(g.default.REMOTE_TRACK_MUTE,this._onTrackRtcMuted),this._onTrackRtcUnmuted=this.onTrackRtcUnmuted.bind(this),this.rtc.addListener(g.default.REMOTE_TRACK_UNMUTE,this._onTrackRtcUnmuted),this._onRemoteTrackAdded=this.onRemoteTrackAdded.bind(this),this.conference.on(u.TRACK_ADDED,this._onRemoteTrackAdded),this._onRemoteTrackRemoved=this.onRemoteTrackRemoved.bind(this),this.conference.on(u.TRACK_REMOVED,this._onRemoteTrackRemoved),this._onSignallingMuteChanged=this.onSignallingMuteChanged.bind(this)),this._onLastNChanged=this._onLastNChanged.bind(this),this.conference.on(u.LAST_N_ENDPOINTS_CHANGED,this._onLastNChanged)}},{key:"dispose",value:function(){this.rtc.removeListener(g.default.ENDPOINT_CONN_STATUS_CHANGED,this._onEndpointConnStatusChanged),m.default.isVideoMuteOnConnInterruptedSupported()&&(this.rtc.removeListener(g.default.REMOTE_TRACK_MUTE,this._onTrackRtcMuted),this.rtc.removeListener(g.default.REMOTE_TRACK_UNMUTE,this._onTrackRtcUnmuted),this.conference.off(u.TRACK_ADDED,this._onRemoteTrackAdded),this.conference.off(u.TRACK_REMOVED,this._onRemoteTrackRemoved)),this.conference.off(u.LAST_N_ENDPOINTS_CHANGED,this._onLastNChanged),this.conference.off(u.P2P_STATUS,this._onP2PStatus);var e=Object.keys(this.trackTimers),t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this.clearTimeout(a),this.clearRtcMutedTimestamp(a)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.connStatusFromJvb={}}},{key:"onEndpointConnStatusChanged",value:function(e,t){E.debug("Detector RTCEvents.ENDPOINT_CONN_STATUS_CHANGED("+Date.now()+"): "+e+": "+t),e!==this.conference.myUserId()&&(this.connStatusFromJvb[e]=t,this.figureOutConnectionStatus(e))}},{key:"_changeConnectionStatus",value:function(e,t){if(e.getConnectionStatus()!==t){var n=e.getId();e._setConnectionStatus(t),E.debug("Emit endpoint conn status("+Date.now()+") "+n+": "+t),b.default.sendLog(JSON.stringify({id:"peer.conn.status",participant:n,status:t})),this.conference.eventEmitter.emit(u.PARTICIPANT_CONN_STATUS_CHANGED,n,t)}}},{key:"clearTimeout",value:function(e){this.trackTimers[e]&&(window.clearTimeout(this.trackTimers[e]),this.trackTimers[e]=null)}},{key:"clearRtcMutedTimestamp",value:function(e){this.rtcMutedTimestamp[e]=null}},{key:"onRemoteTrackAdded",value:function(e){e.isLocal()||e.getType()!==p.VIDEO||(E.debug("Detector on remote track added for: "+e.getParticipantId()),e.on(d.TRACK_MUTE_CHANGED,this._onSignallingMuteChanged))}},{key:"onRemoteTrackRemoved",value:function(e){if(!e.isLocal()&&e.getType()===p.VIDEO){var t=e.getParticipantId();E.debug("Detector on remote track removed: "+t),e.off(d.TRACK_MUTE_CHANGED,this._onSignallingMuteChanged),this.clearTimeout(t),this.clearRtcMutedTimestamp(t),this.figureOutConnectionStatus(t)}}},{key:"isVideoTrackFrozen",value:function(e){if(!m.default.isVideoMuteOnConnInterruptedSupported())return!1;var t=e.hasAnyVideoTrackWebRTCMuted(),n=this.rtcMutedTimestamp[e.getId()];return t&&"number"==typeof n&&Date.now()-n>=this.rtcMuteTimeout}},{key:"refreshConnectionStatusForAll",value:function(){var e=this.conference.getParticipants(),t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this.figureOutConnectionStatus(a.getId())}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"figureOutConnectionStatus",value:function(t){var n=this.conference.getParticipantById(t);if(!n)return void E.warn("figure out conn status - no participant for: "+t);var r=this.conference.isP2PActive(),i=this._isRestoringTimedout(t),o=n.isVideoMuted(),a=this.isVideoTrackFrozen(n),s=this.rtc.isInLastN(t),c=this.connStatusFromJvb[t];"boolean"!=typeof c&&(E.debug("Assuming connection active by JVB - no notification"),c=!0);var u=r?e._getNewStateForP2PMode(o,a):e._getNewStateForJvbMode(c,s,i,o,a);u!==C.RESTORING&&this._clearRestoringTimer(t),E.debug("Figure out conn status for "+t+", is video muted: "+o+" is active(jvb): "+c+" video track frozen: "+a+" p2p mode: "+r+" is in last N: "+s+" currentStatus => newStatus: \n                    "+n.getConnectionStatus()+" => "+u),this._changeConnectionStatus(n,u)}},{key:"_onLastNChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.enteredLastNTimestamp.delete(s),this._clearRestoringTimer(s),this.figureOutConnectionStatus(s)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}var c=!0,u=!1,l=void 0;try{for(var d,f=t[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var p=d.value;this.enteredLastNTimestamp.set(p,Date.now()),this.figureOutConnectionStatus(p)}}catch(e){u=!0,l=e}finally{try{!c&&f.return&&f.return()}finally{if(u)throw l}}}},{key:"_clearRestoringTimer",value:function(e){var t=this.restoringTimers.get(e);t&&(clearTimeout(t),this.restoringTimers.delete(e))}},{key:"_isRestoringTimedout",value:function(e){var t=this,n=this.enteredLastNTimestamp.get(e);if(n&&Date.now()-n>=T)return!0;var r=this.restoringTimers.get(e);return r||this.restoringTimers.set(e,setTimeout(function(){return t.figureOutConnectionStatus(e)},T)),!1}},{key:"onTrackRtcMuted",value:function(e){var t=this,n=e.getParticipantId(),r=this.conference.getParticipantById(n);return E.debug("Detector track RTC muted: "+n),r?(this.rtcMutedTimestamp[n]=Date.now(),void(r.isVideoMuted()||(this.clearTimeout(n),this.trackTimers[n]=window.setTimeout(function(){E.debug("RTC mute timeout for: "+n),t.clearTimeout(n),t.figureOutConnectionStatus(n)},this.rtcMuteTimeout)))):void E.error("No participant for id: "+n)}},{key:"onTrackRtcUnmuted",value:function(e){var t=e.getParticipantId();E.debug("Detector track RTC unmuted: "+t),this.clearTimeout(t),this.clearRtcMutedTimestamp(t),this.figureOutConnectionStatus(t)}},{key:"onSignallingMuteChanged",value:function(e){var t=e.getParticipantId();E.debug("Detector on track signalling mute changed: "+t,e.isMuted()),this.figureOutConnectionStatus(t)}}]),e}();t.default=w}).call(t,"modules/connectivity/ParticipantConnectionStatus.js")},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){var e="undefined"==typeof window?this:window;return e.localStorage}function a(){return(Math.random().toString(16)+"000000000").substr(2,8)}function s(){return a()+a()+a()+a()}function c(){var e=s();return h.log("generated id",e),e}function u(){var e=p.default.generateUsername();return h.log("generated callstats uid",e),e}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),f=n(103),p=r(f),h=(0,d.getLogger)(e),m=function(){function e(){i(this,e);var t=o();t?(this.userId=t.getItem("jitsiMeetId")||c(),this.callStatsUserName=t.getItem("callStatsUserName")||u(),this.save()):(h.log("localStorage is not supported"),this.userId=c(),this.callStatsUserName=u())}return l(e,[{key:"save",value:function(){var e=o();e&&(e.setItem("jitsiMeetId",this.userId),e.setItem("callStatsUserName",this.callStatsUserName))}},{key:"getMachineId",value:function(){return this.userId}},{key:"getCallStatsUserName",value:function(){return this.callStatsUserName}},{key:"setSessionId",value:function(e){var t=o();t&&(e?t.setItem("sessionId",e):t.removeItem("sessionId"))}},{key:"clearSessionId",value:function(){this.setSessionId(void 0)}},{key:"getSessionId",value:function(){var e=o();return e?e.getItem("sessionId"):void 0}}]),e}();t.default=new m}).call(t,"modules/settings/Settings.js")},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STATUS_AVAILABLE="available",t.STATUS_UNDEFINED="undefined",t.STATUS_BUSY="busy",t.STATE_ON="on",t.STATE_OFF="off",t.STATE_PENDING="pending",t.STATE_RETRYING="retrying",t.STATE_FAILED="failed"},function(e,t){"use strict";var n={1080:{width:1920,height:1080,order:7},fullhd:{width:1920,height:1080,order:7},720:{width:1280,height:720,order:6},hd:{width:1280,height:720,order:6},960:{width:960,height:720,order:5},360:{width:640,height:360,order:4},640:{width:640,height:480,order:3},vga:{width:640,height:480,order:3},180:{width:320,height:180,order:2},320:{width:320,height:240,order:1}};e.exports=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LOCAL_STATS_UPDATED="cq.local_stats_updated",t.REMOTE_STATS_UPDATED="cq.remote_stats_updated"},function(e,t,n){function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders}var i=n(16),o=n(37);e.exports=r,o(r.prototype),r.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},r.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){var r=n(140);e.exports=function(e){var t=e.xdomain,n=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(e){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}},function(e,t){function n(e){if(e)return r(e)}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){r.off(e,n),t.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},function(e,t,n){var r=n(158),i=n(159);t.write=i,t.parse=r.parse,t.parseFmtpConfig=r.parseFmtpConfig,t.parseParams=r.parseParams,t.parsePayloads=r.parsePayloads,t.parseRemoteCandidates=r.parseRemoteCandidates,t.parseImageAttributes=r.parseImageAttributes,t.parseSimulcastStreamList=r.parseSimulcastStreamList},function(e,t,n){function r(){}function i(e){var n="",r=!1;return n+=e.type,t.BINARY_EVENT!=e.type&&t.BINARY_ACK!=e.type||(n+=e.attachments,n+="-"),e.nsp&&"/"!=e.nsp&&(r=!0,n+=e.nsp),null!=e.id&&(r&&(n+=",",r=!1),n+=e.id),null!=e.data&&(r&&(n+=","),n+=d.stringify(e.data)),l("encoded %j as %s",e,n),n}function o(e,t){function n(e){var n=p.deconstructPacket(e),r=i(n.packet),o=n.buffers;o.unshift(r),t(o)}p.removeBlobs(e,n)}function a(){this.reconstructor=null}function s(e){var n={},r=0;if(n.type=Number(e.charAt(0)),null==t.types[n.type])return u();if(t.BINARY_EVENT==n.type||t.BINARY_ACK==n.type){for(var i="";"-"!=e.charAt(++r)&&(i+=e.charAt(r),r!=e.length););if(i!=Number(i)||"-"!=e.charAt(r))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"==e.charAt(r+1))for(n.nsp="";++r;){var o=e.charAt(r);if(","==o)break;if(n.nsp+=o,r==e.length)break}else n.nsp="/";var a=e.charAt(r+1);if(""!==a&&Number(a)==a){for(n.id="";++r;){var o=e.charAt(r);if(null==o||Number(o)!=o){--r;break}if(n.id+=e.charAt(r),r==e.length)break}n.id=Number(n.id)}if(e.charAt(++r))try{n.data=d.parse(e.substr(r))}catch(e){return u()}return l("decoded %s as %j",e,n),n}function c(e){this.reconPack=e,this.buffers=[]}function u(e){return{type:t.ERROR,data:"parser error"}}var l=n(10)("socket.io-parser"),d=n(142),f=(n(26),n(164)),p=n(163),h=n(67);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=a,r.prototype.encode=function(e,n){if(l("encoding packet %j",e),t.BINARY_EVENT==e.type||t.BINARY_ACK==e.type)o(e,n);else{var r=i(e);n([r])}},f(a.prototype),a.prototype.add=function(e){var n;if("string"==typeof e)n=s(e),t.BINARY_EVENT==n.type||t.BINARY_ACK==n.type?(this.reconstructor=new c(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!h(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,this.emit("decoded",n))}},a.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},c.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=p.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},c.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CONNECTION_DROPPED_ERROR="connection.droppedError",t.CONNECTION_ERROR="connection.connectionError",t.OTHER_ERROR="connection.otherError",t.PASSWORD_REQUIRED="connection.passwordRequired",t.SERVER_ERROR="connection.serverError"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEVICE_LIST_CHANGED="mediaDevices.devicechange",t.PERMISSION_PROMPT_IS_SHOWN="mediaDevices.permissionPromptIsShown"},function(e,t){"use strict";var n={RECORDER_UNAVAILABLE:"recorder.unavailable",RECORDER_BUSY:"recorder.busy",NO_TOKEN:"recorder.noToken",STATE_CHANGE_FAILED:"recorder.stateChangeFailed",INVALID_STATE:"recorder.invalidState"};e.exports=n},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.getOriginalStream();if(t){var n=t.stop;t.stop=function(){n.apply(t),e.isActive()&&t.onended()}}}function a(e,t){"undefined"==typeof e.active?e.onended=t:e.oninactive=t}function s(e,t,n,r,i,o){this.containers=[],this.conference=e,this.stream=t,this.eventEmitter=new u.default,this.audioLevel=-1,this.type=i,this.track=n,this.videoType=o,this.handlers={},this.disposed=!1,this._setHandler("inactive",r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var c=n(17),u=i(c),l=n(1),d=n(14),f=r(d),p=n(5),h=r(p),m=n(2),v=i(m),g=n(21),y=i(g),b=(0,l.getLogger)(e),E={track_mute:"onmute",track_unmute:"onunmute",track_ended:"onended"};s.prototype._setHandler=function(e,t){this.handlers[e]=t,this.stream&&("inactive"===e?(v.default.isFirefox()&&o(this),a(this.stream,t)):E.hasOwnProperty(e)&&this.stream.getVideoTracks().forEach(function(n){n[E[e]]=t},this))},s.prototype._setStream=function(e){this.stream=e,Object.keys(this.handlers).forEach(function(e){"function"==typeof this.handlers[e]&&this._setHandler(e,this.handlers[e])},this)},s.prototype.getType=function(){return this.type},s.prototype.isAudioTrack=function(){return this.getType()===h.AUDIO},s.prototype.isWebRTCTrackMuted=function(){return this.track&&this.track.muted},s.prototype.isVideoTrack=function(){return this.getType()===h.VIDEO},s.prototype.isLocal=function(){throw new Error("Not implemented by subclass")},s.prototype.getOriginalStream=function(){return this.stream},s.prototype.getStreamId=function(){return this.stream?this.stream.id:null},s.prototype.getTrack=function(){return this.track},s.prototype.getTrackId=function(){return this.track?this.track.id:null},s.prototype.getUsageLabel=function(){return this.isAudioTrack()?"mic":this.videoType?this.videoType:"default"},s.prototype._maybeFireTrackAttached=function(e){this.conference&&e&&this.conference._onTrackAttach(this,e)},s.prototype.attach=function(e){var t=e;return this.stream&&(t=y.default.attachMediaStream(e,this.stream)),this.containers.push(t),this._maybeFireTrackAttached(t),this._attachTTFMTracker(t),t},s.prototype.detach=function(e){for(var t=this.containers,n=t.length-1;n>=0;--n){var r=t[n];e||y.default.attachMediaStream(r,null),e&&r!==e||t.splice(n,1)}e&&y.default.attachMediaStream(e,null)},s.prototype._attachTTFMTracker=function(e){},s.prototype.dispose=function(){return this.eventEmitter.removeAllListeners(),this.disposed=!0,Promise.resolve()},s.prototype.isScreenSharing=function(){},s.prototype.getId=function(){return this.stream?y.default.getStreamID(this.stream):null},s.prototype.isActive=function(){return"undefined"==typeof this.stream.active||this.stream.active},s.prototype.on=function(e,t){this.eventEmitter&&this.eventEmitter.on(e,t)},s.prototype.off=function(e,t){this.eventEmitter&&this.eventEmitter.removeListener(e,t)},s.prototype.addEventListener=s.prototype.on,s.prototype.removeEventListener=s.prototype.off,s.prototype.setAudioLevel=function(e){this.audioLevel!==e&&(this.eventEmitter.emit(f.TRACK_AUDIO_LEVEL_CHANGED,e),this.audioLevel=e)},s.prototype.getMSID=function(){var e=this.getStreamId(),t=this.getTrackId();return e&&t?e+" "+t:null},s.prototype.setAudioOutput=function(e){var t=this;return y.default.isDeviceChangeAvailable("output")?this.isVideoTrack()?Promise.resolve():Promise.all(this.containers.map(function(t){return t.setSinkId(e).catch(function(e){throw b.warn("Failed to change audio output device on element. Default or previously set audio output device will be used.",t,e),e})})).then(function(){t.eventEmitter.emit(f.TRACK_AUDIO_OUTPUT_CHANGED,e)}):Promise.reject(new Error("Audio output device change is not supported"))}}).call(t,"modules/RTC/JitsiTrack.js")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){for(var t=0,n=e.length,r=0;r<n;r++)t<e[r]&&(t=e[r]);return parseFloat(((t-127)/128).toFixed(3))}function o(e,t){var n=0,r=t-e;return n=r>.2?t-.2:r<-.4?t+.4:e,parseFloat(n.toFixed(3))}function a(e,t,n){this.stream=e,this.intervalId=null,this.intervalMilis=t,this.audioLevel=0,this.callback=n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var s=n(2),c=r(s),u=2048,l=.8;window.AudioContext=window.AudioContext||window.webkitAudioContext;var d=null;window.AudioContext&&(d=new AudioContext,d.suspend&&d.suspend()),a.prototype.start=function(){if(a.isLocalStatsSupported()){d.resume();var e=d.createAnalyser();e.smoothingTimeConstant=l,e.fftSize=u;var t=d.createMediaStreamSource(this.stream);t.connect(e);var n=this;this.intervalId=setInterval(function(){var t=new Uint8Array(e.frequencyBinCount);e.getByteTimeDomainData(t);var r=i(t);r!==n.audioLevel&&(n.audioLevel=o(r,n.audioLevel),n.callback(n.audioLevel))},this.intervalMilis)}},a.prototype.stop=function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)},a.isLocalStatsSupported=function(){return Boolean(d&&!c.default.isTemasysPluginUsed())}},function(e,t,n){"use strict";function r(e){if(void 0===e.recorder)throw new Error("Passed an object to startRecorder which is not a TrackRecorder object");e.recorder.start(),e.startTime=new Date}function i(e){if(void 0===e.recorder)throw new Error("Passed an object to stopRecorder which is not a TrackRecorder object");e.recorder.stop()}function o(){if(MediaRecorder.isTypeSupported(u))return u;if(MediaRecorder.isTypeSupported(l))return l;throw new Error("unable to create a MediaRecorder with the right mimetype!")}function a(e){this.recorders=[],this.fileType=o(),this.isRecording=!1,this.jitsiConference=e}function s(){if("undefined"!=typeof MediaStream)return new MediaStream;if("undefined"!=typeof webkitMediaStream)return new webkitMediaStream;throw new Error("cannot create a clean mediaStream")}var c=n(96),u="audio/webm",l="audio/ogg",d=function(e){this.track=e,this.recorder=null,this.data=null,this.name=null,this.startTime=null};a.determineCorrectFileType=o,a.prototype.addTrack=function(e){if(e.isAudioTrack()){var t=this.instantiateTrackRecorder(e);this.recorders.push(t),this.updateNames(),this.isRecording&&r(t)}},a.prototype.instantiateTrackRecorder=function(e){var t=new d(e),n=t.track.getOriginalStream(),r=s();return n.getAudioTracks().forEach(function(e){return r.addTrack(e)}),t.recorder=new MediaRecorder(r,{mimeType:this.fileType}),t.data=[],t.recorder.ondataavailable=function(e){e.data.size>0&&t.data.push(e.data)},t},a.prototype.removeTrack=function(e){if(!e.isVideoTrack()){var t=this.recorders,n=void 0;for(n=0;n<t.length;n++)if(t[n].track.getParticipantId()===e.getParticipantId()){var r=t[n];this.isRecording?i(r):t.splice(n,1)}this.updateNames()}},a.prototype.updateNames=function(){var e=this.jitsiConference;this.recorders.forEach(function(t){if(t.track.isLocal())t.name="the transcriber";else{var n=t.track.getParticipantId(),r=e.getParticipantById(n),i=r.getDisplayName();"undefined"!==i&&(t.name=i)}})},a.prototype.start=function(){if(this.isRecording)throw new Error("audiorecorder is already recording");this.isRecording=!0,this.recorders.forEach(function(e){return r(e)}),console.log("Started the recording of the audio. There are currently "+this.recorders.length+" recorders active.")},a.prototype.stop=function(){this.isRecording=!1,this.recorders.forEach(function(e){return i(e)}),console.log("stopped recording")},a.prototype.download=function(){var e=this;this.recorders.forEach(function(t){var n=new Blob(t.data,{type:e.fileType}),r=URL.createObjectURL(n),i=document.createElement("a");document.body.appendChild(i),i.style="display: none",i.href=r,i.download="test."+e.fileType.split("/")[1],i.click(),window.URL.revokeObjectURL(r)})},a.prototype.getRecordingResults=function(){var e=this;if(this.isRecording)throw new Error("cannot get blobs because the AudioRecorder is still recording!");this.updateNames();var t=[];return this.recorders.forEach(function(n){return t.push(new c(new Blob(n.data,{type:e.fileType}),n.name,n.startTime))}),t},a.prototype.getFileType=function(){return this.fileType},e.exports=a},function(e,t,n){"use strict";var r=n(129),i={loadScript:function(e,t,n,i,o,a){var s=document,c="script",u=s.createElement(c),l=s.getElementsByTagName(c)[0];if(u.async=t,i){var d=r();if(d){var f=d.src,p=f.substring(0,f.lastIndexOf("/")+1);f&&p&&(e=p+e)}}o&&(u.onload=o),a&&(u.onerror=a),u.src=e,n?l.parentNode.insertBefore(u,l):l.parentNode.appendChild(u)}};e.exports=i},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){for(var t=e.split("\r\nm="),n=1,r=t.length;n<r;n++){var i="m="+t[n];n!==r-1&&(i+="\r\n"),t[n]=i}var o=t.shift()+"\r\n";this.media=t,this.raw=o+t.join(""),this.session=o}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var o=n(15),a=r(o);i.prototype.failICE=!1,i.prototype.removeTcpCandidates=!1,i.prototype.removeUdpCandidates=!1,i.prototype.getMediaSsrcMap=function(){for(var e=this,t={},n=void 0,r=function(r){n=a.default.findLines(e.media[r],"a=ssrc:");var i=a.default.parseMID(a.default.findLine(e.media[r],"a=mid:")),o={mediaindex:r,mid:i,ssrcs:{},ssrcGroups:[]};t[r]=o,n.forEach(function(e){var t=e.substring(7).split(" ")[0];o.ssrcs[t]||(o.ssrcs[t]={ssrc:t,lines:[]}),o.ssrcs[t].lines.push(e)}),n=a.default.findLines(e.media[r],"a=ssrc-group:"),n.forEach(function(e){var t=e.indexOf(" "),n=e.substr(0,t).substr(13),r=e.substr(14+n.length).split(" ");r.length&&o.ssrcGroups.push({semantics:n,ssrcs:r})})},i=0;i<e.media.length;i++)r(i);return t},i.prototype.containsSSRC=function(e){
var t=this.getMediaSsrcMap(),n=!1;return Object.keys(t).forEach(function(r){n||t[r].ssrcs[e]&&(n=!0)}),n},i.prototype.mangle=function(){var e=void 0,t=void 0,n=void 0,r=void 0,i=void 0,o=void 0;for(e=0;e<this.media.length;e++)if(n=this.media[e].split("\r\n"),n.pop(),r=a.default.parseMLine(n.shift()),"audio"===r.media){for(i="",r.fmt.length=0,t=0;t<n.length;t++){if("a=rtpmap:"===n[t].substr(0,9)){if(o=a.default.parseRTPMap(n[t]),"CN"===o.name||"ISAC"===o.name)continue;r.fmt.push(o.id)}i+=n[t]+"\r\n"}this.media[e]=a.default.buildMLine(r)+"\r\n"+i}this.raw=this.session+this.media.join("")},i.prototype.removeSessionLines=function(e){var t=this,n=a.default.findLines(this.session,e);return n.forEach(function(e){t.session=t.session.replace(e+"\r\n","")}),this.raw=this.session+this.media.join(""),n},i.prototype.removeMediaLines=function(e,t){var n=this,r=a.default.findLines(this.media[e],t);return r.forEach(function(t){n.media[e]=n.media[e].replace(t+"\r\n","")}),this.raw=this.session+this.media.join(""),r},i.prototype.toJingle=function(e,t){var n=void 0,r=void 0,i=void 0,o=void 0,s=void 0,c=void 0,u=void 0,l=void 0;if(o=a.default.findLines(this.session,"a=group:"),o.length)for(n=0;n<o.length;n++){l=o[n].split(" ");var d=l.shift().substr(8);for(e.c("group",{xmlns:"urn:xmpp:jingle:apps:grouping:0",semantics:d}),r=0;r<l.length;r++)e.c("content",{name:l[r]}).up();e.up()}for(n=0;n<this.media.length;n++)if(s=a.default.parseMLine(this.media[n].split("\r\n")[0]),"audio"===s.media||"video"===s.media||"application"===s.media){var f=a.default.findLine(this.media[n],"a=ssrc:");u=!!f&&f.substring(7).split(" ")[0],e.c("content",{creator:t,name:s.media});var p=a.default.findLine(this.media[n],"a=mid:");if(p){var h=a.default.parseMID(p);e.attrs({name:h})}if(a.default.findLine(this.media[n],"a=rtpmap:").length){for(e.c("description",{xmlns:"urn:xmpp:jingle:apps:rtp:1",media:s.media}),u&&e.attrs({ssrc:u}),r=0;r<s.fmt.length;r++){c=a.default.findLine(this.media[n],"a=rtpmap:"+s.fmt[r]),e.c("payload-type",a.default.parseRTPMap(c));var m=a.default.findLine(this.media[n],"a=fmtp:"+s.fmt[r]);if(m)for(l=a.default.parseFmtp(m),i=0;i<l.length;i++)e.c("parameter",l[i]).up();this.rtcpFbToJingle(n,e,s.fmt[r]),e.up()}var v=a.default.findLines(this.media[n],"a=crypto:",this.session);if(v.length&&(e.c("encryption",{required:1}),v.forEach(function(t){return e.c("crypto",a.default.parseCrypto(t)).up()}),e.up()),u){e.c("source",{ssrc:u,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"});var g=a.default.findLines(this.media[n],"a=ssrc:");if(g.length>0)g.forEach(function(t){var n=t.indexOf(" "),r=t.substr(0,n).substr(7);r!==u&&(e.up(),u=r,e.c("source",{ssrc:u,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}));var i=t.substr(n+1);if(e.c("parameter"),i.indexOf(":")===-1)e.attrs({name:i});else{var o=i.split(":",2)[0];e.attrs({name:o});var s=i.split(":",2)[1];s=a.default.filterSpecialChars(s),e.attrs({value:s})}e.up()});else{e.up(),e.c("source",{ssrc:u,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),e.c("parameter"),e.attrs({name:"cname",value:Math.random().toString(36).substring(7)}),e.up();var y=null,b=APP.RTC.getLocalTracks(s.media);b&&(y=b.getTrackId()),null!==y&&(y=a.default.filterSpecialChars(y),e.c("parameter"),e.attrs({name:"msid",value:y}),e.up(),e.c("parameter"),e.attrs({name:"mslabel",value:y}),e.up(),e.c("parameter"),e.attrs({name:"label",value:y}),e.up())}e.up();var E=a.default.findLines(this.media[n],"a=ssrc-group:");E.forEach(function(t){var n=t.indexOf(" "),r=t.substr(0,n).substr(13),i=t.substr(14+r.length).split(" ");i.length&&(e.c("ssrc-group",{semantics:r,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),i.forEach(function(t){return e.c("source",{ssrc:t}).up()}),e.up())})}if(a.default.findLine(this.media[n],"a=rtcp-mux")&&e.c("rtcp-mux").up(),this.rtcpFbToJingle(n,e,"*"),o=a.default.findLines(this.media[n],"a=extmap:"),o.length)for(r=0;r<o.length;r++){if(l=a.default.parseExtmap(o[r]),e.c("rtp-hdrext",{xmlns:"urn:xmpp:jingle:apps:rtp:rtp-hdrext:0",uri:l.uri,id:l.value}),l.hasOwnProperty("direction"))switch(l.direction){case"sendonly":e.attrs({senders:"responder"});break;case"recvonly":e.attrs({senders:"initiator"});break;case"sendrecv":e.attrs({senders:"both"});break;case"inactive":e.attrs({senders:"none"})}e.up()}e.up()}this.transportToJingle(n,e);var S=this.media[n];a.default.findLine(S,"a=sendrecv",this.session)?e.attrs({senders:"both"}):a.default.findLine(S,"a=sendonly",this.session)?e.attrs({senders:"initiator"}):a.default.findLine(S,"a=recvonly",this.session)?e.attrs({senders:"responder"}):a.default.findLine(S,"a=inactive",this.session)&&e.attrs({senders:"none"}),"0"===s.port&&e.attrs({senders:"rejected"}),e.up()}return e.up(),e},i.prototype.transportToJingle=function(e,t){var n=void 0,r=this;t.c("transport");var i=a.default.findLine(this.media[e],"a=sctpmap:",r.session);if(i){var o=a.default.parseSCTPMap(i);t.c("sctpmap",{xmlns:"urn:xmpp:jingle:transports:dtls-sctp:1",number:o[0],protocol:o[1]}),o.length>2&&t.attrs({streams:o[2]}),t.up()}var s=a.default.findLines(this.media[e],"a=fingerprint:",this.session);if(s.forEach(function(i){n=a.default.parseFingerprint(i),n.xmlns="urn:xmpp:jingle:apps:dtls:0",t.c("fingerprint").t(n.fingerprint),delete n.fingerprint,i=a.default.findLine(r.media[e],"a=setup:",r.session),i&&(n.setup=i.substr(8)),t.attrs(n),t.up()}),n=a.default.iceparams(this.media[e],this.session)){n.xmlns="urn:xmpp:jingle:transports:ice-udp:1",t.attrs(n);var c=a.default.findLines(this.media[e],"a=candidate:",this.session);c.length&&c.forEach(function(e){var n=a.default.candidateToJingle(e);r.failICE&&(n.ip="1.1.1.1");var i=n&&"string"==typeof n.protocol?n.protocol.toLowerCase():"";r.removeTcpCandidates&&("tcp"===i||"ssltcp"===i)||r.removeUdpCandidates&&"udp"===i||t.c("candidate",n).up()})}t.up()},i.prototype.rtcpFbToJingle=function(e,t,n){var r=a.default.findLines(this.media[e],"a=rtcp-fb:"+n);r.forEach(function(e){var n=a.default.parseRTCPFB(e);"trr-int"===n.type?(t.c("rtcp-fb-trr-int",{xmlns:"urn:xmpp:jingle:apps:rtp:rtcp-fb:0",value:n.params[0]}),t.up()):(t.c("rtcp-fb",{xmlns:"urn:xmpp:jingle:apps:rtp:rtcp-fb:0",type:n.type}),n.params.length>0&&t.attrs({subtype:n.params[0]}),t.up())})},i.prototype.rtcpFbFromJingle=function(t,n){var r="",i=t.find('>rtcp-fb-trr-int[xmlns="urn:xmpp:jingle:apps:rtp:rtcp-fb:0"]');return i.length&&(r+="a=rtcp-fb:* trr-int ",r+=i.attr("value")?i.attr("value"):"0",r+="\r\n"),i=t.find('>rtcp-fb[xmlns="urn:xmpp:jingle:apps:rtp:rtcp-fb:0"]'),i.each(function(){r+="a=rtcp-fb:"+n+" "+e(this).attr("type"),e(this).attr("subtype")&&(r+=" "+e(this).attr("subtype")),r+="\r\n"}),r},i.prototype.fromJingle=function(t){var n=this;this.raw="v=0\r\no=- 1923518516 2 IN IP4 0.0.0.0\r\ns=-\r\nt=0 0\r\n";var r=e(t).find('>group[xmlns="urn:xmpp:jingle:apps:grouping:0"]');r.length&&r.each(function(t,r){var i=e(r).find(">content").map(function(e,t){return t.getAttribute("name")}).get();i.length>0&&(n.raw+="a=group:"+(r.getAttribute("semantics")||r.getAttribute("type"))+" "+i.join(" ")+"\r\n")}),this.session=this.raw,t.find(">content").each(function(){var t=n.jingle2media(e(this));n.media.push(t)}),this.raw=this.session+this.media.join("")},i.prototype.jingle2media=function(t){var n=t.find("description"),r="",i=this,o=t.find('>transport>sctpmap[xmlns="urn:xmpp:jingle:transports:dtls-sctp:1"]'),s={media:n.attr("media")};if(s.port="1","rejected"===t.attr("senders")&&(s.port="0"),t.find(">transport>fingerprint").length||n.find("encryption").length?s.proto=o.length?"DTLS/SCTP":"RTP/SAVPF":s.proto="RTP/AVPF",o.length){r+="m=application 1 DTLS/SCTP "+o.attr("number")+"\r\n",r+="a=sctpmap:"+o.attr("number")+" "+o.attr("protocol");var c=o.attr("streams");r+=c?" "+c+"\r\n":"\r\n"}else s.fmt=n.find("payload-type").map(function(){return this.getAttribute("id")}).get(),r+=a.default.buildMLine(s)+"\r\n";switch(r+="c=IN IP4 0.0.0.0\r\n",o.length||(r+="a=rtcp:1 IN IP4 0.0.0.0\r\n"),s=t.find('>transport[xmlns="urn:xmpp:jingle:transports:ice-udp:1"]'),s.length&&(s.attr("ufrag")&&(r+=a.default.buildICEUfrag(s.attr("ufrag"))+"\r\n"),s.attr("pwd")&&(r+=a.default.buildICEPwd(s.attr("pwd"))+"\r\n"),s.find(">fingerprint").each(function(){r+="a=fingerprint:"+this.getAttribute("hash"),r+=" "+e(this).text(),r+="\r\n",this.getAttribute("setup")&&(r+="a=setup:"+this.getAttribute("setup")+"\r\n")})),t.attr("senders")){case"initiator":r+="a=sendonly\r\n";break;case"responder":r+="a=recvonly\r\n";break;case"none":r+="a=inactive\r\n";break;case"both":r+="a=sendrecv\r\n"}return r+="a=mid:"+t.attr("name")+"\r\n",n.find("rtcp-mux").length&&(r+="a=rtcp-mux\r\n"),n.find("encryption").length&&n.find("encryption>crypto").each(function(){r+="a=crypto:"+this.getAttribute("tag"),r+=" "+this.getAttribute("crypto-suite"),r+=" "+this.getAttribute("key-params"),this.getAttribute("session-params")&&(r+=" "+this.getAttribute("session-params")),r+="\r\n"}),n.find("payload-type").each(function(){r+=a.default.buildRTPMap(this)+"\r\n",e(this).find(">parameter").length&&(r+="a=fmtp:"+this.getAttribute("id")+" ",r+=e(this).find("parameter").map(function(){return(this.getAttribute("name")?this.getAttribute("name")+"=":"")+this.getAttribute("value")}).get().join("; "),r+="\r\n"),r+=i.rtcpFbFromJingle(e(this),this.getAttribute("id"))}),r+=i.rtcpFbFromJingle(n,"*"),s=n.find('>rtp-hdrext[xmlns="urn:xmpp:jingle:apps:rtp:rtp-hdrext:0"]'),s.each(function(){r+="a=extmap:"+this.getAttribute("id")+" "+this.getAttribute("uri")+"\r\n"}),t.find('>transport[xmlns="urn:xmpp:jingle:transports:ice-udp:1"]>candidate').each(function(){var e=this.getAttribute("protocol");e="string"==typeof e?e.toLowerCase():"",i.removeTcpCandidates&&("tcp"===e||"ssltcp"===e)||i.removeUdpCandidates&&"udp"===e||(i.failICE&&this.setAttribute("ip","1.1.1.1"),r+=a.default.candidateFromJingle(this))}),t.find('description>ssrc-group[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each(function(){var t=this.getAttribute("semantics"),n=e(this).find(">source").map(function(){return this.getAttribute("ssrc")}).get();n.length&&(r+="a=ssrc-group:"+t+" "+n.join(" ")+"\r\n")}),s=t.find('description>source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]'),s.each(function(){var t=this.getAttribute("ssrc");e(this).find(">parameter").each(function(){var e=this.getAttribute("name"),n=this.getAttribute("value");n=a.default.filterSpecialChars(n),r+="a=ssrc:"+t+" "+e,n&&n.length&&(r+=":"+n),r+="\r\n"})}),r}}).call(t,n(4))},function(e,t){"use strict";var n={ENVIRONMENT:"environment",USER:"user"};e.exports=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PEER_MUTED_CHANGED="signaling.peerMuted",t.PEER_VIDEO_TYPE_CHANGED="signaling.peerVideoType"},function(e,t){"use strict";var n={IDENTITY_UPDATED:"authentication.identity_updated"};e.exports=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AUDIO_LEVEL="statistics.audioLevel",t.BEFORE_DISPOSED="statistics.before_disposed",t.BYTE_SENT_STATS="statistics.byte_sent_stats",t.CONNECTION_STATS="statistics.connectionstats"},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t){function n(e){if(e)return r(e)}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){(function(e){function r(t){var n,r=!1,s=!1,c=!1!==t.jsonp;if(e.location){var u="https:"==location.protocol,l=location.port;l||(l=u?443:80),r=t.hostname!=location.hostname||l!=t.port,s=t.secure!=u}if(t.xdomain=r,t.xscheme=s,n=new i(t),"open"in n&&!t.forceJSONP)return new o(t);if(!c)throw new Error("JSONP disabled");return new a(t)}var i=n(36),o=n(135),a=n(134),s=n(136);t.polling=r,t.websocket=s}).call(t,function(){return this}())},function(e,t,n){function r(e){var t=e&&e.forceBase64;l&&!t||(this.supportsBinary=!1),i.call(this,e)}var i=n(35),o=n(38),a=n(16),s=n(25),c=n(69),u=n(10)("engine.io-client:polling");e.exports=r;var l=function(){var e=n(36),t=new e({xdomain:!1});return null!=t.responseType}();s(r,i),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(e){function t(){u("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){u("pre-pause polling complete"),--r||t()})),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",function(){u("pre-pause writing complete"),--r||t()}))}else t()},r.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(e){var t=this;u("polling got data %s",e);var n=function(e,n,r){return"opening"==t.readyState&&t.onOpen(),"close"==e.type?(t.onClose(),!1):void t.onPacket(e)};a.decodePayload(e,this.socket.binaryType,n),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function e(){u("writing close packet"),t.write([{type:"close"}])}var t=this;"open"==this.readyState?(u("transport open - closing"),e()):(u("transport not open - deferring close"),this.once("open",e))},r.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")},t=this;a.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";!1!==this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"==t&&443!=this.port||"http"==t&&80!=this.port)&&(n=":"+this.port),e.length&&(e="?"+e);var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t){function n(){var e={methodName:"",fileLocation:"",line:null,column:null},t=new Error,n=t.stack?t.stack.split("\n"):[];if(!n||n.length<1)return e;var r=null;return n[3]&&(r=n[3].match(/\s*at\s*(.+?)\s*\((\S*)\s*:(\d*)\s*:(\d*)\)/)),!r||r.length<=4?(0===n[2].indexOf("log@")?e.methodName=n[3].substr(0,n[3].indexOf("@")):e.methodName=n[2].substr(0,n[2].indexOf("@")),e):(e.methodName=r[1],e.fileLocation=r[2],e.line=r[3],e.column=r[4],e)}function r(){var e=arguments[0],t=arguments[1],r=Array.prototype.slice.call(arguments,2);if(!(o[t]<e.level))for(var i=n(),s=a.concat(e.transports),c=0;c<s.length;c++){var u=s[c],l=u[t];l&&"function"==typeof l&&l.bind(u,e.id?"["+e.id+"]":"","<"+i.methodName+">: ").apply(u,r)}}function i(e,t,n,i){this.id=t,this.format=i,this.transports=n,this.transports||(this.transports=[]),this.level=o[e];for(var a=Object.keys(o),s=0;s<a.length;s++)this[a[s]]=r.bind(null,this,a[s])}var o={trace:0,debug:1,info:2,log:3,warn:4,error:5};i.consoleTransport=console;var a=[i.consoleTransport];i.addGlobalTransport=function(e){a.indexOf(e)===-1&&a.push(e)},i.removeGlobalTransport=function(e){var t=a.indexOf(e);t!==-1&&a.splice(t,1)},i.prototype.setLevel=function(e){this.level=o[e]},e.exports=i,i.levels={TRACE:"trace",DEBUG:"debug",INFO:"info",LOG:"log",WARN:"warn",ERROR:"error"}},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");i!=-1&&o!=-1&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var a=n.exec(e||""),s={},c=14;c--;)s[r[c]]=a[c]||"";return i!=-1&&o!=-1&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(e){if(d===clearTimeout)return clearTimeout(e);if((d===r||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function a(){m&&p&&(m=!1,p.length?h=p.concat(h):v=-1,h.length&&s())}function s(){if(!m){var e=i(a);m=!0;for(var t=h.length;t;){for(p=h,h=[];++v<t;)p&&p[v].run();v=-1,t=h.length}p=null,m=!1,o(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var l,d,f=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{d="function"==typeof clearTimeout?clearTimeout:r}catch(e){d=r}}();var p,h=[],m=!1,v=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new c(e,t)),1!==h.length||m||i(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.prependListener=u,f.prependOnceListener=u,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t){var n=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(e){return null!=e.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{push:"ssrcGroups",reg:/^ssrc-group:(\w*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{push:"invalid",names:["value"]}]};Object.keys(n).forEach(function(e){var t=n[e];t.forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},function(e,t){var n=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(e){return null!=e.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{push:"ssrcGroups",reg:/^ssrc-group:(\w*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{push:"invalid",names:["value"]}]};Object.keys(n).forEach(function(e){var t=n[e];t.forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},function(e,t){var n=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+" %s"+(e.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{push:"invalid",names:["value"]}]};Object.keys(n).forEach(function(e){var t=n[e];t.forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},function(e,t,n){function r(e,t){return this instanceof r?(e&&"object"==typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],
this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new s.Encoder,this.decoder=new s.Decoder,this.autoConnect=t.autoConnect!==!1,void(this.autoConnect&&this.open())):new r(e,t)}var i=n(131),o=n(66),a=n(54),s=n(40),c=n(65),u=n(53),l=n(10)("socket.io-client:manager"),d=n(57),f=n(126),p=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},r.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.engine.id)},a(r.prototype),r.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},r.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},r.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(e){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=i(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var r=c(t,"open",function(){n.onopen(),e&&e()}),o=c(t,"error",function(t){if(l("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var r=new Error("Connection error");r.data=t,e(r)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;l("connect attempt will timeout after %d",a);var s=setTimeout(function(){l("connect attempt timed out after %d",a),r.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(s)}})}return this.subs.push(r),this.subs.push(o),this},r.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(c(e,"data",u(this,"ondata"))),this.subs.push(c(e,"ping",u(this,"onping"))),this.subs.push(c(e,"pong",u(this,"onpong"))),this.subs.push(c(e,"error",u(this,"onerror"))),this.subs.push(c(e,"close",u(this,"onclose"))),this.subs.push(c(this.decoder,"decoded",u(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(e){this.decoder.add(e)},r.prototype.ondecoded=function(e){this.emit("packet",e)},r.prototype.onerror=function(e){l("error",e),this.emitAll("error",e)},r.prototype.socket=function(e){function t(){~d(r.connecting,n)||r.connecting.push(n)}var n=this.nsps[e];if(!n){n=new o(this,e),this.nsps[e]=n;var r=this;n.on("connecting",t),n.on("connect",function(){n.id=r.engine.id}),this.autoConnect&&t()}return n},r.prototype.destroy=function(e){var t=d(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},r.prototype.packet=function(e){l("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},r.prototype.cleanup=function(){l("cleanup");for(var e;e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){l("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"==this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(e){l("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();l("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(l("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(l("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(l("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},r.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t){function n(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}e.exports=n},function(e,t,n){function r(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.io.autoConnect&&this.open()}var i=n(40),o=n(54),a=n(167),s=n(65),c=n(53),u=n(10)("socket.io-client:socket"),l=n(139);e.exports=t=r;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=o.prototype.emit;o(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",c(this,"onopen")),s(e,"packet",c(this,"onpacket")),s(e,"close",c(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this.emit("connecting"),this)},r.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},r.prototype.emit=function(e){if(d.hasOwnProperty(e))return f.apply(this,arguments),this;var t=a(arguments),n=i.EVENT;l(t)&&(n=i.BINARY_EVENT);var r={type:n,data:t};return r.options={},r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),delete this.flags,this},r.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},r.prototype.onopen=function(){u("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:i.CONNECT})},r.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},r.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:this.onevent(e);break;case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:this.onack(e);break;case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},r.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},r.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=a(arguments);u("sending ack %j",r);var o=l(r)?i.BINARY_ACK:i.ACK;t.packet({type:o,id:e,data:r})}}},r.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},function(e,t){(function(t){function n(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}e.exports=n}).call(t,function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";function n(e){var t="";do t=a[e%s]+t,e=Math.floor(e/s);while(e>0);return t}function r(e){var t=0;for(l=0;l<e.length;l++)t=t*s+c[e.charAt(l)];return t}function i(){var e=n(+new Date);return e!==o?(u=0,o=e):e+"."+n(u++)}for(var o,a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s=64,c={},u=0,l=0;l<s;l++)c[a[l]]=l;i.encode=n,i.decode=r,e.exports=i},function(e,t){function n(e,t,n){function i(e,r){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,t(e),t=n):0!==i.count||o||t(null,r)}var o=!1;return n=n||r,i.count=e,0===e?t():i}function r(){}e.exports=n},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)o[s]=i[a];return o.buffer}},function(e,t,n){var r,i;(function(n,o){/*!
	 * async
	 * https://github.com/caolan/async
	 *
	 * Copyright 2010-2014 Caolan McMahon
	 * Released under the MIT license
	 */
!function(){function a(e){var t=!1;return function(){if(t)throw new Error("Callback was already called.");t=!0,e.apply(s,arguments)}}var s,c,u={};s=this,null!=s&&(c=s.async),u.noConflict=function(){return s.async=c,u};var l=Object.prototype.toString,d=Array.isArray||function(e){return"[object Array]"===l.call(e)},f=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n+=1)t(e[n],n,e)},p=function(e,t){if(e.map)return e.map(t);var n=[];return f(e,function(e,r,i){n.push(t(e,r,i))}),n},h=function(e,t,n){return e.reduce?e.reduce(t,n):(f(e,function(e,r,i){n=t(n,e,r,i)}),n)},m=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};"undefined"!=typeof n&&n.nextTick?(u.nextTick=n.nextTick,"undefined"!=typeof o?u.setImmediate=function(e){o(e)}:u.setImmediate=u.nextTick):"function"==typeof o?(u.nextTick=function(e){o(e)},u.setImmediate=u.nextTick):(u.nextTick=function(e){setTimeout(e,0)},u.setImmediate=u.nextTick),u.each=function(e,t,n){function r(t){t?(n(t),n=function(){}):(i+=1,i>=e.length&&n())}if(n=n||function(){},!e.length)return n();var i=0;f(e,function(e){t(e,a(r))})},u.forEach=u.each,u.eachSeries=function(e,t,n){if(n=n||function(){},!e.length)return n();var r=0,i=function(){t(e[r],function(t){t?(n(t),n=function(){}):(r+=1,r>=e.length?n():i())})};i()},u.forEachSeries=u.eachSeries,u.eachLimit=function(e,t,n,r){var i=v(t);i.apply(null,[e,n,r])},u.forEachLimit=u.eachLimit;var v=function(e){return function(t,n,r){if(r=r||function(){},!t.length||e<=0)return r();var i=0,o=0,a=0;!function s(){if(i>=t.length)return r();for(;a<e&&o<t.length;)o+=1,a+=1,n(t[o-1],function(e){e?(r(e),r=function(){}):(i+=1,a-=1,i>=t.length?r():s())})}()}},g=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[u.each].concat(t))}},y=function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[v(e)].concat(n))}},b=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[u.eachSeries].concat(t))}},E=function(e,t,n,r){if(t=p(t,function(e,t){return{index:t,value:e}}),r){var i=[];e(t,function(e,t){n(e.value,function(n,r){i[e.index]=r,t(n)})},function(e){r(e,i)})}else e(t,function(e,t){n(e.value,function(e){t(e)})})};u.map=g(E),u.mapSeries=b(E),u.mapLimit=function(e,t,n,r){return S(t)(e,n,r)};var S=function(e){return y(e,E)};u.reduce=function(e,t,n,r){u.eachSeries(e,function(e,r){n(t,e,function(e,n){t=n,r(e)})},function(e){r(e,t)})},u.inject=u.reduce,u.foldl=u.reduce,u.reduceRight=function(e,t,n,r){var i=p(e,function(e){return e}).reverse();u.reduce(i,t,n,r)},u.foldr=u.reduceRight;var T=function(e,t,n,r){var i=[];t=p(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n&&i.push(e),t()})},function(e){r(p(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};u.filter=g(T),u.filterSeries=b(T),u.select=u.filter,u.selectSeries=u.filterSeries;var C=function(e,t,n,r){var i=[];t=p(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n||i.push(e),t()})},function(e){r(p(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};u.reject=g(C),u.rejectSeries=b(C);var w=function(e,t,n,r){e(t,function(e,t){n(e,function(n){n?(r(e),r=function(){}):t()})},function(e){r()})};u.detect=g(w),u.detectSeries=b(w),u.some=function(e,t,n){u.each(e,function(e,r){t(e,function(e){e&&(n(!0),n=function(){}),r()})},function(e){n(!1)})},u.any=u.some,u.every=function(e,t,n){u.each(e,function(e,r){t(e,function(e){e||(n(!1),n=function(){}),r()})},function(e){n(!0)})},u.all=u.every,u.sortBy=function(e,t,n){u.map(e,function(e,n){t(e,function(t,r){t?n(t):n(null,{value:e,criteria:r})})},function(e,t){if(e)return n(e);var r=function(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0};n(null,p(t.sort(r),function(e){return e.value}))})},u.auto=function(e,t){t=t||function(){};var n=m(e),r=n.length;if(!r)return t();var i={},o=[],a=function(e){o.unshift(e)},s=function(e){for(var t=0;t<o.length;t+=1)if(o[t]===e)return void o.splice(t,1)},c=function(){r--,f(o.slice(0),function(e){e()})};a(function(){if(!r){var e=t;t=function(){},e(null,i)}}),f(n,function(n){var r=d(e[n])?e[n]:[e[n]],o=function(e){var r=Array.prototype.slice.call(arguments,1);if(r.length<=1&&(r=r[0]),e){var o={};f(m(i),function(e){o[e]=i[e]}),o[n]=r,t(e,o),t=function(){}}else i[n]=r,u.setImmediate(c)},l=r.slice(0,Math.abs(r.length-1))||[],p=function(){return h(l,function(e,t){return e&&i.hasOwnProperty(t)},!0)&&!i.hasOwnProperty(n)};if(p())r[r.length-1](o,i);else{var v=function(){p()&&(s(v),r[r.length-1](o,i))};a(v)}})},u.retry=function(e,t,n){var r=5,i=[];"function"==typeof e&&(n=t,t=e,e=r),e=parseInt(e,10)||r;var o=function(r,o){for(var a=function(e,t){return function(n){e(function(e,r){n(!e||t,{err:e,result:r})},o)}};e;)i.push(a(t,!(e-=1)));u.series(i,function(e,t){t=t[t.length-1],(r||n)(t.err,t.result)})};return n?o():o},u.waterfall=function(e,t){if(t=t||function(){},!d(e)){var n=new Error("First argument to waterfall must be an array of functions");return t(n)}if(!e.length)return t();var r=function(e){return function(n){if(n)t.apply(null,arguments),t=function(){};else{var i=Array.prototype.slice.call(arguments,1),o=e.next();o?i.push(r(o)):i.push(t),u.setImmediate(function(){e.apply(null,i)})}}};r(u.iterator(e))()};var _=function(e,t,n){if(n=n||function(){},d(t))e.map(t,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},n);else{var r={};e.each(m(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[e]=i,n(t)})},function(e){n(e,r)})}};u.parallel=function(e,t){_({map:u.map,each:u.each},e,t)},u.parallelLimit=function(e,t,n){_({map:S(t),each:v(t)},e,n)},u.series=function(e,t){if(t=t||function(){},d(e))u.mapSeries(e,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},t);else{var n={};u.eachSeries(m(e),function(t,r){e[t](function(e){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),n[t]=i,r(e)})},function(e){t(e,n)})}},u.iterator=function(e){var t=function(n){var r=function(){return e.length&&e[n].apply(null,arguments),r.next()};return r.next=function(){return n<e.length-1?t(n+1):null},r};return t(0)},u.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var R=function(e,t,n,r){var i=[];e(t,function(e,t){n(e,function(e,n){i=i.concat(n||[]),t(e)})},function(e){r(e,i)})};u.concat=g(R),u.concatSeries=b(R),u.whilst=function(e,t,n){e()?t(function(r){return r?n(r):void u.whilst(e,t,n)}):n()},u.doWhilst=function(e,t,n){e(function(r){if(r)return n(r);var i=Array.prototype.slice.call(arguments,1);t.apply(null,i)?u.doWhilst(e,t,n):n()})},u.until=function(e,t,n){e()?n():t(function(r){return r?n(r):void u.until(e,t,n)})},u.doUntil=function(e,t,n){e(function(r){if(r)return n(r);var i=Array.prototype.slice.call(arguments,1);t.apply(null,i)?n():u.doUntil(e,t,n)})},u.queue=function(e,t){function n(e,t,n,r){return e.started||(e.started=!0),d(t)||(t=[t]),0==t.length?u.setImmediate(function(){e.drain&&e.drain()}):void f(t,function(t){var i={data:t,callback:"function"==typeof r?r:null};n?e.tasks.unshift(i):e.tasks.push(i),e.saturated&&e.tasks.length===e.concurrency&&e.saturated(),u.setImmediate(e.process)})}void 0===t&&(t=1);var r=0,i={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(e,t){n(i,e,!1,t)},kill:function(){i.drain=null,i.tasks=[]},unshift:function(e,t){n(i,e,!0,t)},process:function(){if(!i.paused&&r<i.concurrency&&i.tasks.length){var t=i.tasks.shift();i.empty&&0===i.tasks.length&&i.empty(),r+=1;var n=function(){r-=1,t.callback&&t.callback.apply(t,arguments),i.drain&&i.tasks.length+r===0&&i.drain(),i.process()},o=a(n);e(t.data,o)}},length:function(){return i.tasks.length},running:function(){return r},idle:function(){return i.tasks.length+r===0},pause:function(){i.paused!==!0&&(i.paused=!0,i.process())},resume:function(){i.paused!==!1&&(i.paused=!1,i.process())}};return i},u.priorityQueue=function(e,t){function n(e,t){return e.priority-t.priority}function r(e,t,n){for(var r=-1,i=e.length-1;r<i;){var o=r+(i-r+1>>>1);n(t,e[o])>=0?r=o:i=o-1}return r}function i(e,t,i,o){return e.started||(e.started=!0),d(t)||(t=[t]),0==t.length?u.setImmediate(function(){e.drain&&e.drain()}):void f(t,function(t){var a={data:t,priority:i,callback:"function"==typeof o?o:null};e.tasks.splice(r(e.tasks,a,n)+1,0,a),e.saturated&&e.tasks.length===e.concurrency&&e.saturated(),u.setImmediate(e.process)})}var o=u.queue(e,t);return o.push=function(e,t,n){i(o,e,t,n)},delete o.unshift,o},u.cargo=function(e,t){var n=!1,r=[],i={tasks:r,payload:t,saturated:null,empty:null,drain:null,drained:!0,push:function(e,n){d(e)||(e=[e]),f(e,function(e){r.push({data:e,callback:"function"==typeof n?n:null}),i.drained=!1,i.saturated&&r.length===t&&i.saturated()}),u.setImmediate(i.process)},process:function o(){if(!n){if(0===r.length)return i.drain&&!i.drained&&i.drain(),void(i.drained=!0);var a="number"==typeof t?r.splice(0,t):r.splice(0,r.length),s=p(a,function(e){return e.data});i.empty&&i.empty(),n=!0,e(s,function(){n=!1;var e=arguments;f(a,function(t){t.callback&&t.callback.apply(null,e)}),o()})}},length:function(){return r.length},running:function(){return n}};return i};var A=function(e){return function(t){var n=Array.prototype.slice.call(arguments,1);t.apply(null,n.concat([function(t){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[e]&&f(n,function(t){console[e](t)}))}]))}};u.log=A("log"),u.dir=A("dir"),u.memoize=function(e,t){var n={},r={};t=t||function(e){return e};var i=function(){var i=Array.prototype.slice.call(arguments),o=i.pop(),a=t.apply(null,i);a in n?u.nextTick(function(){o.apply(null,n[a])}):a in r?r[a].push(o):(r[a]=[o],e.apply(null,i.concat([function(){n[a]=arguments;var e=r[a];delete r[a];for(var t=0,i=e.length;t<i;t++)e[t].apply(null,arguments)}])))};return i.memo=n,i.unmemoized=e,i},u.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},u.times=function(e,t,n){for(var r=[],i=0;i<e;i++)r.push(i);return u.map(r,t,n)},u.timesSeries=function(e,t,n){for(var r=[],i=0;i<e;i++)r.push(i);return u.mapSeries(r,t,n)},u.seq=function(){var e=arguments;return function(){var t=this,n=Array.prototype.slice.call(arguments),r=n.pop();u.reduce(e,n,function(e,n,r){n.apply(t,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);r(e,t)}]))},function(e,n){r.apply(t,[e].concat(n))})}},u.compose=function(){return u.seq.apply(null,Array.prototype.reverse.call(arguments))};var k=function(e,t){var n=function(){var n=this,r=Array.prototype.slice.call(arguments),i=r.pop();return e(t,function(e,t){e.apply(n,r.concat([t]))},i)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return n.apply(this,r)}return n};u.applyEach=g(k),u.applyEachSeries=b(k),u.forever=function(e,t){function n(r){if(r){if(t)return t(r);throw r}e(n)}n()},"undefined"!=typeof e&&e.exports?e.exports=u:(r=[],i=function(){return u}.apply(t,r),!(void 0!==i&&(e.exports=i)))}()}).call(t,n(60),n(166).setImmediate)},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e){if(!e.name||e.name.toLowerCase()!==e.name){var t="Invalid conference name (no conference name passed or it contains invalid characters like capital letters)!";throw oe.error(t),new Error(t)}this.eventEmitter=new v.default,this.options=e,this.eventManager=new T.default(this),this._init(e),this.componentsVersions=new u.default(this),this.participants={},this.jvbJingleSession=null,this.lastDominantSpeaker=null,this.dtmfManager=null,this.somebodySupportsDTMF=!1,this.authEnabled=!1,this.startAudioMuted=!1,this.startVideoMuted=!1,this.startMutedPolicy={audio:!1,video:!1},this.availableDevices={audio:void 0,video:void 0},this.isMutedByFocus=!1,this.wasStopped=!1,this.connectionQuality=new d.default(this,this.eventEmitter,e),this.avgRtpStatsReporter=new s.default(this,e.config.avgRtpStatsN||15),this.isJvbConnectionInterrupted=!1,this.speakerStatsCollector=new ie.default(this),this.deferredStartP2PTask=null;var n=parseInt(e.config.backToP2PDelay,10);this.backToP2PDelay=isNaN(n)?5:n,oe.info("backToP2PDelay: "+this.backToP2PDelay),this.isP2PConnectionInterrupted=!1,this.p2p=!1,this.p2pJingleSession=null}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var a=n(91),s=i(a),c=n(104),u=i(c),l=n(89),d=i(l),f=n(1),p=n(3),h=i(p),m=n(17),v=i(m),g=n(23),y=r(g),b=n(28),E=r(b),S=n(74),T=i(S),C=n(8),w=r(C),_=n(78),R=i(_),A=n(77),k=i(A),O=n(12),I=i(O),P=n(13),D=r(P),N=n(14),x=r(N),L=n(5),M=r(L),j=n(30),F=i(j),U=n(20),B=i(U),J=n(2),H=i(J),G=n(9),V=r(G),W=n(6),K=i(W),q=n(88),z=i(q),X=n(97),$=i(X),Q=n(19),Y=i(Q),Z=n(106),ee=i(Z),te=n(7),ne=r(te),re=n(95),ie=i(re),oe=(0,f.getLogger)(e);o.prototype.constructor=o,o.prototype._init=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.connection&&(this.connection=t.connection,this.xmpp=this.connection.xmpp,this.eventManager.setupXMPPListeners()),this.room=this.xmpp.createRoom(this.options.name,this.options.config),this._onIceConnectionInterrupted=this._onIceConnectionInterrupted.bind(this),this.room.addListener(ne.CONNECTION_INTERRUPTED,this._onIceConnectionInterrupted),this._onIceConnectionRestored=this._onIceConnectionRestored.bind(this),this.room.addListener(ne.CONNECTION_RESTORED,this._onIceConnectionRestored),this._onIceConnectionEstablished=this._onIceConnectionEstablished.bind(this),this.room.addListener(ne.CONNECTION_ESTABLISHED,this._onIceConnectionEstablished),this.room.updateDeviceAvailability(B.default.getDeviceAvailability()),this.rtc||(this.rtc=new B.default(this,t),this.eventManager.setupRTCListeners()),this.participantConnectionStatus=new F.default(this.rtc,this,t.config.peerDisconnectedThroughRtcTimeout),this.participantConnectionStatus.init(),this.statistics||(this.statistics=new K.default(this.xmpp,{callStatsID:this.options.config.callStatsID,callStatsSecret:this.options.config.callStatsSecret,callStatsConfIDNamespace:this.options.config.callStatsConfIDNamespace||window.location.hostname,callStatsCustomScriptUrl:this.options.config.callStatsCustomScriptUrl,callStatsAliasName:this.myUserId(),roomName:this.options.name})),this.eventManager.setupChatRoomListeners(),this.eventManager.setupStatisticsListeners(),this.options.config.enableTalkWhileMuted&&new z.default(this,function(){return e.eventEmitter.emit(w.TALK_WHILE_MUTED)})},o.prototype.join=function(e){this.room&&this.room.join(e)},o.prototype.isJoined=function(){return this.room&&this.room.joined},o.prototype.leave=function(){var e=this;if(this.participantConnectionStatus&&(this.participantConnectionStatus.dispose(),this.participantConnectionStatus=null),this.avgRtpStatsReporter&&(this.avgRtpStatsReporter.dispose(),this.avgRtpStatsReporter=null),this.getLocalTracks().forEach(function(t){return e.onLocalTrackRemoved(t)}),this.rtc.closeAllDataChannels(),this.statistics&&this.statistics.dispose(),this.jvbJingleSession&&(this.jvbJingleSession.close(),this.jvbJingleSession=null),this.p2pJingleSession&&(this.p2pJingleSession.close(),this.p2pJingleSession=null),this.room){var t=this.room;return t.removeListener(ne.CONNECTION_INTERRUPTED,this._onIceConnectionInterrupted),t.removeListener(ne.CONNECTION_RESTORED,this._onIceConnectionRestored),t.removeListener(ne.CONNECTION_ESTABLISHED,this._onIceConnectionEstablished),this.room=null,t.leave().catch(function(){e.getParticipants().forEach(function(t){return e.onMemberLeft(t.getJid())})})}return Promise.reject(new Error("The conference is has been already left"))},o.prototype.getName=function(){return this.options.name},o.prototype.isAuthEnabled=function(){return this.authEnabled},o.prototype.isLoggedIn=function(){return Boolean(this.authIdentity)},o.prototype.getAuthLogin=function(){return this.authIdentity},o.prototype.isExternalAuthEnabled=function(){return this.room&&this.room.moderator.isExternalAuthEnabled()},o.prototype.getExternalAuthUrl=function(e){var t=this;return new Promise(function(n,r){return t.isExternalAuthEnabled()?void(e?t.room.moderator.getPopupLoginUrl(n,r):t.room.moderator.getLoginUrl(n,r)):void r()})},o.prototype.getLocalTracks=function(e){var t=[];return this.rtc&&(t=this.rtc.getLocalTracks(e)),t},o.prototype.getLocalAudioTrack=function(){return this.rtc?this.rtc.getLocalAudioTrack():null},o.prototype.getLocalVideoTrack=function(){return this.rtc?this.rtc.getLocalVideoTrack():null},o.prototype.on=function(e,t){this.eventEmitter&&this.eventEmitter.on(e,t)},o.prototype.off=function(e,t){this.eventEmitter&&this.eventEmitter.removeListener(e,t)},o.prototype.addEventListener=o.prototype.on,o.prototype.removeEventListener=o.prototype.off,o.prototype.addCommandListener=function(e,t){this.room&&this.room.addPresenceListener(e,t)},o.prototype.removeCommandListener=function(e){this.room&&this.room.removePresenceListener(e)},o.prototype.sendTextMessage=function(e){this.room&&this.room.sendMessage(e)},o.prototype.sendCommand=function(e,t){this.room&&(this.room.addToPresence(e,t),this.room.sendPresence())},o.prototype.sendCommandOnce=function(e,t){this.sendCommand(e,t),this.removeCommand(e)},o.prototype.removeCommand=function(e){this.room&&this.room.removeFromPresence(e)},o.prototype.setDisplayName=function(e){this.room&&(this.room.removeFromPresence("nick"),this.room.addToPresence("nick",{attributes:{xmlns:"http://jabber.org/protocol/nick"},value:e}),this.room.sendPresence())},o.prototype.setSubject=function(e){this.room&&this.isModerator()&&this.room.setSubject(e)},o.prototype.getTranscriber=function(){if(void 0===this.transcriber){this.transcriber=new $.default;var e=this.getLocalTracks(M.AUDIO),t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this.transcriber.addTrack(a)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=this.rtc.getRemoteTracks(M.AUDIO),c=!0,u=!1,l=void 0;try{for(var d,f=s[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var p=d.value;this.transcriber.addTrack(p)}}catch(e){u=!0,l=e}finally{try{!c&&f.return&&f.return()}finally{if(u)throw l}}}return this.transcriber},o.prototype.addTrack=function(e){if(e.isVideoTrack()){var t=this.rtc.getLocalVideoTrack();if(t)return e===t?Promise.resolve(e):Promise.reject(new Error("cannot add second video track to the conference"))}return this.replaceTrack(null,e)},o.prototype._fireAudioLevelChangeEvent=function(e){this.eventEmitter.emit(w.TRACK_AUDIO_LEVEL_CHANGED,this.myUserId(),e)},o.prototype._fireMuteChangeEvent=function(e){this.isMutedByFocus&&e.isAudioTrack()&&!e.isMuted()&&(this.isMutedByFocus=!1,this.room.muteParticipant(this.room.myroomjid,!1)),this.eventEmitter.emit(w.TRACK_MUTE_CHANGED,e)},o.prototype.onLocalTrackRemoved=function(e){e._setConference(null),this.rtc.removeLocalTrack(e),e.removeEventListener(x.TRACK_MUTE_CHANGED,e.muteHandler),e.removeEventListener(x.TRACK_AUDIO_LEVEL_CHANGED,e.audioLevelHandler),e.isVideoTrack()&&e.videoType===Y.default.DESKTOP&&this.statistics.sendScreenSharingEvent(!1),this.eventEmitter.emit(w.TRACK_REMOVED,e)},o.prototype.removeTrack=function(e){return this.replaceTrack(e,null)},o.prototype.replaceTrack=function(e,t){var n=this;return e&&e.disposed?Promise.reject(new I.default(D.TRACK_IS_DISPOSED)):t&&t.disposed?Promise.reject(new I.default(D.TRACK_IS_DISPOSED)):this._doReplaceTrack(e,t).then(function(){return e&&n.onLocalTrackRemoved(e),t&&n._setupNewTrack(t),Promise.resolve()},function(e){return Promise.reject(new Error(e))})},o.prototype._doReplaceTrack=function(e,t){var n=[];return this.jvbJingleSession?n.push(this.jvbJingleSession.replaceTrack(e,t)):oe.info("_doReplaceTrack - no JVB JingleSession"),this.p2pJingleSession?n.push(this.p2pJingleSession.replaceTrack(e,t)):oe.info("_doReplaceTrack - no P2P JingleSession"),Promise.all(n)},o.prototype._setupNewTrack=function(e){if(e.isAudioTrack()||e.isVideoTrack()&&e.videoType!==Y.default.DESKTOP){var t=B.default.getCurrentlyAvailableMediaDevices(),n=t.find(function(t){return t.kind===e.getTrack().kind+"input"&&t.label===e.getTrack().label});n&&K.default.sendActiveDeviceListEvent(B.default.getEventDataForActiveDevice(n))}e.isVideoTrack()&&(this.removeCommand("videoType"),this.sendCommand("videoType",{value:e.videoType,attributes:{xmlns:"http://jitsi.org/jitmeet/video"}})),this.rtc.addLocalTrack(e),e.isAudioTrack()?this.room.setAudioMute(e.isMuted()):this.room.setVideoMute(e.isMuted()),e.muteHandler=this._fireMuteChangeEvent.bind(this,e),e.audioLevelHandler=this._fireAudioLevelChangeEvent.bind(this),e.addEventListener(x.TRACK_MUTE_CHANGED,e.muteHandler),e.addEventListener(x.TRACK_AUDIO_LEVEL_CHANGED,e.audioLevelHandler),e._setConference(this),e.isVideoTrack()&&e.videoType===Y.default.DESKTOP&&this.statistics.sendScreenSharingEvent(!0),this.eventEmitter.emit(w.TRACK_ADDED,e)},o.prototype._addLocalTrackAsUnmute=function(e){var t=[];return this.jvbJingleSession?t.push(this.jvbJingleSession.addTrackAsUnmute(e)):oe.info("Add local MediaStream as unmute - no JVB Jingle session started yet"),this.p2pJingleSession?t.push(this.p2pJingleSession.addTrackAsUnmute(e)):oe.info("Add local MediaStream as unmute - no P2P Jingle session started yet"),Promise.all(t)},o.prototype._removeLocalTrackAsMute=function(e){var t=[];return this.jvbJingleSession?t.push(this.jvbJingleSession.removeTrackAsMute(e)):oe.info("Remove local MediaStream - no JVB JingleSession started yet"),this.p2pJingleSession?t.push(this.p2pJingleSession.removeTrackAsMute(e)):oe.info("Remove local MediaStream - no P2P JingleSession started yet"),Promise.all(t)},o.prototype.getRole=function(){return this.room.role},o.prototype.isModerator=function(){return this.room?this.room.isModerator():null},o.prototype.lock=function(e){var t=this;return this.isModerator()?new Promise(function(n,r){t.room.lockRoom(e||"",function(){return n()},function(e){return r(e)},function(){return r(E.PASSWORD_NOT_SUPPORTED)})}):Promise.reject()},o.prototype.unlock=function(){return this.lock()},o.prototype.selectParticipant=function(e){this.rtc.selectEndpoint(e)},o.prototype.pinParticipant=function(e){this.rtc.pinEndpoint(e)},o.prototype.setLastN=function(e){if(!Number.isInteger(e)&&!Number.parseInt(e,10))throw new Error("Invalid value for lastN: "+e);var t=Number(e);if(t<-1)throw new RangeError("lastN cannot be smaller than -1");this.rtc.setLastN(t)},o.prototype.isInLastN=function(e){return this.rtc.isInLastN(e)},o.prototype.getParticipants=function(){return Object.keys(this.participants).map(function(e){return this.participants[e]},this)},o.prototype.getParticipantCount=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.getParticipants();return e||(t=t.filter(function(e){return!e.isHidden()})),t.length+1},o.prototype.getParticipantById=function(e){return this.participants[e]},o.prototype.kickParticipant=function(e){var t=this.getParticipantById(e);t&&this.room.kick(t.getJid())},o.prototype.muteParticipant=function(e){var t=this.getParticipantById(e);t&&this.room.muteParticipant(t.getJid(),!0)},o.prototype.onMemberJoined=function(e,t,n,r){var i=this,o=Strophe.getResourceFromJid(e);if("focus"!==o&&this.myUserId()!==o){var a=new k.default(e,this,t,r);a._role=n,this.participants[o]=a,this.eventEmitter.emit(w.USER_JOINED,o,a),this.xmpp.caps.getFeatures(e).then(function(e){a._supportsDTMF=e.has("urn:xmpp:jingle:dtmf:0"),i.updateDTMFSupport()},function(t){return oe.error("Failed to discover features of "+e,t)}),this._maybeStartOrStopP2P()}},o.prototype.onMemberLeft=function(e){var t=this,n=Strophe.getResourceFromJid(e);if("focus"!==n&&this.myUserId()!==n){var r=this.participants[n];delete this.participants[n];var i=this.rtc.removeRemoteTracks(n);i.forEach(function(e){return t.eventEmitter.emit(w.TRACK_REMOVED,e)}),r&&this.eventEmitter.emit(w.USER_LEFT,n,r),this._maybeStartOrStopP2P(!0)}},o.prototype.onLocalRoleChanged=function(e){this.eventEmitter.emit(w.USER_ROLE_CHANGED,this.myUserId(),e),this._maybeStartOrStopP2P()},o.prototype.onUserRoleChanged=function(e,t){var n=Strophe.getResourceFromJid(e),r=this.getParticipantById(n);r&&(r._role=t,this.eventEmitter.emit(w.USER_ROLE_CHANGED,n,t))},o.prototype.onDisplayNameChanged=function(e,t){var n=Strophe.getResourceFromJid(e),r=this.getParticipantById(n);r&&r._displayName!==t&&(r._displayName=t,this.eventEmitter.emit(w.DISPLAY_NAME_CHANGED,n,t))},o.prototype.onRemoteTrackAdded=function(e){if(e.isP2P&&!this.isP2PActive())return void oe.info("Trying to add remote P2P track, when not in P2P - IGNORED");if(!e.isP2P&&this.isP2PActive())return void oe.info("Trying to add remote JVB track, when in P2P - IGNORED");var t=e.getParticipantId(),n=this.getParticipantById(t);if(!n)return void oe.error("No participant found for id: "+t);n._tracks.push(e),this.transcriber&&this.transcriber.addTrack(e);var r=this.eventEmitter;e.addEventListener(x.TRACK_MUTE_CHANGED,function(){return r.emit(w.TRACK_MUTE_CHANGED,e)}),e.addEventListener(x.TRACK_AUDIO_LEVEL_CHANGED,function(e){r.emit(w.TRACK_AUDIO_LEVEL_CHANGED,t,e)}),r.emit(w.TRACK_ADDED,e)},o.prototype.onCallAccepted=function(e,t){this.p2pJingleSession===e&&(oe.info("P2P setAnswer"),this.p2pJingleSession.setAnswer(t))},o.prototype.onTransportInfo=function(e,t){this.p2pJingleSession===e&&(oe.info("P2P addIceCandidates"),this.p2pJingleSession.addIceCandidates(t))},o.prototype.onRemoteTrackRemoved=function(e){var t=this,n=!1;if(this.getParticipants().forEach(function(r){for(var i=r.getTracks(),o=0;o<i.length;o++)if(i[o]===e){r._tracks.splice(o,1),t.eventEmitter.emit(w.TRACK_REMOVED,e),t.transcriber&&t.transcriber.removeTrack(e),n=!0;break}},this),!n){if(this.isP2PActive()&&!e.isP2P||!this.isP2PActive()&&e.isP2P)return;oe.error("Failed to match remote track on remove with any of the participants",e.getStreamId(),e.getParticipantId())}},o.prototype.onIncomingCall=function(e,t,n){if(e.isP2P){var r=this.room.getMemberRole(e.peerjid);return void("moderator"!==r?this._rejectIncomingCallNonModerator(e):H.default.isP2PSupported()?this.p2pJingleSession?this._rejectIncomingCall(e,{reasonTag:"busy",reasonMsg:"P2P already in progress",errorMsg:'Duplicated P2P "session-initiate"'}):this._acceptP2PIncomingCall(e,t):this._rejectIncomingCall(e,{reasonTag:"unsupported-applications",reasonMsg:"P2P not supported",errorMsg:"This client does not support P2P connections"}))}if(!this.room.isFocus(e.peerjid))return void this._rejectIncomingCall(e);this.jvbJingleSession=e,this.room.connectionTimes["session.initiate"]=n,this.wasStopped&&K.default.sendEventToAll("session.restart");var i=null;window.jitsiRegionInfo&&(i=window.jitsiRegionInfo.CrossRegion),K.default.analytics.sendEvent("session.initiate",{value:n-this.room.connectionTimes["muc.joined"],label:i});try{e.initialize(!1,this.room,this.rtc)}catch(e){h.default.callErrorHandler(e)}this.rtc.initializeDataChannels(e.peerconnection);try{e.acceptOffer(t,null,function(e){h.default.callErrorHandler(e),oe.error("Failed to accept incoming Jingle session",e)},this.getLocalTracks()),oe.info("Starting CallStats for JVB connection..."),this.statistics.startCallStats(this.jvbJingleSession.peerconnection,"jitsi"),this._startRemoteStats()}catch(e){h.default.callErrorHandler(e),oe.error(e)}},o.prototype._rejectIncomingCallNonModerator=function(e){this._rejectIncomingCall(e,{reasonTag:"security-error",reasonMsg:"Only focus can start new sessions",errorMsg:"Rejecting session-initiate from non-focus andnon-moderator user: "+e.peerjid})},o.prototype._rejectIncomingCall=function(e,t){t&&t.errorMsg&&h.default.callErrorHandler(new Error(t.errorMsg)),e.terminate(t&&t.reasonTag,t&&t.reasonMsg,null,function(e){oe.warn("An error occurred while trying to terminate invalid Jingle session",e)})},o.prototype._startRemoteStats=function(){var e=this.getActivePeerConnection();e&&this.statistics.startRemoteStats(e)},o.prototype.onCallEnded=function(e,t,n){oe.info("Call ended: "+t+" - "+n+" P2P ?"+e.isP2P),e===this.jvbJingleSession?(this.wasStopped=!0,K.default.sendEventToAll("session.terminate"),this.statistics&&(this.statistics.stopRemoteStats(),oe.info("Stopping JVB CallStats"),this.statistics.stopCallStats(this.jvbJingleSession.peerconnection)),this.jvbJingleSession=null,this.rtc.onCallEnded()):e===this.p2pJingleSession?this._stopP2PSession():oe.error("Received onCallEnded for invalid session",e.sid,e.peerjid,t,n)},o.prototype.onSuspendDetected=function(e){e.isP2P||(this.leave(),this.eventEmitter.emit(w.SUSPEND_DETECTED))},o.prototype.updateDTMFSupport=function(){for(var e=!1,t=this.getParticipants(),n=0;n<t.length;n+=1)if(t[n].supportsDTMF()){e=!0;break}e!==this.somebodySupportsDTMF&&(this.somebodySupportsDTMF=e,this.eventEmitter.emit(w.DTMF_SUPPORT_CHANGED,e))},o.prototype.isDTMFSupported=function(){return this.somebodySupportsDTMF},o.prototype.myUserId=function(){return this.room&&this.room.myroomjid?Strophe.getResourceFromJid(this.room.myroomjid):null},o.prototype.sendTones=function(e,t,n){if(!this.dtmfManager){var r=this.getActivePeerConnection();if(!r)return void oe.warn("cannot sendTones: no peer connection");var i=this.getLocalAudioTrack();if(!i)return void oe.warn("cannot sendTones: no local audio stream");this.dtmfManager=new R.default(i,r)}this.dtmfManager.sendTones(e,t,n)},o.prototype.isRecordingSupported=function(){return!!this.room&&this.room.isRecordingSupported()},o.prototype.getRecordingState=function(){return this.room?this.room.getRecordingState():void 0},o.prototype.getRecordingURL=function(){return this.room?this.room.getRecordingURL():null},o.prototype.toggleRecording=function(e){var t=this;return this.room?this.room.toggleRecording(e,function(e,n){t.eventEmitter.emit(w.RECORDER_STATE_CHANGED,e,n)}):void this.eventEmitter.emit(w.RECORDER_STATE_CHANGED,"error",new Error("The conference is not created yet!"))},o.prototype.isSIPCallingSupported=function(){return!!this.room&&this.room.isSIPCallingSupported()},o.prototype.dial=function(e){return this.room?this.room.dial(e):new Promise(function(e,t){t(new Error("The conference is not created yet!"))})},o.prototype.hangup=function(){return this.room?this.room.hangup():new Promise(function(e,t){t(new Error("The conference is not created yet!"))})},o.prototype.getPhoneNumber=function(){return this.room?this.room.getPhoneNumber():null},o.prototype.getPhonePin=function(){return this.room?this.room.getPhonePin():null},o.prototype.getActivePeerConnection=function(){return this.isP2PActive()?this.p2pJingleSession.peerconnection:this.jvbJingleSession?this.jvbJingleSession.peerconnection:null},o.prototype.getConnectionState=function(){var e=this.getActivePeerConnection();return e?e.getConnectionState():null},o.prototype.setStartMutedPolicy=function(e){this.isModerator()&&(this.startMutedPolicy=e,this.room.removeFromPresence("startmuted"),this.room.addToPresence("startmuted",{attributes:{audio:e.audio,video:e.video,xmlns:"http://jitsi.org/jitmeet/start-muted"}}),this.room.sendPresence())},o.prototype.getStartMutedPolicy=function(){return this.startMutedPolicy},o.prototype.isStartAudioMuted=function(){return this.startAudioMuted},o.prototype.isStartVideoMuted=function(){return this.startVideoMuted},o.prototype.getLogs=function(){var e=this.xmpp.getJingleLog(),t={};t.time=new Date,t.url=window.location.href,t.ua=navigator.userAgent;var n=this.xmpp.getXmppLog();return n&&(t.xmpp=n),e.metadata=t,e},o.prototype.getConnectionTimes=function(){return this.room.connectionTimes},o.prototype.setLocalParticipantProperty=function(e,t){this.sendCommand("jitsi_participant_"+e,{value:t})},o.prototype.sendFeedback=function(e,t){
this.statistics.sendFeedback(e,t)},o.prototype.isCallstatsEnabled=function(){return this.statistics.isCallstatsEnabled()},o.prototype._onTrackAttach=function(e,t){var n=e.isLocal(),r=null,i=e.isP2P,o=i?e.getParticipantId():"jitsi",a=i?this.p2pJingleSession&&this.p2pJingleSession.peerconnection:this.jvbJingleSession&&this.jvbJingleSession.peerconnection;n?a&&(r=a.getLocalSSRC(e)):r=e.getSSRC(),t.id&&r&&a&&this.statistics.associateStreamWithVideoTag(a,r,n,o,e.getUsageLabel(),t.id)},o.prototype.sendApplicationLog=function(e){K.default.sendLog(e)},o.prototype._isFocus=function(e){return this.room?this.room.isFocus(e):null},o.prototype._fireIncompatibleVersionsEvent=function(){this.eventEmitter.emit(w.CONFERENCE_FAILED,E.INCOMPATIBLE_SERVER_VERSIONS)},o.prototype.sendEndpointMessage=function(e,t){this.rtc.sendDataChannelMessage(e,t)},o.prototype.broadcastEndpointMessage=function(e){this.sendEndpointMessage("",e)},o.prototype.isConnectionInterrupted=function(){return this.isP2PActive()?this.isP2PConnectionInterrupted:this.isJvbConnectionInterrupted},o.prototype._onIceConnectionInterrupted=function(e){e.isP2P?this.isP2PConnectionInterrupted=!0:this.isJvbConnectionInterrupted=!0,e.isP2P===this.isP2PActive()&&this.eventEmitter.emit(w.CONNECTION_INTERRUPTED)},o.prototype._onIceConnectionFailed=function(e){e.isP2P&&(this.p2pJingleSession&&this.p2pJingleSession.isInitiator&&K.default.sendEventToAll("p2p.failed"),this._stopP2PSession("connectivity-error","ICE FAILED"))},o.prototype._onIceConnectionRestored=function(e){e.isP2P?this.isP2PConnectionInterrupted=!1:this.isJvbConnectionInterrupted=!1,e.isP2P===this.isP2PActive()&&this.eventEmitter.emit(w.CONNECTION_RESTORED)},o.prototype._acceptP2PIncomingCall=function(e,t){e.setSSRCOwnerJid(this.room.myroomjid),this.isP2PConnectionInterrupted=!1,this.p2pJingleSession=e,this.p2pJingleSession.initialize(!1,this.room,this.rtc),oe.info("Starting CallStats for P2P connection..."),this.statistics.startCallStats(this.p2pJingleSession.peerconnection,Strophe.getResourceFromJid(this.p2pJingleSession.peerjid));var n=this.getLocalTracks();this.p2pJingleSession.acceptOffer(t,function(){oe.debug('Got RESULT for P2P "session-accept"')},function(e){oe.error("Failed to accept incoming P2P Jingle session",e)},n)},o.prototype._addRemoteJVBTracks=function(){this._addRemoteTracks("JVB",this.jvbJingleSession.peerconnection.getRemoteTracks())},o.prototype._addRemoteP2PTracks=function(){this._addRemoteTracks("P2P",this.p2pJingleSession.peerconnection.getRemoteTracks())},o.prototype._addRemoteTracks=function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;oe.info("Adding remote "+e+" track: "+s),this.rtc.eventEmitter.emit(V.REMOTE_TRACK_ADDED,s)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}},o.prototype._onIceConnectionEstablished=function(e){if(e.isP2P){if(this.p2pJingleSession!==e)return void oe.error("CONNECTION_ESTABLISHED - wrong P2P session instance ?!");this._setP2PStatus(!0),this.jvbJingleSession?this._removeRemoteJVBTracks():oe.info("Not removing remote JVB tracks - no session yet"),this._addRemoteP2PTracks(),this.jvbJingleSession&&this._suspendMediaTransferForJvbConnection(),oe.info("Starting remote stats with p2p connection"),this._startRemoteStats(),this.p2pJingleSession.isInitiator&&K.default.sendEventToAll("p2p.established")}},o.prototype._maybeClearDeferredStartP2P=function(){this.deferredStartP2PTask&&(oe.info("Cleared deferred start P2P task"),clearTimeout(this.deferredStartP2PTask),this.deferredStartP2PTask=null)},o.prototype._removeRemoteJVBTracks=function(){this._removeRemoteTracks("JVB",this.jvbJingleSession.peerconnection.getRemoteTracks())},o.prototype._removeRemoteP2PTracks=function(){this._removeRemoteTracks("P2P",this.p2pJingleSession.peerconnection.getRemoteTracks())},o.prototype._removeRemoteTracks=function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;oe.info("Removing remote "+e+" track: "+s),this.rtc.eventEmitter.emit(V.REMOTE_TRACK_REMOVED,s)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}},o.prototype._resumeMediaTransferForJvbConnection=function(){oe.info("Resuming media transfer over the JVB connection..."),this.jvbJingleSession.setMediaTransferActive(!0).then(function(){oe.info("Resumed media transfer over the JVB connection!")},function(e){oe.error("Failed to resume media transfer over the JVB connection:",e)})},o.prototype._setP2PStatus=function(e){return this.p2p===e?void oe.error("Called _setP2PStatus with the same status: "+e):(this.p2p=e,e?oe.info("Peer to peer connection established!"):oe.info("Peer to peer connection closed!"),this.jvbJingleSession&&this.statistics.sendConnectionResumeOrHoldEvent(this.jvbJingleSession.peerconnection,!e),this.dtmfManager=null,this.eventEmitter.emit(w.P2P_STATUS,this,this.p2p),void this.eventEmitter.emit(this.isConnectionInterrupted()?w.CONNECTION_INTERRUPTED:w.CONNECTION_RESTORED))},o.prototype._startP2PSession=function(e){if(this._maybeClearDeferredStartP2P(),this.p2pJingleSession)return void oe.error("P2P session already started!");this.isP2PConnectionInterrupted=!1,this.p2pJingleSession=this.xmpp.connection.jingle.newP2PJingleSession(this.room.myroomjid,e),this.p2pJingleSession.setSSRCOwnerJid(this.room.myroomjid),oe.info("Created new P2P JingleSession",this.room.myroomjid,e),this.p2pJingleSession.initialize(!0,this.room,this.rtc),oe.info("Starting CallStats for P2P connection..."),this.statistics.startCallStats(this.p2pJingleSession.peerconnection,Strophe.getResourceFromJid(this.p2pJingleSession.peerjid));var t=this.getLocalTracks();this.p2pJingleSession.invite(t)},o.prototype._suspendMediaTransferForJvbConnection=function(){oe.info("Suspending media transfer over the JVB connection..."),this.jvbJingleSession.setMediaTransferActive(!1).then(function(){oe.info("Suspended media transfer over the JVB connection !")},function(e){oe.error("Failed to suspend media transfer over the JVB connection:",e)})},o.prototype._maybeStartOrStopP2P=function(e){if(!this.options.config.enableP2P||!H.default.isP2PSupported())return void oe.info("Auto P2P disabled");var t=this.getParticipants(),n=t.length,r=this.isModerator(),i=1===n;if(oe.debug("P2P? isModerator: "+r+", peerCount: "+n+" => "+i),!i&&this.deferredStartP2PTask&&this._maybeClearDeferredStartP2P(),r&&!this.p2pJingleSession&&i){var o=n&&t[0];if(r&&"moderator"===o.getRole()){var a=this.myUserId(),s=o.getId();if(a>s)return void oe.debug("Everyone's a moderator - the other peer should start P2P",a,s);if(a===s)return void oe.error("The same IDs ? ",a,s)}var c=o.getJid();if(e){if(this.deferredStartP2PTask)return void oe.error("Deferred start P2P task's been set already!");oe.info("Will start P2P with: "+c+" after "+this.backToP2PDelay+" seconds..."),this.deferredStartP2PTask=setTimeout(this._startP2PSession.bind(this,c),1e3*this.backToP2PDelay)}else oe.info("Will start P2P with: "+c),this._startP2PSession(c)}else r&&this.p2pJingleSession&&!i&&(oe.info("Will stop P2P with: "+this.p2pJingleSession.peerjid),this.p2pJingleSession.isInitiator&&n>1&&K.default.sendEventToAll("p2p.switch_to_jvb"),this._stopP2PSession())},o.prototype._stopP2PSession=function(e,t){if(!this.p2pJingleSession)return void oe.error("No P2P session to be stopped!");var n=this.isP2PActive();n&&(this._resumeMediaTransferForJvbConnection(),this._removeRemoteP2PTracks()),oe.info("Stopping remote stats for P2P connection"),this.statistics.stopRemoteStats(),oe.info("Stopping CallStats for P2P connection"),this.statistics.stopCallStats(this.p2pJingleSession.peerconnection),y.ENDED!==this.p2pJingleSession.state&&this.p2pJingleSession.terminate(e?e:"success",t?t:"Turing off P2P session",function(){oe.info("P2P session terminate RESULT")},function(e){oe.warn("An error occurred while trying to terminate P2P Jingle session",e)}),this.p2pJingleSession=null,this._setP2PStatus(!1),n&&(this.jvbJingleSession?this._addRemoteJVBTracks():oe.info("Not adding remote JVB tracks - no session yet")),oe.info("Starting remote stats with JVB connection"),this.jvbJingleSession&&this._startRemoteStats()},o.prototype.isP2PActive=function(){return this.p2p},o.prototype.getP2PConnectionState=function(){return this.isP2PActive()?this.p2pJingleSession.peerconnection.getConnectionState():null},o.prototype.startP2PSession=function(){var e=this.getParticipants();if(1!==e.length)throw new Error("There must be exactly 1 participant to start the P2P session !");var t=e[0].getJid();this._startP2PSession(t)},o.prototype.stopP2PSession=function(){this._stopP2PSession()},o.prototype.getSpeakerStats=function(){return this.speakerStatsCollector.getStats()},o.prototype._getVideoSIPGWHandle=function(){return this.videoSIPGWHandler||(this.videoSIPGWHandler=new ee.default(this.room),oe.info("Created VideoSIPGW")),this.videoSIPGWHandler},o.prototype.isVideoSIPGWAvailable=function(){return this._getVideoSIPGWHandle().isVideoSIPGWAvailable()},o.prototype.createVideoSIPGWSession=function(e,t){return this.room?this._getVideoSIPGWHandle().createVideoSIPGWSession(e,t):null}}).call(t,"JitsiConference.js")},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e){this.conference=e,e.on(v.TRACK_MUTE_CHANGED,function(t){if(t.isLocal()&&e.statistics){var n=t.isP2P?e.p2pJingleSession:e.jvbJingleSession,r=n&&n.peerconnection||null;e.statistics.sendMuteEvent(r,t.isMuted(),t.getType())}}),e.on(v.CONNECTION_INTERRUPTED,T.default.sendEventToAll.bind(T.default,"connection.interrupted")),e.on(v.CONNECTION_RESTORED,T.default.sendEventToAll.bind(T.default,"connection.restored"))}function a(e,t){var n={};return Object.keys(t).forEach(function(r){var i=t[r];if(i.width&&i.height&&i.width!==-1&&i.height!==-1){var o=e.rtc.getResourceBySSRC(r);if(o){var a=n[o]||{};a[r]=i,n[o]=a}}}),n}function s(e,t){var n={};return Object.keys(t).forEach(function(r){var i=t[r];if(0!==i){var o=e.rtc.getResourceBySSRC(r);if(o){var a=n[o]||{};a[r]=i,n[o]=a}}}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var c=n(51),u=i(c),l=n(102),d=i(l),f=n(1),p=n(28),h=r(p),m=n(8),v=r(m),g=n(5),y=r(g),b=n(9),E=i(b),S=n(6),T=i(S),C=n(7),w=i(C),_=(0,f.getLogger)(e);o.prototype.setupChatRoomListeners=function(){var e=this,t=this.conference,n=t.room;this.chatRoomForwarder=new d.default(n,this.conference.eventEmitter),n.addListener(w.default.ICE_RESTARTING,function(e){e.isP2P||t.rtc.closeAllDataChannels()}),n.addListener(w.default.AUDIO_MUTED_BY_FOCUS,function(e){t.rtc.setAudioMute(e).then(function(){t.isMutedByFocus=!0},function(){return _.warn("Error while audio muting due to focus request")})}),this.chatRoomForwarder.forward(w.default.SUBJECT_CHANGED,v.SUBJECT_CHANGED),this.chatRoomForwarder.forward(w.default.MUC_JOINED,v.CONFERENCE_JOINED),n.addListener(w.default.MUC_JOINED,function(){e.conference.isJvbConnectionInterrupted=!1,Object.keys(n.connectionTimes).forEach(function(e){var t=n.connectionTimes[e];T.default.analytics.sendEvent("conference."+e,{value:t})}),Object.keys(n.xmpp.connectionTimes).forEach(function(e){var t=n.xmpp.connectionTimes[e];T.default.analytics.sendEvent("xmpp."+e,{value:t})})}),this.chatRoomForwarder.forward(w.default.ROOM_JOIN_ERROR,v.CONFERENCE_FAILED,h.CONNECTION_ERROR),this.chatRoomForwarder.forward(w.default.ROOM_CONNECT_ERROR,v.CONFERENCE_FAILED,h.CONNECTION_ERROR),this.chatRoomForwarder.forward(w.default.ROOM_CONNECT_NOT_ALLOWED_ERROR,v.CONFERENCE_FAILED,h.NOT_ALLOWED_ERROR),this.chatRoomForwarder.forward(w.default.ROOM_MAX_USERS_ERROR,v.CONFERENCE_FAILED,h.CONFERENCE_MAX_USERS),this.chatRoomForwarder.forward(w.default.PASSWORD_REQUIRED,v.CONFERENCE_FAILED,h.PASSWORD_REQUIRED),this.chatRoomForwarder.forward(w.default.AUTHENTICATION_REQUIRED,v.CONFERENCE_FAILED,h.AUTHENTICATION_REQUIRED),this.chatRoomForwarder.forward(w.default.BRIDGE_DOWN,v.CONFERENCE_FAILED,h.VIDEOBRIDGE_NOT_AVAILABLE),n.addListener(w.default.BRIDGE_DOWN,function(){return T.default.analytics.sendEvent("conference.bridgeDown")}),this.chatRoomForwarder.forward(w.default.RESERVATION_ERROR,v.CONFERENCE_FAILED,h.RESERVATION_ERROR),this.chatRoomForwarder.forward(w.default.GRACEFUL_SHUTDOWN,v.CONFERENCE_FAILED,h.GRACEFUL_SHUTDOWN),n.addListener(w.default.JINGLE_FATAL_ERROR,function(e,n){e.isP2P||t.eventEmitter.emit(v.CONFERENCE_FAILED,h.JINGLE_FATAL_ERROR,n)}),n.addListener(w.default.CONNECTION_ICE_FAILED,function(e){t._onIceConnectionFailed(e)}),this.chatRoomForwarder.forward(w.default.MUC_DESTROYED,v.CONFERENCE_FAILED,h.CONFERENCE_DESTROYED),this.chatRoomForwarder.forward(w.default.CHAT_ERROR_RECEIVED,v.CONFERENCE_ERROR,h.CHAT_ERROR),this.chatRoomForwarder.forward(w.default.FOCUS_DISCONNECTED,v.CONFERENCE_FAILED,h.FOCUS_DISCONNECTED),n.addListener(w.default.FOCUS_LEFT,function(){T.default.analytics.sendEvent("conference.focusLeft"),t.eventEmitter.emit(v.CONFERENCE_FAILED,h.FOCUS_LEFT)});var r=function(e){return T.default.sendEventToAll("conference.error."+e)};n.addListener(w.default.SESSION_ACCEPT_TIMEOUT,function(e){r(e.isP2P?"p2pSessionAcceptTimeout":"sessionAcceptTimeout")}),this.chatRoomForwarder.forward(w.default.RECORDER_STATE_CHANGED,v.RECORDER_STATE_CHANGED),this.chatRoomForwarder.forward(w.default.VIDEO_SIP_GW_AVAILABILITY_CHANGED,v.VIDEO_SIP_GW_AVAILABILITY_CHANGED),this.chatRoomForwarder.forward(w.default.PHONE_NUMBER_CHANGED,v.PHONE_NUMBER_CHANGED),n.addListener(w.default.CONFERENCE_SETUP_FAILED,function(e,n){e.isP2P||t.eventEmitter.emit(v.CONFERENCE_FAILED,h.SETUP_FAILED,n)}),n.setParticipantPropertyListener(function(e,n){var r=t.getParticipantById(n);r&&r.setProperty(e.tagName.substring("jitsi_participant_".length),e.value)}),this.chatRoomForwarder.forward(w.default.KICKED,v.KICKED),n.addListener(w.default.KICKED,function(){t.room=null,t.leave()}),n.addListener(w.default.SUSPEND_DETECTED,t.onSuspendDetected.bind(t)),this.chatRoomForwarder.forward(w.default.MUC_LOCK_CHANGED,v.LOCK_STATE_CHANGED),n.addListener(w.default.MUC_MEMBER_JOINED,t.onMemberJoined.bind(t)),n.addListener(w.default.MUC_MEMBER_LEFT,t.onMemberLeft.bind(t)),this.chatRoomForwarder.forward(w.default.MUC_LEFT,v.CONFERENCE_LEFT),n.addListener(w.default.DISPLAY_NAME_CHANGED,t.onDisplayNameChanged.bind(t)),n.addListener(w.default.LOCAL_ROLE_CHANGED,function(e){t.onLocalRoleChanged(e),t.statistics&&t.isModerator()&&t.on(v.RECORDER_STATE_CHANGED,function(e,t){var n={id:"recorder_status",status:e};t&&(n.error=t),T.default.sendLog(JSON.stringify(n))})}),n.addListener(w.default.MUC_ROLE_CHANGED,t.onUserRoleChanged.bind(t)),n.addListener(u.default.IDENTITY_UPDATED,function(e,n){t.authEnabled=e,t.authIdentity=n,t.eventEmitter.emit(v.AUTH_STATUS_CHANGED,e,n)}),n.addListener(w.default.MESSAGE_RECEIVED,function(e,n,r,i,o){var a=Strophe.getResourceFromJid(e);t.eventEmitter.emit(v.MESSAGE_RECEIVED,a,r,o)}),n.addListener(w.default.PRESENCE_STATUS,function(e,n){var r=Strophe.getResourceFromJid(e),i=t.getParticipantById(r);i&&i._status!==n&&(i._status=n,t.eventEmitter.emit(v.USER_STATUS_CHANGED,r,n))}),n.addPresenceListener("startmuted",function(e,n){var r=!1;if(t.myUserId()===n&&t.isModerator())r=!0;else{var i=t.getParticipantById(n);i&&i.isModerator()&&(r=!0)}if(r){var o="true"===e.attributes.audio,a="true"===e.attributes.video,s=!1;o!==t.startMutedPolicy.audio&&(t.startMutedPolicy.audio=o,s=!0),a!==t.startMutedPolicy.video&&(t.startMutedPolicy.video=a,s=!0),s&&t.eventEmitter.emit(v.START_MUTED_POLICY_CHANGED,t.startMutedPolicy)}}),n.addPresenceListener("devices",function(e,n){var r=!1,i=!1;e.children.forEach(function(e){"audio"===e.tagName&&(r="true"===e.value),"video"===e.tagName&&(i="true"===e.value)});var o=void 0;if(t.myUserId()===n)o=t.availableDevices;else{var a=t.getParticipantById(n);if(!a)return;o=a._availableDevices}var s=!1;o.audio!==r&&(s=!0,o.audio=r),o.video!==i&&(s=!0,o.video=i),s&&t.eventEmitter.emit(v.AVAILABLE_DEVICES_CHANGED,n,o)}),t.statistics&&(n.addListener(w.default.CONNECTION_ICE_FAILED,function(e){t.statistics.sendIceConnectionFailedEvent(e.peerconnection)}),n.addListener(w.default.ADD_ICE_CANDIDATE_FAILED,function(e,n){t.statistics.sendAddIceCandidateFailed(e,n)}))},o.prototype.setupRTCListeners=function(){var e=this.conference,t=e.rtc;t.addListener(E.default.REMOTE_TRACK_ADDED,e.onRemoteTrackAdded.bind(e)),t.addListener(E.default.REMOTE_TRACK_REMOVED,e.onRemoteTrackRemoved.bind(e)),t.addListener(E.default.DOMINANT_SPEAKER_CHANGED,function(t){e.lastDominantSpeaker!==t&&e.room&&(e.lastDominantSpeaker=t,e.eventEmitter.emit(v.DOMINANT_SPEAKER_CHANGED,t)),e.statistics&&e.myUserId()===t&&e.statistics.sendDominantSpeakerEvent()}),t.addListener(E.default.DATA_CHANNEL_OPEN,function(){var t=window.performance.now();_.log("(TIME) data channel opened ",t),e.room.connectionTimes["data.channel.opened"]=t,T.default.analytics.sendEvent("conference.dataChannel.open",{value:t})}),t.addListener(E.default.AVAILABLE_DEVICES_CHANGED,function(t){return e.room.updateDeviceAvailability(t)}),t.addListener(E.default.ENDPOINT_MESSAGE_RECEIVED,function(t,n){var r=e.getParticipantById(t);r?e.eventEmitter.emit(v.ENDPOINT_MESSAGE_RECEIVED,r,n):_.warn("Ignored ENDPOINT_MESSAGE_RECEIVED for not existing participant: "+t,n)}),t.addListener(E.default.LOCAL_UFRAG_CHANGED,function(e,t){e.isP2P||T.default.sendLog(JSON.stringify({id:"local_ufrag",value:t}))}),t.addListener(E.default.REMOTE_UFRAG_CHANGED,function(e,t){e.isP2P||T.default.sendLog(JSON.stringify({id:"remote_ufrag",value:t}))}),e.statistics&&(t.addListener(E.default.CREATE_ANSWER_FAILED,function(t,n){e.statistics.sendCreateAnswerFailed(t,n)}),t.addListener(E.default.CREATE_OFFER_FAILED,function(t,n){e.statistics.sendCreateOfferFailed(t,n)}),t.addListener(E.default.SET_LOCAL_DESCRIPTION_FAILED,function(t,n){e.statistics.sendSetLocalDescFailed(t,n)}),t.addListener(E.default.SET_REMOTE_DESCRIPTION_FAILED,function(t,n){e.statistics.sendSetRemoteDescFailed(t,n)}))},o.prototype.setupXMPPListeners=function(){var e=this.conference;e.xmpp.caps.addListener(w.default.PARTCIPANT_FEATURES_CHANGED,function(t){var n=e.getParticipantId(Strophe.getResourceFromJid(t));n&&e.eventEmitter.emit(v.PARTCIPANT_FEATURES_CHANGED,n)}),e.xmpp.addListener(w.default.CALL_INCOMING,e.onIncomingCall.bind(e)),e.xmpp.addListener(w.default.CALL_ACCEPTED,e.onCallAccepted.bind(e)),e.xmpp.addListener(w.default.TRANSPORT_INFO,e.onTransportInfo.bind(e)),e.xmpp.addListener(w.default.CALL_ENDED,e.onCallEnded.bind(e)),e.xmpp.addListener(w.default.START_MUTED_FROM_FOCUS,function(t,n){e.options.config.ignoreStartMuted||(e.startAudioMuted=t,e.startVideoMuted=n,e.getLocalTracks().forEach(function(t){switch(t.getType()){case y.AUDIO:e.startAudioMuted&&t.mute();break;case y.VIDEO:e.startVideoMuted&&t.mute()}}),e.eventEmitter.emit(v.STARTED_MUTED))})},o.prototype.setupStatisticsListeners=function(){var e=this.conference;e.statistics&&(e.statistics.addAudioLevelListener(function(t,n){e.rtc.setAudioLevel(t,n)}),e.statistics.addBeforeDisposedListener(function(){e.eventEmitter.emit(v.BEFORE_STATISTICS_DISPOSED)}),e.statistics.addConnectionStatsListener(function(t){t.resolution=a(e,t.resolution),t.framerate=s(e,t.framerate),e.eventEmitter.emit(v.CONNECTION_STATS,t)}),e.statistics.addByteSentStatsListener(function(t,n){e.getLocalTracks(y.AUDIO).forEach(function(e){var r=t.getLocalSSRC(e);r&&n.hasOwnProperty(r)&&e._setByteSent(t,n[r])})}))}}).call(t,"JitsiConferenceEventManager.js")},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){this.appID=e,this.token=t,this.options=n,this.xmpp=new p.default(n,t),this.addEventListener(u.CONNECTION_FAILED,function(e,t){d.default.sendEventToAll("connection.failed."+e,{label:t})}),this.addEventListener(u.CONNECTION_DISCONNECTED,function(e){e&&d.default.analytics.sendEvent("connection.disconnected."+e),d.default.sendLog(JSON.stringify({id:"connection.disconnected",msg:e}))})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var a=n(73),s=i(a),c=n(29),u=r(c),l=n(6),d=i(l),f=n(123),p=i(f);o.prototype.connect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.xmpp.connect(e.id,e.password)},o.prototype.attach=function(e){this.xmpp.attach(e)},o.prototype.disconnect=function(){var e;(e=this.xmpp).disconnect.apply(e,arguments)},o.prototype.setToken=function(e){this.token=e},o.prototype.initJitsiConference=function(e,t){return new s.default({name:e,config:t,connection:this})},o.prototype.addEventListener=function(e,t){this.xmpp.addListener(e,t)},o.prototype.removeEventListener=function(e,t){this.xmpp.removeListener(e,t)},o.prototype.getConnectionTimes=function(){return this.xmpp.connectionTimes},o.prototype.addFeature=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.xmpp.caps.addFeature(e,t)},o.prototype.removeFeature=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.xmpp.caps.removeFeature(e,t)}},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=t.find(function(t){return"audiooutput"===t.kind&&t.deviceId===e});n&&b.default.sendActiveDeviceListEvent(p.default.getEventDataForActiveDevice(n))}Object.defineProperty(t,"__esModule",{value:!0});var a=n(17),s=i(a),c=n(42),u=r(c),l=n(5),d=r(l),f=n(20),p=i(f),h=n(2),m=i(h),v=n(9),g=i(v),y=n(6),b=i(y),E=new s.default,S={enumerateDevices:function(e){p.default.enumerateDevices(e)},isDeviceListAvailable:function(){return p.default.isDeviceListAvailable()},isDeviceChangeAvailable:function(e){return p.default.isDeviceChangeAvailable(e)},isDevicePermissionGranted:function(e){var t=p.default.getDeviceAvailability();switch(e){case d.VIDEO:return t.video===!0;case d.AUDIO:return t.audio===!0;default:return t.video===!0&&t.audio===!0}},isMultipleAudioInputSupported:function(){return!m.default.isFirefox()},getAudioOutputDevice:function(){return p.default.getAudioOutputDevice()},setAudioOutputDevice:function(e){var t=p.default.getCurrentlyAvailableMediaDevices();return t&&t.length>0&&o(e,p.default.getCurrentlyAvailableMediaDevices()),p.default.setAudioOutputDevice(e)},addEventListener:function(e,t){E.addListener(e,t)},removeEventListener:function(e,t){E.removeListener(e,t)},emitEvent:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];E.emit.apply(E,[e].concat(n))}};p.default.addListener(g.default.DEVICE_LIST_CHANGED,function(e){return E.emit(u.DEVICE_LIST_CHANGED,e)}),p.default.addListener(g.default.DEVICE_LIST_AVAILABLE,function(e){return o(S.getAudioOutputDevice(),e)}),t.default=S},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(8),s=r(a),c=n(30),u=n(5),l=r(u),d=function(){function e(t,n,r,o){i(this,e),this._jid=t,this._id=Strophe.getResourceFromJid(t),this._conference=n,this._displayName=r,this._supportsDTMF=!1,this._tracks=[],this._role="none",this._status=null,this._availableDevices={audio:void 0,video:void 0},this._hidden=o,this._connectionStatus=c.ParticipantConnectionStatus.ACTIVE,this._properties={}}return o(e,[{key:"getConference",value:function(){return this._conference}},{key:"getProperty",value:function(e){return this._properties[e]}},{key:"hasAnyVideoTrackWebRTCMuted",value:function(){return this.getTracks().some(function(e){return e.getType()===l.VIDEO&&e.isWebRTCTrackMuted()})}},{key:"_setConnectionStatus",value:function(e){this._connectionStatus=e}},{key:"getConnectionStatus",value:function(){return this._connectionStatus}},{key:"setProperty",value:function(e,t){var n=this._properties[e];t!==n&&(this._properties[e]=t,this._conference.eventEmitter.emit(s.PARTICIPANT_PROPERTY_CHANGED,this,e,n,t))}},{key:"getTracks",value:function(){return this._tracks.slice()}},{key:"getId",value:function(){return this._id}},{key:"getJid",value:function(){return this._jid}},{key:"getDisplayName",value:function(){return this._displayName}},{key:"getStatus",value:function(){return this._status}},{key:"isModerator",value:function(){return"moderator"===this._role}},{key:"isHidden",value:function(){return this._hidden}},{key:"isAudioMuted",value:function(){return this._isMediaTypeMuted(l.AUDIO)}},{key:"_isMediaTypeMuted",value:function(e){return this.getTracks().reduce(function(t,n){return t&&(n.getType()!==e||n.isMuted())},!0)}},{key:"isVideoMuted",value:function(){return this._isMediaTypeMuted(l.VIDEO)}},{key:"getRole",value:function(){return this._role}},{key:"supportsDTMF",value:function(){return this._supportsDTMF}},{key:"getFeatures",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;return this._conference.xmpp.caps.getFeatures(this._jid,e)}}]),e}();t.default=d},function(e,t,n){(function(e){"use strict";function t(e,t){var n=e.getTrack();if(!n)throw new Error("Failed to initialize DTMFSender: no audio track.");this.dtmfSender=t.peerconnection.createDTMFSender(n),r.debug("Initialized DTMFSender")}var r=n(1).getLogger(e);t.prototype.sendTones=function(e,t,n){this.dtmfSender.insertDTMF(e,t||200,n||200)}}).call(t,"modules/DTMF/JitsiDTMFManager.js")},function(e,t,n){(function(t){"use strict";function r(e,t){e.ondatachannel=this.onDataChannel.bind(this),this.eventEmitter=t,this._dataChannels=[]}var i=n(1).getLogger(t),o=n(9),a=n(3);r.prototype.onDataChannel=function(e){var t=e.channel,n=this;t.onopen=function(){i.info("Data channel opened by the Videobridge!",t),n.eventEmitter.emit(o.DATA_CHANNEL_OPEN)},t.onerror=function(e){i.error("Data Channel Error:",e,t)},t.onmessage=function(e){var r=e.data,s=void 0;try{s=JSON.parse(r)}catch(e){a.callErrorHandler(e),i.error("Failed to parse data channel message as JSON: ",r,t,e)}if("undefined"!=typeof s&&null!==s){var c=s.colibriClass;if("DominantSpeakerEndpointChangeEvent"===c){var u=s.dominantSpeakerEndpoint;i.info("Data channel new dominant speaker event: ",u),n.eventEmitter.emit(o.DOMINANT_SPEAKER_CHANGED,u)}else if("LastNEndpointsChangeEvent"===c){var l=s.lastNEndpoints;i.info("Data channel new last-n event: ",l,s),n.eventEmitter.emit(o.LASTN_ENDPOINT_CHANGED,l,s)}else if("EndpointMessage"===c)n.eventEmitter.emit(o.ENDPOINT_MESSAGE_RECEIVED,s.from,s.msgPayload);else if("EndpointConnectivityStatusChangeEvent"===c){var d=s.endpoint,f="true"===s.active;i.info("Endpoint connection status changed: "+d+" active ? "+f),n.eventEmitter.emit(o.ENDPOINT_CONN_STATUS_CHANGED,d,f)}else i.debug("Data channel JSON-formatted message: ",s),n.eventEmitter.emit("rtc.datachannel."+c,s)}},t.onclose=function(){i.info("The Data Channel closed",t);var e=n._dataChannels.indexOf(t);e>-1&&(n._dataChannels=n._dataChannels.splice(e,1))},this._dataChannels.push(t)},r.prototype.closeAllChannels=function(){this._dataChannels.forEach(function(e){e.close()})},r.prototype.sendSelectedEndpointMessage=function(e){this._onXXXEndpointChanged("selected",e)},r.prototype.sendPinnedEndpointMessage=function(e){this._onXXXEndpointChanged("pinned",e)},r.prototype._onXXXEndpointChanged=function(e,t){var n=e.charAt(0),r=e.substring(1),o=n.toLowerCase()+r,a=n.toUpperCase()+r;i.log("sending "+o+" endpoint changed notification to the bridge: ",t);var s={};s.colibriClass=a+"EndpointChangedEvent",s[o+"Endpoint"]=t?t:null,this.send(s),i.log(o+" endpoint changed: ",t)},r.prototype._some=function(e,t){var n=this._dataChannels;return!(!n||0===n.length)&&(t?n.some(e,t):n.some(e))},r.prototype.send=function(e){if(!this._some(function(t){if("open"===t.readyState)return t.send(JSON.stringify(e)),!0}))throw new Error("No opened data channels found!")},r.prototype.sendDataChannelMessage=function(e,t){this.send({colibriClass:"EndpointMessage",to:e,msgPayload:t})},r.prototype.sendSetLastNMessage=function(e){var t={colibriClass:"LastNChangedEvent",lastN:e};this.send(t),i.log("Channel lastN set to: "+e)},e.exports=r}).call(t,"modules/RTC/DataChannels.js")},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,r,i,o,a,s){var c=this;this.rtcId=e,d.default.call(this,null,t,n,function(){c.dontFireRemoveEvent||c.eventEmitter.emit(g.LOCAL_TRACK_STOPPED),c.dontFireRemoveEvent=!1},r,i),this.dontFireRemoveEvent=!1,this.resolution=o,S.default.isFirefox()&&(this.resolution=null),this.deviceId=a,this.storedMSID=this.getMSID(),this.inMuteOrUnmuteProgress=!1,this._facingMode=s,this._trackEnded=!1,this._bytesSent=null,this._testByteSent=!0,this._realDeviceId=""===this.deviceId?void 0:this.deviceId,this.stopStreamInProgress=!1,this._noDataFromSourceTimeout=null,this._onDeviceListChanged=function(e){c._setRealDeviceIdFromDeviceList(e),"undefined"!=typeof c.getTrack().readyState||"undefined"==typeof c._realDeviceId||e.find(function(e){return e.deviceId===c._realDeviceId})||(c._trackEnded=!0)},this.isAudioTrack()&&_.default.isDeviceChangeAvailable("output")&&(this._onAudioOutputDeviceChanged=this.setAudioOutput.bind(this),_.default.addListener(C.default.AUDIO_OUTPUT_DEVICE_CHANGED,this._onAudioOutputDeviceChanged)),_.default.addListener(C.default.DEVICE_LIST_CHANGED,this._onDeviceListChanged),this._initNoDataFromSourceHandlers()}function a(e,t){return e.inMuteOrUnmuteProgress?Promise.reject(new p.default(m.TRACK_MUTE_UNMUTE_IN_PROGRESS)):(e.inMuteOrUnmuteProgress=!0,e._setMute(t).then(function(){e.inMuteOrUnmuteProgress=!1}).catch(function(t){throw e.inMuteOrUnmuteProgress=!1,t}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var s=n(49),c=i(s),u=n(1),l=n(44),d=i(l),f=n(12),p=i(f),h=n(13),m=r(h),v=n(14),g=r(v),y=n(5),b=r(y),E=n(2),S=i(E),T=n(9),C=i(T),w=n(21),_=i(w),R=n(6),A=i(R),k=n(19),O=i(k),I=(0,u.getLogger)(e);o.prototype=Object.create(d.default.prototype),o.prototype.constructor=o,o.prototype.isEnded=function(){return"ended"===this.getTrack().readyState||this._trackEnded},o.prototype._initNoDataFromSourceHandlers=function(){var e=this;if(this.isVideoTrack()&&this.videoType===O.default.CAMERA){var t=this._onNoDataFromSourceError.bind(this);this._setHandler("track_mute",function(){if(e._checkForCameraIssues()){var n=window.performance.now();e._noDataFromSourceTimeout=setTimeout(t,3e3),e._setHandler("track_unmute",function(){e._clearNoDataFromSourceMuteResources(),A.default.sendEventToAll(e.getType()+".track_unmute",{value:window.performance.now()-n})})}}),this._setHandler("track_ended",t)}},o.prototype._clearNoDataFromSourceMuteResources=function(){this._noDataFromSourceTimeout&&(clearTimeout(this._noDataFromSourceTimeout),this._noDataFromSourceTimeout=null),this._setHandler("track_unmute",void 0)},o.prototype._onNoDataFromSourceError=function(){this._clearNoDataFromSourceMuteResources(),this._checkForCameraIssues()&&this._fireNoDataFromSourceEvent()},o.prototype._fireNoDataFromSourceEvent=function(){this.eventEmitter.emit(g.NO_DATA_FROM_SOURCE);var e=this.getType()+".no_data_from_source";A.default.analytics.sendEvent(e);var t={name:e};this.isAudioTrack()&&(t.isReceivingData=this._isReceivingData()),A.default.sendLog(JSON.stringify(t));
},o.prototype._setRealDeviceIdFromDeviceList=function(e){var t=this.getTrack(),n=e.find(function(e){return e.kind===t.kind+"input"&&e.label===t.label});n&&(this._realDeviceId=n.deviceId)},o.prototype._setStream=function(e){d.default.prototype._setStream.call(this,e),e?(this.storedMSID=this.getMSID(),I.debug("Setting new MSID: "+this.storedMSID+" on "+this)):I.debug("Setting 'null' stream on "+this)},o.prototype.mute=function(){return a(this,!0)},o.prototype.unmute=function(){return a(this,!1)},o.prototype._setMute=function(e){var t=this;if(this.isMuted()===e)return Promise.resolve();var n=Promise.resolve(),r=this;this.dontFireRemoveEvent=!1;var i=function(){return I.info("Mute "+t+": "+e)};if(this.isAudioTrack()||this.videoType===O.default.DESKTOP||!S.default.doesVideoMuteByStreamRemove())i(),this.track&&(this.track.enabled=!e);else if(e)this.dontFireRemoveEvent=!0,n=new Promise(function(e,n){i(),t._removeStreamFromConferenceAsMute(function(){t._stopMediaStream(),t._setStream(null),e()},function(e){n(e)})});else{i();var o={cameraDeviceId:this.getDeviceId(),devices:[b.VIDEO],facingMode:this.getCameraFacingMode()};this.resolution&&(o.resolution=this.resolution),n=_.default.obtainAudioAndVideoPermissions(o).then(function(e){var n=r.getType(),i=e.find(function(e){return e.mediaType===n});if(!i)throw new p.default(m.TRACK_NO_STREAM_FOUND);return r._setStream(i.stream),r.track=i.track,r.videoType!==i.videoType&&(I.warn(t+": video type has changed after unmute!",r.videoType,i.videoType),r.videoType=i.videoType),r.containers=r.containers.map(function(e){return _.default.attachMediaStream(e,r.stream)}),r._addStreamToConferenceAsUnmute()})}return n.then(function(){return t._sendMuteStatus(e)}).then(function(){t.eventEmitter.emit(g.TRACK_MUTE_CHANGED,t)})},o.prototype._addStreamToConferenceAsUnmute=function(){var e=this;return this.conference?new Promise(function(t,n){e.conference._addLocalTrackAsUnmute(e).then(t,function(e){return n(new Error(e))})}):Promise.resolve()},o.prototype._removeStreamFromConferenceAsMute=function(e,t){return this.conference?void this.conference._removeLocalTrackAsMute(this).then(e,function(e){return t(new Error(e))}):void e()},o.prototype._sendMuteStatus=function(e){var t=this;return this.conference&&this.conference.room?new Promise(function(n){t.conference.room[t.isAudioTrack()?"setAudioMute":"setVideoMute"](e,n)}):Promise.resolve()},o.prototype.dispose=function(){var e=this,t=Promise.resolve();return this.conference&&(t=this.conference.removeTrack(this)),this.stream&&(this._stopMediaStream(),this.detach()),_.default.removeListener(C.default.DEVICE_LIST_CHANGED,this._onDeviceListChanged),this._onAudioOutputDeviceChanged&&_.default.removeListener(C.default.AUDIO_OUTPUT_DEVICE_CHANGED,this._onAudioOutputDeviceChanged),t.then(function(){return d.default.prototype.dispose.call(e)})},o.prototype.isMuted=function(){return!(this.stream&&(!this.isVideoTrack()||this.isActive())&&this.track&&this.track.enabled)},o.prototype._setConference=function(e){this.conference=e;for(var t=0;t<this.containers.length;t++)this._maybeFireTrackAttached(this.containers[t])},o.prototype.isLocal=function(){return!0},o.prototype.getDeviceId=function(){return this._realDeviceId||this.deviceId},o.prototype.getParticipantId=function(){return this.conference&&this.conference.myUserId()},o.prototype._setByteSent=function(e,t){var n=this;this._bytesSent=t;var r=e.getConnectionState();this._testByteSent&&"connected"===r&&(setTimeout(function(){n._bytesSent<=0&&(I.warn(n+" 'bytes sent' <= 0: "+n._bytesSent),n._fireNoDataFromSourceEvent())},3e3),this._testByteSent=!1)},o.prototype.getCameraFacingMode=function(){if(this.isVideoTrack()&&this.videoType===O.default.CAMERA){var e=void 0;try{e=this.track.getSettings()}catch(e){}return e&&"facingMode"in e?e.facingMode:"undefined"!=typeof this._facingMode?this._facingMode:c.default.USER}},o.prototype._stopMediaStream=function(){this.stopStreamInProgress=!0,_.default.stopMediaStream(this.stream),this.stopStreamInProgress=!1},o.prototype._switchCamera=function(){this.isVideoTrack()&&this.videoType===O.default.CAMERA&&"function"==typeof this.track._switchCamera&&(this.track._switchCamera(),this._facingMode=this._facingMode===c.default.ENVIRONMENT?c.default.USER:c.default.ENVIRONMENT)},o.prototype._checkForCameraIssues=function(){return!(!this.isVideoTrack()||this.stopStreamInProgress||this.videoType===O.default.DESKTOP||this._isReceivingData())},o.prototype._isReceivingData=function(){return!!this.stream&&this.stream.getTracks().some(function(e){return!("readyState"in e&&"live"!==e.readyState||"muted"in e&&e.muted===!0)})},o.prototype.toString=function(){return"LocalTrack["+this.rtcId+","+this.getType()+"]"}}).call(t,"modules/RTC/JitsiLocalTrack.js")},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,r,i,o,a,c,u,l){s.default.call(this,t,r,i,function(){},o,a),this.rtc=e,this.ssrc=c,this.ownerEndpointId=n,this.muted=u,this.isP2P=l,this.hasBeenMuted=u,this.rtc&&this.track&&this._bindMuteHandlers()}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var a=n(44),s=i(a),c=n(14),u=r(c),l=n(2),d=i(l),f=n(6),p=i(f),h=n(1).getLogger(e),m=n(9),v=!1,g=!1;o.prototype=Object.create(s.default.prototype),o.prototype.constructor=o,o.prototype._bindMuteHandlers=function(){var e=this;this.track.addEventListener("mute",function(){h.debug('"onmute" event('+Date.now()+"): ",e.getParticipantId(),e.getType(),e.getSSRC()),e.rtc.eventEmitter.emit(m.REMOTE_TRACK_MUTE,e)}),this.track.addEventListener("unmute",function(){h.debug('"onunmute" event('+Date.now()+"): ",e.getParticipantId(),e.getType(),e.getSSRC()),e.rtc.eventEmitter.emit(m.REMOTE_TRACK_UNMUTE,e)})},o.prototype.setMute=function(e){this.muted!==e&&(e&&(this.hasBeenMuted=!0),this.stream&&(this.stream.muted=e),this.muted=e,this.eventEmitter.emit(u.TRACK_MUTE_CHANGED,this))},o.prototype.isMuted=function(){return this.muted},o.prototype.getParticipantId=function(){return this.ownerEndpointId},o.prototype.isLocal=function(){return!1},o.prototype.getSSRC=function(){return this.ssrc},o.prototype._setVideoType=function(e){this.videoType!==e&&(this.videoType=e,this.eventEmitter.emit(u.TRACK_VIDEOTYPE_CHANGED,e))},o.prototype._playCallback=function(){var e=this.isVideoTrack()?"video":"audio",t=window.performance.now();console.log("(TIME) Render "+e+":\t",t),this.conference.getConnectionTimes()[e+".render"]=t;var n=t-(this.conference.getConnectionTimes()["session.initiate"]-this.conference.getConnectionTimes()["muc.joined"])-(window.connectionTimes["obtainPermissions.end"]-window.connectionTimes["obtainPermissions.start"]);this.conference.getConnectionTimes()[e+".ttfm"]=n,console.log("(TIME) TTFM "+e+":\t",n);var r=e+".ttfm";this.hasBeenMuted&&(r+=".muted"),p.default.analytics.sendEvent(r,{value:n})},o.prototype._attachTTFMTracker=function(e){if(!(v&&this.isAudioTrack()||g&&this.isVideoTrack()))if(this.isAudioTrack()&&(v=!0),this.isVideoTrack()&&(g=!0),d.default.isTemasysPluginUsed()){var t=n(27);t.addEvent(e,"play",this._playCallback.bind(this))}else e.addEventListener("canplay",this._playCallback.bind(this))},o.prototype.toString=function(){return"RemoteTrack["+this.ownerEndpointId+", "+this.getType()+", p2p: "+this.isP2P+"]"}}).call(t,"modules/RTC/JitsiRemoteTrack.js")},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(5),c=r(s),u=n(24),l=(0,a.getLogger)(e),d=function(){function e(t){i(this,e),this.tpc=t}return o(e,[{key:"_addMutedLocalVideoTracksToSDP",value:function(e){var t=this.tpc.getLocalTracks(c.VIDEO);if(!t.length)return!1;1!==t.length&&l.error(this.tpc+" there is more than 1 video track ! Strange things may happen !",t);var n=e.selectMedia("video");if(!n)return l.error(this.tpc+' unable to hack local video track SDP- no "video" media'),!1;var r=!1,i=!0,o=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var d=s.value,f=d.isMuted(),p=d.inMuteOrUnmuteProgress,h=f||p;if(l.debug(this.tpc+" "+d+" isMuted: "+f+", is mute in progress: "+p+" => should fake sdp ? : "+h),h){var m=this.tpc.isSimulcastOn()?this.tpc.simulcast.ssrcCache:[this.tpc.sdpConsistency.cachedPrimarySsrc];if(m.length){r=!0,n.direction="sendrecv";var v=m[0],g="injected-"+v,y=!0,b=!1,E=void 0;try{for(var S,T=m[Symbol.iterator]();!(y=(S=T.next()).done);y=!0){var C=S.value;n.removeSSRC(C),l.debug(this.tpc+" injecting video SSRC: "+(C+" for "+d)),n.addSSRCAttribute({id:C,attribute:"cname",value:g}),n.addSSRCAttribute({id:C,attribute:"msid",value:d.storedMSID})}}catch(e){b=!0,E=e}finally{try{!y&&T.return&&T.return()}finally{if(b)throw E}}if(m.length>1){var w={ssrcs:m.join(" "),semantics:"SIM"};n.findGroup(w.semantics,w.ssrcs)||(l.debug(this.tpc+" injecting SIM group for "+d,w),n.addSSRCGroup(w))}this.tpc.options.disableRtx||this.tpc.rtxModifier.modifyRtxSsrcs2(n)}else l.error("No SSRCs stored for: "+d+" in "+this.tpc)}}}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}return r}},{key:"maybeMungeLocalSdp",value:function(e){if(e&&e.sdp){var t=new u.SdpTransformWrap(e.sdp);this._addMutedLocalVideoTracksToSDP(t)&&(e.sdp=t.toRawSDP())}}}]),e}();t.default=d}).call(t,"modules/RTC/LocalSdpMunger.js")},function(e,t,n){(function(e,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=i(o),s=n(1).getLogger(e),c={getVideoElementName:function(){return a.default.isTemasysPluginUsed()?"object":"video"},findVideoElement:function(e){var t=c.getVideoElementName();if(!a.default.isTemasysPluginUsed())return r(e).find(t)[0];var n=r(e).find(" "+t+'>param[value="video"]');return n.length?(n.length>1&&s.warn("Container with more than one video elements: ",e),n.parent()[0]):void 0},setVolume:function(e,t){a.default.isIExplorer()||(e.volume=t)},setAutoPlay:function(e,t){a.default.isIExplorer()||(e.autoplay=t)}};t.default=c}).call(t,"modules/RTC/RTCUIHelper.js",n(4))},function(e,t,n){(function(e,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){k(["screen"],t,n)}function s(e){return"https://chrome.google.com/webstore/detail/"+e.desktopSharingChromeExtId}function c(e,t){try{for(var n=e.split("."),r=t.split("."),i=Math.max(n.length,r.length),o=0;o<i;o++){var a=0,s=0;if(o<n.length&&(a=parseInt(n[o],10)),o<r.length&&(s=parseInt(r[o],10)),isNaN(a)||isNaN(s))return!0;if(a!==s)return a>s}return!1}catch(e){return C.callErrorHandler(e),T.error("Failed to parse extension version",e),!0}}function u(e,t){return"undefined"!=typeof chrome&&chrome&&chrome.runtime?void chrome.runtime.sendMessage(t.desktopSharingChromeExtId,{getVersion:!0},function(n){if(!n||!n.version)return T.warn("Extension not installed?: ",chrome.runtime.lastError),void e(!1,!1);var r=n.version;T.log("Extension version is: "+r);var i=c(t.desktopSharingChromeMinExtVersion,r);e(!i,i)}):void e(!1,!1)}function l(e,t,n){chrome.runtime.sendMessage(e.desktopSharingChromeExtId,{getStream:!0,sources:e.desktopSharingChromeSources},function(e){if(!e){var r=chrome.runtime.lastError;return void n(r instanceof Error?r:new g.default(b.CHROME_EXTENSION_GENERIC_ERROR,r))}T.log("Response from extension: ",e),h(e,t,n)})}function d(e){0===r("link[rel=chrome-webstore-item]").length&&r("head").append('<link rel="chrome-webstore-item">'),r("link[rel=chrome-webstore-item]").attr("href",s(e))}function f(e){d(e),u(function(e,t){w=e,_=t,T.info("Chrome extension installed: "+w+" updateRequired: "+_)},e)}function p(e,t,n){return 0===n?Promise.reject():new Promise(function(r,i){var o=n,a=window.setInterval(function(){u(function(e){e?(window.clearInterval(a),r()):(o--,0===o&&(i(),window.clearInterval(a)))},e)},t)})}function h(e,t,n){if(e.streamId)k(["desktop"],function(e){return t(e)},n,{desktopStream:e.streamId});else{if(""===e.streamId)return void n(new g.default(b.CHROME_EXTENSION_USER_CANCELED));n(new g.default(b.CHROME_EXTENSION_GENERIC_ERROR,e.error))}}function m(e){if(!e.desktopSharingFirefoxDisabled&&R!==!1&&R!==!0){if(!e.desktopSharingFirefoxExtId)return void(R=!1);var t=document.createElement("img");t.onload=function(){T.log("Detected firefox screen sharing extension."),R=!0},t.onerror=function(){T.log("Detected lack of firefox screen sharing extension."),R=!1};var n="chrome://"+e.desktopSharingFirefoxExtId.replace("@",".")+"/content/"+document.location.hostname+".png";t.setAttribute("src",n)}}Object.defineProperty(t,"__esModule",{value:!0});var v=n(12),g=o(v),y=n(13),b=i(y),E=n(2),S=o(E),T=n(1).getLogger(e),C=n(3),w=!1,_=!1,R=null,A=!1,k=null,O="Inline installs can not be initiated from pop-up windows.",I="Chrome Web Store installations can only be started by the top frame.",P={obtainStream:null,init:function(e,t){var r=null;if(this.options=e=e||{},k=t,S.default.isFirefox()&&m(e),S.default.isNWJS())r=function(e,t,n){window.JitsiMeetNW.obtainDesktopStream(t,function(e,t){var r=void 0;r=e&&"InvalidStateError"===e.name?new g.default(b.CHROME_EXTENSION_USER_CANCELED):new g.default(e,t,["desktop"]),"function"==typeof n&&n(r)})};else if(S.default.isElectron())r=function(e,t,n){window.JitsiMeetScreenObtainer&&window.JitsiMeetScreenObtainer.openDesktopPicker?window.JitsiMeetScreenObtainer.openDesktopPicker(function(e){return h({streamId:e},t,n)},function(e){return n(new g.default(b.ELECTRON_DESKTOP_PICKER_ERROR,e))}):n(new g.default(b.ELECTRON_DESKTOP_PICKER_NOT_FOUND))};else if(S.default.isTemasysPluginUsed()){var i=n(27).WebRTCPlugin.plugin;i.HasScreensharingFeature?i.isScreensharingAvailable?(r=a,T.info("Using Temasys plugin for desktop sharing")):T.info("Screensharing not available with Temasys plugin on this site"):T.info("Screensharing not supported by this plugin version")}else S.default.isChrome()?e.desktopSharingChromeDisabled||e.desktopSharingChromeMethod===!1||!e.desktopSharingChromeExtId?r=null:S.default.getChromeVersion()>=34?(r=this.obtainScreenFromExtension,T.info("Using Chrome extension for desktop sharing"),f(e)):T.info("Chrome extension not supported until ver 34"):S.default.isFirefox()&&(e.desktopSharingFirefoxDisabled?r=null:"http:"===window.location.protocol?(T.log("Screen sharing is not supported over HTTP. Use of HTTPS is required."),r=null):r=this.obtainScreenOnFirefox);r||T.info("Desktop sharing disabled"),this.obtainStream=r},isSupported:function(){return null!==this.obtainStream},obtainScreenOnFirefox:function(e,t,n){var r=this,i=!1,o=this.options.desktopSharingFirefoxMaxVersionExtRequired;return(o===-1||o>=0&&S.default.getFirefoxVersion()<=o)&&(i=!0,T.log("Jidesha extension required on firefox version "+S.default.getFirefoxVersion())),i&&R!==!0?(A&&(A=!1,m(this.options)),null===R?(window.setTimeout(function(){null===R&&(R=!1),r.obtainScreenOnFirefox(t,n)},300),void T.log("Waiting for detection of jidesha on firefox to finish.")):(R=null,A=!0,void n(new g.default(b.FIREFOX_EXTENSION_NEEDED)))):void a(e,t,n)},obtainScreenFromExtension:function(e,t,n){var r=this;if(w)l(this.options,t,n);else{_&&alert("Jitsi Desktop Streamer requires update. Changes will take effect after next Chrome restart.");try{chrome.webstore.install(s(this.options),function(i){T.log("Extension installed successfully",i),w=!0,p(r.options,200,10).then(function(){l(r.options,t,n)}).catch(function(){r.handleExtensionInstallationError(e,t,n)})},this.handleExtensionInstallationError.bind(this,e,t,n))}catch(r){this.handleExtensionInstallationError(e,t,n,r)}}},handleExtensionInstallationError:function(e,t,n,r){var i=s(this.options);if((O===r||I===r)&&e.interval>0&&"function"==typeof e.checkAgain&&"function"==typeof e.listener)return e.listener("waitingForExtension",i),void this.checkForChromeExtensionOnInterval(e,t,n,r);var o="Failed to install the extension from "+i;T.log(o,r),n(new g.default(b.CHROME_EXTENSION_INSTALLATION_ERROR,o))},checkForChromeExtensionOnInterval:function(e,t,n){var r=this;return e.checkAgain()===!1?void n(new g.default(b.CHROME_EXTENSION_INSTALLATION_ERROR)):void p(this.options,e.interval,1).then(function(){w=!0,e.listener("extensionFound"),r.obtainScreenFromExtension(e,t,n)}).catch(function(){r.checkForChromeExtensionOnInterval(e,t,n)})}};t.default=P}).call(t,"modules/RTC/ScreenObtainer.js",n(4))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r,i,o,a,s){var c=this;this.mediaTransferActive=!0,this.rtc=e,this.id=t,this.isP2P=a,this.remoteTracks=new Map,this.localTracks=new Map,this.localSSRCs=new Map,this.localUfrag=null,this.remoteUfrag=null,this.signalingLayer=r,this._peerVideoTypeChanged=this._peerVideoTypeChanged.bind(this),this.signalingLayer.on(F.PEER_VIDEO_TYPE_CHANGED,this._peerVideoTypeChanged),this._peerMutedChanged=this._peerMutedChanged.bind(this),this.signalingLayer.on(F.PEER_MUTED_CHANGED,this._peerMutedChanged),this.options=s,this.peerconnection=new C.default.RTCPeerConnectionType(i,o),this.updateLog=[],this.stats={},this.statsinterval=null,this.maxstats=0;var u=n(147).Interop;this.interop=new u;var l=n(153);this.simulcast=new l({numOfLayers:B,explodeRemoteSimulcast:!1}),this.sdpConsistency=new N.default(this.toString()),this.localSdpMunger=new b.default(this),this.eventEmitter=e.eventEmitter,this.rtxModifier=new O.default,this.trace=function(e,t){c.updateLog.push({time:new Date,type:e,value:t||""})},this.onicecandidate=null,this.peerconnection.onicecandidate=function(e){_.default.isTemasysPluginUsed()||c.trace("onicecandidate",JSON.stringify(e.candidate,null," ")),null!==c.onicecandidate&&c.onicecandidate(e)},this.onaddstream=null,this.peerconnection.onaddstream=function(e){c.trace("onaddstream",e.stream.id),null!==c.onaddstream&&c.onaddstream(e)},this.onremovestream=null,this.peerconnection.onremovestream=function(e){c.trace("onremovestream",e.stream.id),null!==c.onremovestream&&c.onremovestream(e)},this.peerconnection.onaddstream=function(e){return c._remoteStreamAdded(e.stream)},this.peerconnection.onremovestream=function(e){return c._remoteStreamRemoved(e.stream)},this.onsignalingstatechange=null,this.peerconnection.onsignalingstatechange=function(e){c.trace("onsignalingstatechange",c.signalingState),null!==c.onsignalingstatechange&&c.onsignalingstatechange(e)},this.oniceconnectionstatechange=null,this.peerconnection.oniceconnectionstatechange=function(e){c.trace("oniceconnectionstatechange",c.iceConnectionState),null!==c.oniceconnectionstatechange&&c.oniceconnectionstatechange(e)},this.onnegotiationneeded=null,this.peerconnection.onnegotiationneeded=function(e){c.trace("onnegotiationneeded"),null!==c.onnegotiationneeded&&c.onnegotiationneeded(e)},this.ondatachannel=null,this.peerconnection.ondatachannel=function(e){c.trace("ondatachannel",e),null!==c.ondatachannel&&c.ondatachannel(e)},!_.default.isFirefox()&&this.maxstats&&(this.statsinterval=window.setInterval(function(){c.peerconnection.getStats(function(e){for(var t=e.result(),n=new Date,r=function(e){t[e].names().forEach(function(r){var i=t[e].id+"-"+r,o=c.stats[i];o||(c.stats[i]=o={startTime:n,endTime:n,values:[],times:[]}),o.values.push(t[e].stat(r)),o.times.push(n.getTime()),o.values.length>c.maxstats&&(o.values.shift(),o.times.shift()),o.endTime=n})},i=0;i<t.length;++i)r(i)})},1e3)),U.info("Create new "+this)}function a(e){var t=new Map,n=new Map;if("object"!==("undefined"==typeof e?"undefined":c(e))||null===e||"string"!=typeof e.sdp)return U.warn("An empty description was passed as an argument."),t;var r=d.default.parse(e.sdp);if(!Array.isArray(r.media))return t;var i=!0,o=!1,a=void 0;try{for(var s,u=r.media[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;if(Array.isArray(l.ssrcs)){if(Array.isArray(l.ssrcGroups)){var f=!0,p=!1,h=void 0;try{for(var m,v=l.ssrcGroups[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var g=m.value;if("undefined"!=typeof g.semantics&&"undefined"!=typeof g.ssrcs){var y=g.ssrcs.split(" ").map(function(e){return parseInt(e,10)}),b=y[0];g.ssrcs=y,n.has(b)||n.set(b,[]),n.get(b).push(g)}}}catch(e){p=!0,h=e}finally{try{!f&&v.return&&v.return()}finally{if(p)throw h}}}var E=!0,S=!1,T=void 0;try{for(var C,w=l.ssrcs[Symbol.iterator]();!(E=(C=w.next()).done);E=!0){var _=C.value;if("msid"===_.attribute){var R=_.value,A=t.get(R);A||(A={ssrcs:[],groups:[],msid:R},t.set(R,A));var k=_.id;if(A.ssrcs.push(k),n.has(k)){var O=n.get(k),I=!0,P=!1,D=void 0;try{for(var N,x=O[Symbol.iterator]();!(I=(N=x.next()).done);I=!0){var L=N.value;A.groups.push(L)}}catch(e){P=!0,D=e}finally{try{!I&&x.return&&x.return()}finally{if(P)throw D}}}}}}catch(e){S=!0,T=e}finally{try{!E&&w.return&&w.return()}finally{if(S)throw T}}}}}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}return t}function s(e){return e&&e.groups&&e.groups.length?e.groups[0].ssrcs[0]:e&&e.ssrcs&&e.ssrcs.length?e.ssrcs[0]:null}Object.defineProperty(t,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=o;var u=n(1),l=n(39),d=i(l),f=n(3),p=r(f),h=n(81),m=i(h),v=n(5),g=r(v),y=n(82),b=i(y),E=n(20),S=i(E),T=n(21),C=i(T),w=n(2),_=i(w),R=n(9),A=i(R),k=n(111),O=i(k),I=n(48),P=i(I),D=n(113),N=i(D),x=n(24),L=n(15),M=i(L),j=n(50),F=r(j),U=(0,u.getLogger)(e),B=3,J=function(e){return"undefined"==typeof e||null===e?"":"type: "+e.type+"\r\n"+e.sdp};o.prototype.getConnectionState=function(){var e=this.peerconnection.iceConnectionState;return"completed"===e?"connected":e},o.prototype._getDesiredMediaDirection=function(e){return this.mediaTransferActive?this.hasAnyTracksOfType(e)?"sendrecv":"recvonly":"inactive"},o.prototype.isSimulcastOn=function(){return!this.options.disableSimulcast&&_.default.supportsSimulcast()&&!this.isP2P},o.prototype._peerVideoTypeChanged=function(e,t){if(!e)return void U.error("No endpointID on peerVideoTypeChanged "+this);var n=this.getRemoteTracks(e,g.VIDEO);n.length&&n[0]._setVideoType(t)},o.prototype._peerMutedChanged=function(e,t,n){if(!e)return void U.error("On peerMuteChanged - no endpoint ID");var r=this.getRemoteTracks(e,t);r.length&&r[0].setMute(n)},o.prototype.getLocalTracks=function(e){var t=Array.from(this.localTracks.values());return void 0!==e&&(t=t.filter(function(t){return t.getType()===e})),t},o.prototype.hasAnyTracksOfType=function(e){if(!e)throw new Error('"mediaType" is required');return this.getLocalTracks(e).length>0},o.prototype.getRemoteTracks=function(e,t){var n=[],r=e?[e]:this.remoteTracks.keys(),i=!0,o=!1,a=void 0;try{for(var s,c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var u=s.value,l=this.remoteTracks.get(u);if(l){var d=!0,f=!1,p=void 0;try{for(var h,m=l.keys()[Symbol.iterator]();!(d=(h=m.next()).done);d=!0){var v=h.value;if(!t||t===v){var g=l.get(v);g&&n.push(g)}}}catch(e){f=!0,p=e}finally{try{!d&&m.return&&m.return()}finally{if(f)throw p}}}}}catch(e){o=!0,a=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw a}}return n},o.prototype._remoteStreamAdded=function(e){var t=this,n=S.default.getStreamID(e);if(!S.default.isUserStreamById(n))return void U.info(this+" ignored remote 'stream added' event for non-user streamid: "+n);(_.default.isChrome()||_.default.isNWJS()||_.default.isElectron())&&(e.onaddtrack=function(e){t._remoteTrackAdded(e.target,e.track)},e.onremovetrack=function(e){t._remoteTrackRemoved(e.target,e.track)});var r=e.getAudioTracks(),i=!0,o=!1,a=void 0;try{for(var s,c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var u=s.value;this._remoteTrackAdded(e,u)}}catch(e){o=!0,a=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw a}}var l=e.getVideoTracks(),d=!0,f=!1,p=void 0;try{for(var h,m=l[Symbol.iterator]();!(d=(h=m.next()).done);d=!0){var v=h.value;this._remoteTrackAdded(e,v)}}catch(e){f=!0,p=e}finally{try{!d&&m.return&&m.return()}finally{if(f)throw p}}},o.prototype._remoteTrackAdded=function(e,t){var n=S.default.getStreamID(e),r=t.kind;if(U.info(this+" remote track added:",n,r),!r)return void p.callErrorHandler(new Error("MediaType undefined for remote track, stream id: "+n));var i=new P.default(this.remoteDescription.sdp),o=i.media.filter(function(e){return e.startsWith("m="+r)});if(!o.length)return void p.callErrorHandler(new Error("No media lines for type "+r+" found in remote SDP for remote track: "+n));var a=M.default.findLines(o[0],"a=ssrc:");if(a=a.filter(function(e){var t=_.default.isTemasysPluginUsed()?"mslabel":"msid";return e.indexOf(t+":"+n)!==-1}),!a.length)return void p.callErrorHandler(new Error("No SSRC lines for streamId "+n+" for remote track, media type: "+r));var s=a[0].substring(7).split(" ")[0],c=this.signalingLayer.getSSRCOwner(s);if(!c)return void p.callErrorHandler(new Error("No SSRC owner known for: "+s+" for remote track, msid: "+n+" media type: "+r));U.log(this+" associated ssrc",c,s);var u=this.signalingLayer.getPeerMediaInfo(c,r);if(!u)return void p.callErrorHandler(new Error(this+": no peer media info available for "+c));var l=u.muted,d=u.videoType;this._createRemoteTrack(c,e,t,r,d,s,l)},o.prototype._createRemoteTrack=function(e,t,n,r,i,o,a){var s=new m.default(this.rtc,this.rtc.conference,e,t,n,r,i,o,a,this.isP2P),c=this.remoteTracks.get(e);c||(c=new Map,this.remoteTracks.set(e,c)),c.has(r)&&U.error(this+" overwriting remote track! "+s,e,r),c.set(r,s),this.rtc.eventEmitter.emit(A.default.REMOTE_TRACK_ADDED,s)},o.prototype._remoteStreamRemoved=function(e){if(!S.default.isUserStream(e)){var t=S.default.getStreamID(e);return void U.info("Ignored remote 'stream removed' event for non-user stream "+t)}var n=e.getVideoTracks(),r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value;this._remoteTrackRemoved(e,c)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}var u=e.getAudioTracks(),l=!0,d=!1,f=void 0;try{for(var p,h=u[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var m=p.value;this._remoteTrackRemoved(e,m)}}catch(e){d=!0,f=e}finally{try{!l&&h.return&&h.return()}finally{if(d)throw f}}},o.prototype._remoteTrackRemoved=function(e,t){var n=S.default.getStreamID(e),r=t&&t.id;return U.info(this+" - remote track removed: "+n+", "+r),n?r?void(this._removeRemoteTrack(n,r)||U.warn(this+" Removed track not found for msid: "+n+",\n             track id: "+r)):void p.callErrorHandler(new Error(this+" remote track removal failed - no track ID")):void p.callErrorHandler(new Error(this+" remote track removal failed - no stream ID"))},o.prototype._getRemoteTrackById=function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=this.remoteTracks.values()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=!0,u=!1,l=void 0;try{for(var d,f=s.values()[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var p=d.value;if(p.getStreamId()==e&&p.getTrackId()==t)return p}}catch(e){u=!0,l=e}finally{try{!c&&f.return&&f.return()}finally{if(u)throw l}}}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}},o.prototype.removeRemoteTracks=function(e){var t=[],n=this.remoteTracks.get(e);if(n){var r=n.get(g.AUDIO),i=n.get(g.VIDEO);r&&t.push(r),i&&t.push(i),this.remoteTracks.delete(e)}return U.debug(this+" removed remote tracks for "+e+" count: "+t.length),t},o.prototype._removeRemoteTrack=function(e,t){var n=this._getRemoteTrackById(e,t);if(n){n.dispose();var r=this.remoteTracks.get(n.getParticipantId());r.delete(n.getType())||U.error("Failed to remove "+n+" - type mapping messed up ?"),this.rtc.eventEmitter.emit(A.default.REMOTE_TRACK_REMOVED,n)}return n};var H=function(e){if("object"!==("undefined"==typeof e?"undefined":c(e))||null===e||"string"!=typeof e.sdp)return U.warn("An empty description was passed as an argument."),e;var t=n(39),r=t.parse(e.sdp);"undefined"!=typeof r&&"undefined"!=typeof r.media&&Array.isArray(r.media)&&r.media.forEach(function(e){var t=[],n=[];if("undefined"!=typeof e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach(function(e){"undefined"!=typeof e.semantics&&"FID"===e.semantics&&"undefined"!=typeof e.ssrcs&&t.push(Number(e.ssrcs.split(" ")[0]))}),Array.isArray(e.ssrcs)){var r=void 0;for(r=0;r<e.ssrcs.length;r++)"object"===c(e.ssrcs[r])&&"undefined"!=typeof e.ssrcs[r].id&&t.indexOf(e.ssrcs[r].id)>=0&&(n.push(e.ssrcs[r]),delete e.ssrcs[r]);for(r=0;r<e.ssrcs.length;r++)"undefined"!=typeof e.ssrcs[r]&&n.push(e.ssrcs[r]);e.ssrcs=n}});var i=t.write(r);return new RTCSessionDescription({type:e.type,sdp:i})};o.prototype.getLocalSSRC=function(e){var t=this._getSSRC(e.rtcId);return t&&t.ssrcs[0]};var G={signalingState:function(){return this.peerconnection.signalingState},iceConnectionState:function(){return this.peerconnection.iceConnectionState},localDescription:function(){var e=this.peerconnection.localDescription;return this.trace("getLocalDescription::preTransform",J(e)),_.default.usesUnifiedPlan()&&(e=this.interop.toPlanB(e),this.trace("getLocalDescription::postTransform (Plan B)",J(e))),_.default.doesVideoMuteByStreamRemove()&&(this.localSdpMunger.maybeMungeLocalSdp(e),U.debug("getLocalDescription::postTransform (munge local SDP)",e)),e||{}},remoteDescription:function(){var e=this.peerconnection.remoteDescription;return this.trace("getRemoteDescription::preTransform",J(e)),_.default.usesUnifiedPlan()&&(e=this.interop.toPlanB(e),this.trace("getRemoteDescription::postTransform (Plan B)",J(e))),e||{}}};Object.keys(G).forEach(function(e){Object.defineProperty(o.prototype,e,{get:G[e]})}),o.prototype._getSSRC=function(e){return this.localSSRCs.get(e)},o.prototype.addTrack=function(e){var t=e.rtcId;if(U.info("add "+e+" to: "+this),this.localTracks.has(t))return void U.error(e+" is already in "+this);this.localTracks.set(t,e);var n=e.getOriginalStream();if(n?this._addStream(n):(!_.default.doesVideoMuteByStreamRemove()||e.isAudioTrack()||e.isVideoTrack()&&!e.isMuted())&&U.error(this+" no WebRTC stream for: "+e),_.default.doesVideoMuteByStreamRemove()&&e.isVideoTrack()&&e.isMuted()){var r=this.generateNewStreamSSRCInfo(e);this.sdpConsistency.setPrimarySsrc(r.ssrcs[0]);var i=r.groups.find(function(e){return"SIM"===e.semantics});i&&this.simulcast.setSsrcCache(i.ssrcs);var o=r.groups.filter(function(e){return"FID"===e.semantics});if(o){var a=new Map;o.forEach(function(e){var t=e.ssrcs[0],n=e.ssrcs[1];a.set(t,n)}),this.rtxModifier.setSsrcCache(a)}}},o.prototype.addTrackUnmute=function(e){if(!this._assertTrackBelongs("addTrackUnmute",e))return!1;U.info("Adding "+e+" as unmute to "+this);var t=e.getOriginalStream();return t?(this._addStream(t),!0):(U.error("Unable to add "+e+" as unmute to "+this+" - no WebRTC stream"),!1)},o.prototype._addStream=function(e){this.peerconnection.addStream(e)},o.prototype._removeStream=function(e){_.default.isFirefox()?this._handleFirefoxRemoveStream(e):this.peerconnection.removeStream(e)},o.prototype._assertTrackBelongs=function(e,t){var n=this.localTracks.has(t.rtcId);return n||U.error(e+": "+t+" does not belong to "+this),n},o.prototype.removeTrack=function(e){var t=e.getOriginalStream();this.trace("removeStream",e.rtcId,t?t.id:void 0),this._assertTrackBelongs("removeStream",e)&&(this.localTracks.delete(e.rtcId),
this.localSSRCs.delete(e.rtcId),t&&(_.default.isFirefox()?this._handleFirefoxRemoveStream(t):this.peerconnection.removeStream(t)))},o.prototype.removeTrackMute=function(e){var t=e.getOriginalStream();return this.trace("removeStreamMute",e.rtcId,t?t.id:null),!!this._assertTrackBelongs("removeStreamMute",e)&&(t?(U.info("Removing "+e+" as mute from "+this),this._removeStream(t),!0):(U.error("removeStreamMute - no WebRTC stream for "+e),!1))},o.prototype._handleFirefoxRemoveStream=function(e){if(e){var t=null,n=null;if(e.getAudioTracks()&&e.getAudioTracks().length?n=e.getAudioTracks()[0]:e.getVideoTracks()&&e.getVideoTracks().length&&(n=e.getVideoTracks()[0]),!n)return void U.error("Cannot remove tracks: no tracks.");this.peerconnection.getSenders().some(function(e){return e.track===n&&(t=e,!0)}),t?this.peerconnection.removeTrack(t):U.log("Cannot remove tracks: no RTPSender.")}},o.prototype.createDataChannel=function(e,t){return this.trace("createDataChannel",e,t),this.peerconnection.createDataChannel(e,t)},o.prototype._ensureSimulcastGroupIsLast=function(e){var t=e.sdp,n=t.indexOf("m=video"),r=t.indexOf("a=ssrc-group:SIM",n),i=t.lastIndexOf("a=ssrc-group");if(r!==-1&&i!==-1&&i!==r){var o=t.indexOf("\r\n",r),a=t.substring(r,o+2);t=t.replace(a,""),i=t.lastIndexOf("a=ssrc-group");var s=t.indexOf("\r\n",i),c=t.slice(0,s),u=a.trim(),l=t.slice(s);t=c+"\r\n"+u+l,e.sdp=t}},o.prototype._adjustLocalMediaDirection=function(e){var t=new x.SdpTransformWrap(e.sdp),n=!1,r=t.selectMedia("audio");if(r){var i=this._getDesiredMediaDirection(g.AUDIO);r.direction!==i&&(r.direction=i,U.info("Adjusted local audio direction to "+i),n=!0)}else U.warn('No "audio" media found int the local description');var o=t.selectMedia("video");if(o){var a=this._getDesiredMediaDirection(g.VIDEO);o.direction!==a&&(o.direction=a,U.info("Adjusted local video direction to "+a),n=!0)}else U.warn('No "video" media found in the local description');n&&(e.sdp=t.toRawSDP())},o.prototype.setLocalDescription=function(e,t,n){var r=this,i=e;this.trace("setLocalDescription::preTransform",J(i)),this._adjustLocalMediaDirection(i),this._ensureSimulcastGroupIsLast(i),_.default.usesUnifiedPlan()&&(i=this.interop.toUnifiedPlan(i),this.trace("setLocalDescription::postTransform (Unified Plan)",J(i))),this.peerconnection.setLocalDescription(i,function(){r.trace("setLocalDescriptionOnSuccess");var e=M.default.getUfrag(i.sdp);e!==r.localUfrag&&(r.localUfrag=e,r.rtc.eventEmitter.emit(A.default.LOCAL_UFRAG_CHANGED,r,e)),t()},function(e){r.trace("setLocalDescriptionOnFailure",e),r.eventEmitter.emit(A.default.SET_LOCAL_DESCRIPTION_FAILED,e,r),n(e)})},o.prototype.setMediaTransferActive=function(e){this.mediaTransferActive=e},o.prototype.setRemoteDescription=function(e,t,n){var r=this;if(this.trace("setRemoteDescription::preTransform",J(e)),e=this.simulcast.mungeRemoteDescription(e),this.trace("setRemoteDescription::postTransform (simulcast)",J(e)),this.options.preferH264){var i=d.default.parse(e.sdp),o=i.media.find(function(e){return"video"===e.type});M.default.preferVideoCodec(o,"h264"),e.sdp=d.default.write(i)}_.default.usesUnifiedPlan()?(e.sdp=this.rtxModifier.stripRtx(e.sdp),this.trace("setRemoteDescription::postTransform (stripRtx)",J(e)),e=this.interop.toUnifiedPlan(e),this.trace("setRemoteDescription::postTransform (Plan A)",J(e))):e=H(e),this.peerconnection.setRemoteDescription(e,function(){r.trace("setRemoteDescriptionOnSuccess");var n=M.default.getUfrag(e.sdp);n!==r.remoteUfrag&&(r.remoteUfrag=n,r.rtc.eventEmitter.emit(A.default.REMOTE_UFRAG_CHANGED,r,n)),t()},function(e){r.trace("setRemoteDescriptionOnFailure",e),r.eventEmitter.emit(A.default.SET_REMOTE_DESCRIPTION_FAILED,e,r),n(e)})},o.prototype.generateRecvonlySsrc=function(){var e=M.default.generateSsrc();U.info(this+" generated new recvonly SSRC: "+e),this.sdpConsistency.setPrimarySsrc(e)},o.prototype.clearRecvonlySsrc=function(){U.info("Clearing primary video SSRC!"),this.sdpConsistency.clearVideoSsrcCache()},o.prototype.close=function(){this.trace("stop"),this.signalingLayer.off(F.PEER_MUTED_CHANGED,this._peerMutedChanged),this.signalingLayer.off(F.PEER_VIDEO_TYPE_CHANGED,this._peerVideoTypeChanged),this.rtc._removePeerConnection(this)||U.error("RTC._removePeerConnection returned false"),null!==this.statsinterval&&(window.clearInterval(this.statsinterval),this.statsinterval=null),this.peerconnection.close()};var V=function(e,t){_.default.isChrome()&&e&&t&&e.media&&t.media&&e.media.length===t.media.length&&(t.media.forEach(function(n,r){M.default.findLine(e.media[r],"a=setup:actpass",e.session)&&(t.media[r]=n.replace(/a=setup:active/g,"a=setup:passive"))}),t.raw=t.session+t.media.join(""))};o.prototype.createAnswer=function(e,t,n){this._createOfferOrAnswer(!1,e,t,n)},o.prototype.createOffer=function(e,t,n){this._createOfferOrAnswer(!0,e,t,n)},o.prototype._createOfferOrAnswer=function(e,t,n,r){var i=this,o=e?"Offer":"Answer";this.trace("create"+o,JSON.stringify(r,null," "));var s=function(r){try{if(i.trace("create"+o+"OnSuccess::preTransform",J(r)),_.default.usesUnifiedPlan()&&(r=i.interop.toPlanB(r),i.trace("create"+o+"OnSuccess::postTransform (Plan B)",J(r))),_.default.isFirefox()||(i.hasAnyTracksOfType(g.VIDEO)||i.sdpConsistency.hasPrimarySsrcCached()||i.generateRecvonlySsrc(),r.sdp=i.sdpConsistency.makeVideoPrimarySsrcsConsistent(r.sdp),i.trace("create"+o+"OnSuccess::postTransform (make primary audio/video ssrcs consistent)",J(r))),i.isSimulcastOn()&&(r=i.simulcast.mungeLocalDescription(r),i.trace("create"+o+"OnSuccess::postTransform (simulcast)",J(r))),!i.options.disableRtx&&_.default.supportsRtx()&&(r.sdp=i.rtxModifier.modifyRtxSsrcs(r.sdp),i.trace("create"+o+"OnSuccess::postTransform (rtx modifier)",J(r))),!e){var s=new P.default(i.remoteDescription.sdp),c=new P.default(r.sdp);V(s,c),r.sdp=c.raw}var u=a(r);U.debug("Got local SSRCs MAP: ",u),i._processLocalSSRCsMap(u),t(r)}catch(e){i.trace("create"+o+"OnError",e),i.trace("create"+o+"OnError",J(r)),U.error("create"+o+"OnError",e,J(r)),n(e)}},c=function(t){i.trace("create"+o+"OnFailure",t);var r=e?A.default.CREATE_OFFER_FAILED:A.default.CREATE_ANSWER_FAILED;i.eventEmitter.emit(r,t,i),n(t)};e?this.peerconnection.createOffer(s,c,r):this.peerconnection.createAnswer(s,c,r)},o.prototype._processLocalSSRCsMap=function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.localTracks.values()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,c=a.getMSID();if(e.has(c)){var u=e.get(c);if(!u)return void U.error("No SSRC found for: "+c+" in "+this);var l=this.localSSRCs.get(a.rtcId),d=s(u),f=s(l);d!==f?(null===f?U.info("Storing new local SSRC for "+a+" in "+this,u):U.error("Overwriting SSRC for "+a+" "+c+" in "+this+" with: ",u),this.localSSRCs.set(a.rtcId,u)):U.debug("The local SSRC("+d+") for "+a+" "+c+("is still up to date in "+this))}else U.warn("No local track matched with: "+c+" in "+this)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}},o.prototype.addIceCandidate=function(e,t,n){this.trace("addIceCandidate",JSON.stringify(e,null," ")),this.peerconnection.addIceCandidate(e,t,n)},o.prototype.getStats=function(e,t){_.default.isFirefox()||_.default.isTemasysPluginUsed()||_.default.isReactNative()?this.peerconnection.getStats(null,e,t||function(){}):this.peerconnection.getStats(e)},o.prototype.generateNewStreamSSRCInfo=function(e){var t=e.rtcId,n=this._getSSRC(t);if(n&&U.error("Will overwrite local SSRCs for track ID: "+t),this.isSimulcastOn()){n={ssrcs:[],groups:[]};for(var r=0;r<B;r++)n.ssrcs.push(M.default.generateSsrc());n.groups.push({ssrcs:n.ssrcs.slice(),semantics:"SIM"})}else n={ssrcs:[M.default.generateSsrc()],groups:[]};if(!this.options.disableRtx&&_.default.supportsRtx())for(var i=n.ssrcs.length,o=0;o<i;++o){var a=n.ssrcs[o],s=M.default.generateSsrc();n.ssrcs.push(s),n.groups.push({ssrcs:[a,s],semantics:"FID"})}return n.msid=e.storedMSID,this.localSSRCs.set(t,n),n},o.prototype.toString=function(){return"TPC["+this.id+",p2p:"+this.isP2P+"]"}}).call(t,"modules/RTC/TraceablePeerConnection.js")},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(1),u=n(170),l=r(u),d=n(87),f=(0,c.getLogger)(e),p={stable:"stable",haveLocalOffer:"have-local-offer",haveRemoteOffer:"have-remote-offer",closed:"closed"},h={new:"new",gathering:"gathering",complete:"complete"},m=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return f.debug("constructor() pcConfig:",e),n._closed=!1,n._iceGatherer=n._createIceGatherer(e),n._iceGatheringState=h.new,n._iceTransport=n._createIceTransport(n._iceGatherer),n._localDescription=null,n._localStreams=new Set,n._remoteDescription=null,n._remoteStreams=new Set,n._signalingState=p.stable,n}return a(t,e),s(t,[{key:"close",value:function(){if(!this._closed){this._closed=!0,f.debug("close()"),this._updateAndEmitSignalingStateChange(p.closed);try{this._iceGatherer.close()}catch(e){f.warn("iceGatherer.close() failed:"+e)}try{this._iceTransport.stop()}catch(e){f.warn("iceTransport.stop() failed:"+e)}this._localStreams.clear(),this._remoteStreams.clear()}}},{key:"createOffer",value:function(){var e=void 0,t=void 0,n=void 0,r=void 0;if(arguments.length<=1)e=!0,t=arguments.length<=0?void 0:arguments[0];else{if(e=!1,n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],t=arguments.length<=2?void 0:arguments[2],"function"!=typeof n)throw new TypeError("callback missing");if("function"!=typeof r)throw new TypeError("errback missing")}return f.debug("createOffer() options:",t),e?this._createOffer(t):void this._createOffer(t).then(function(e){return n(e)}).catch(function(e){return r(e)})}},{key:"createAnswer",value:function(){var e=void 0,t=void 0,n=void 0,r=void 0;if(arguments.length<=1)e=!0,t=arguments.length<=0?void 0:arguments[0];else{if(e=!1,n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],t=arguments.length<=2?void 0:arguments[2],"function"!=typeof n)throw new TypeError("callback missing");if("function"!=typeof r)throw new TypeError("errback missing")}return f.debug("createAnswer() options:",t),e?this._createAnswer(t):void this._createAnswer(t).then(function(e){return n(e)}).catch(function(e){return r(e)})}},{key:"setLocalDescription",value:function(e){var t=void 0,n=void 0,r=void 0;if(!e)throw new TypeError("description missing");if(0===(arguments.length<=1?0:arguments.length-1))t=!0;else{if(t=!1,n=arguments.length<=1?void 0:arguments[1],r=arguments.length<=2?void 0:arguments[2],"function"!=typeof n)throw new TypeError("callback missing");if("function"!=typeof r)throw new TypeError("errback missing")}return f.debug("setLocalDescription() desc:",e),t?this._setLocalDescription(e):void this._setLocalDescription(e).then(function(){return n()}).catch(function(e){return r(e)})}},{key:"setRemoteDescription",value:function(e){var t=void 0,n=void 0,r=void 0;if(!e)throw new TypeError("description missing");if(0===(arguments.length<=1?0:arguments.length-1))t=!0;else{if(t=!1,n=arguments.length<=1?void 0:arguments[1],r=arguments.length<=2?void 0:arguments[2],"function"!=typeof n)throw new TypeError("callback missing");if("function"!=typeof r)throw new TypeError("errback missing")}return f.debug("setRemoteDescription() desc:",e),t?this._setRemoteDescription(e):void this._setRemoteDescription(e).then(function(){return n()}).catch(function(e){return r(e)})}},{key:"addIceCandidate",value:function(e){var t=void 0,n=void 0,r=void 0;if(!e)throw new TypeError("candidate missing");if(0===(arguments.length<=1?0:arguments.length-1))t=!0;else{if(t=!1,n=arguments.length<=1?void 0:arguments[1],r=arguments.length<=2?void 0:arguments[2],"function"!=typeof n)throw new TypeError("callback missing");if("function"!=typeof r)throw new TypeError("errback missing")}return f.debug("addIceCandidate() candidate:",e),t?this._addIceCandidate(e):void this._addIceCandidate(e).then(function(){return n()}).catch(function(e){return r(e)})}},{key:"addStream",value:function(e){f.debug("addStream()"),this._addStream(e)}},{key:"removeStream",value:function(e){f.debug("removeStream()"),this._removeStream(e)}},{key:"createDataChannel",value:function(){f.debug("createDataChannel()")}},{key:"getLocalStreams",value:function(){return Array.from(this._localStreams)}},{key:"getRemoteStreams",value:function(){return Array.from(this._remoteStreams)}},{key:"getStats",value:function(){}},{key:"_createIceGatherer",value:function(e){var t=this,n={gatherPolicy:e.iceTransportPolicy||"all",iceServers:e.iceServers||[]},r=new RTCIceGatherer(n);r.onstatechange=function(){f.debug('iceGatherer "statechange" event, state:'+r.state),t._updateAndEmitIceGatheringStateChange(r.state)},r.onlocalcandidate=function(e){var n=e.candidate,r=e.complete;f.debug('iceGatherer "localcandidate" event, candidate:',n),r||!n||0===Object.keys(n).length?(n=null,t._updateAndEmitIceGatheringStateChange(h.complete),t._emitIceCandidate(null)):t._emitIceCandidate(n)},r.onerror=function(e){var t=e.errorCode,n=e.errorText;f.error('iceGatherer "error" event, errorCode:'+t+", errorText:"+n)};try{r.gather()}catch(e){f.warn("iceGatherer.gather() failed:"+e)}return r}},{key:"_createIceTransport",value:function(e){var t=this,n=new RTCIceTransport(e);return n.onstatechange=function(){f.debug('iceTransport "statechange" event, state:'+n.state),t._emitIceConnectionStateChange()},n.onicestatechange=function(){f.debug('iceTransport "icestatechange" event, state:'+n.state),t._emitIceConnectionStateChange()},n}},{key:"_createOffer",value:function(e){return this._closed?Promise.reject(new d.InvalidStateError("RTCPeerConnection closed")):this.signalingState!==p.stable?Promise.reject(new d.InvalidStateError('invalid signalingState "'+this.signalingState+'"')):void 0}},{key:"_createAnswer",value:function(e){return this._closed?Promise.reject(new d.InvalidStateError("RTCPeerConnection closed")):this.signalingState!==p.haveRemoteOffer?Promise.reject(new d.InvalidStateError('invalid signalingState "'+this.signalingState+'"')):void 0}},{key:"_setLocalDescription",value:function(e){if(this._closed)return Promise.reject(new d.InvalidStateError("RTCPeerConnection closed"));switch(e.type){case"offer":if(this.signalingState!==p.stable)return Promise.reject(new d.InvalidStateError('invalid signalingState "'+this.signalingState+'"'));break;case"answer":if(this.signalingState!==p.haveRemoteOffer)return Promise.reject(new d.InvalidStateError('invalid signalingState "'+this.signalingState+'"'));break;default:throw new TypeError('unsupported description.type "'+e.type+'"')}}},{key:"_setRemoteDescription",value:function(e){if(this._closed)return Promise.reject(new d.InvalidStateError("RTCPeerConnection closed"));switch(e.type){case"offer":if(this.signalingState!==p.stable)return Promise.reject(new d.InvalidStateError('invalid signalingState "'+this.signalingState+'"'));break;case"answer":if(this.signalingState!==p.haveLocalOffer)return Promise.reject(new d.InvalidStateError('invalid signalingState "'+this.signalingState+'"'));break;default:throw new TypeError('unsupported description.type "'+e.type+'"')}}},{key:"_addStream",value:function(e){if(this._closed)throw new d.InvalidStateError("RTCPeerConnection closed");this._localStreams.has(e)||(this._localStreams.add(e),this._emitNegotiationNeeded())}},{key:"_removeStream",value:function(e){if(this._closed)throw new d.InvalidStateError("RTCPeerConnection closed");this._localStreams.has(e)&&(this._localStreams.delete(e),this._emitNegotiationNeeded())}},{key:"_updateAndEmitSignalingStateChange",value:function(e){if(e!==this.signalingState){this._signalingState=e,f.debug('emitting "signalingstatechange", signalingState:',this.signalingState);var t=new l.default.Event("signalingstatechange");this.dispatchEvent(t)}}},{key:"_emitNegotiationNeeded",value:function(){if(this.signalingState===p.stable){f.debug('emitting "negotiationneeded"');var e=new l.default.Event("negotiationneeded");this.dispatchEvent(e)}}},{key:"_updateAndEmitIceGatheringStateChange",value:function(e){if(!this._closed&&e!==this.iceGatheringState){this._iceGatheringState=e,f.debug('emitting "icegatheringstatechange", iceGatheringState:',this.iceGatheringState);var t=new l.default.Event("icegatheringstatechange");this.dispatchEvent(t)}}},{key:"_emitIceConnectionStateChange",value:function(){if(!this._closed||"closed"===this.iceConnectionState){f.debug('emitting "iceconnectionstatechange", iceConnectionState:',this.iceConnectionState);var e=new l.default.Event("iceconnectionstatechange");this.dispatchEvent(e)}}},{key:"_emitIceCandidate",value:function(e){if(!this._closed){var t=new l.default.Event("icecandidate");f.debug('emitting "icecandidate", candidate:',e),t.candidate=e,this.dispatchEvent(t)}}},{key:"signalingState",get:function(){return this._signalingState}},{key:"iceGatheringState",get:function(){return this._iceGatheringState}},{key:"iceConnectionState",get:function(){return this._iceTransport.state}},{key:"localDescription",get:function(){return this._localDescription}},{key:"remoteDescription",get:function(){return this._remoteDescription}}]),t}(l.default.EventTarget);t.default=m}).call(t,"modules/RTC/ortc/RTCPeerConnection.js")},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e){var t=function(t){function o(t){n(this,o);var i=r(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t));return Object.defineProperty(i,"name",{value:e}),i}return i(o,t),o}(Error);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidStateError=o("InvalidStateError")},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(8),s=r(a),c=function(){function e(t,n){i(this,e),this._callback=n,this._eventFired=!1,t.statistics.addAudioLevelListener(this._audioLevel.bind(this)),t.on(s.TRACK_MUTE_CHANGED,this._trackMuteChanged.bind(this)),t.on(s.TRACK_ADDED,this._trackAdded.bind(this))}return o(e,[{key:"_audioLevel",value:function(e,t,n){n&&this.audioTrack&&!this._eventFired&&this.audioTrack.isMuted()&&t>.6&&(this._eventFired=!0,this._callback())}},{key:"_isLocalAudioTrack",value:function(e){return e.isAudioTrack()&&e.isLocal()}},{key:"_trackAdded",value:function(e){this._isLocalAudioTrack(e)&&(this.audioTrack=e)}},{key:"_trackMuteChanged",value:function(e){this._isLocalAudioTrack(e)&&e.isMuted()&&(this._eventFired=!1)}}]),e}();t.default=c},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){if(n<5e3)return 1;var r=0,i=Math.min(t.height,t.width);if(e){var o=y.find(function(e){return e.height<=i});if(o){var s=function(){var e=i;return(o=y.find(function(t){return t.height===e}))?void(r+=o.target):"break"};for(i=o.height;i>=180;i/=2){var c=s();if("break"===c)break}}}else{var u=t.width*t.height;r=u<=76800?600:u<=307200?1700:u<=518400?2e3:2500}return Math.min(r,a(Math.max(0,n-1e3)))}function a(e){return e>6e4?Number.MAX_SAFE_INTEGER:b*Math.pow(1.08,e/1e3)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(34),u=r(c),l=n(8),d=r(l),f=n(1),p=n(7),h=n(19),m=n(33),v=(0,f.getLogger)(e),g="stats",y=[{width:1920,height:1080,layers:3,max:5e3,target:4e3,min:800},{width:1280,height:720,layers:3,max:2500,target:2500,min:600},{width:960,height:540,layers:3,max:900,target:900,min:450},{width:640,height:360,layers:2,max:700,target:500,min:150},{width:480,height:270,layers:2,max:450,target:350,min:150},{width:320,height:180,layers:1,max:200,target:150,min:30}],b=800,E=function(){function e(t,n,r){var o=this;i(this,e),this.eventEmitter=n,this._conference=t,this._localStats={connectionQuality:100},this._lastConnectionQualityUpdate=-1,this._remoteStats={},this._timeIceConnected=-1,this._timeVideoUnmuted=-1,r.startBitrate&&r.startBitrate>0&&(b=r.startBitrate),t.on(d.CONNECTION_INTERRUPTED,function(){o._updateLocalConnectionQuality(0),o.eventEmitter.emit(u.LOCAL_STATS_UPDATED,o._localStats),o._broadcastLocalStats()}),t.room.addListener(p.ICE_CONNECTION_STATE_CHANGED,function(e,t){e.isP2P||"connected"!==t||(o._timeIceConnected=window.performance.now())}),t.on(d.ENDPOINT_MESSAGE_RECEIVED,function(e,t){t.type===g&&o._updateRemoteStats(e.getId(),t.values)}),t.on(d.CONNECTION_STATS,this._updateLocalStats.bind(this)),t.on(d.TRACK_MUTE_CHANGED,function(e){e.isVideoTrack()&&(e.isMuted()?o._timeVideoUnmuted=-1:o._maybeUpdateUnmuteTime())}),t.on(d.TRACK_ADDED,function(e){e.isVideoTrack()&&!e.isMuted()&&o._maybeUpdateUnmuteTime()})}return s(e,[{key:"_maybeUpdateUnmuteTime",value:function(){this._timeVideoUnmuted<0&&(this._timeVideoUnmuted=window.performance.now())}},{key:"_calculateConnectionQuality",value:function(e,t,n){var r=m[n],i=100,a=void 0;if(this._localStats.packetLoss&&(a=this._localStats.packetLoss.upload,t&&(a*=.5)),t||!r||e===h.DESKTOP||this._timeIceConnected<0||this._timeVideoUnmuted<0)void 0===a?(v.error("Cannot calculate connection quality, unknown packet loss."),i=100):i=a<=2?100:a<=4?70:a<=6?50:a<=8?30:a<=12?10:0;else{var s=window.performance.now()-Math.max(this._timeVideoUnmuted,this._timeIceConnected),c=this._conference.getActivePeerConnection(),u=Boolean(c&&c.isSimulcastOn()),l=o(u,r,s);l*=.9,i=100*this._localStats.bitrate.upload/l,a&&a>=10&&(i=Math.min(i,30))}if(this._lastConnectionQualityUpdate>0){var d=2,f=this._localStats.connectionQuality,p=(window.performance.now()-this._lastConnectionQualityUpdate)/1e3;i=Math.min(i,f+p*d)}return Math.min(100,i)}},{key:"_updateLocalConnectionQuality",value:function(e){this._localStats.connectionQuality=e,this._lastConnectionQualityUpdate=window.performance.now()}},{key:"_broadcastLocalStats",value:function(){var e={bitrate:this._localStats.bitrate,packetLoss:this._localStats.packetLoss,connectionQuality:this._localStats.connectionQuality,jvbRTT:this._localStats.transport&&this._localStats.transport.length&&!this._localStats.transport[0].p2p?this._localStats.transport[0].rtt:void 0},t=this._conference.getLocalVideoTrack();t&&t.resolution&&(e.resolution=t.resolution);try{this._conference.broadcastEndpointMessage({type:g,values:e})}catch(e){}}},{key:"_updateLocalStats",value:function(e){var t=void 0,n=!this._conference.isConnectionInterrupted(),r=this._conference.getLocalVideoTrack(),i=r?r.videoType:void 0,o=!r||r.isMuted(),a=r?r.resolution:null;o||this._maybeUpdateUnmuteTime();for(t in e)e.hasOwnProperty(t)&&(this._localStats[t]=e[t]);n&&this._updateLocalConnectionQuality(this._calculateConnectionQuality(i,o,a)),this.eventEmitter.emit(u.LOCAL_STATS_UPDATED,this._localStats),this._broadcastLocalStats()}},{key:"_updateRemoteStats",value:function(e,t){this._remoteStats[e]={bitrate:t.bitrate,packetLoss:t.packetLoss,connectionQuality:t.connectionQuality,jvbRTT:t.jvbRTT},this.eventEmitter.emit(u.REMOTE_STATS_UPDATED,e,this._remoteStats[e])}},{key:"getStats",value:function(){return this._localStats}}]),e}();t.default=E}).call(t,"modules/connectivity/ConnectionQuality.js")},function(e,t){"use strict";function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){i(this,e)}return o(e,[{key:"sendEvent",value:function(){}}]),e}(),s=function(e){function t(){i(this,t);var e=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.eventCache=[],e}return r(t,e),o(t,[{key:"sendEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.eventCache.push({action:e,data:t})}},{key:"drainCachedEvents",value:function(){var e=this.eventCache.slice();return this.eventCache=[],e}}]),t}(a),c=new s,u=function(){function e(){i(this,e),this.analyticsHandlers=new Set,this.permanentProperties=Object.create(null)}return o(e,[{key:"init",value:function(e){this.browserName=e,this.analyticsHandlers.add(c)}},{key:"sendEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({browserName:this.browserName},this.permanentProperties,t);this.analyticsHandlers.forEach(function(t){return t.sendEvent(e,n)})}},{key:"dispose",value:function(){c.drainCachedEvents(),this.analyticsHandlers.clear()}},{key:"setAnalyticsHandlers",value:function(e){var t=this;this.analyticsHandlers=new Set(e),c.drainCachedEvents().forEach(function(e){return t.sendEvent(e.action,e.data)})}},{key:"addPermanentProperties",value:function(e){this.permanentProperties=Object.assign(this.permanentProperties,e)}}]),e}();t.default=new u},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),c=n(34),u=i(c),l=n(8),d=i(l),f=n(2),p=r(f),h=n(6),m=r(h),v=(0,s.getLogger)(e),g=function(){function e(t){o(this,e),this.name=t,this.count=0,this.sum=0}return a(e,[{key:"addNext",value:function(e){return"number"!=typeof e?void v.error(this.name+" - invalid value for idx: "+this.count,e):(this.sum+=e,void(this.count+=1))}},{key:"calculate",value:function(){return this.sum/this.count}},{key:"report",value:function(e){m.default.analytics.sendEvent(""+(e?"p2p.":"")+this.name,{value:this.calculate()})}},{key:"reset",value:function(){this.sum=0,this.count=0}}]),e}(),y=function(){function e(t,n){var r=this;return o(this,e),this._n=n,n>0?(v.info("Avg RTP stats will be calculated every "+n+" samples"),this._sampleIdx=0,this._conference=t,this._avgBitrateUp=new g("stat.avg.bitrate.upload"),this._avgBitrateDown=new g("stat.avg.bitrate.download"),this._avgBandwidthUp=new g("stat.avg.bandwidth.upload"),this._avgBandwidthDown=new g("stat.avg.bandwidth.download"),this._avgPacketLossTotal=new g("stat.avg.packetloss.total"),this._avgPacketLossUp=new g("stat.avg.packetloss.upload"),this._avgPacketLossDown=new g("stat.avg.packetloss.download"),this._avgRemoteFPS=new g("stat.avg.framerate.remote"),this._avgRemoteRTTMap=new Map,this._avgRTT=new g("stat.avg.rtt"),this._avgLocalFPS=new g("stat.avg.framerate.local"),this._avgCQ=new g("stat.avg.cq"),this._onLocalStatsUpdated=function(e){return r._calculateAvgStats(e)},t.on(u.LOCAL_STATS_UPDATED,this._onLocalStatsUpdated),this._onRemoteStatsUpdated=function(e,t){return r._processRemoteStats(e,t)},t.on(u.REMOTE_STATS_UPDATED,this._onRemoteStatsUpdated),this._onP2PStatusChanged=function(){v.debug("Resetting average stats calculation"),r._resetAvgStats()},t.on(d.P2P_STATUS,this._onP2PStatusChanged),this._onUserLeft=function(e){return r._avgRemoteRTTMap.delete(e)},void t.on(d.USER_LEFT,this._onUserLeft)):void v.info("Avg RTP stats reports are disabled.")}return a(e,[{key:"_calculateAvgRemoteRTT",value:function(){var e=0,t=0,n=!0,r=!1,i=void 0;try{for(var o,a=this._avgRemoteRTTMap.values()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,c=s.calculate();isNaN(c)||(t+=c,e+=1,s.reset())}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return t/e}},{key:"_calculateAvgStats",value:function(e){var t=this._conference.isP2PActive(),n=this._conference.getParticipants().length;if(t||!(n<1)){if(!e)return void v.error("No stats");var r=e.bitrate,i=e.bandwidth,o=e.packetLoss,a=e.framerate;if(!r)return void v.error('No "bitrate"');if(!i)return void v.error('No "bandwidth"');if(!o)return void v.error('No "packetloss"');if(!a)return void v.error('No "framerate"');if(this._avgBitrateUp.addNext(r.upload),this._avgBitrateDown.addNext(r.download),p.default.supportsBandwidthStatistics()&&(this._avgBandwidthUp.addNext(i.upload),this._avgBandwidthDown.addNext(i.download)),this._avgPacketLossUp.addNext(o.upload),this._avgPacketLossDown.addNext(o.download),this._avgPacketLossTotal.addNext(o.total),this._avgCQ.addNext(e.connectionQuality),p.default.supportsRTTStatistics()&&(e.transport&&e.transport.length?this._avgRTT.addNext(e.transport[0].rtt):this._avgRTT.reset()),a&&(this._avgRemoteFPS.addNext(this._calculateAvgVideoFps(a,!1)),this._avgLocalFPS.addNext(this._calculateAvgVideoFps(a,!0))),this._sampleIdx+=1,this._sampleIdx>=this._n){if(this._avgBitrateUp.report(t),this._avgBitrateDown.report(t),p.default.supportsBandwidthStatistics()&&(this._avgBandwidthUp.report(t),this._avgBandwidthDown.report(t)),this._avgPacketLossUp.report(t),this._avgPacketLossDown.report(t),this._avgPacketLossTotal.report(t),this._avgRemoteFPS.report(t),this._avgLocalFPS.report(t),this._avgCQ.report(t),p.default.supportsRTTStatistics()&&(this._avgRTT.report(t),!t)){var s=this._calculateAvgRemoteRTT(),c=this._avgRTT.calculate();isNaN(c)||isNaN(s)||m.default.analytics.sendEvent("stat.avg.end2endrtt",c+s)}this._resetAvgStats()}
}}},{key:"_calculateAvgVideoFps",value:function(e,t){var n=0,r=0,i=this._conference.myUserId(),o=!0,a=!1,s=void 0;try{for(var c,u=Object.keys(e)[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var l=c.value;if(t?l===i:l!==i){var d=e[l],f=Object.keys(d);if(f.length){var p=0,h=!0,m=!1,v=void 0;try{for(var g,y=f[Symbol.iterator]();!(h=(g=y.next()).done);h=!0){var b=g.value;p+=parseInt(d[b],10)}}catch(e){m=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(m)throw v}}p/=f.length,r+=p,n+=1}}}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}return r/n}},{key:"_processRemoteStats",value:function(e,t){var n="number"==typeof t.jvbRTT,r=this._avgRemoteRTTMap.get(e);!r&&n&&(r=new g(e+".stat.rtt"),this._avgRemoteRTTMap.set(e,r)),n?r.addNext(t.jvbRTT):r&&this._avgRemoteRTTMap.delete(e)}},{key:"_resetAvgStats",value:function(){this._avgBitrateUp.reset(),this._avgBitrateDown.reset(),this._avgBandwidthUp.reset(),this._avgBandwidthDown.reset(),this._avgPacketLossUp.reset(),this._avgPacketLossDown.reset(),this._avgRemoteFPS.reset(),this._avgLocalFPS.reset(),this._avgCQ.reset(),this._avgRTT.reset(),this._avgRemoteRTTMap.clear(),this._sampleIdx=0}},{key:"dispose",value:function(){this._conference.off(d.P2P_STATUS,this._onP2PStatusChanged),this._conference.off(u.LOCAL_STATS_UPDATED,this._onLocalStatsUpdated),this._conference.off(u.REMOTE_STATS_UPDATED,this._onRemoteStatsUpdated),this._conference.off(d.USER_LEFT,this._onUserLeft)}}]),e}();t.default=y}).call(t,"modules/statistics/AvgRTPStatsReporter.js")},function(e,t,n){(function(e,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1).getLogger(e),s=n(3),c=n(143),u=n(161),l={createOffer:"createOffer",createAnswer:"createAnswer",setLocalDescription:"setLocalDescription",setRemoteDescription:"setRemoteDescription",addIceCandidate:"addIceCandidate",getUserMedia:"getUserMedia",iceConnectionFailure:"iceConnectionFailure",signalingError:"signalingError",applicationLog:"applicationLog"},d={fabricHold:"fabricHold",fabricResume:"fabricResume",audioMute:"audioMute",audioUnmute:"audioUnmute",videoPause:"videoPause",videoResume:"videoResume",fabricUsageEvent:"fabricUsageEvent",fabricStats:"fabricStats",fabricTerminated:"fabricTerminated",screenShareStart:"screenShareStart",screenShareStop:"screenShareStop",dominantSpeaker:"dominantSpeaker",activeDeviceList:"activeDeviceList"},f="jitsi",p={ERROR:"error",EVENT:"event",MST_WITH_USERID:"mstWithUserID"},h=void 0,m=function(){function e(t,n){if(i(this,e),!e.backend)throw new Error("CallStats backend not intiialized!");this.confID=n.confID,this.tpc=t,this.peerconnection=t.peerconnection,this.remoteUserID=n.remoteUserID||f,this.hasFabric=!1,e.fabrics.add(this),e.initialized&&this._addNewFabric()}return o(e,null,[{key:"_addNewFabricCallback",value:function(t,n){e.backend&&"success"!==t&&a.error("Monitoring status: "+t+" msg: "+n)}},{key:"_initCallback",value:function(t,n){if(a.log("CallStats Status: err="+t+" msg="+n),"success"===t){var r=!1,i=null,o=!0,s=!1,c=void 0;try{for(var u,l=e.fabrics.values()[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var d=u.value;d.hasFabric||(a.debug("addNewFabric - initCallback"),d._addNewFabric()&&(r=!0,i||(i=d)))}}catch(e){s=!0,c=e}finally{try{!o&&l.return&&l.return()}finally{if(s)throw c}}if(r){e.initialized=!0;var f=i.confID,h=i.peerconnection,m=!0,v=!1,g=void 0;try{for(var y,b=e.reportsQueue[Symbol.iterator]();!(m=(y=b.next()).done);m=!0){var E=y.value;if(E.type===p.ERROR){var S=E.data;e._reportError(i,S.type,S.error,S.pc||h)}else if(E.type===p.EVENT){var T=E.data;e.backend.sendFabricEvent(E.pc||h,T.event,f,T.eventData)}else if(E.type===p.MST_WITH_USERID){var C=E.data;e.backend.associateMstWithUserID(E.pc||h,C.callStatsId,f,C.ssrc,C.usageLabel,C.containerId)}}}catch(e){v=!0,g=e}finally{try{!m&&b.return&&b.return()}finally{if(v)throw g}}e.reportsQueue.length=0}}}},{key:"_reportError",value:function(t,n,r,i){var o=r;o||(a.warn("No error is passed!"),o=new Error("Unknown error")),e.initialized&&t?e.backend.reportError(i,t.confID,n,o):e.reportsQueue.push({type:p.ERROR,data:{error:o,pc:i,type:n}})}},{key:"_reportEvent",value:function(t,n,r){var i=t&&t.peerconnection,o=t&&t.confID;e.initialized&&t?e.backend.sendFabricEvent(i,n,o,r):e.reportsQueue.push({confID:o,pc:i,type:p.EVENT,data:{event:n,eventData:r}})}},{key:"_traceAndCatchBackendCalls",value:function(e){var t=["associateMstWithUserID","sendFabricEvent","sendUserFeedback"],n=!0,r=!1,i=void 0;try{for(var o,c=function(){var t=o.value,n=e[t];e[t]=function(){try{for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return n.apply(e,r)}catch(e){s.callErrorHandler(e)}}},u=t[Symbol.iterator]();!(n=(o=u.next()).done);n=!0)c()}catch(e){r=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}var d=["associateMstWithUserID","sendFabricEvent","sendUserFeedback"],f=!0,p=!1,h=void 0;try{for(var m,v=function(){var t=m.value,n=e[t];e[t]=function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];a.debug(t,i),n.apply(e,i)}},g=d[Symbol.iterator]();!(f=(m=g.next()).done);f=!0)v()}catch(e){p=!0,h=e}finally{try{!f&&g.return&&g.return()}finally{if(p)throw h}}var y=e.reportError;e.reportError=function(t,n,r){for(var i=arguments.length,o=Array(i>3?i-3:0),c=3;c<i;c++)o[c-3]=arguments[c];r===l.applicationLog?console&&console.debug("reportError",t,n,r):a.debug.apply(a,["reportError",t,n,r].concat(o));try{y.call.apply(y,[e,t,n,r].concat(o))}catch(e){r===l.applicationLog?console&&console.error("reportError",e):s.callErrorHandler(e)}}}},{key:"initBackend",value:function(t){if(e.backend)throw new Error("CallStats backend has been initialized already!");try{return e.backend=new callstats(r,u,c),e._traceAndCatchBackendCalls(e.backend),e.userID={aliasName:t.aliasName,userName:t.userName},e.callStatsID=t.callStatsID,e.callStatsSecret=t.callStatsSecret,e.backend.initialize(e.callStatsID,e.callStatsSecret,e.userID,e._initCallback),!0}catch(t){return s.callErrorHandler(t),e.backend=null,a.error(t),!1}}},{key:"isBackendInitialized",value:function(){return Boolean(e.backend)}},{key:"sendActiveDeviceListEvent",value:function(t,n){e._reportEvent(n,d.activeDeviceList,t)}},{key:"sendApplicationLog",value:function(t,n){try{e._reportError(n,l.applicationLog,t,n&&n.peerconnection)}catch(e){console&&"function"==typeof console.error&&console.error("sendApplicationLog failed",e)}}},{key:"sendFeedback",value:function(t,n,r){e.backend?e.backend.sendUserFeedback(t,{userID:e.userID,overall:n,comment:r}):a.error("Failed to submit feedback to CallStats - no backend")}},{key:"sendGetUserMediaFailed",value:function(t,n){e._reportError(n,l.getUserMedia,t,null)}},{key:"sendMuteEvent",value:function(t,n,r){var i=void 0;i="video"===n?t?d.videoPause:d.videoResume:t?d.audioMute:d.audioUnmute,e._reportEvent(r,i)}},{key:"fabrics",get:function(){return h||(h=new Set),h}}]),o(e,[{key:"_addNewFabric",value:function(){a.info("addNewFabric",this.remoteUserID,this);try{var t=e.backend.addNewFabric(this.peerconnection,this.remoteUserID,e.backend.fabricUsage.multiplex,this.confID,e._addNewFabricCallback);this.hasFabric=!0;var n="success"===t.status;return n||a.error("callstats fabric not initilized",t.message),n}catch(e){return s.callErrorHandler(e),!1}}},{key:"associateStreamWithVideoTag",value:function(t,n,r,i,o){if(e.backend){var a=n?e.userID:r;e.initialized?e.backend.associateMstWithUserID(this.peerconnection,a,this.confID,t,i,o):e.reportsQueue.push({type:p.MST_WITH_USERID,pc:this.peerconnection,data:{callStatsId:a,containerId:o,ssrc:t,usageLabel:i}})}}},{key:"sendDominantSpeakerEvent",value:function(){e._reportEvent(this,d.dominantSpeaker)}},{key:"sendTerminateEvent",value:function(){e.initialized&&e.backend.sendFabricEvent(this.peerconnection,e.backend.fabricEvent.fabricTerminated,this.confID),e.fabrics.delete(this)}},{key:"sendIceConnectionFailedEvent",value:function(){e._reportError(this,l.iceConnectionFailure,null,this.peerconnection)}},{key:"sendCreateOfferFailed",value:function(t){e._reportError(this,l.createOffer,t,this.peerconnection)}},{key:"sendCreateAnswerFailed",value:function(t){e._reportError(this,l.createAnswer,t,this.peerconnection)}},{key:"sendResumeOrHoldEvent",value:function(t){e._reportEvent(this,t?d.fabricResume:d.fabricHold)}},{key:"sendScreenSharingEvent",value:function(t){e._reportEvent(this,t?d.screenShareStart:d.screenShareStop)}},{key:"sendSetLocalDescFailed",value:function(t){e._reportError(this,l.setLocalDescription,t,this.peerconnection)}},{key:"sendSetRemoteDescFailed",value:function(t){e._reportError(this,l.setRemoteDescription,t,this.peerconnection)}},{key:"sendAddIceCandidateFailed",value:function(t){e._reportError(this,l.addIceCandidate,t,this.peerconnection)}}]),e}();t.default=m,m.backend=null,m.reportsQueue=[],m.initialized=!1,m.callStatsID=null,m.callStatsSecret=null,m.userID=null}).call(t,"modules/statistics/CallStats.js",n(4))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return!t||t<=0||!e||e<=0?0:Math.round(e/t*100)}function a(){this.loss={},this.bitrate={download:0,upload:0},this.resolution={},this.framerate=0}function s(){this.bandwidth={},this.bitrate={},this.packetLoss=null,this.transport=[]}function c(e,t,n,r){this._browserType=l.default.getBrowserType();var i=v[this._browserType];if(!i)throw"The browser type '"+this._browserType+"' isn't supported!";this._getStatValue=this._defineGetStatValueMethod(i),this.peerconnection=e,this.baselineAudioLevelsReport=null,this.currentAudioLevelsReport=null,this.currentStatsReport=null,this.previousStatsReport=null,this.audioLevelsIntervalId=null,this.eventEmitter=r,this.conferenceStats=new s,this.audioLevelsIntervalMilis=t,this.statsIntervalId=null,this.statsIntervalMilis=n,this.ssrc2stats={}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var u=n(2),l=i(u),d=n(52),f=r(d),p=n(3),h=n(1).getLogger(e),m=l.default.isChrome()||l.default.isOpera()||l.default.isFirefox()||l.default.isNWJS()||l.default.isElectron(),v={};v[l.default.RTC_BROWSER_FIREFOX]={ssrc:"ssrc",packetsReceived:"packetsReceived",packetsLost:"packetsLost",packetsSent:"packetsSent",bytesReceived:"bytesReceived",bytesSent:"bytesSent",framerateMean:"framerateMean"},v[l.default.RTC_BROWSER_CHROME]={receiveBandwidth:"googAvailableReceiveBandwidth",sendBandwidth:"googAvailableSendBandwidth",remoteAddress:"googRemoteAddress",transportType:"googTransportType",localAddress:"googLocalAddress",activeConnection:"googActiveConnection",ssrc:"ssrc",packetsReceived:"packetsReceived",packetsSent:"packetsSent",packetsLost:"packetsLost",bytesReceived:"bytesReceived",bytesSent:"bytesSent",googFrameHeightReceived:"googFrameHeightReceived",googFrameWidthReceived:"googFrameWidthReceived",googFrameHeightSent:"googFrameHeightSent",googFrameWidthSent:"googFrameWidthSent",googFrameRateReceived:"googFrameRateReceived",googFrameRateSent:"googFrameRateSent",audioInputLevel:"audioInputLevel",audioOutputLevel:"audioOutputLevel",currentRoundTripTime:"googRtt"},v[l.default.RTC_BROWSER_OPERA]=v[l.default.RTC_BROWSER_CHROME],v[l.default.RTC_BROWSER_NWJS]=v[l.default.RTC_BROWSER_CHROME],v[l.default.RTC_BROWSER_ELECTRON]=v[l.default.RTC_BROWSER_CHROME],v[l.default.RTC_BROWSER_IEXPLORER]=v[l.default.RTC_BROWSER_CHROME],v[l.default.RTC_BROWSER_SAFARI]=v[l.default.RTC_BROWSER_CHROME],v[l.default.RTC_BROWSER_REACT_NATIVE]=v[l.default.RTC_BROWSER_CHROME],a.prototype.setLoss=function(e){this.loss=e||{}},a.prototype.setResolution=function(e){this.resolution=e||{}},a.prototype.addBitrate=function(e){this.bitrate.download+=e.download,this.bitrate.upload+=e.upload},a.prototype.resetBitrate=function(){this.bitrate.download=0,this.bitrate.upload=0},a.prototype.setFramerate=function(e){this.framerate=e||0},c.prototype.stop=function(){this.audioLevelsIntervalId&&(clearInterval(this.audioLevelsIntervalId),this.audioLevelsIntervalId=null),this.statsIntervalId&&(clearInterval(this.statsIntervalId),this.statsIntervalId=null)},c.prototype.errorCallback=function(e){p.callErrorHandler(e),h.error("Get stats error",e),this.stop()},c.prototype.start=function(e){var t=this;e&&(this.audioLevelsIntervalId=setInterval(function(){t.peerconnection.getStats(function(e){var n=null;n=e&&e.result&&"function"==typeof e.result?e.result():e,t.currentAudioLevelsReport=n,t.processAudioLevelReport(),t.baselineAudioLevelsReport=t.currentAudioLevelsReport},t.errorCallback)},t.audioLevelsIntervalMilis)),m&&(this.statsIntervalId=setInterval(function(){t.peerconnection.getStats(function(e){var n=null;n=e&&e.result&&"function"==typeof e.result?e.result():e,t.currentStatsReport=n;try{t.processStatsReport()}catch(e){p.callErrorHandler(e),h.error("Unsupported key:"+e,e)}t.previousStatsReport=t.currentStatsReport},t.errorCallback)},t.statsIntervalMilis))},c.prototype._defineGetStatValueMethod=function(e){var t=function(t){var n=e[t];if(n)return n;throw"The property '"+t+"' isn't supported!"},n=void 0;switch(this._browserType){case l.default.RTC_BROWSER_CHROME:case l.default.RTC_BROWSER_OPERA:case l.default.RTC_BROWSER_NWJS:case l.default.RTC_BROWSER_ELECTRON:n=function(e,t){return e.stat(t)};break;case l.default.RTC_BROWSER_REACT_NATIVE:n=function(e,t){var n=void 0;return e.values.some(function(e){return!!e.hasOwnProperty(t)&&(n=e[t],!0)}),n};break;default:n=function(e,t){return e[t]}}return function(e,r){return n(e,t(r))}},c.prototype.processStatsReport=function(){function e(e,t){var r=n(e,t);return"number"!=typeof r&&(r=Number(r)),isNaN(r)?0:Math.max(0,r)}var t=this;if(this.previousStatsReport){var n=this._getStatValue,r={};for(var i in this.currentStatsReport)if(this.currentStatsReport.hasOwnProperty(i)){var s=this.currentStatsReport[i];if(s){try{var c=n(s,"receiveBandwidth"),u=n(s,"sendBandwidth");(c||u)&&(this.conferenceStats.bandwidth={download:Math.round(c/1e3),upload:Math.round(u/1e3)})}catch(e){}if("googCandidatePair"===s.type){var l=function(){var r=void 0,i=void 0,o=void 0,a=void 0,c=void 0;try{i=n(s,"remoteAddress"),c=n(s,"transportType"),o=n(s,"localAddress"),r=n(s,"activeConnection"),a=e(s,"currentRoundTripTime")}catch(e){}if(!i||!c||!o||"true"!==r)return"continue";var u=t.conferenceStats.transport;return u.some(function(e){return e.ip===i&&e.type===c&&e.localip===o})||u.push({ip:i,type:c,localip:o,p2p:t.peerconnection.isP2P,rtt:a}),"continue"}();if("continue"===l)continue}if("candidatepair"===s.type){if("succeeded"!==s.state)continue;var d=this.currentStatsReport[s.localCandidateId],p=this.currentStatsReport[s.remoteCandidateId];this.conferenceStats.transport.push({ip:p.ipAddress+":"+p.portNumber,type:d.transport,localip:d.ipAddress+":"+d.portNumber,p2p:this.peerconnection.isP2P})}if("ssrc"===s.type||"outboundrtp"===s.type||"inboundrtp"===s.type){var m=this.previousStatsReport[i],v=n(s,"ssrc");if(m&&v&&s.isRemote!==!0){var g=this.ssrc2stats[v]||(this.ssrc2stats[v]=new a),y=!0,b="packetsReceived",E=n(s,b);if("undefined"!=typeof E&&null!==E&&""!==E||(y=!1,b="packetsSent",E=n(s,b),"undefined"!=typeof E&&null!==E)){(!E||E<0)&&(E=0);var S=e(m,b),T=Math.max(0,E-S),C=e(s,"packetsLost"),w=e(m,"packetsLost"),_=Math.max(0,C-w);g.setLoss({packetsTotal:T+_,packetsLost:_,isDownloadStream:y});var R=e(s,"bytesReceived"),A=e(m,"bytesReceived"),k=Math.max(0,R-A),O=0,I=n(s,"bytesSent");"number"!=typeof I&&"string"!=typeof I||(I=Number(I),isNaN(I)||(r[v]=I,I>0&&(O=I-n(m,"bytesSent")))),O=Math.max(0,O);var P=s.timestamp-m.timestamp,D=0,N=0;P>0&&(D=Math.round(8*k/P),N=Math.round(8*O/P)),g.addBitrate({download:D,upload:N});var x={height:null,width:null};try{var L=void 0,M=void 0;(L=n(s,"googFrameHeightReceived"))&&(M=n(s,"googFrameWidthReceived"))?(x.height=L,x.width=M):(L=n(s,"googFrameHeightSent"))&&(M=n(s,"googFrameWidthSent"))&&(x.height=L,x.width=M)}catch(e){}try{g.setFramerate(n(s,"googFrameRateReceived")||n(s,"googFrameRateSent")||0)}catch(t){try{g.setFramerate(Math.round(e(s,"framerateMean")))}catch(e){}}x.height&&x.width?g.setResolution(x):g.setResolution(null)}else h.warn("No packetsReceived nor packetsSent stat found")}}}}var j={download:0,upload:0},F={download:0,upload:0},U=0,B=0,J={},H={};Object.keys(this.ssrc2stats).forEach(function(e){var t=this.ssrc2stats[e],n=t.loss,r=n.isDownloadStream?"download":"upload";j[r]+=n.packetsTotal,F[r]+=n.packetsLost,U+=t.bitrate.download,B+=t.bitrate.upload,t.resetBitrate(),J[e]=t.resolution,H[e]=t.framerate},this),this.eventEmitter.emit(f.BYTE_SENT_STATS,this.peerconnection,r),this.conferenceStats.bitrate={upload:B,download:U},this.conferenceStats.packetLoss={total:o(F.download+F.upload,j.download+j.upload),download:o(F.download,j.download),upload:o(F.upload,j.upload)},this.eventEmitter.emit(f.CONNECTION_STATS,{bandwidth:this.conferenceStats.bandwidth,bitrate:this.conferenceStats.bitrate,packetLoss:this.conferenceStats.packetLoss,resolution:J,framerate:H,transport:this.conferenceStats.transport}),this.conferenceStats.transport=[]}},c.prototype.processAudioLevelReport=function(){if(this.baselineAudioLevelsReport){var e=this._getStatValue;for(var t in this.currentAudioLevelsReport)if(this.currentAudioLevelsReport.hasOwnProperty(t)){var n=this.currentAudioLevelsReport[t];if("ssrc"===n.type){var r=this.baselineAudioLevelsReport[t],i=e(n,"ssrc");if(r)if(i){var o=void 0;try{o=e(n,"audioInputLevel")||e(n,"audioOutputLevel")}catch(e){return h.warn("Audio Levels are not available in the statistics."),void clearInterval(this.audioLevelsIntervalId)}if(o){var a=!e(n,"packetsReceived");o/=32767,this.eventEmitter.emit(f.AUDIO_LEVEL,i,o,a)}}else Date.now()-n.timestamp<3e3&&h.warn("No ssrc: ");else h.warn(i+" not enough data")}}}}}).call(t,"modules/statistics/RTPStatsCollector.js")},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,r,i){n(this,e),this._userId=t,this.setDisplayName(r),this._isLocalStats=i||!1,this.setIsDominantSpeaker(!1),this.totalDominantSpeakerTime=0,this._dominantSpeakerStart=null,this._hasLeft=!1}return r(e,[{key:"getUserId",value:function(){return this._userId}},{key:"getDisplayName",value:function(){return this.displayName}},{key:"setDisplayName",value:function(e){this.displayName=e}},{key:"isLocalStats",value:function(){return this._isLocalStats}},{key:"isDominantSpeaker",value:function(){return this._isDominantSpeaker}},{key:"setIsDominantSpeaker",value:function(e){if(!this._isDominantSpeaker&&e)this._dominantSpeakerStart=Date.now();else if(this._isDominantSpeaker&&!e){var t=Date.now(),n=t-(this._dominantSpeakerStart||0);this.totalDominantSpeakerTime+=n,this._dominantSpeakerStart=null}this._isDominantSpeaker=e}},{key:"getTotalDominantSpeakerTime",value:function(){var e=this.totalDominantSpeakerTime;return this._isDominantSpeaker&&(e+=Date.now()-this._dominantSpeakerStart),e}},{key:"hasLeft",value:function(){return this._hasLeft}},{key:"markAsHasLeft",value:function(){this._hasLeft=!0,this.setIsDominantSpeaker(!1)}}]),e}();e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(8),c=i(s),u=n(94),l=r(u),d=function(){function e(t){o(this,e),this.stats={users:{},dominantSpeakerId:null};var n=t.myUserId();this.stats.users[n]=new l.default(n,null,!0),t.addEventListener(c.DOMINANT_SPEAKER_CHANGED,this._onDominantSpeaker.bind(this)),t.addEventListener(c.USER_JOINED,this._onUserJoin.bind(this)),t.addEventListener(c.USER_LEFT,this._onUserLeave.bind(this)),t.addEventListener(c.DISPLAY_NAME_CHANGED,this._onDisplayNameChange.bind(this))}return a(e,[{key:"_onDominantSpeaker",value:function(e){var t=this.stats.users[this.stats.dominantSpeakerId],n=this.stats.users[e];t&&t.setIsDominantSpeaker(!1),n&&n.setIsDominantSpeaker(!0),this.stats.dominantSpeakerId=e}},{key:"_onUserJoin",value:function(e,t){var n=this.stats.users[e];n||(n=this.stats.users[e]=new l.default(e,t.getDisplayName()))}},{key:"_onUserLeave",value:function(e){var t=this.stats.users[e];t&&t.markAsHasLeft()}},{key:"_onDisplayNameChange",value:function(e,t){var n=this.stats.users[e];n&&n.setDisplayName(t)}},{key:"getStats",value:function(){return this.stats.users}}]),e}();t.default=d},function(e,t){"use strict";var n=function(e,t,n,r){this.blob=e,this.name=t,this.startTime=n,this.wordArray=r};e.exports=n},function(e,t,n){"use strict";function r(){this.audioRecorder=new s,this.transcriptionService=new c,this.counter=null,this.startTime=null,this.transcription=null,this.callback=null,this.results=[],this.state=u,this.lineLength=0}function i(e,t){if(console.log("retrieved an answer from the transcription service. The answer has an array of length: "+t.wordArray.length),t.wordArray.length>0){var n=t.startTime.getUTCMilliseconds()-e.startTime.getUTCMilliseconds();n<0&&(n=0);var r="[";t.wordArray.forEach(function(e){e.begin+=n,e.end+=n,r+=e.word+","}),r+="]",console.log(r),t.wordArray.name=t.name}e.results.push(t.wordArray),e.counter--,console.log("current counter: "+e.counter),e.maybeMerge()}function o(e){for(var t=0;t<e.length;t++)0===e[t].length&&e.splice(t,1);return e.length>0}function a(e,t){if(0===e.length)e.push(t);else{if(e[e.length-1].begin<=t.begin)return void e.push(t);for(var n=0;n<e.length;n++)if(t.begin<e[n].begin)return void e.splice(n,0,t);e.push(t)}}var s=n(46),c=n(99),u="before",l="recording",d="transcribing",f="finished",p=80;r.prototype.start=function(){if(this.state!==u)throw new Error("The transcription can only start when it's in the \""+u+'" state. It\'s currently in the "'+this.state+'" state');this.state=l,this.audioRecorder.start(),this.startTime=new Date},r.prototype.stop=function(e){var t=this;if(this.state!==l)throw new Error("The transcription can only stop when it's in the \""+l+'" state. It\'s currently in the "'+this.state+'" state');console.log("stopping recording and sending audio files"),this.audioRecorder.stop();var n=i.bind(null,this);this.audioRecorder.getRecordingResults().forEach(function(e){t.transcriptionService.send(e,n),t.counter++}),this.state=d,this.callback=e},r.prototype.maybeMerge=function(){this.state===d&&0===this.counter&&this.merge()},r.prototype.merge=function(){var e=this;console.log("starting merge process!\n The length of the array: "+this.results.length),this.transcription="";var t=this.results,n=[];o(t),t.forEach(function(e){return a(n,e)});for(var r=function(){var n=t[0];t.forEach(function(e){e[0].begin<n[0].begin&&(n=e)});var r=n.shift();e.updateTranscription(r,n.name);for(var i=function(){var i=!1,o=n[0].begin;return t.forEach(function(e){e[0].begin<o&&(i=!0)}),i?"break":(r=n.shift(),void e.updateTranscription(r,null))};n.length>0;){var o=i();if("break"===o)break}};o(t);)r();this.state=f,this.callback&&this.callback(this.transcription)},r.prototype.updateTranscription=function(e,t){void 0!==t&&null!==t&&(this.transcription+="\n"+t+":",this.lineLength=t.length+1),this.lineLength+e.word.length>p&&(this.transcription+="\n    ",this.lineLength=4),this.transcription+=" "+e.word,this.lineLength+=e.word.length+1},r.prototype.addTrack=function(e){this.audioRecorder.addTrack(e)},r.prototype.removeTrack=function(e){this.audioRecorder.removeTrack(e)},r.prototype.getTranscription=function(){if(this.state!==f)throw new Error("The transcription can only be retrieved when it's in the \""+f+'" state. It\'s currently in the "'+this.state+'" state');return this.transcription},r.prototype.getState=function(){return this.state},r.prototype.reset=function(){this.state=u,this.counter=null,this.transcription=null,this.startTime=null,this.callback=null,this.results=[],this.lineLength=0},e.exports=r},function(e,t){"use strict";var n=function(){throw new Error("TranscriptionService is abstract and cannot becreated")};n.prototype.send=function(e,t){var n=this;this.sendRequest(e.blob,function(r){n.verify(r)?e.wordArray=n.formatResponse(r):(console.log("the retrieved response from the server is not valid!"),e.wordArray=[]),t(e)})},n.prototype.sendRequest=function(e,t){throw new Error("TranscriptionService.sendRequest is abstract")},n.prototype.formatResponse=function(e){throw new Error("TranscriptionService.format is abstract")},n.prototype.verify=function(e){throw new Error("TranscriptionService.verify is abstract")},e.exports=n},function(e,t,n){"use strict";function r(){var e="config does not contain an url to a Sphinx4 https server";if(void 0===config.sphinxURL)console.log(e);else{var t=config.sphinxURL;if(void 0!==t.includes&&t.includes("https://"))return t;console.log(e)}}var i=n(98),o=n(100),a=n(46),s=function(){this.url=r()};s.prototype=Object.create(i.prototype),s.constructor=s,s.prototype.sendRequest=function(e,t){console.log("sending an audio file  to "+this.url),console.log("the audio file being sent: "+e);var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE&&200===n.status)t(n.responseText);else if(n.readyState===XMLHttpRequest.DONE)throw new Error("unable to accept response from sphinx server. status: "+n.status)},n.open("POST",this.url),n.setRequestHeader("Content-Type",a.determineCorrectFileType()),n.send(e),console.log("send "+e)},s.prototype.formatResponse=function(e){var t=JSON.parse(e).objects;t.shift();var n=[];return t.forEach(function(e){return e.filler||n.push(new o(e.word,e.start,e.end))}),n},s.prototype.verify=function(e){if(console.log("response from server:"+e.toString()),"string"!=typeof e)return!1;var t=void 0;try{t=JSON.parse(e)}catch(e){return console.log(e),!1}if(void 0===t.objects)return!1;var n=t.objects;return!(!n[0]||!n[0]["session-id"])},e.exports=s},function(e,t){"use strict";var n=function(e,t,n){this.word=e,this.begin=t,this.end=n};n.prototype.getWord=function(){return this.word},n.prototype.getBeginTime=function(){return this.begin},n.prototype.getEndTime=function(){return this.end},e.exports=n},function(e,t){"use strict";var n={getTokenAuthUrl:function(e,t,n){var r=e;return"string"!=typeof r?null:r.replace("{room}",t).replace("{roleUpgrade}",n===!0)}};e.exports=n},function(e,t){"use strict";function n(e,t){if(!e||!t||"function"!=typeof e.addListener||"function"!=typeof t.emit)throw new Error("Invalid arguments passed to EventEmitterForwarder");this.src=e,this.dest=t}n.prototype.forward=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0];t[0]=this.dest,this.src.addListener(r,Function.prototype.bind.apply(this.dest.emit,t))},e.exports=n},function(e,t,n){"use strict";function r(){var e=i.randomElement(o),t=i.randomAlphanumStr(3);return e+"-"+t}var i=n(22),o=["Aaliyah","Aaron","Abagail","Abbey","Abbie","Abbigail","Abby","Abdiel","Abdul","Abdullah","Abe","Abel","Abelardo","Abigail","Abigale","Abigayle","Abner","Abraham","Ada","Adah","Adalberto","Adaline","Adam","Adan","Addie","Addison","Adela","Adelbert","Adele","Adelia","Adeline","Adell","Adella","Adelle","Aditya","Adolf","Adolfo","Adolph","Adolphus","Adonis","Adrain","Adrian","Adriana","Adrianna","Adriel","Adrien","Adrienne","Afton","Aglae","Agnes","Agustin","Agustina","Ahmad","Ahmed","Aida","Aidan","Aiden","Aileen","Aisha","Aiyana","Akeem","Al","Alaina","Alan","Alana","Alanis","Alanna","Alayna","Alba","Albert","Alberta","Albertha","Alberto","Albin","Albina","Alda","Alden","Alec","Aleen","Alejandra","Alejandrin","Alek","Alena","Alene","Alessandra","Alessandro","Alessia","Aletha","Alex","Alexa","Alexander","Alexandra","Alexandre","Alexandrea","Alexandria","Alexandrine","Alexandro","Alexane","Alexanne","Alexie","Alexis","Alexys","Alexzander","Alf","Alfonso","Alfonzo","Alford","Alfred","Alfreda","Alfredo","Ali","Alia","Alice","Alicia","Alisa","Alisha","Alison","Alivia","Aliya","Aliyah","Aliza","Alize","Allan","Allen","Allene","Allie","Allison","Ally","Alphonso","Alta","Althea","Alva","Alvah","Alvena","Alvera","Alverta","Alvina","Alvis","Alyce","Alycia","Alysa","Alysha","Alyson","Alysson","Amalia","Amanda","Amani","Amara","Amari","Amaya","Amber","Ambrose","Amelia","Amelie","Amely","America","Americo","Amie","Amina","Amir","Amira","Amiya","Amos","Amparo","Amy","Amya","Ana","Anabel","Anabelle","Anahi","Anais","Anastacio","Anastasia","Anderson","Andre","Andreane","Andreanne","Andres","Andrew","Andy","Angel","Angela","Angelica","Angelina","Angeline","Angelita","Angelo","Angie","Angus","Anibal","Anika","Anissa","Anita","Aniya","Aniyah","Anjali","Anna","Annabel","Annabell","Annabelle","Annalise","Annamae","Annamarie","Anne","Annetta","Annette","Annie","Ansel","Ansley","Anthony","Antoinette","Antone","Antonetta","Antonette","Antonia","Antonietta","Antonina","Antonio","Antwan","Antwon","Anya","April","Ara","Araceli","Aracely","Arch","Archibald","Ardella","Arden","Ardith","Arely","Ari","Ariane","Arianna","Aric","Ariel","Arielle","Arjun","Arlene","Arlie","Arlo","Armand","Armando","Armani","Arnaldo","Arne","Arno","Arnold","Arnoldo","Arnulfo","Aron","Art","Arthur","Arturo","Arvel","Arvid","Arvilla","Aryanna","Asa","Asha","Ashlee","Ashleigh","Ashley","Ashly","Ashlynn","Ashton","Ashtyn","Asia","Assunta","Astrid","Athena","Aubree","Aubrey","Audie","Audra","Audreanne","Audrey","August","Augusta","Augustine","Augustus","Aurelia","Aurelie","Aurelio","Aurore","Austen","Austin","Austyn","Autumn","Ava","Avery","Avis","Axel","Ayana","Ayden","Ayla","Aylin","Baby","Bailee","Bailey","Barbara","Barney","Baron","Barrett","Barry","Bart","Bartholome","Barton","Baylee","Beatrice","Beau","Beaulah","Bell","Bella","Belle","Ben","Benedict","Benjamin","Bennett","Bennie","Benny","Benton","Berenice","Bernadette","Bernadine","Bernard","Bernardo","Berneice","Bernhard","Bernice","Bernie","Berniece","Bernita","Berry","Bert","Berta","Bertha","Bertram","Bertrand","Beryl","Bessie","Beth","Bethany","Bethel","Betsy","Bette","Bettie","Betty","Bettye","Beulah","Beverly","Bianka","Bill","Billie","Billy","Birdie","Blair","Blaise","Blake","Blanca","Blanche","Blaze","Bo","Bobbie","Bobby","Bonita","Bonnie","Boris","Boyd","Brad","Braden","Bradford","Bradley","Bradly","Brady","Braeden","Brain","Brandi","Brando","Brandon","Brandt","Brandy","Brandyn","Brannon","Branson","Brant","Braulio","Braxton","Brayan","Breana","Breanna","Breanne","Brenda","Brendan","Brenden","Brendon","Brenna","Brennan","Brennon","Brent","Bret","Brett","Bria","Brian","Briana","Brianne","Brice","Bridget","Bridgette","Bridie","Brielle","Brigitte","Brionna","Brisa","Britney","Brittany","Brock","Broderick","Brody","Brook","Brooke","Brooklyn","Brooks","Brown","Bruce","Bryana","Bryce","Brycen","Bryon","Buck","Bud","Buddy","Buford","Bulah","Burdette","Burley","Burnice","Buster","Cade","Caden","Caesar","Caitlyn","Cale","Caleb","Caleigh","Cali","Calista","Callie","Camden","Cameron","Camila","Camilla","Camille","Camren","Camron","Camryn","Camylle","Candace","Candelario","Candice","Candida","Candido","Cara","Carey","Carissa","Carlee","Carleton","Carley","Carli","Carlie","Carlo","Carlos","Carlotta","Carmel","Carmela","Carmella","Carmelo","Carmen","Carmine","Carol","Carolanne","Carole","Carolina","Caroline","Carolyn","Carolyne","Carrie","Carroll","Carson","Carter","Cary","Casandra","Casey","Casimer","Casimir","Casper","Cassandra","Cassandre","Cassidy","Cassie","Catalina","Caterina","Catharine","Catherine","Cathrine","Cathryn","Cathy","Cayla","Ceasar","Cecelia","Cecil","Cecile","Cecilia","Cedrick","Celestine","Celestino","Celia","Celine","Cesar","Chad","Chadd","Chadrick","Chaim","Chance","Chandler","Chanel","Chanelle","Charity","Charlene","Charles","Charley","Charlie","Charlotte","Chase","Chasity","Chauncey","Chaya","Chaz","Chelsea","Chelsey","Chelsie","Chesley","Chester","Chet","Cheyanne","Cheyenne","Chloe","Chris","Christ","Christa","Christelle","Christian","Christiana","Christina","Christine","Christop","Christophe","Christopher","Christy","Chyna","Ciara","Cicero","Cielo","Cierra","Cindy","Citlalli","Clair","Claire","Clara","Clarabelle","Clare","Clarissa","Clark","Claud","Claude","Claudia","Claudie","Claudine","Clay","Clemens","Clement","Clementina","Clementine","Clemmie","Cleo","Cleora","Cleta","Cletus","Cleve","Cleveland","Clifford","Clifton","Clint","Clinton","Clotilde","Clovis","Cloyd","Clyde","Coby","Cody","Colby","Cole","Coleman","Colin","Colleen","Collin","Colt","Colten","Colton","Columbus","Concepcion","Conner","Connie","Connor","Conor","Conrad","Constance","Constantin","Consuelo","Cooper","Cora","Coralie","Corbin","Cordelia","Cordell","Cordia","Cordie","Corene","Corine","Cornelius","Cornell","Corrine","Cortez","Cortney","Cory","Coty","Courtney","Coy","Craig","Crawford","Creola","Cristal","Cristian","Cristina","Cristobal","Cristopher","Cruz","Crystal","Crystel","Cullen","Curt","Curtis","Cydney","Cynthia","Cyril","Cyrus","Dagmar","Dahlia","Daija","Daisha","Daisy","Dakota","Dale","Dallas","Dallin","Dalton","Damaris","Dameon","Damian","Damien","Damion","Damon","Dan","Dana","Dandre","Dane","D'angelo","Dangelo","Danial","Daniela","Daniella","Danielle","Danika","Dannie","Danny","Dante","Danyka","Daphne","Daphnee","Daphney","Darby","Daren","Darian","Dariana","Darien","Dario","Darion","Darius","Darlene","Daron","Darrel","Darrell","Darren","Darrick","Darrin","Darrion","Darron","Darryl","Darwin","Daryl","Dashawn","Dasia","Dave","David","Davin","Davion","Davon","Davonte","Dawn","Dawson","Dax","Dayana","Dayna","Dayne","Dayton","Dean","Deangelo","Deanna","Deborah","Declan","Dedric","Dedrick","Dee","Deion","Deja","Dejah","Dejon","Dejuan","Delaney","Delbert","Delfina","Delia","Delilah","Dell","Della","Delmer","Delores","Delpha","Delphia","Delphine","Delta","Demarco","Demarcus","Demario","Demetris","Demetrius","Demond","Dena","Denis","Dennis","Deon","Deondre","Deontae","Deonte","Dereck","Derek","Derick","Deron","Derrick","Deshaun","Deshawn","Desiree","Desmond","Dessie","Destany","Destin","Destinee","Destiney","Destini","Destiny","Devan","Devante","Deven","Devin","Devon","Devonte","Devyn","Dewayne","Dewitt","Dexter","Diamond","Diana","Dianna","Diego","Dillan","Dillon","Dimitri","Dina","Dino","Dion","Dixie","Dock","Dolly","Dolores","Domenic","Domenica","Domenick","Domenico","Domingo","Dominic","Dominique","Don","Donald","Donato","Donavon","Donna","Donnell","Donnie","Donny","Dora","Dorcas","Dorian","Doris","Dorothea","Dorothy","Dorris","Dortha","Dorthy","Doug","Douglas","Dovie","Doyle","Drake","Drew","Duane","Dudley","Dulce","Duncan","Durward","Dustin","Dusty","Dwight","Dylan","Earl","Earlene","Earline","Earnest","Earnestine","Easter","Easton","Ebba","Ebony","Ed","Eda","Edd","Eddie","Eden","Edgar","Edgardo","Edison","Edmond","Edmund","Edna","Eduardo","Edward","Edwardo","Edwin","Edwina","Edyth","Edythe","Effie","Efrain","Efren","Eileen","Einar","Eino","Eladio","Elaina","Elbert","Elda","Eldon","Eldora","Eldred","Eldridge","Eleanora","Eleanore","Eleazar","Electa","Elena","Elenor","Elenora","Eleonore","Elfrieda","Eli","Elian","Eliane","Elias","Eliezer","Elijah","Elinor","Elinore","Elisa","Elisabeth","Elise","Eliseo","Elisha","Elissa","Eliza","Elizabeth","Ella","Ellen","Ellie","Elliot","Elliott","Ellis","Ellsworth","Elmer","Elmira","Elmo","Elmore","Elna","Elnora","Elody","Eloisa","Eloise","Elouise","Eloy","Elroy","Elsa","Else","Elsie","Elta","Elton","Elva","Elvera","Elvie","Elvis","Elwin","Elwyn","Elyse","Elyssa","Elza","Emanuel","Emelia","Emelie","Emely","Emerald","Emerson","Emery","Emie","Emil","Emile","Emilia","Emiliano","Emilie","Emilio","Emily","Emma","Emmalee","Emmanuel","Emmanuelle","Emmet","Emmett","Emmie","Emmitt","Emmy","Emory","Ena","Enid","Enoch","Enola","Enos","Enrico","Enrique","Ephraim","Era","Eriberto","Eric","Erica","Erich","Erick","Ericka","Erik","Erika","Erin","Erling","Erna","Ernest","Ernestina","Ernestine","Ernesto","Ernie","Ervin","Erwin","Eryn","Esmeralda","Esperanza","Esta","Esteban","Estefania","Estel","Estell","Estella","Estelle","Estevan","Esther","Estrella","Etha","Ethan","Ethel","Ethelyn","Ethyl","Ettie","Eudora","Eugene","Eugenia","Eula","Eulah","Eulalia","Euna","Eunice","Eusebio","Eva","Evalyn","Evan","Evangeline","Evans","Eve","Eveline","Evelyn","Everardo","Everett","Everette","Evert","Evie","Ewald","Ewell","Ezekiel","Ezequiel","Ezra","Fabian","Fabiola","Fae","Fannie","Fanny","Fatima","Faustino","Fausto","Favian","Fay","Faye","Federico","Felicia","Felicita","Felicity","Felipa","Felipe","Felix","Felton","Fermin","Fern","Fernando","Ferne","Fidel","Filiberto","Filomena","Finn","Fiona","Flavie","Flavio","Fleta","Fletcher","Flo","Florence","Florencio","Florian","Florida","Florine","Flossie","Floy","Floyd","Ford","Forest","Forrest","Foster","Frances","Francesca","Francesco","Francis","Francisca","Francisco","Franco","Frank","Frankie","Franz","Fred","Freda","Freddie","Freddy","Frederic","Frederick","Frederik","Frederique","Fredrick","Fredy","Freeda","Freeman","Freida","Frida","Frieda","Friedrich","Fritz","Furman","Gabe","Gabriel","Gabriella","Gabrielle","Gaetano","Gage","Gail","Gardner","Garett","Garfield","Garland","Garnet","Garnett","Garret","Garrett","Garrick","Garrison","Garry","Garth","Gaston","Gavin","Gay","Gayle","Gaylord","Gene","General","Genesis","Genevieve","Gennaro","Genoveva","Geo","Geoffrey","George","Georgette","Georgiana","Georgianna","Geovanni","Geovanny","Geovany","Gerald","Geraldine","Gerard","Gerardo","Gerda","Gerhard","Germaine","German","Gerry","Gerson","Gertrude","Gia","Gianni","Gideon","Gilbert","Gilberto","Gilda","Giles","Gillian","Gina","Gino","Giovani","Giovanna","Giovanni","Giovanny","Gisselle","Giuseppe","Gladyce","Gladys","Glen","Glenda","Glenna","Glennie","Gloria","Godfrey","Golda","Golden","Gonzalo","Gordon","Grace","Gracie","Graciela","Grady","Graham","Grant","Granville","Grayce","Grayson","Green","Greg","Gregg","Gregoria","Gregorio","Gregory","Greta","Gretchen","Greyson","Griffin","Grover","Guadalupe","Gudrun","Guido","Guillermo","Guiseppe","Gunnar","Gunner","Gus","Gussie","Gust","Gustave","Guy","Gwen","Gwendolyn","Hadley","Hailee","Hailey","Hailie","Hal","Haleigh","Haley","Halie","Halle","Hallie","Hank","Hanna","Hannah","Hans","Hardy","Harley","Harmon","Harmony","Harold","Harrison","Harry","Harvey","Haskell","Hassan","Hassie","Hattie","Haven","Hayden","Haylee","Hayley","Haylie","Hazel","Hazle","Heath","Heather","Heaven","Heber","Hector","Heidi","Helen","Helena","Helene","Helga","Hellen","Helmer","Heloise","Henderson","Henri","Henriette","Henry","Herbert","Herman","Hermann","Hermina","Herminia","Herminio","Hershel","Herta","Hertha","Hester","Hettie","Hilario","Hilbert","Hilda","Hildegard","Hillard","Hillary","Hilma","Hilton","Hipolito","Hiram","Hobart","Holden","Hollie","Hollis","Holly","Hope","Horace","Horacio","Hortense","Hosea","Houston","Howard","Howell","Hoyt","Hubert","Hudson","Hugh","Hulda","Humberto","Hunter","Hyman","Ian","Ibrahim","Icie","Ida","Idell","Idella","Ignacio","Ignatius","Ike","Ila","Ilene","Iliana","Ima","Imani","Imelda","Immanuel","Imogene","Ines","Irma","Irving","Irwin","Isaac","Isabel","Isabell","Isabella","Isabelle","Isac","Isadore","Isai","Isaiah","Isaias","Isidro","Ismael","Isobel","Isom","Israel","Issac","Itzel","Iva","Ivah","Ivory","Ivy","Izabella","Izaiah","Jabari","Jace","Jacey","Jacinthe","Jacinto","Jack","Jackeline","Jackie","Jacklyn","Jackson","Jacky","Jaclyn","Jacquelyn","Jacques","Jacynthe","Jada","Jade","Jaden","Jadon","Jadyn","Jaeden","Jaida","Jaiden","Jailyn","Jaime","Jairo","Jakayla","Jake","Jakob","Jaleel","Jalen","Jalon","Jalyn","Jamaal","Jamal","Jamar","Jamarcus","Jamel","Jameson","Jamey","Jamie","Jamil","Jamir","Jamison","Jammie","Jan","Jana","Janae","Jane","Janelle","Janessa","Janet","Janice","Janick","Janie","Janis","Janiya","Jannie","Jany","Jaquan","Jaquelin","Jaqueline","Jared","Jaren","Jarod","Jaron","Jarred","Jarrell","Jarret","Jarrett","Jarrod","Jarvis","Jasen","Jasmin","Jason","Jasper","Jaunita","Javier","Javon","Javonte","Jay","Jayce","Jaycee","Jayda","Jayde","Jayden","Jaydon","Jaylan","Jaylen","Jaylin","Jaylon","Jayme","Jayne","Jayson","Jazlyn","Jazmin","Jazmyn","Jazmyne","Jean","Jeanette","Jeanie","Jeanne","Jed","Jedediah","Jedidiah","Jeff","Jefferey","Jeffery","Jeffrey","Jeffry","Jena","Jenifer","Jennie","Jennifer","Jennings","Jennyfer","Jensen","Jerad","Jerald","Jeramie","Jeramy","Jerel","Jeremie","Jeremy","Jermain","Jermaine","Jermey","Jerod","Jerome","Jeromy","Jerrell","Jerrod","Jerrold","Jerry","Jess","Jesse","Jessica","Jessie","Jessika","Jessy","Jessyca","Jesus","Jett","Jettie","Jevon","Jewel","Jewell","Jillian","Jimmie","Jimmy","Jo","Joan","Joana","Joanie","Joanne","Joannie","Joanny","Joany","Joaquin","Jocelyn","Jodie","Jody","Joe","Joel","Joelle","Joesph","Joey","Johan","Johann","Johanna","Johathan","John","Johnathan","Johnathon","Johnnie","Johnny","Johnpaul","Johnson","Jolie","Jon","Jonas","Jonatan","Jonathan","Jonathon","Jordan","Jordane","Jordi","Jordon","Jordy","Jordyn","Jorge","Jose","Josefa","Josefina","Joseph","Josephine","Josh","Joshua","Joshuah","Josiah","Josiane","Josianne","Josie","Josue","Jovan","Jovani","Jovanny","Jovany","Joy","Joyce","Juana","Juanita","Judah","Judd","Jude","Judge","Judson","Judy","Jules","Julia","Julian","Juliana","Julianne","Julie","Julien","Juliet","Julio","Julius","June","Junior","Junius","Justen","Justice","Justina","Justine","Juston","Justus","Justyn","Juvenal","Juwan","Kacey","Kaci","Kacie","Kade","Kaden","Kadin","Kaela","Kaelyn","Kaia","Kailee","Kailey","Kailyn","Kaitlin","Kaitlyn","Kale","Kaleb","Kaleigh","Kaley","Kali","Kallie","Kameron","Kamille","Kamren","Kamron","Kamryn","Kane","Kara","Kareem","Karelle","Karen","Kari","Kariane","Karianne","Karina","Karine","Karl","Karlee","Karley","Karli","Karlie","Karolann","Karson","Kasandra","Kasey","Kassandra","Katarina","Katelin","Katelyn","Katelynn","Katharina","Katherine","Katheryn","Kathleen","Kathlyn","Kathryn","Kathryne","Katlyn","Katlynn","Katrina","Katrine","Kattie","Kavon","Kay","Kaya","Kaycee","Kayden","Kayla","Kaylah","Kaylee","Kayleigh","Kayley","Kayli","Kaylie","Kaylin","Keagan","Keanu","Keara","Keaton","Keegan","Keeley","Keely","Keenan","Keira","Keith","Kellen","Kelley","Kelli","Kellie","Kelly","Kelsi","Kelsie","Kelton","Kelvin","Ken","Kendall","Kendra","Kendrick","Kenna","Kennedi","Kennedy","Kenneth","Kennith","Kenny","Kenton","Kenya","Kenyatta","Kenyon","Keon","Keshaun","Keshawn","Keven","Kevin","Kevon","Keyon","Keyshawn","Khalid","Khalil","Kian","Kiana","Kianna","Kiara","Kiarra","Kiel","Kiera","Kieran","Kiley","Kim","Kimberly","King","Kip","Kira","Kirk","Kirsten","Kirstin","Kitty","Kobe","Koby","Kody","Kolby","Kole","Korbin","Korey","Kory","Kraig","Kris","Krista","Kristian","Kristin","Kristina","Kristofer","Kristoffer","Kristopher","Kristy","Krystal","Krystel","Krystina","Kurt","Kurtis","Kyla","Kyle","Kylee","Kyleigh","Kyler","Kylie","Kyra","Lacey","Lacy","Ladarius","Lafayette","Laila","Laisha","Lamar","Lambert","Lamont","Lance","Landen","Lane","Laney","Larissa","Laron","Larry","Larue","Laura","Laurel","Lauren","Laurence","Lauretta","Lauriane","Laurianne","Laurie","Laurine","Laury","Lauryn","Lavada","Lavern","Laverna","Laverne","Lavina","Lavinia","Lavon","Lavonne","Lawrence","Lawson","Layla","Layne","Lazaro","Lea","Leann","Leanna","Leanne","Leatha","Leda","Lee","Leif","Leila","Leilani","Lela","Lelah","Leland","Lelia","Lempi","Lemuel","Lenna","Lennie","Lenny","Lenora","Lenore","Leo","Leola","Leon","Leonard","Leonardo","Leone","Leonel","Leonie","Leonor","Leonora","Leopold","Leopoldo","Leora","Lera","Lesley","Leslie","Lesly","Lessie","Lester","Leta","Letha","Letitia","Levi","Lew","Lewis","Lexi","Lexie","Lexus","Lia","Liam","Liana","Libbie","Libby","Lila","Lilian","Liliana","Liliane","Lilla","Lillian","Lilliana","Lillie","Lilly","Lily","Lilyan","Lina","Lincoln","Linda","Lindsay","Lindsey","Linnea","Linnie","Linwood","Lionel","Lisa","Lisandro","Lisette","Litzy","Liza","Lizeth","Lizzie","Llewellyn","Lloyd","Logan","Lois","Lola","Lolita","Loma","Lon","London","Lonie","Lonnie","Lonny","Lonzo","Lora","Loraine","Loren","Lorena","Lorenz","Lorenza","Lorenzo","Lori","Lorine","Lorna","Lottie","Lou","Louie","Louisa","Lourdes","Louvenia","Lowell","Loy","Loyal","Loyce","Lucas","Luciano","Lucie","Lucienne","Lucile","Lucinda","Lucio","Lucious","Lucius","Lucy","Ludie","Ludwig","Lue","Luella","Luigi","Luis","Luisa","Lukas","Lula","Lulu","Luna","Lupe","Lura","Lurline","Luther","Luz","Lyda","Lydia","Lyla","Lynn","Lyric","Lysanne","Mabel","Mabelle","Mable","Mac","Macey","Maci","Macie","Mack","Mackenzie","Macy","Madaline","Madalyn","Maddison","Madeline","Madelyn","Madelynn","Madge","Madie","Madilyn","Madisen","Madison","Madisyn","Madonna","Madyson","Mae","Maegan","Maeve","Mafalda","Magali","Magdalen","Magdalena","Maggie","Magnolia","Magnus","Maia","Maida","Maiya","Major","Makayla","Makenna","Makenzie","Malachi","Malcolm","Malika","Malinda","Mallie","Mallory","Malvina","Mandy","Manley","Manuel","Manuela","Mara","Marc","Marcel","Marcelina","Marcelino","Marcella","Marcelle","Marcellus","Marcelo","Marcia","Marco","Marcos","Marcus","Margaret","Margarete","Margarett","Margaretta","Margarette","Margarita","Marge","Margie","Margot","Margret","Marguerite","Maria","Mariah","Mariam","Marian","Mariana","Mariane","Marianna","Marianne","Mariano","Maribel","Marie","Mariela","Marielle","Marietta","Marilie","Marilou","Marilyne","Marina","Mario","Marion","Marisa","Marisol","Maritza","Marjolaine","Marjorie","Marjory","Mark","Markus","Marlee","Marlen","Marlene","Marley","Marlin","Marlon","Marques","Marquis","Marquise","Marshall","Marta","Martin","Martina","Martine","Marty","Marvin","Mary","Maryam","Maryjane","Maryse","Mason","Mateo","Mathew","Mathias","Mathilde","Matilda","Matilde","Matt","Matteo","Mattie","Maud","Maude","Maudie","Maureen","Maurice","Mauricio","Maurine","Maverick","Mavis","Max","Maxie","Maxime","Maximilian","Maximillia","Maximillian","Maximo","Maximus","Maxine","Maxwell","May","Maya","Maybell","Maybelle","Maye","Maymie","Maynard","Mayra","Mazie","Mckayla","Mckenna","Mckenzie","Meagan","Meaghan","Meda","Megane","Meggie","Meghan","Mekhi","Melany","Melba","Melisa","Melissa","Mellie","Melody","Melvin","Melvina","Melyna","Melyssa","Mercedes","Meredith","Merl","Merle","Merlin","Merritt","Mertie","Mervin","Meta","Mia","Micaela","Micah","Michael","Michaela","Michale","Micheal","Michel","Michele","Michelle","Miguel","Mikayla","Mike","Mikel","Milan","Miles","Milford","Miller","Millie","Milo","Milton","Mina","Minerva","Minnie","Miracle","Mireille","Mireya","Misael","Missouri","Misty","Mitchel","Mitchell","Mittie","Modesta","Modesto","Mohamed","Mohammad","Mohammed","Moises","Mollie","Molly","Mona","Monica","Monique","Monroe","Monserrat","Monserrate","Montana","Monte","Monty","Morgan","Moriah","Morris","Mortimer","Morton","Mose","Moses","Moshe","Mossie","Mozell","Mozelle","Muhammad","Muriel","Murl","Murphy","Murray","Mustafa","Mya","Myah","Mylene","Myles","Myra","Myriam","Myrl","Myrna","Myron","Myrtice","Myrtie","Myrtis","Myrtle","Nadia","Nakia","Name","Nannie","Naomi","Naomie","Napoleon","Narciso","Nash","Nasir","Nat","Natalia","Natalie","Natasha","Nathan","Nathanael","Nathanial","Nathaniel","Nathen","Nayeli","Neal","Ned","Nedra","Neha","Neil","Nelda","Nella","Nelle","Nellie","Nels","Nelson","Neoma","Nestor","Nettie","Neva","Newell","Newton","Nia","Nicholas","Nicholaus","Nichole","Nick","Nicklaus","Nickolas","Nico","Nicola","Nicolas","Nicole","Nicolette","Nigel","Nikita","Nikki","Nikko","Niko","Nikolas","Nils","Nina","Noah","Noble","Noe","Noel","Noelia","Noemi","Noemie","Noemy","Nola","Nolan","Nona","Nora","Norbert","Norberto","Norene","Norma","Norris","Norval","Norwood","Nova","Novella","Nya","Nyah","Nyasia","Obie","Oceane","Ocie","Octavia","Oda","Odell","Odessa","Odie","Ofelia","Okey","Ola","Olaf","Ole","Olen","Oleta","Olga","Olin","Oliver","Ollie","Oma","Omari","Omer","Ona","Onie","Opal","Ophelia","Ora","Oral","Oran","Oren","Orie","Orin","Orion","Orland","Orlando","Orlo","Orpha","Orrin","Orval","Orville","Osbaldo","Osborne","Oscar","Osvaldo","Oswald","Oswaldo","Otha","Otho","Otilia","Otis","Ottilie","Ottis","Otto","Ova","Owen","Ozella","Pablo","Paige","Palma","Pamela","Pansy","Paolo","Paris","Parker","Pascale","Pasquale","Pat","Patience","Patricia","Patrick","Patsy","Pattie","Paul","Paula","Pauline","Paxton","Payton","Pearl","Pearlie","Pearline","Pedro","Peggie","Penelope","Percival","Percy","Perry","Pete","Peter","Petra","Peyton","Philip","Phoebe","Phyllis","Pierce","Pierre","Pietro","Pink","Pinkie","Piper","Polly","Porter","Precious","Presley","Preston","Price","Prince","Princess","Priscilla","Providenci","Prudence","Queen","Queenie","Quentin","Quincy","Quinn","Quinten","Quinton","Rachael","Rachel","Rachelle","Rae","Raegan","Rafael","Rafaela","Raheem","Rahsaan","Rahul","Raina","Raleigh","Ralph","Ramiro","Ramon","Ramona","Randal","Randall","Randi","Randy","Ransom","Raoul","Raphael","Raphaelle","Raquel","Rashad","Rashawn","Rasheed","Raul","Raven","Ray","Raymond","Raymundo","Reagan","Reanna","Reba","Rebeca","Rebecca","Rebeka","Rebekah","Reece","Reed","Reese","Regan","Reggie","Reginald","Reid","Reilly","Reina","Reinhold","Remington","Rene","Renee","Ressie","Reta","Retha","Retta","Reuben","Reva","Rex","Rey","Reyes","Reymundo","Reyna","Reynold","Rhea","Rhett","Rhianna","Rhiannon","Rhoda","Ricardo","Richard","Richie","Richmond","Rick","Rickey","Rickie","Ricky","Rico","Rigoberto","Riley","Rita","River","Robb","Robbie","Robert","Roberta","Roberto","Robin","Robyn","Rocio","Rocky","Rod","Roderick","Rodger","Rodolfo","Rodrick","Rodrigo","Roel","Rogelio","Roger","Rogers","Rolando","Rollin","Roma","Romaine","Roman","Ron","Ronaldo","Ronny","Roosevelt","Rory","Rosa","Rosalee","Rosalia","Rosalind","Rosalinda","Rosalyn","Rosamond","Rosanna","Rosario","Roscoe","Rose","Rosella","Roselyn","Rosemarie","Rosemary","Rosendo","Rosetta","Rosie","Rosina","Roslyn","Ross","Rossie","Rowan","Rowena","Rowland","Roxane","Roxanne","Roy","Royal","Royce","Rozella","Ruben","Rubie","Ruby","Rubye","Rudolph","Rudy","Rupert","Russ","Russel","Russell","Rusty","Ruth","Ruthe","Ruthie","Ryan","Ryann","Ryder","Rylan","Rylee","Ryleigh","Ryley","Sabina","Sabrina","Sabryna","Sadie","Sadye","Sage","Saige","Sallie","Sally","Salma","Salvador","Salvatore","Sam","Samanta","Samantha","Samara","Samir","Sammie","Sammy","Samson","Sandra","Sandrine","Sandy","Sanford","Santa","Santiago","Santina","Santino","Santos","Sarah","Sarai","Sarina","Sasha","Saul","Savanah","Savanna","Savannah","Savion","Scarlett","Schuyler","Scot","Scottie","Scotty","Seamus","Sean","Sebastian","Sedrick","Selena","Selina","Selmer","Serena","Serenity","Seth","Shad","Shaina","Shakira","Shana","Shane","Shanel","Shanelle","Shania","Shanie","Shaniya","Shanna","Shannon","Shanny","Shanon","Shany","Sharon","Shaun","Shawn","Shawna","Shaylee","Shayna","Shayne","Shea","Sheila","Sheldon","Shemar","Sheridan","Sherman","Sherwood","Shirley","Shyann","Shyanne","Sibyl","Sid","Sidney","Sienna","Sierra","Sigmund","Sigrid","Sigurd","Silas","Sim","Simeon","Simone","Sincere","Sister","Skye","Skyla","Skylar","Sofia","Soledad","Solon","Sonia","Sonny","Sonya","Sophia","Sophie","Spencer","Stacey","Stacy","Stan","Stanford","Stanley","Stanton","Stefan","Stefanie","Stella","Stephan","Stephania","Stephanie","Stephany","Stephen","Stephon","Sterling","Steve","Stevie","Stewart","Stone","Stuart","Summer","Sunny","Susan","Susana","Susanna","Susie","Suzanne","Sven","Syble","Sydnee","Sydney","Sydni","Sydnie","Sylvan","Sylvester","Sylvia","Tabitha","Tad","Talia","Talon","Tamara","Tamia","Tania","Tanner","Tanya","Tara","Taryn","Tate","Tatum","Tatyana","Taurean","Tavares","Taya","Taylor","Teagan","Ted","Telly","Terence","Teresa","Terrance","Terrell","Terrence","Terrill","Terry","Tess","Tessie","Tevin","Thad","Thaddeus","Thalia","Thea","Thelma","Theo","Theodora","Theodore","Theresa","Therese","Theresia","Theron","Thomas","Thora","Thurman","Tia","Tiana","Tianna","Tiara","Tierra","Tiffany","Tillman","Timmothy","Timmy","Timothy","Tina","Tito","Titus","Tobin","Toby","Tod","Tom","Tomas","Tomasa","Tommie","Toney","Toni","Tony","Torey","Torrance","Torrey","Toy","Trace","Tracey","Tracy","Travis","Travon","Tre","Tremaine","Tremayne","Trent","Trenton","Tressa","Tressie","Treva","Trever","Trevion","Trevor","Trey","Trinity","Trisha","Tristian","Tristin","Triston","Troy","Trudie","Trycia","Trystan","Turner","Twila","Tyler","Tyra","Tyree","Tyreek","Tyrel","Tyrell","Tyrese","Tyrique","Tyshawn","Tyson","Ubaldo","Ulices","Ulises","Una","Unique","Urban","Uriah","Uriel","Ursula","Vada","Valentin","Valentina","Valentine","Valerie","Vallie","Van","Vance","Vanessa","Vaughn","Veda","Velda","Vella","Velma","Velva","Vena","Verda","Verdie","Vergie","Verla","Verlie","Vern","Verna","Verner","Vernice","Vernie","Vernon","Verona","Veronica","Vesta","Vicenta","Vicente","Vickie","Vicky","Victor","Victoria","Vida","Vidal","Vilma","Vince","Vincent","Vincenza","Vincenzo","Vinnie","Viola","Violet","Violette","Virgie","Virgil","Virginia","Virginie","Vita","Vito","Viva","Vivian","Viviane","Vivianne","Vivien","Vivienne","Vladimir","Wade","Waino","Waldo","Walker","Wallace","Walter","Walton","Wanda","Ward","Warren","Watson","Wava","Waylon","Wayne","Webster","Weldon","Wellington","Wendell","Wendy","Werner","Westley","Weston","Whitney","Wilber","Wilbert","Wilburn","Wiley","Wilford","Wilfred","Wilfredo","Wilfrid","Wilhelm","Wilhelmine","Will","Willa","Willard","William","Willie","Willis","Willow","Willy","Wilma","Wilmer","Wilson","Wilton","Winfield","Winifred","Winnifred","Winona","Winston","Woodrow","Wyatt","Wyman","Xander","Xavier","Xzavier","Yadira","Yasmeen","Yasmin","Yasmine","Yazmin","Yesenia","Yessenia","Yolanda","Yoshiko","Yvette","Yvonne","Zachariah","Zachary","Zachery","Zack","Zackary","Zackery","Zakary","Zander","Zane","Zaria","Zechariah","Zelda","Zella","Zelma","Zena","Zetta","Zion","Zita","Zoe","Zoey","Zoie","Zoila","Zola","Zora","Zula"];
e.exports={generateUsername:r}},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){this.versions={},this.conference=e,this.conference.addCommandListener("versions",this.processPresence.bind(this))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var o=n(6),a=r(o),s=n(1).getLogger(e);i.FOCUS_COMPONENT="focus",i.VIDEOBRIDGE_COMPONENT="videobridge",i.XMPP_SERVER_COMPONENT="xmpp",i.prototype.processPresence=function(e,t,n){var r=this;if("http://jitsi.org/jitmeet"!==e.attributes.xmlns)return void s.warn("Ignored presence versions node - invalid xmlns",e);if(!this.conference._isFocus(n))return void s.warn("Received versions not from the focus user: "+e,n);var o=[];e.children.forEach(function(e){var t=e.attributes.name;if(t!==i.FOCUS_COMPONENT&&t!==i.XMPP_SERVER_COMPONENT&&t!==i.VIDEOBRIDGE_COMPONENT)return void s.warn("Received version for not supported component name: "+t);var n=e.value;r.versions[t]!==n&&(r.versions[t]=n,s.info("Got "+t+" version: "+n),o.push({id:"component_version",component:t,version:n}))}),o.length>0&&a.default.sendLog(JSON.stringify(o))},i.prototype.getComponentVersion=function(e){return this.versions[e]}}).call(t,"modules/version/ComponentsVersions.js")},function(e,t,n){(function(e,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),d=n(11),f=o(d),p=n(32),h=i(p),m=(0,l.getLogger)(e),v="STATE_CHANGED",g=function(e){function t(e,n,r){a(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.sipAddress=e,i.displayName=n,i.chatRoom=r,i.state=void 0,i}return c(t,e),u(t,[{key:"stop",value:function(){return this.state===h.STATE_OFF||this.state===h.STATE_FAILED?void m.warn("Video SIP GW session already stopped or failed!"):void this._sendJibriIQ("stop")}},{key:"start",value:function(){return this.state===h.STATE_ON||this.state===h.STATE_OFF||this.state===h.STATE_PENDING||this.state===h.STATE_RETRYING?void m.warn("Video SIP GW session already started!"):void this._sendJibriIQ("start")}},{key:"setState",value:function(e){if(e!==this.state){var t=this.state;this.state=e,this.eventEmitter.emit(this.sipAddress,{name:v,oldState:t,newState:this.state})}}},{key:"addStateListener",value:function(e){this.addListener(v,e)}},{key:"removeStateListener",value:function(e){this.removeListener(v,e)}},{key:"_sendJibriIQ",value:function(e){var t=this,n={xmlns:"http://jitsi.org/protocol/jibri",action:e,sipaddress:this.sipAddress};n.displayname=this.displayName;var i=$iq({to:this.chatRoom.focusMucJid,type:"set"}).c("jibri",n).up();m.log("Stop video SIP GW session",i.nodeTree),this.chatRoom.connection.sendIQ(i,function(e){m.log("Result",e);var n=r(e).find("jibri").attr("state");t.setState(n)},function(e){m.log("Failed to start video SIP GW session, error: ",e),t.setState(h.STATE_FAILED)})}}]),t}(f.default);t.default=g}).call(t,"modules/videosipgw/JitsiVideoSIPGWSession.js",n(4))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),c=n(105),u=i(c),l=n(32),d=r(l),f=n(7),p=i(f),h=(0,s.getLogger)(e),m=function(){function e(t){o(this,e),this.chatRoom=t,this.eventEmitter=t.eventEmitter,h.info("creating VideoSIPGW"),this.sessions={},this.sessionStateChangeListener=this.sessionStateChanged.bind(this),t.addPresenceListener("jibri-sip-status",this.handleJibriSIPStatus.bind(this)),t.addPresenceListener("jibri-sip-call-state",this.handleJibriSIPState.bind(this))}return a(e,[{key:"handleJibriSIPStatus",value:function(e){var t=e.attributes;if(t){h.log("Handle video sip gw status : ",t);var n=t.status;n===this.status||n!==d.STATUS_UNDEFINED&&n!==d.STATUS_AVAILABLE&&n!==d.STATUS_BUSY||(this.status=n,this.eventEmitter.emit(p.default.VIDEO_SIP_GW_AVAILABILITY_CHANGED,this.status))}}},{key:"handleJibriSIPState",value:function(e){var t=e.attributes;if(t){h.log("Handle video sip gw state : ",t);var n=t.state;if(n!==this.state)switch(n){case d.STATE_ON:case d.STATE_OFF:case d.STATE_PENDING:case d.STATE_RETRYING:case d.STATE_FAILED:var r=t.sipaddress;if(!r)return;var i=this.sessions[r];i?i.setState(n):h.warn("Video SIP GW session not found:",r)}}}},{key:"createVideoSIPGWSession",value:function(e,t){var n=new u.default(e,t,this.chatRoom);return n.addStateListener(this.sessionStateChangeListener),this.sessions[e]&&h.warn("There was already a Video SIP GW session for address",e),this.sessions[e]=n,n}},{key:"isVideoSIPGWAvailable",value:function(){return this.status===d.STATUS_AVAILABLE}},{key:"sessionStateChanged",value:function(e,t){if(t.newState===d.STATE_OFF||t.newState===d.STATE_FAILED){var n=this.sessions[e];if(!n)return void h.error("Missing Video SIP GW session with address:",e);n.removeStateListener(this.sessionStateChangeListener),delete this.sessions[e]}}}]),e}();t.default=m}).call(t,"modules/videosipgw/VideoSIPGW.js")},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){var n=0;return h.some(function(r){return 0!==(n=e[r]>t[r]&&1||e[r]<t[r]&&-1)}),n}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(7),l=r(u),d=n(11),f=r(d),p=["category","type","lang","name"],h=["category","type","lang"],m="sha-1",v=function(t){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"http://jitsi.org/jitsimeet";i(this,n);var r=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));if(r.node=t,r.disco=e.disco,!r.disco)throw new Error("Missing strophe-plugins (disco and caps plugins are required)!");r.versionToCapabilities=Object.create(null),r.jidToVersion=Object.create(null),r.version="",r.rooms=new Set;var a=e.emuc;return a.addListener(l.default.EMUC_ROOM_ADDED,function(e){return r._addChatRoom(e)}),a.addListener(l.default.EMUC_ROOM_REMOVED,function(e){return r._removeChatRoom(e)}),Object.keys(a.rooms).forEach(function(e){r._addChatRoom(a.rooms[e])}),Strophe.addNamespace("CAPS","http://jabber.org/protocol/caps"),r.disco.addFeature(Strophe.NS.CAPS),e.addHandler(r._handleCaps.bind(r),Strophe.NS.CAPS),r._onMucMemberLeft=r._removeJidToVersionEntry.bind(r),r}return a(n,t),c(n,[{key:"addFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.disco.addFeature(e),this._generateVersion(),t&&this.submit()}},{key:"removeFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.disco.removeFeature(e),this._generateVersion(),t&&this.submit()}},{key:"submit",value:function(){this.rooms.forEach(function(e){return e.sendPresence()})}},{key:"getFeatures",value:function(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,i=t in this.jidToVersion?this.jidToVersion[t]:null;if(!(i&&i.version in this.versionToCapabilities)){var o=i?i.node+"#"+i.version:null;return new Promise(function(a,s){return n.disco.info(t,o,function(t){var r=new Set;e(t).find(">query>feature").each(function(e,t){return r.add(t.getAttribute("var"))}),i&&(n.versionToCapabilities[i.version]=r),a(r)},s,r)})}return Promise.resolve(this.versionToCapabilities[i.version])}},{key:"_addChatRoom",value:function(e){this.rooms.add(e),e.addListener(l.default.MUC_MEMBER_LEFT,this._onMucMemberLeft),this._fixChatRoomPresenceMap(e)}},{key:"_removeChatRoom",value:function(e){this.rooms.delete(e),e.removeListener(l.default.MUC_MEMBER_LEFT,this._onMucMemberLeft)}},{key:"_fixChatRoomPresenceMap",value:function(e){e.addToPresence("c",{attributes:{xmlns:Strophe.NS.CAPS,hash:m,node:this.node,ver:this.version}})}},{key:"_notifyVersionChanged",value:function(){var e=this;this.rooms.forEach(function(t){return e._fixChatRoomPresenceMap(t)}),this.submit()}},{key:"_generateVersion",value:function(){var e=this.disco._identities.sort(s),t=this.disco._features.sort();this.version=b64_sha1(e.reduce(function(e,t){return p.reduce(function(e,n,r){return e+(0===r?"":"/")+t[n]},"")+"<"},"")+t.reduce(function(e,t){return e+t+"<"},"")),this._notifyVersionChanged()}},{key:"_handleCaps",value:function(e){var t=e.getAttribute("from"),n=e.querySelector("c"),r=n.getAttribute("ver"),i=n.getAttribute("node"),o=this.jidToVersion[t];return this.jidToVersion[t]={version:r,node:i},o&&o.version!==r&&this.eventEmitter.emit(l.default.PARTCIPANT_FEATURES_CHANGED,t),!0}},{key:"_removeJidToVersionEntry",value:function(e){e in this.jidToVersion&&delete this.jidToVersion[e]}}]),n}(f.default);t.default=v}).call(t,n(4))},function(e,t,n){(function(e,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){for(var n=[],r=0;r<e.length;r++)e[r].tagName===t&&n.push(e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),f=n(3),p=o(f),h=n(11),m=o(h),v=n(5),g=i(v),y=n(115),b=o(y),E=n(116),S=o(E),T=n(7),C=o(T),w=(0,d.getLogger)(e),_={packet2JSON:function(e,t){var n=this;r(e).children().each(function(){var e=r(this).prop("tagName"),i={tagName:e};i.attributes={},r(r(this)[0].attributes).each(function(e,t){i.attributes[t.name]=t.value});var o=Strophe.getText(r(this)[0]);o&&(i.value=o),i.children=[],t.push(i),n.packet2JSON(r(this),i.children)})},json2packet:function(e,t){for(var n=0;n<e.length;n++){var r=e[n];r&&(t.c(r.tagName,r.attributes),r.value&&t.t(r.value),r.children&&this.json2packet(r.children,t),t.up())}}},R=function(e){function t(e,n,r,i,o){a(this,t);var c=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return c.xmpp=i,c.connection=e,c.roomjid=Strophe.getBareJidFromJid(n),c.myroomjid=n,c.password=r,w.info("Joined MUC as "+c.myroomjid),c.members={},c.presMap={},c.presHandlers={},c.joined=!1,c.role=null,c.focusMucJid=null,c.noBridgeAvailable=!1,c.options=o||{},c.moderator=new b.default(c.roomjid,c.xmpp,c.eventEmitter,{connection:c.xmpp.options,conference:c.options}),c.initPresenceMap(),c.lastPresences={},c.phoneNumber=null,c.phonePin=null,c.connectionTimes={},c.participantPropertyListener=null,c.locked=!1,c}return c(t,e),l(t,[{key:"initPresenceMap",value:function(){this.presMap.to=this.myroomjid,this.presMap.xns="http://jabber.org/protocol/muc",this.presMap.nodes=[],this.presMap.nodes.push({tagName:"user-agent",value:navigator.userAgent,attributes:{xmlns:"http://jitsi.org/jitmeet/user-agent"}}),this.addVideoInfoToPresence(!1)}},{key:"updateDeviceAvailability",value:function(e){this.presMap.nodes.push({tagName:"devices",children:[{tagName:"audio",value:e.audio},{tagName:"video",value:e.video}]})}},{key:"join",value:function(e){var t=this;this.password=e,this.moderator.allocateConferenceFocus(function(){return t.sendPresence(!0)})}},{key:"sendPresence",value:function(e){var t=this.presMap.to;if(t&&(this.joined||e)){var n=$pres({to:t});e&&(n.c("x",{xmlns:this.presMap.xns}),this.password&&n.c("password").t(this.password).up(),n.up()),_.json2packet(this.presMap.nodes,n),this.connection.send(n),e&&this.connection.flush()}}},{key:"doLeave",value:function(){w.log("do leave",this.myroomjid);var e=$pres({to:this.myroomjid,type:"unavailable"});this.presMap.length=0,this.connection.flush(),this.connection.send(e),this.connection.flush()}},{key:"discoRoomInfo",value:function(){var e=this,t=$iq({type:"get",to:this.roomjid}).c("query",{xmlns:Strophe.NS.DISCO_INFO});this.connection.sendIQ(t,function(t){var n=1===r(t).find('>query>feature[var="muc_passwordprotected"]').length;n!==e.locked&&(e.eventEmitter.emit(C.default.MUC_LOCK_CHANGED,n),e.locked=n)},function(e){p.default.callErrorHandler(e),w.error("Error getting room info: ",e)})}},{key:"createNonAnonymousRoom",value:function(){var e=$iq({type:"get",to:this.roomjid}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"}).c("x",{xmlns:"jabber:x:data",type:"submit"}),t=this;this.connection.sendIQ(e,function(e){if(!r(e).find('>query>x[xmlns="jabber:x:data"]>field[var="muc#roomconfig_whois"]').length){var n="non-anonymous rooms not supported";return p.default.callErrorHandler(new Error(n)),void w.error(n)}var i=$iq({to:t.roomjid,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"});i.c("x",{xmlns:"jabber:x:data",type:"submit"}),i.c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up(),i.c("field",{var:"muc#roomconfig_whois"}).c("value").t("anyone").up().up(),t.connection.sendIQ(i)},function(e){p.default.callErrorHandler(e),w.error("Error getting room configuration form: ",e)})}},{key:"onPresence",value:function(e){var t=e.getAttribute("from"),n={};n.show=r(e).find(">show").text(),n.status=r(e).find(">status").text();var i=r(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>item');n.affiliation=i.attr("affiliation"),n.role=i.attr("role");var o=i.attr("jid");n.jid=o,n.isFocus=o&&0===o.indexOf(this.moderator.getFocusUserJid()+"/"),n.isHiddenDomain=o&&o.indexOf("@")>0&&this.options.hiddenDomain===o.substring(o.indexOf("@")+1,o.indexOf("/")),r(e).find(">x").remove();var a=[];_.packet2JSON(e,a),this.lastPresences[t]=a;for(var s=null,c=0;c<a.length;c++){var u=a[c];switch(u.tagName){case"nick":n.nick=u.value;break;case"userId":n.id=u.value}}if(t===this.myroomjid){var l="owner"===n.affiliation?n.role:"none";if(this.role!==l&&(this.role=l,this.eventEmitter.emit(C.default.LOCAL_ROLE_CHANGED,this.role)),!this.joined){this.joined=!0;var d=this.connectionTimes["muc.joined"]=window.performance.now();w.log("(TIME) MUC joined:\t",d),this.password&&(this.locked=!0),this.eventEmitter.emit(C.default.MUC_JOINED)}}else if(void 0===this.members[t])this.members[t]=n,w.log("entered",t,n),n.isFocus?this._initFocus(t,o):this.eventEmitter.emit(C.default.MUC_MEMBER_JOINED,t,n.nick,n.role,n.isHiddenDomain);else{var f=this.members[t];f.role!==n.role&&(f.role=n.role,this.eventEmitter.emit(C.default.MUC_ROLE_CHANGED,t,n.role)),n.isFocus&&(f.isFocus=!0,this._initFocus(t,o)),n.displayName&&(f.displayName=n.displayName)}for(var p=0;p<a.length;p++){var h=a[p];switch(h.tagName){case"nick":if(!n.isFocus){var m=this.xmpp.options.displayJids?Strophe.getResourceFromJid(t):n.nick;m&&m.length>0&&this.eventEmitter.emit(C.default.DISPLAY_NAME_CHANGED,t,m)}break;case"bridgeNotAvailable":n.isFocus&&!this.noBridgeAvailable&&(this.noBridgeAvailable=!0,this.eventEmitter.emit(C.default.BRIDGE_DOWN));break;case"jibri-recording-status":s=h;break;case"call-control":var v=h.attributes;if(!v)break;this.phoneNumber=v.phone||null,this.phonePin=v.pin||null,this.eventEmitter.emit(C.default.PHONE_NUMBER_CHANGED);break;default:this.processNode(h,t)}}n.status&&this.eventEmitter.emit(C.default.PRESENCE_STATUS,t,n.status),s&&(this.lastJibri=s,this.recording&&this.recording.handleJibriPresence(s))}},{key:"_initFocus",value:function(e,t){this.focusMucJid=e,this.recording||(this.recording=new S.default(this.options.recordingType,this.eventEmitter,this.connection,this.focusMucJid,this.options.jirecon,this.roomjid),this.lastJibri&&this.recording.handleJibriPresence(this.lastJibri)),w.info("Ignore focus: "+e+", real JID: "+t)}},{key:"setParticipantPropertyListener",value:function(e){this.participantPropertyListener=e}},{key:"processNode",value:function(e,t){try{var n=this.presHandlers[e.tagName];e.tagName.startsWith("jitsi_participant_")&&(n=[this.participantPropertyListener]),n&&n.forEach(function(n){n(e,Strophe.getResourceFromJid(t),t)})}catch(t){p.default.callErrorHandler(t),w.error("Error processing:"+e.tagName+" node.",t)}}},{key:"sendMessage",value:function(e,t){var n=$msg({to:this.roomjid,type:"groupchat"});n.c("body",e).up(),t&&n.c("nick",{xmlns:"http://jabber.org/protocol/nick"}).t(t).up().up(),this.connection.send(n),this.eventEmitter.emit(C.default.SENDING_CHAT_MESSAGE,e)}},{key:"setSubject",value:function(e){var t=$msg({to:this.roomjid,type:"groupchat"});t.c("subject",e),this.connection.send(t)}},{key:"onParticipantLeft",value:function(e,t){delete this.lastPresences[e],t||(this.eventEmitter.emit(C.default.MUC_MEMBER_LEFT,e),this.moderator.onMucMemberLeft(e))}},{key:"onPresenceUnavailable",value:function(e,t){var n=this;if(r(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>destroy').length){var i=void 0,o=r(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>destroy>reason');return o.length&&(i=o.text()),this.eventEmitter.emit(C.default.MUC_DESTROYED,i),this.connection.emuc.doLeave(this.roomjid),!0}var a=0!==r(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>status[code="110"]').length,s=0!==r(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>status[code="307"]').length,c=Object.keys(this.members);a?c.length>0&&(c.forEach(function(e){var t=n.members[e];delete n.members[e],n.onParticipantLeft(e,t.isFocus)}),this.connection.emuc.doLeave(this.roomjid),s||this.eventEmitter.emit(C.default.MUC_LEFT)):(delete this.members[t],this.onParticipantLeft(t,!1)),s&&this.myroomjid===t&&this.eventEmitter.emit(C.default.KICKED)}},{key:"onMessage",value:function(e,t){var n=r(e).find('>nick[xmlns="http://jabber.org/protocol/nick"]').text()||Strophe.getResourceFromJid(t),i=r(e).find(">body").text(),o=e.getAttribute("type");if("error"===o)return this.eventEmitter.emit(C.default.CHAT_ERROR_RECEIVED,r(e).find(">text").text(),i),!0;var a=r(e).find(">subject");if(a.length){var s=a.text();(s||""===s)&&(this.eventEmitter.emit(C.default.SUBJECT_CHANGED,s),w.log("Subject is changed to "+s))}var c=r(e).find(">delay").attr("stamp");if(!c&&(c=r(e).find('>[xmlns="jabber:x:delay"]').attr("stamp"))){var u=c.match(/(\d{4})(\d{2})(\d{2}T\d{2}:\d{2}:\d{2})/);c=u[1]+"-"+u[2]+"-"+u[3]+"Z"}t===this.roomjid&&r(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>status[code="104"]').length&&this.discoRoomInfo(),i&&(w.log("chat",n,i),this.eventEmitter.emit(C.default.MESSAGE_RECEIVED,t,n,i,this.myroomjid,c))}},{key:"onPresenceError",value:function(e,t){if(r(e).find('>error[type="auth"]>not-authorized[xmlns="urn:ietf:params:xml:ns:xmpp-stanzas"]').length)w.log("on password required",t),this.eventEmitter.emit(C.default.PASSWORD_REQUIRED);else if(r(e).find('>error[type="cancel"]>not-allowed[xmlns="urn:ietf:params:xml:ns:xmpp-stanzas"]').length){var n=Strophe.getDomainFromJid(e.getAttribute("to"));n===this.xmpp.options.hosts.anonymousdomain?this.eventEmitter.emit(C.default.ROOM_JOIN_ERROR):(w.warn("onPresError ",e),this.eventEmitter.emit(C.default.ROOM_CONNECT_NOT_ALLOWED_ERROR))}else r(e).find(">error>service-unavailable").length?(w.warn("Maximum users limit for the room has been reached",e),this.eventEmitter.emit(C.default.ROOM_MAX_USERS_ERROR)):(w.warn("onPresError ",e),this.eventEmitter.emit(C.default.ROOM_CONNECT_ERROR))}},{key:"kick",value:function(e){var t=$iq({to:this.roomjid,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#admin"}).c("item",{nick:Strophe.getResourceFromJid(e),role:"none"}).c("reason").t("You have been kicked.").up().up().up();this.connection.sendIQ(t,function(t){return w.log("Kick participant with jid: ",e,t)},function(e){return w.log("Kick participant error: ",e)})}},{key:"lockRoom",value:function(e,t,n,i){var o=this;this.connection.sendIQ($iq({to:this.roomjid,type:"get"}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"}),function(a){if(r(a).find('>query>x[xmlns="jabber:x:data"]>field[var="muc#roomconfig_roomsecret"]').length){var s=$iq({to:o.roomjid,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"});s.c("x",{xmlns:"jabber:x:data",type:"submit"}),s.c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up(),s.c("field",{var:"muc#roomconfig_roomsecret"}).c("value").t(e).up().up(),s.c("field",{var:"muc#roomconfig_whois"}).c("value").t("anyone").up().up(),o.connection.sendIQ(s,t,n)}else i()},n)}},{key:"addToPresence",value:function(e,t){t.tagName=e,this.removeFromPresence(e),this.presMap.nodes.push(t)}},{key:"removeFromPresence",value:function(e){var t=this.presMap.nodes.filter(function(t){return e!==t.tagName});this.presMap.nodes=t}},{key:"addPresenceListener",value:function(e,t){if("function"!=typeof t)throw new Error('"handler" is not a function');var n=this.presHandlers[e];n||(this.presHandlers[e]=n=[]),n.indexOf(t)===-1?n.push(t):w.warn("Trying to add the same handler more than once for: "+e)}},{key:"removePresenceListener",value:function(e,t){var n=this.presHandlers[e],r=n?n.indexOf(t):-1;r!==-1?n.splice(r,1):w.warn("Handler for: "+e+" was not registered")}},{key:"isFocus",value:function(e){var t=this.members[e];return t?t.isFocus:null}},{key:"isModerator",value:function(){return"moderator"===this.role}},{key:"getMemberRole",value:function(e){return this.members[e]?this.members[e].role:null}},{key:"setVideoMute",value:function(e,t){this.sendVideoInfoPresence(e),t&&t(e)}},{key:"setAudioMute",value:function(e,t){return this.sendAudioInfoPresence(e,t)}},{key:"addAudioInfoToPresence",value:function(e){this.removeFromPresence("audiomuted"),this.addToPresence("audiomuted",{attributes:{xmlns:"http://jitsi.org/jitmeet/audio"},value:e.toString()})}},{key:"sendAudioInfoPresence",value:function(e,t){this.addAudioInfoToPresence(e),this.connection&&this.sendPresence(),t&&t()}},{key:"addVideoInfoToPresence",value:function(e){this.removeFromPresence("videomuted"),this.addToPresence("videomuted",{attributes:{xmlns:"http://jitsi.org/jitmeet/video"},value:e.toString()})}},{key:"sendVideoInfoPresence",value:function(e){this.addVideoInfoToPresence(e),this.connection&&this.sendPresence()}},{key:"getMediaPresenceInfo",value:function(e,t){var n=this.lastPresences[this.roomjid+"/"+e];if(!n)return null;var r={muted:!1,videoType:void 0},i=null;if(t===g.AUDIO)i=u(n,"audiomuted");else{if(t!==g.VIDEO)return w.error("Unsupported media type: "+t),null;i=u(n,"videomuted");var o=u(n,"videoType");o.length>0&&(r.videoType=o[0].value)}return r.muted=i.length>0&&"true"===i[0].value,r}},{key:"isRecordingSupported",value:function(){return!!this.recording&&this.recording.isSupported()}},{key:"getRecordingState",value:function(){return this.recording?this.recording.getState():void 0}},{key:"getRecordingURL",value:function(){return this.recording?this.recording.getURL():null}},{key:"toggleRecording",value:function(e,t){return this.recording?this.recording.toggleRecording(e,t):t("error",new Error("The conference is not created yet!"))}},{key:"isSIPCallingSupported",value:function(){return!!this.moderator&&this.moderator.isSipGatewayEnabled()}},{key:"dial",value:function(e){return this.connection.rayo.dial(e,"fromnumber",Strophe.getBareJidFromJid(this.myroomjid),this.password,this.focusMucJid)}},{key:"hangup",value:function(){return this.connection.rayo.hangup()}},{key:"getPhoneNumber",value:function(){return this.phoneNumber}},{key:"getPhonePin",value:function(){return this.phonePin}},{key:"muteParticipant",value:function(e,t){w.info("set mute",t);var n=$iq({to:this.focusMucJid,type:"set"}).c("mute",{xmlns:"http://jitsi.org/jitmeet/audio",jid:e}).t(t.toString()).up();this.connection.sendIQ(n,function(e){return w.log("set mute",e)},function(e){return w.log("set mute error",e)})}},{key:"onMute",value:function(e){var t=e.getAttribute("from");if(t!==this.focusMucJid)return w.warn("Ignored mute from non focus peer"),!1;var n=r(e).find("mute");if(n.length){var i="true"===n.text();this.eventEmitter.emit(C.default.AUDIO_MUTED_BY_FOCUS,i)}return!0}},{key:"leave",value:function(){var e=this;return new Promise(function(t,n){function r(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.removeListener(C.default.MUC_LEFT,r),clearTimeout(i),e?n(new Error("The timeout for the confirmation about leaving the room expired.")):t()}var i=setTimeout(function(){return r(!0)},5e3),o=e.eventEmitter;o.on(C.default.MUC_LEFT,r),e.doLeave()})}}]),t}(m.default);t.default=R}).call(t,"modules/xmpp/ChatRoom.js",n(4))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(23),c=r(s),u=(0,a.getLogger)(e),l=function(){function e(t,n,r,o,a,s){i(this,e),this.sid=t,this.localJid=n,this.peerjid=r,this.connection=o,this.mediaConstraints=a,this.iceConfig=s,this.usedrip=!0,this.dripContainer=[],this.room=null,this.state=null,this.rtc=null}return o(e,[{key:"initialize",value:function(e,t,n){if(null!==this.state){var r="attempt to initiate on session "+this.sid+"\n                   in state "+this.state;throw u.error(r),new Error(r)}this.room=t,this.rtc=n,this.state=c.PENDING,this.initiator=e?this.localJid:this.peerjid,this.responder=e?this.peerjid:this.localJid,this.doInitialize()}},{key:"doInitialize",value:function(){}},{key:"addIceCandidates",value:function(e){}},{key:"getState",value:function(){return this.state}},{key:"addSources",value:function(e){}},{key:"removeSources",value:function(e){}},{key:"terminate",value:function(e,t,n,r){}},{key:"acceptOffer",value:function(e,t,n){}}]),e}();t.default=l}).call(t,"modules/xmpp/JingleSession.js")},function(e,t,n){(function(e,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(72),d=o(l),f=n(1),p=n(3),h=o(p),m=n(109),v=o(m),g=n(48),y=o(g),b=n(112),E=o(b),S=n(15),T=o(S),C=n(114),w=o(C),_=n(6),R=o(_),A=n(7),k=o(A),O=n(23),I=i(O),P=(0,f.getLogger)(e),D=1e4,N=function(e){function t(e,n,r,i,o,c,u,l,f){a(this,t);var p=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r,i,o,c));return p._iceCheckingStartedTimestamp=null,p._gatheringStartedTimestamp=null,p._gatheringReported=!1,p.lasticecandidate=!1,p.closed=!1,p.isInitiator=l,p.isP2P=u,p.mediaTransferActive=!0,p.signalingLayer=new w.default,p.webrtcIceUdpDisable=Boolean(f.webrtcIceUdpDisable),p.webrtcIceTcpDisable=Boolean(f.webrtcIceTcpDisable),p.failICE=Boolean(f.failICE),p.modificationQueue=d.default.queue(p._processQueueTasks.bind(p),1),p.ssrcOwnerJid=null,p.wasConnected=!1,p}return c(t,e),u(t,[{key:"_assertNotEnded",value:function(e){return this.state!==I.ENDED||(P.log("The session has ended - cancelling action: "+e),!1)}},{key:"_markAsSSRCOwner",value:function(e){r(e).find("description source").append('<ssrc-info xmlns="http://jitsi.org/jitmeet" '+('owner="'+this.ssrcOwnerJid+'"></ssrc-info>'))}},{key:"setSSRCOwnerJid",value:function(e){this.ssrcOwnerJid=e}},{key:"doInitialize",value:function(){var e=this;this.lasticecandidate=!1,this.isreconnect=!1,this.wasstable=!1,this.peerconnection=this.rtc.createPeerConnection(this.signalingLayer,this.iceConfig,this.isP2P,{disableSimulcast:this.room.options.disableSimulcast,disableRtx:this.room.options.disableRtx,preferH264:this.room.options.preferH264}),this.peerconnection.setMediaTransferActive(this.mediaTransferActive),this.peerconnection.onicecandidate=function(t){if(t){var n=t.candidate,r=window.performance.now();if(n){null===e._gatheringStartedTimestamp&&(e._gatheringStartedTimestamp=r);var i=n.protocol;if("string"==typeof i)if(i=i.toLowerCase(),"tcp"===i||"ssltcp"===i){if(e.webrtcIceTcpDisable)return}else if("udp"===i&&e.webrtcIceUdpDisable)return}else if(!e._gatheringReported){var o=e.isP2P?"p2p.ice.":"ice.";o+=e.isInitiator?"initiator":"responder",o+=".gatheringDuration",R.default.analytics.sendEvent(o,{value:r-e._gatheringStartedTimestamp}),e._gatheringReported=!0}e.sendIceCandidate(n)}},this.peerconnection.onsignalingstatechange=function(){e.peerconnection&&("stable"===e.peerconnection.signalingState?e.wasstable=!0:"closed"!==e.peerconnection.signalingState&&"closed"!==e.peerconnection.connectionState||e.closed||e.room.eventEmitter.emit(k.default.SUSPEND_DETECTED,e));
},this.peerconnection.oniceconnectionstatechange=function(){if(e.peerconnection&&e._assertNotEnded("oniceconnectionstatechange")){var t=window.performance.now();switch(e.isP2P||(e.room.connectionTimes["ice.state."+e.peerconnection.iceConnectionState]=t),P.log("(TIME) ICE "+e.peerconnection.iceConnectionState+(" P2P? "+e.isP2P+":\t"),t),R.default.analytics.sendEvent(""+(e.isP2P?"p2p.ice.":"ice.")+(""+e.peerconnection.iceConnectionState),{value:t}),e.room.eventEmitter.emit(k.default.ICE_CONNECTION_STATE_CHANGED,e,e.peerconnection.iceConnectionState),e.peerconnection.iceConnectionState){case"checking":e._iceCheckingStartedTimestamp=t;break;case"connected":if("stable"===e.peerconnection.signalingState&&e.isreconnect&&e.room.eventEmitter.emit(k.default.CONNECTION_RESTORED,e),!e.wasConnected&&e.wasstable){var n=e.isP2P?"p2p.ice.":"ice.";n+=e.isInitiator?"initiator.":"responder.",n+="checksDuration",R.default.analytics.sendEvent(n,{value:t-e._iceCheckingStartedTimestamp}),e.wasConnected=!0,e.room.eventEmitter.emit(k.default.CONNECTION_ESTABLISHED,e)}e.isreconnect=!1;break;case"disconnected":if(e.closed)break;e.isreconnect=!0,e.wasstable&&e.room.eventEmitter.emit(k.default.CONNECTION_INTERRUPTED,e);break;case"failed":e.room.eventEmitter.emit(k.default.CONNECTION_ICE_FAILED,e),e.room.eventEmitter.emit(k.default.CONFERENCE_SETUP_FAILED,e,new Error("ICE fail"))}}},this.peerconnection.onnegotiationneeded=function(){e.room.eventEmitter.emit(k.default.PEERCONNECTION_READY,e)},this.signalingLayer.setChatRoom(this.room)}},{key:"sendIceCandidate",value:function(e){var t=this,n=new y.default(this.peerconnection.localDescription.sdp);if(e&&!this.lasticecandidate){var r=T.default.iceparams(n.media[e.sdpMLineIndex],n.session),i=T.default.candidateToJingle(e.candidate);if(!r||!i){var o="failed to get ice && jcand";return h.default.callErrorHandler(new Error(o)),void P.error(o)}r.xmlns="urn:xmpp:jingle:transports:ice-udp:1",this.usedrip?(0===this.dripContainer.length&&setTimeout(function(){0!==t.dripContainer.length&&(t.sendIceCandidates(t.dripContainer),t.dripContainer=[])},20),this.dripContainer.push(e)):this.sendIceCandidates([e])}else P.log("sendIceCandidate: last candidate."),this.lasticecandidate=!0}},{key:"sendIceCandidates",value:function(e){var t=this;if(this._assertNotEnded("sendIceCandidates")){P.log("sendIceCandidates",e);for(var n=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"transport-info",initiator:this.initiator,sid:this.sid}),r=new y.default(this.peerconnection.localDescription.sdp),i=function(i){var o=e.filter(function(e){return e.sdpMLineIndex===i}),a=T.default.parseMLine(r.media[i].split("\r\n")[0]);if(o.length>0){var s=T.default.iceparams(r.media[i],r.session);s.xmlns="urn:xmpp:jingle:transports:ice-udp:1",n.c("content",{creator:t.initiator===t.localJid?"initiator":"responder",name:o[0].sdpMid?o[0].sdpMid:a.media}).c("transport",s);for(var c=0;c<o.length;c++){var u=T.default.candidateToJingle(o[c].candidate);t.failICE&&(u.ip="1.1.1.1"),n.c("candidate",u).up()}var l=T.default.findLine(r.media[i],"a=fingerprint:",r.session);if(l){var d=T.default.parseFingerprint(l);d.required=!0,n.c("fingerprint",{xmlns:"urn:xmpp:jingle:apps:dtls:0"}).t(d.fingerprint),delete d.fingerprint,n.attrs(d),n.up()}n.up(),n.up()}},o=0;o<r.media.length;o++)i(o);this.connection.sendIQ(n,null,this.newJingleErrorHandler(n,function(e){h.default.callErrorHandler(new Error("Jingle error: "+JSON.stringify(e)))}),D)}}},{key:"addIceCandidates",value:function(e){var t=this;if("closed"===this.peerconnection.signalingState)return void P.warn("Ignored add ICE candidate when in closed state");var n=[];if(e.find(">content>transport>candidate").each(function(e,t){var r=T.default.candidateFromJingle(t);r=r.replace("\r\n","").replace("a=","");var i=new RTCIceCandidate({sdpMLineIndex:0,candidate:r});n.push(i)}),!n.length)return void P.error("No ICE candidates to add ?",e[0]&&e[0].outerHTML);var r=function(e){var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value;t.peerconnection.addIceCandidate(c,function(){P.debug("addIceCandidate ok!")},function(e){P.error("addIceCandidate failed!",e)})}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}e()};P.debug("Queued add ("+n.length+") ICE candidates task..."),this.modificationQueue.push(r)}},{key:"readSsrcInfo",value:function(e){var t=this;r(e).each(function(e,n){var i=r(n).find('description>source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]');i.each(function(e,n){var i=n.getAttribute("ssrc");r(n).find('>ssrc-info[xmlns="http://jitsi.org/jitmeet"]').each(function(e,n){var r=n.getAttribute("owner");r&&r.length&&t.signalingLayer.setSSRCOwner(i,Strophe.getResourceFromJid(r))})})})}},{key:"generateRecvonlySsrc",value:function(){this.peerconnection?this.peerconnection.generateRecvonlySsrc():P.error("Unable to generate recvonly SSRC - no peerconnection")}},{key:"acceptOffer",value:function(e,t,n,r){var i=this;this.setOfferAnswerCycle(e,function(){i.state=I.ACTIVE,i.sendSessionAccept(t,n)},n,r)}},{key:"invite",value:function(e){if(!this.isInitiator)throw new Error("Trying to invite from the responder session");var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this.peerconnection.addTrack(a)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.peerconnection.createOffer(this.sendSessionInitiate.bind(this),function(e){return P.error("Failed to create offer",e)},this.mediaConstraints)}},{key:"sendSessionInitiate",value:function(e){var t=this;P.log("createdOffer",e);var n=function(){var e=$iq({to:t.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-initiate",initiator:t.initiator,sid:t.sid}),n=new y.default(t.peerconnection.localDescription.sdp);n.toJingle(e,t.initiator===t.me?"initiator":"responder"),e=e.tree(),t._markAsSSRCOwner(e),P.info("Session-initiate: ",e),t.connection.sendIQ(e,function(){P.info('Got RESULT for "session-initiate"')},function(e){P.error('"session-initiate" error',e)},D)};this.peerconnection.setLocalDescription(e,n,function(e){P.error("session-init setLocalDescription failed",e)})}},{key:"setAnswer",value:function(e){var t=this;if(!this.isInitiator)throw new Error("Trying to set an answer on the responder session");this.setOfferAnswerCycle(e,function(){t.state=I.ACTIVE,P.info("setAnswer - succeeded")},function(e){P.error("setAnswer failed: ",e)})}},{key:"setOfferAnswerCycle",value:function(e,n,r,i){var o=this,a=function(n){if(i){var r=!0,a=!1,s=void 0;try{for(var c,u=i[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var l=c.value;o.peerconnection.addTrack(l)}}catch(e){a=!0,s=e}finally{try{!r&&u.return&&u.return()}finally{if(a)throw s}}}var d=o._processNewJingleOfferIq(e);o._renegotiate(d).then(function(){n()},function(e){P.error("Error renegotiating after setting new remote "+(o.isInitiator?"answer: ":"offer: ")+e,d),t.onJingleFatalError(o,e),n(e)})};this.modificationQueue.push(a,function(e){e?r(e):n()})}},{key:"replaceTransport",value:function(e,t,n){var r=this;this.room.eventEmitter.emit(k.default.ICE_RESTARTING,this);var i=e.clone();e.find(">content[name='data']").remove(),this.setOfferAnswerCycle(e,function(){r.setOfferAnswerCycle(i,function(){var e=new y.default(r.peerconnection.localDescription.sdp);r.sendTransportAccept(e,t,n)},n)},n)}},{key:"sendSessionAccept",value:function(e,t){var n=this,r=new y.default(this.peerconnection.localDescription.sdp),i=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-accept",initiator:this.initiator,responder:this.responder,sid:this.sid});this.webrtcIceTcpDisable&&(r.removeTcpCandidates=!0),this.webrtcIceUdpDisable&&(r.removeUdpCandidates=!0),this.failICE&&(r.failICE=!0),r.toJingle(i,this.initiator===this.localJid?"initiator":"responder",null),i=i.tree(),this._markAsSSRCOwner(i),P.info("Sending session-accept",i),this.connection.sendIQ(i,e,this.newJingleErrorHandler(i,function(e){t(e),n.room.eventEmitter.emit(k.default.SESSION_ACCEPT_TIMEOUT,n)}),D)}},{key:"sendTransportAccept",value:function(e,t,n){var r=this,i=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"transport-accept",initiator:this.initiator,sid:this.sid});e.media.forEach(function(t,n){var o=T.default.parseMLine(t.split("\r\n")[0]);i.c("content",{creator:r.initiator===r.localJid?"initiator":"responder",name:o.media}),e.transportToJingle(n,i),i.up()}),i=i.tree(),P.info("Sending transport-accept: ",i),this.connection.sendIQ(i,t,this.newJingleErrorHandler(i,n),D)}},{key:"sendTransportReject",value:function(e,t){var n=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"transport-reject",initiator:this.initiator,sid:this.sid});n=n.tree(),P.info("Sending 'transport-reject",n),this.connection.sendIQ(n,e,this.newJingleErrorHandler(n,t),D)}},{key:"terminate",value:function(e,t,n,r){var i=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"session-terminate",initiator:this.initiator,sid:this.sid}).c("reason").c(e||"success");t&&i.up().c("text").t(t),i=i.tree(),P.info("Sending session-terminate",i),this.connection.sendIQ(i,n,this.newJingleErrorHandler(i,r),D),this.connection.jingle.terminate(this.sid)}},{key:"onTerminated",value:function(e,t){this.state=I.ENDED,P.info("Session terminated "+this,e,t),this.close()}},{key:"_parseSsrcInfoFromSourceAdd",value:function(e,t){var n=[];return r(e).each(function(e,i){var o=r(i).attr("name"),a="";r(i).find('ssrc-group[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each(function(){var e=this.getAttribute("semantics"),t=r(this).find(">source").map(function(){return this.getAttribute("ssrc")}).get();t.length&&(a+="a=ssrc-group:"+e+" "+t.join(" ")+"\r\n")});var s=r(i).find('source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]');s.each(function(){var e=r(this).attr("ssrc");return t.containsSSRC(e)?void P.warn("Source-add request for existing SSRC: "+e):void r(this).find(">parameter").each(function(){a+="a=ssrc:"+e+" "+r(this).attr("name"),r(this).attr("value")&&r(this).attr("value").length&&(a+=":"+r(this).attr("value")),a+="\r\n"})}),t.media.forEach(function(e,t){T.default.findLine(e,"a=mid:"+o)&&(n[t]||(n[t]=""),n[t]+=a)})}),n}},{key:"addRemoteStream",value:function(e){this._addOrRemoveRemoteStream(!0,e)}},{key:"removeRemoteStream",value:function(e){this._addOrRemoveRemoteStream(!1,e)}},{key:"_addOrRemoveRemoteStream",value:function(e,t){var n=this,r=e?"addRemoteStream":"removeRemoteStream";e&&this.readSsrcInfo(t);var i=function(i){if(!n.peerconnection.localDescription||!n.peerconnection.localDescription.sdp){var o=r+" - localDescription not ready yet";return P.error(o),void i(o)}P.log("Processing "+r),P.log("ICE connection state: ",n.peerconnection.iceConnectionState);var a=new y.default(n.peerconnection.localDescription.sdp),s=new y.default(n.peerconnection.remoteDescription.sdp),c=e?n._parseSsrcInfoFromSourceAdd(t,s):n._parseSsrcInfoFromSourceRemove(t,s),u=e?n._processRemoteAddSource(c):n._processRemoteRemoveSource(c);n._renegotiate(u).then(function(){var e=new y.default(n.peerconnection.localDescription.sdp);P.log(r+" - OK, SDPs: ",a,e),n.notifyMySSRCUpdate(a,e),i()},function(e){P.error(r+" failed:",e),i(e)})};this.modificationQueue.push(i)}},{key:"_processQueueTasks",value:function(e,t){e(t)}},{key:"_processNewJingleOfferIq",value:function(e){var t=new y.default("");return this.webrtcIceTcpDisable&&(t.removeTcpCandidates=!0),this.webrtcIceUdpDisable&&(t.removeUdpCandidates=!0),this.failICE&&(t.failICE=!0),t.fromJingle(e),this.readSsrcInfo(r(e).find(">content")),t}},{key:"_processRemoteRemoveSource",value:function(e){var t=new y.default(this.peerconnection.remoteDescription.sdp);return e.forEach(function(e,n){e=e.split("\r\n"),e.pop(),e.forEach(function(e){t.media[n]=t.media[n].replace(e+"\r\n","")})}),t.raw=t.session+t.media.join(""),t}},{key:"_processRemoteAddSource",value:function(e){var t=new y.default(this.peerconnection.remoteDescription.sdp);return e.forEach(function(e,n){t.media[n]+=e}),t.raw=t.session+t.media.join(""),t}},{key:"_renegotiate",value:function(e){var t=this,n=e||new y.default(this.peerconnection.remoteDescription.sdp),r=new RTCSessionDescription({type:this.isInitiator?"answer":"offer",sdp:n.raw});return new Promise(function(e,n){return"closed"===t.peerconnection.signalingState?void n("Attempted to renegotiate in state closed"):void(t.isInitiator?t._initiatorRenegotiate(r,e,n):t._responderRenegotiate(r,e,n))})}},{key:"_responderRenegotiate",value:function(e,t,n){var r=this;P.debug("Renegotiate: setting remote description"),this.peerconnection.setRemoteDescription(e,function(){P.debug("Renegotiate: creating answer"),r.peerconnection.createAnswer(function(e){P.debug("Renegotiate: setting local description"),r.peerconnection.setLocalDescription(e,function(){t()},function(e){n("setLocalDescription failed: "+e)})},function(e){return n("createAnswer failed: "+e)},r.mediaConstraints)},function(e){return n("setRemoteDescription failed: "+e)})}},{key:"_initiatorRenegotiate",value:function(e,t,n){var r=this;"have-local-offer"===this.peerconnection.signalingState?(P.debug("Renegotiate: setting remote description"),this.peerconnection.setRemoteDescription(e,function(){t()},function(e){return n("setRemoteDescription failed: "+e)})):(P.debug("Renegotiate: creating offer"),this.peerconnection.createOffer(function(i){P.debug("Renegotiate: setting local description"),r.peerconnection.setLocalDescription(i,function(){P.debug("Renegotiate: setting remote description"),r.peerconnection.setRemoteDescription(e,function(){t()},function(e){return n("setRemoteDescription failed: "+e)})},function(e){n("setLocalDescription failed: ",e)})},function(e){return n("createOffer failed: "+e)},this.mediaConstraints))}},{key:"replaceTrack",value:function(e,t){var n=this,r=function(r){var i=n.peerconnection.localDescription.sdp;!e&&t&&t.isVideoTrack()?n.peerconnection.clearRecvonlySsrc():e&&e.isVideoTrack()&&!t&&(n.peerconnection.clearRecvonlySsrc(),n.peerconnection.generateRecvonlySsrc()),e&&n.peerconnection.removeTrack(e),t&&n.peerconnection.addTrack(t),(e||t)&&i?n._renegotiate().then(function(){var e=new y.default(n.peerconnection.localDescription.sdp);n.notifyMySSRCUpdate(new y.default(i),e),r()},r):r()};this.modificationQueue.push(r,function(e){e?P.error("Replace track error:",e):P.info("Replace track done!")})}},{key:"_parseSsrcInfoFromSourceRemove",value:function(e,t){var n=[];return r(e).each(function(e,i){var o=r(i).attr("name"),a="";r(i).find('ssrc-group[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]').each(function(){var e=this.getAttribute("semantics"),t=r(this).find(">source").map(function(){return this.getAttribute("ssrc")}).get();t.length&&(a+="a=ssrc-group:"+e+" "+t.join(" ")+"\r\n")});var s=[],c=r(i).find('source[xmlns="urn:xmpp:jingle:apps:rtp:ssma:0"]');c.each(function(){var e=r(this).attr("ssrc");s.push(e)}),t.media.forEach(function(e,t){T.default.findLine(e,"a=mid:"+o)&&(n[t]||(n[t]=""),s.forEach(function(r){var i=T.default.findLines(e,"a=ssrc:"+r);i.length&&(n[t]+=i.join("\r\n")+"\r\n")}),n[t]+=a)})}),n}},{key:"_verifyNoSSRCChanged",value:function(e,t){var n=new y.default(this.peerconnection.localDescription.sdp),r=new E.default(t,n),i=r.getNewMedia();if(Object.keys(i).length)return P.error("Some SSRC were added on "+e,i),!1;r=new E.default(n,t);var o=r.getNewMedia();return!Object.keys(o).length||(P.error("Some SSRCs were removed on "+e,o),!1)}},{key:"addTrackAsUnmute",value:function(e){return this._addRemoveTrackAsMuteUnmute(!1,e)}},{key:"removeTrackAsMute",value:function(e){return this._addRemoveTrackAsMuteUnmute(!0,e)}},{key:"_addRemoveTrackAsMuteUnmute",value:function(e,t){var n=this;if(!t)return Promise.reject('invalid "track" argument value');var r=e?"removeTrackMute":"addTrackUnmute",i=function(i){var o=n.peerconnection;if(!o)return void i("Error:  tried "+r+" track with no active peerconnection");var a=o.localDescription.sdp,s=e?o.removeTrackMute.bind(o,t):o.addTrackUnmute.bind(o,t);s()?a&&o.remoteDescription.sdp?n._renegotiate().then(function(){n._verifyNoSSRCChanged(r,new y.default(a)),i()},i):i():i(r+" failed!")};return new Promise(function(e,t){n.modificationQueue.push(i,function(n){n?t(n):e()})})}},{key:"setMediaTransferActive",value:function(e){var t=this,n=function(n){t.mediaTransferActive=e,t.peerconnection?(t.peerconnection.setMediaTransferActive(t.mediaTransferActive),t._renegotiate().then(n,n)):n()},r=e?"active":"inactive";return P.info("Queued make media transfer "+r+" task..."),new Promise(function(e,r){t.modificationQueue.push(n,function(t){t?r(t):e()})})}},{key:"notifyMySSRCUpdate",value:function(e,t){if(this.state!==I.ACTIVE)return void P.warn("Skipping SSRC update in '"+this.state+" ' state.");var n=new E.default(t,e),r=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"source-remove",initiator:this.initiator,sid:this.sid}),i=n.toJingle(r);i?(P.info("Sending source-remove",r.tree()),this.connection.sendIQ(r,null,this.newJingleErrorHandler(r,function(e){h.default.callErrorHandler(new Error("Jingle error: "+JSON.stringify(e)))}),D)):P.log("removal not necessary"),n=new E.default(e,t);var o=$iq({to:this.peerjid,type:"set"}).c("jingle",{xmlns:"urn:xmpp:jingle:1",action:"source-add",initiator:this.initiator,sid:this.sid}),a=n.toJingle(o);a?(P.info("Sending source-add",o.tree()),this.connection.sendIQ(o,null,this.newJingleErrorHandler(o,function(e){h.default.callErrorHandler(new Error("Jingle error: "+JSON.stringify(e)))}),D)):P.log("addition not necessary")}},{key:"newJingleErrorHandler",value:function(e,t){return function(n){var i={},o=r(n).find("error");if(o.length){i.code=o.attr("code");var a=r(n).find("error :first");a.length&&(i.reason=a[0].tagName)}n||(i.reason="timeout"),i.source=e,e&&"function"==typeof e.tree&&(i.source=e.tree()),i.source&&i.source.outerHTML&&(i.source=i.source.outerHTML),P.error("Jingle error",i),t&&t(i)}}},{key:"getIceConnectionState",value:function(){return this.peerconnection.iceConnectionState}},{key:"close",value:function(){this.closed=!0,this.signalingLayer.setChatRoom(null),this.peerconnection&&(this.peerconnection.signalingState&&"closed"!==this.peerconnection.signalingState||this.peerconnection.connectionState&&"closed"!==this.peerconnection.connectionState)&&this.peerconnection.close()}},{key:"toString",value:function(){return"JingleSessionPC[p2p="+this.isP2P+","+("initiator="+this.isInitiator+",sid="+this.sid+"]")}}],[{key:"onJingleFatalError",value:function(e,t){this.room&&(this.room.eventEmitter.emit(k.default.CONFERENCE_SETUP_FAILED,e,t),this.room.eventEmitter.emit(k.default.JINGLE_FATAL_ERROR,e,t))}}]),t}(v.default);t.default=N}).call(t,"modules/xmpp/JingleSessionPC.js",n(4))},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){d.debug("Updating mline to associate "+n+("rtx ssrc with primary stream, "+t.id));var r=t.id,i=t.msid,o=t.cname,a=e.getRtxSSRC(r);return a===n?void d.debug(n+" was already associated with "+r):(a&&(d.debug(r+" was previously associated with rtx"+(a+", removing all references to it")),e.removeSSRC(a),d.debug("groups before filtering for "+a),d.debug(e.dumpSSRCGroups()),e.removeGroupsWithSSRC(a)),e.addSSRCAttribute({id:n,attribute:"cname",value:o}),e.addSSRCAttribute({id:n,attribute:"msid",value:i}),void e.addSSRCGroup({semantics:"FID",ssrcs:r+" "+n}))}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),c=n(24),u=n(15),l=r(u),d=(0,s.getLogger)(e),f=function(){function e(){i(this,e),this.correspondingRtxSsrcs=new Map}return a(e,[{key:"clearSsrcCache",value:function(){this.correspondingRtxSsrcs.clear()}},{key:"setSsrcCache",value:function(e){d.debug("Setting ssrc cache to ",e),this.correspondingRtxSsrcs=e}},{key:"modifyRtxSsrcs",value:function(e){var t=new c.SdpTransformWrap(e),n=t.selectMedia("video");return n?this.modifyRtxSsrcs2(n)?t.toRawSDP():e:(d.error("No 'video' media found in the sdp: "+e),e)}},{key:"modifyRtxSsrcs2",value:function(e){if("recvonly"===e.direction)return d.debug("RtxModifier doing nothing, video m line is recvonly"),!1;if(e.getSSRCCount()<1)return d.debug("RtxModifier doing nothing, no video ssrcs present"),!1;d.debug("Current ssrc mapping: ",this.correspondingRtxSsrcs);var t=e.getPrimaryVideoSSRCs();d.debug("Parsed primary video ssrcs ",t," making sure all have rtx streams");var n=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var c=a.value,u=e.getSSRCAttrValue(c,"msid"),f=e.getSSRCAttrValue(c,"cname"),p=this.correspondingRtxSsrcs.get(c);if(p)d.debug("Already have an associated rtx ssrc for"+("video ssrc "+c+": "+p));else{d.debug("No previously associated rtx ssrc for video ssrc "+c);var h=e.getRtxSSRC(c);h?(d.debug("Rtx stream "+h+" already existed in the sdp as an rtx stream for "+c),p=h):(p=l.default.generateSsrc(),d.debug("Generated rtx ssrc "+p+" for ssrc "+c)),d.debug("Caching rtx ssrc "+p+" for video ssrc "+c),this.correspondingRtxSsrcs.set(c,p)}o(e,{id:c,cname:f,msid:u},p)}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}return!0}},{key:"stripRtx",value:function(e){var t=new c.SdpTransformWrap(e),n=t.selectMedia("video");if(!n)return d.error("No 'video' media found in the sdp: "+e),e;if("recvonly"===n.direction)return d.debug("RtxModifier doing nothing, video m line is recvonly"),e;if(n.getSSRCCount()<1)return d.debug("RtxModifier doing nothing, no video ssrcs present"),e;if(!n.containsAnySSRCGroups())return d.debug("RtxModifier doing nothing, no video ssrcGroups present"),e;var r=n.findGroups("FID");n.removeGroupsBySemantics("FID");var i=!0,o=!1,a=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value,f=(0,c.parseSecondarySSRC)(l);n.removeSSRC(f)}}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}return t.toRawSDP()}}]),e}();t.default=f}).call(t,"modules/xmpp/RtxModifier.js")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!t)return!1;if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!e[n].equals(t[n]))return!1}else if(e[n]!==t[n])return!1;return!0}function o(e,t){this.mySDP=e,this.otherSDP=t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var a=n(15),s=r(a);o.prototype.getNewMedia=function(){var e=this.mySDP.getMediaSsrcMap(),t=this.otherSDP.getMediaSsrcMap(),n={};return Object.keys(t).forEach(function(r){var o=e[r],a=t[r];return!o&&a?void(n[r]=a):(Object.keys(a.ssrcs).forEach(function(e){Object.keys(o.ssrcs).indexOf(e)===-1&&(n[r]||(n[r]={mediaindex:a.mediaindex,mid:a.mid,ssrcs:{},ssrcGroups:[]}),n[r].ssrcs[e]=a.ssrcs[e])}),void a.ssrcGroups.forEach(function(e){for(var t=!1,s=0;s<o.ssrcGroups.length;s++){var c=o.ssrcGroups[s];if(e.semantics===c.semantics&&i(e.ssrcs,c.ssrcs)){t=!0;break}}t||(n[r]||(n[r]={mediaindex:a.mediaindex,mid:a.mid,ssrcs:{},ssrcGroups:[]}),n[r].ssrcGroups.push(e))}))}),n},o.prototype.toJingle=function(e){var t=this.getNewMedia(),n=!1;return Object.keys(t).forEach(function(r){n=!0;var i=t[r];e.c("content",{name:i.mid}),e.c("description",{xmlns:"urn:xmpp:jingle:apps:rtp:1",media:i.mid}),Object.keys(i.ssrcs).forEach(function(t){var n=i.ssrcs[t];e.c("source",{xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),e.attrs({ssrc:n.ssrc}),n.lines.forEach(function(t){var n=t.indexOf(" "),r=t.substr(n+1);if(e.c("parameter"),r.indexOf(":")===-1)e.attrs({name:r});else{var i=r.split(":",2),o=i[0],a=s.default.filterSpecialChars(i[1]);e.attrs({name:o}),e.attrs({value:a})}e.up()}),e.up()}),i.ssrcGroups.forEach(function(t){t.ssrcs.length&&(e.c("ssrc-group",{semantics:t.semantics,xmlns:"urn:xmpp:jingle:apps:rtp:ssma:0"}),t.ssrcs.forEach(function(t){e.c("source",{ssrc:t}).up()}),e.up())}),e.up(),e.up()}),n}},function(e,t,n){(function(e){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=n(24),s=(0,o.getLogger)(e),c=function(){function e(t){r(this,e),this.clearVideoSsrcCache(),this.logPrefix=t}return i(e,[{key:"clearVideoSsrcCache",value:function(){this.cachedPrimarySsrc=null,this.injectRecvOnly=!1}},{key:"setPrimarySsrc",value:function(e){if("number"!=typeof e)throw new Error("Primary SSRC must be a number!");this.cachedPrimarySsrc=e}},{key:"hasPrimarySsrcCached",value:function(){return Boolean(this.cachedPrimarySsrc)}},{key:"makeVideoPrimarySsrcsConsistent",value:function(e){var t=new a.SdpTransformWrap(e),n=t.selectMedia("video");if(!n)return s.error(this.logPrefix+" no 'video' media found in the sdp: "+e),e;if("recvonly"===n.direction)this.cachedPrimarySsrc&&this.injectRecvOnly?n.addSSRCAttribute({id:this.cachedPrimarySsrc,attribute:"cname",value:"recvonly-"+this.cachedPrimarySsrc}):s.info(this.logPrefix+" no SSRC found for the recvonly videostream!");else{var r=n.getPrimaryVideoSsrc();if(!r)return s.info(this.logPrefix+" sdp-consistency couldn't parse new primary ssrc"),e;if(this.cachedPrimarySsrc){s.info(this.logPrefix+" sdp-consistency replacing new ssrc"+(r+" with cached ")+(""+this.cachedPrimarySsrc)),n.replaceSSRC(r,this.cachedPrimarySsrc);var i=!0,o=!1,c=void 0;try{for(var u,l=n.ssrcGroups[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var d=u.value;if("FID"===d.semantics){var f=(0,a.parsePrimarySSRC)(d),p=(0,a.parseSecondarySSRC)(d);f===r&&(d.ssrcs=this.cachedPrimarySsrc+" "+p)}}}catch(e){o=!0,c=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw c}}}else this.cachedPrimarySsrc=r,s.info(this.logPrefix+" sdp-consistency caching primary ssrc"+this.cachedPrimarySsrc);this.injectRecvOnly=!0}return t.toRawSDP()}}]),e}();t.default=c}).call(t,"modules/xmpp/SdpConsistency.js")},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=n(5),d=i(l),f=n(50),p=i(f),h=n(124),m=r(h),v=(0,u.getLogger)(e),g=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.ssrcOwners=new Map,e.chatRoom=null,e}return s(t,e),c(t,[{key:"setChatRoom",value:function(e){var t=this,n=this.chatRoom;this.chatRoom=e,n&&(n.removePresenceListener("audiomuted",this._audioMuteHandler),n.removePresenceListener("videomuted",this._videoMuteHandler),n.removePresenceListener("videoType",this._videoTypeHandler)),e&&(this._audioMuteHandler=function(e,n){t.eventEmitter.emit(p.PEER_MUTED_CHANGED,n,d.AUDIO,"true"===e.value)},e.addPresenceListener("audiomuted",this._audioMuteHandler),this._videoMuteHandler=function(e,n){t.eventEmitter.emit(p.PEER_MUTED_CHANGED,n,d.VIDEO,"true"===e.value)},e.addPresenceListener("videomuted",this._videoMuteHandler),this._videoTypeHandler=function(e,n){t.eventEmitter.emit(p.PEER_VIDEO_TYPE_CHANGED,n,e.value)},e.addPresenceListener("videoType",this._videoTypeHandler))}},{key:"getPeerMediaInfo",value:function(e,t){return this.chatRoom?this.chatRoom.getMediaPresenceInfo(e,t):void v.error("Requested peer media info, before room was set")}},{key:"getSSRCOwner",value:function(e){return this.ssrcOwners.get(e)}},{key:"setSSRCOwner",value:function(e,t){this.ssrcOwners.set(e,t)}}]),t}(m.default);t.default=g}).call(t,"modules/xmpp/SignalingLayerImpl.js")},function(e,t,n){(function(e,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=1;return function(n){if(n)return void(t=1);var r=Math.pow(2,t-1);return t+=1,r*e}}function a(e,t,n,r){function i(e){if(e.data&&e.data.sessionId){if(e.origin!==window.location.origin)return void u.warn("Ignoring sessionId from different origin: "+e.origin);c.default.setSessionId(e.data.sessionId)}}this.roomName=e,this.xmppService=t,this.getNextTimeout=o(1e3),this.getNextErrorTimeout=o(1e3),this.externalAuthEnabled=!1,this.options=r,this.sipGatewayEnabled=this.options.connection.hosts&&void 0!==this.options.connection.hosts.call_control,this.eventEmitter=n,this.connection=this.xmppService.connection,window.addEventListener?window.addEventListener("message",i,!1):window.attachEvent("onmessage",i)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var s=n(31),c=i(s),u=n(1).getLogger(e),l=n(7),d=n(51),f=n(3);a.prototype.isExternalAuthEnabled=function(){return this.externalAuthEnabled},a.prototype.isSipGatewayEnabled=function(){return this.sipGatewayEnabled},a.prototype.onMucMemberLeft=function(e){u.info("Someone left is it focus ? "+e);var t=Strophe.getResourceFromJid(e);"focus"===t&&(u.info("Focus has left the room - leaving conference"),this.eventEmitter.emit(l.FOCUS_LEFT))},a.prototype.setFocusUserJid=function(e){this.focusUserJid||(this.focusUserJid=e,u.info("Focus jid set to:  "+this.focusUserJid))},a.prototype.getFocusUserJid=function(){return this.focusUserJid},a.prototype.getFocusComponent=function(){var e=this.options.connection.hosts.focus;return e||(e="focus."+this.options.connection.hosts.domain),e},a.prototype.createConferenceIq=function(){var e=$iq({to:this.getFocusComponent(),type:"set"}),t=c.default.getSessionId(),n=c.default.getMachineId();return u.info("Session ID: "+t+" machine UID: "+n),e.c("conference",{xmlns:"http://jitsi.org/protocol/focus",room:this.roomName,"machine-uid":n}),t&&e.attrs({"session-id":t}),void 0!==this.options.connection.enforcedBridge&&e.c("property",{name:"enforcedBridge",value:this.options.connection.enforcedBridge}).up(),void 0!==this.options.connection.hosts&&void 0!==this.options.connection.hosts.call_control&&e.c("property",{name:"call_control",value:this.options.connection.hosts.call_control}).up(),void 0!==this.options.conference.channelLastN&&e.c("property",{name:"channelLastN",value:this.options.conference.channelLastN}).up(),e.c("property",{name:"disableRtx",value:Boolean(this.options.conference.disableRtx)}).up(),e.c("property",{name:"enableLipSync",value:this.options.connection.enableLipSync!==!1}).up(),void 0!==this.options.conference.audioPacketDelay&&e.c("property",{name:"audioPacketDelay",value:this.options.conference.audioPacketDelay}).up(),this.options.conference.startBitrate&&e.c("property",{name:"startBitrate",value:this.options.conference.startBitrate}).up(),this.options.conference.minBitrate&&e.c("property",{name:"minBitrate",value:this.options.conference.minBitrate}).up(),void 0!==this.options.conference.openSctp&&e.c("property",{name:"openSctp",value:this.options.conference.openSctp
}).up(),void 0!==this.options.conference.startAudioMuted&&e.c("property",{name:"startAudioMuted",value:this.options.conference.startAudioMuted}).up(),void 0!==this.options.conference.startVideoMuted&&e.c("property",{name:"startVideoMuted",value:this.options.conference.startVideoMuted}).up(),void 0!==this.options.conference.stereo&&e.c("property",{name:"stereo",value:this.options.conference.stereo}).up(),void 0!==this.options.conference.useRoomAsSharedDocumentName&&e.c("property",{name:"useRoomAsSharedDocumentName",value:this.options.conference.useRoomAsSharedDocumentName}).up(),e.up(),e},a.prototype.parseSessionId=function(e){var t=r(e).find("conference").attr("session-id");t&&(u.info("Received sessionId:  "+t),c.default.setSessionId(t))},a.prototype.parseConfigOptions=function(e){this.setFocusUserJid(r(e).find("conference").attr("focusjid"));var t=r(e).find(">conference>property[name='authentication'][value='true']").length>0;u.info("Authentication enabled: "+t),this.externalAuthEnabled=r(e).find(">conference>property[name='externalAuth'][value='true']").length>0,u.info("External authentication enabled: "+this.externalAuthEnabled),this.externalAuthEnabled||this.parseSessionId(e);var n=r(e).find(">conference").attr("identity");this.eventEmitter.emit(d.IDENTITY_UPDATED,t,n),r(e).find(">conference>property[name='sipGatewayEnabled'][value='true']").length&&(this.sipGatewayEnabled=!0),u.info("Sip gateway enabled:  "+this.sipGatewayEnabled)},a.prototype.allocateConferenceFocus=function(e){var t=this;this.setFocusUserJid(this.options.connection.focusUserJid),this.connection.sendIQ(this.createConferenceIq(),function(n){return t._allocateConferenceFocusSuccess(n,e)},function(n){return t._allocateConferenceFocusError(n,e)}),this.connection.flush()},a.prototype._allocateConferenceFocusError=function(e,t){var n=this,i=r(e).find(">error>session-invalid").length;if(i&&(u.info("Session expired! - removing"),c.default.clearSessionId()),r(e).find(">error>graceful-shutdown").length)return void this.eventEmitter.emit(l.GRACEFUL_SHUTDOWN);var o=r(e).find(">error>reservation-error");if(o.length){var a=o.attr("error-code"),s=r(e).find(">error>text"),d=void 0;return s&&(d=s.text()),void this.eventEmitter.emit(l.RESERVATION_ERROR,a,d)}if(r(e).find(">error>not-authorized").length){u.warn("Unauthorized to start the conference",e);var p=Strophe.getDomainFromJid(e.getAttribute("to"));return p!==this.options.connection.hosts.anonymousdomain&&(this.externalAuthEnabled=!0),void this.eventEmitter.emit(l.AUTHENTICATION_REQUIRED)}var h=this.getNextErrorTimeout(),m="Focus error, retry after "+h;f.callErrorHandler(new Error(m)),u.error(m,e);var v=this.getFocusComponent(),g=h/1e3;i||this.eventEmitter.emit(l.FOCUS_DISCONNECTED,v,g),this.getNextTimeout(!0),window.setTimeout(function(){return n.allocateConferenceFocus(t)},h)},a.prototype._allocateConferenceFocusSuccess=function(e,t){var n=this;if(this.parseConfigOptions(e),this.getNextErrorTimeout(!0),"true"===r(e).find("conference").attr("ready"))this.getNextTimeout(!0),t();else{var i=this.getNextTimeout();u.info("Waiting for the focus... "+i),window.setTimeout(function(){return n.allocateConferenceFocus(t)},i)}},a.prototype.authenticate=function(){var e=this;return new Promise(function(t,n){e.connection.sendIQ(e.createConferenceIq(),function(n){e.parseSessionId(n),t()},function(e){var t=r(e).find(">error").attr("code");n(e,t)})})},a.prototype.getLoginUrl=function(e,t){this._getLoginUrl(!1,e,t)},a.prototype._getLoginUrl=function(e,t,n){function i(e,t){f.callErrorHandler(new Error(e)),u.error(e,t),n(t)}var o=$iq({to:this.getFocusComponent(),type:"get"}),a={xmlns:"http://jitsi.org/protocol/focus",room:this.roomName,"machine-uid":c.default.getMachineId()},s="auth url";e&&(a.popup=!0,s="POPUP "+s),o.c("login-url",a),this.connection.sendIQ(o,function(e){var n=r(e).find("login-url").attr("url");n=decodeURIComponent(n),n?(u.info("Got "+s+": "+n),t(n)):i("Failed to get "+s+" from the focus",e)},i.bind(void 0,"Get "+s+" error"))},a.prototype.getPopupLoginUrl=function(e,t){this._getLoginUrl(!0,e,t)},a.prototype.logout=function(e){var t=$iq({to:this.getFocusComponent(),type:"set"}),n=c.default.getSessionId();return n?(t.c("logout",{xmlns:"http://jitsi.org/protocol/focus","session-id":n}),void this.connection.sendIQ(t,function(t){var n=r(t).find("logout").attr("logout-url");n&&(n=decodeURIComponent(n)),u.info("Log out OK, url: "+n,t),c.default.clearSessionId(),e(n)},function(e){var t="Logout error";f.callErrorHandler(new Error(t)),u.error(t,e)})):void e()}}).call(t,"modules/xmpp/moderator.js",n(4))},function(e,t,n){(function(e,r){"use strict";function i(e,t,n,r,o,a){this.eventEmitter=t,this.connection=n,this.state=null,this.focusMucJid=r,this.jirecon=o,this.url=null,this.type=e,this._isSupported=!(e===i.types.JIRECON&&!this.jirecon||e!==i.types.JIBRI&&e!==i.types.COLIBRI),this.jireconRid=null,this.roomjid=a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var o=n(1),a=(0,o.getLogger)(e),s=n(7),c=n(43),u=n(3);i.types={COLIBRI:"colibri",JIRECON:"jirecon",JIBRI:"jibri"},i.status={ON:"on",OFF:"off",AVAILABLE:"available",UNAVAILABLE:"unavailable",PENDING:"pending",RETRYING:"retrying",BUSY:"busy",FAILED:"failed"},i.action={START:"start",STOP:"stop"},i.prototype.handleJibriPresence=function(e){var t=e.attributes;if(t){var n=t.status;a.log("Handle jibri presence : ",n),n!==this.state&&("undefined"===n?this.state=i.status.UNAVAILABLE:n===i.status.OFF?this.state&&"undefined"!==this.state&&this.state!==i.status.UNAVAILABLE?this.state=i.status.OFF:this.state=i.status.AVAILABLE:this.state=n,this.eventEmitter.emit(s.RECORDER_STATE_CHANGED,this.state))}},i.prototype.setRecordingJibri=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e===this.state&&n(c.INVALID_STATE);var s=$iq({to:this.focusMucJid,type:"set"}).c("jibri",{xmlns:"http://jitsi.org/protocol/jibri",action:e===i.status.ON?i.action.START:i.action.STOP,streamid:o.streamId}).up();a.log("Set jibri recording: "+e,s.nodeTree),a.log(s.nodeTree),this.connection.sendIQ(s,function(e){a.log("Result",e);var n=r(e).find("jibri");t(n.attr("state"),n.attr("url"))},function(e){a.log("Failed to start recording, error: ",e),n(e)})},i.prototype.setRecordingJirecon=function(e,t,n){e===this.state&&n(new Error("Invalid state!"));var o=$iq({to:this.jirecon,type:"set"}).c("recording",{xmlns:"http://jitsi.org/protocol/jirecon",action:e===i.status.ON?i.action.START:i.action.STOP,mucjid:this.roomjid});e===i.status.OFF&&o.attrs({rid:this.jireconRid}),a.log("Start recording");var s=this;this.connection.sendIQ(o,function(n){s.jireconRid=r(n).find("recording").attr("rid"),a.log("Recording "+(e===i.status.ON?"started":"stopped")+"(jirecon)"+n),s.state=e,e===i.status.OFF&&(s.jireconRid=null),t(e)},function(e){a.log("Failed to start recording, error: ",e),n(e)})},i.prototype.setRecordingColibri=function(e,t,n,i){var o=$iq({to:this.focusMucJid,type:"set"});o.c("conference",{xmlns:"http://jitsi.org/protocol/colibri"}),o.c("recording",{state:e,token:i.token});var s=this;this.connection.sendIQ(o,function(n){a.log('Set recording "',e,'". Result:',n);var i=r(n).find(">conference>recording"),o=i.attr("state");s.state=o,t(o),"pending"===o&&s.connection.addHandler(function(e){var n=r(e).find("recording").attr("state");n&&(s.state=o,t(n))},"http://jitsi.org/protocol/colibri","iq",null,null,null)},function(e){a.warn(e),n(e)})},i.prototype.setRecording=function(){switch(this.type){case i.types.JIRECON:this.setRecordingJirecon.apply(this,arguments);break;case i.types.COLIBRI:this.setRecordingColibri.apply(this,arguments);break;case i.types.JIBRI:this.setRecordingJibri.apply(this,arguments);break;default:var e="Unknown recording type!";u.callErrorHandler(new Error(e)),a.error(e)}},i.prototype.toggleRecording=function(e,t){var n=this.state;if(n===i.status.UNAVAILABLE||n===i.status.FAILED?t(i.status.FAILED,c.RECORDER_UNAVAILABLE):n===i.status.BUSY&&t(i.status.BUSY,c.RECORDER_BUSY),(n===i.status.OFF||n===i.status.AVAILABLE)&&(!e.token&&this.type===i.types.COLIBRI||!e.streamId&&this.type===i.types.JIBRI))return t(i.status.FAILED,c.NO_TOKEN),void a.error("No token passed!");var r=n===i.status.AVAILABLE||n===i.status.OFF?i.status.ON:i.status.OFF,o=this;a.log("Toggle recording (old state, new state): ",n,r),this.setRecording(r,function(e,r){e&&e!==n&&(o.state=e,o.url=r,t(e))},function(e){return t(i.status.FAILED,e)},e)},i.prototype.isSupported=function(){return this._isSupported},i.prototype.getState=function(){return this.state},i.prototype.getURL=function(){return this.url}}).call(t,"modules/xmpp/recording.js",n(4))},function(e,t,n){(function(e,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};t.default=function(e){Strophe.addConnectionPlugin("emuc",new g(e))};var l=n(1),d=n(108),f=i(d),p=n(18),h=n(7),m=i(h),v=(0,l.getLogger)(e),g=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.xmpp=e,n.rooms={},n}return s(t,e),c(t,[{key:"init",value:function(e){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this,e),this.connection.addHandler(this.onPresence.bind(this),null,"presence",null,null,null,null),this.connection.addHandler(this.onPresenceUnavailable.bind(this),null,"presence","unavailable",null),this.connection.addHandler(this.onPresenceError.bind(this),null,"presence","error",null),this.connection.addHandler(this.onMessage.bind(this),null,"message",null,null),this.connection.addHandler(this.onMute.bind(this),"http://jitsi.org/jitmeet/audio","iq","set",null,null)}},{key:"createRoom",value:function(e,t,n){var r=Strophe.getBareJidFromJid(e);if(this.rooms[r]){var i="You are already in the room!";throw v.error(i),new Error(i)}return this.rooms[r]=new f.default(this.connection,e,t,this.xmpp,n),this.eventEmitter.emit(m.default.EMUC_ROOM_ADDED,this.rooms[r]),this.rooms[r]}},{key:"doLeave",value:function(e){this.eventEmitter.emit(m.default.EMUC_ROOM_REMOVED,this.rooms[e]),delete this.rooms[e]}},{key:"onPresence",value:function(e){var t=e.getAttribute("from");if(e.getAttribute("type"))return!0;var n=this.rooms[Strophe.getBareJidFromJid(t)];return n?(r(e).find('>x[xmlns="http://jabber.org/protocol/muc#user"]>status[code="201"]').length&&n.createNonAnonymousRoom(),n.onPresence(e),!0):void 0}},{key:"onPresenceUnavailable",value:function(e){var t=e.getAttribute("from"),n=this.rooms[Strophe.getBareJidFromJid(t)];if(n)return n.onPresenceUnavailable(e,t),!0}},{key:"onPresenceError",value:function(e){var t=e.getAttribute("from"),n=this.rooms[Strophe.getBareJidFromJid(t)];if(n)return n.onPresenceError(e,t),!0}},{key:"onMessage",value:function(e){var t=e.getAttribute("from"),n=this.rooms[Strophe.getBareJidFromJid(t)];if(n)return n.onMessage(e,t),!0}},{key:"onMute",value:function(e){var t=e.getAttribute("from"),n=this.rooms[Strophe.getBareJidFromJid(t)];if(n)return n.onMute(e),!0}}]),t}(p.ConnectionPluginListenable)}).call(t,"modules/xmpp/strophe.emuc.js",n(4))},function(e,t,n){(function(e,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n){Strophe.addConnectionPlugin("jingle",new k(e,t,n))}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};t.default=u;var f=n(1),p=n(110),h=o(p),m=n(23),v=i(m),g=n(7),y=o(g),b=n(3),E=o(b),S=n(22),T=o(S),C=n(6),w=o(C),_=n(18),R=o(_),A=(0,f.getLogger)(e),k=function(e){function t(e,n,r){a(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.xmpp=e,i.eventEmitter=n,i.sessions={},i.jvbIceConfig={iceServers:[]},i.p2pIceConfig={iceServers:[]},Array.isArray(r)&&(A.info("Configured STUN servers: ",r),i.p2pIceConfig.iceServers=r),i.mediaConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},i}return c(t,e),l(t,[{key:"init",value:function(e){d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this,e),this.connection.addHandler(this.onJingle.bind(this),"urn:xmpp:jingle:1","iq","set",null,null)}},{key:"onJingle",value:function(e){var t=r(e).find("jingle").attr("sid"),n=r(e).find("jingle").attr("action"),i=e.getAttribute("from"),o=$iq({type:"result",to:i,id:e.getAttribute("id")});A.log("on jingle "+n+" from "+i,e);var a=this.sessions[t];if("session-initiate"!==n){if(!a)return o.attrs({type:"error"}),o.c("error",{type:"cancel"}).c("item-not-found",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("unknown-session",{xmlns:"urn:xmpp:jingle:errors:1"}),A.warn("invalid session id",e),this.connection.send(o),!0;if(i!==a.peerjid)return A.warn("jid mismatch for session id",t,a.peerjid,e),o.attrs({type:"error"}),o.c("error",{type:"cancel"}).c("item-not-found",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("unknown-session",{xmlns:"urn:xmpp:jingle:errors:1"}),this.connection.send(o),!0}else if(void 0!==a)return o.attrs({type:"error"}),o.c("error",{type:"cancel"}).c("service-unavailable",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up(),A.warn("duplicate session id",t,e),this.connection.send(o),!0;var s=window.performance.now();switch(n){case"session-initiate":A.log("(TIME) received session-initiate:\t",s);var c=r(e).find("jingle>startmuted");if(c&&c.length>0){var u=c.attr("audio"),l=c.attr("video");this.eventEmitter.emit(y.default.START_MUTED_FROM_FOCUS,"true"===u,"true"===l)}var d="focus"!==Strophe.getResourceFromJid(i);A.info("Marking session from "+i+" as "+(d?"":"*not*")+" P2P"),a=new h.default(r(e).find("jingle").attr("sid"),r(e).attr("to"),i,this.connection,this.mediaConstraints,d?this.p2pIceConfig:this.jvbIceConfig,d,!1,this.xmpp.options),this.sessions[a.sid]=a,this.eventEmitter.emit(y.default.CALL_INCOMING,a,r(e).find(">jingle"),s),w.default.analytics.sendEvent("xmpp.session-initiate",{value:s});break;case"session-accept":this.eventEmitter.emit(y.default.CALL_ACCEPTED,a,r(e).find(">jingle"));break;case"transport-info":this.eventEmitter.emit(y.default.TRANSPORT_INFO,a,r(e).find(">jingle"));break;case"session-terminate":A.log("terminating...",a.sid);var f=null,p=null;r(e).find(">jingle>reason").length&&(f=r(e).find(">jingle>reason>:first")[0].tagName,p=r(e).find(">jingle>reason>text").text()),a.state=v.ENDED,this.terminate(a.sid,f,p),this.eventEmitter.emit(y.default.CALL_ENDED,a,f,p);break;case"transport-replace":A.info("(TIME) Start transport replace",s),w.default.analytics.sendEvent("xmpp.transport-replace.start",{value:s}),a.replaceTransport(r(e).find(">jingle"),function(){var e=window.performance.now();A.info("(TIME) Transport replace success!",e),w.default.analytics.sendEvent("xmpp.transport-replace.success",{value:e})},function(e){E.default.callErrorHandler(e),A.error("Transport replace failed",e),a.sendTransportReject()});break;case"addsource":case"source-add":a.addRemoteStream(r(e).find(">jingle>content"));break;case"removesource":case"source-remove":a.removeRemoteStream(r(e).find(">jingle>content"));break;default:A.warn("jingle action not implemented",n),o.attrs({type:"error"}),o.c("error",{type:"cancel"}).c("bad-request",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up()}return this.connection.send(o),!0}},{key:"newP2PJingleSession",value:function(e,t){var n=new h.default(T.default.randomHexString(12),e,t,this.connection,this.mediaConstraints,this.p2pIceConfig,!0,!0,this.xmpp.options);return this.sessions[n.sid]=n,n}},{key:"terminate",value:function(e,t,n){this.sessions.hasOwnProperty(e)&&("ended"!==this.sessions[e].state&&this.sessions[e].onTerminated(t,n),delete this.sessions[e])}},{key:"getStunAndTurnCredentials",value:function(){var e=this;this.connection.sendIQ($iq({type:"get",to:this.connection.domain}).c("services",{xmlns:"urn:xmpp:extdisco:1"}).c("service",{host:"turn."+this.connection.domain}),function(t){var n=[];r(t).find(">services>service").each(function(e,t){t=r(t);var i={},o=t.attr("type");switch(o){case"stun":i.url="stun:"+t.attr("host"),t.attr("port")&&(i.url+=":"+t.attr("port")),n.push(i);break;case"turn":case"turns":i.url=o+":";var a=t.attr("username");a&&(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10)<28?i.url+=a+"@":i.username=a),i.url+=t.attr("host");var s=t.attr("port");s&&"3478"!==s&&(i.url+=":"+t.attr("port"));var c=t.attr("transport");c&&"udp"!==c&&(i.url+="?transport="+c),i.credential=t.attr("password")||i.credential,n.push(i)}}),e.jvbIceConfig.iceServers=n},function(e){A.warn("getting turn credentials failed",e),A.warn("is mod_turncredentials or similar installed?")})}},{key:"getLog",value:function(){var e=this,t={};return Object.keys(this.sessions).forEach(function(n){var r=e.sessions[n],i=r.peerconnection;i&&i.updateLog&&(t["jingle_"+n]={updateLog:i.updateLog,stats:i.stats,url:window.location.href})}),t}}]),t}(R.default)}).call(t,"modules/xmpp/strophe.jingle.js",n(4))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};t.default=function(){Strophe.addConnectionPlugin("logger",new d)};var u=n(18),l=r(u),d=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.log=[],e}return a(t,e),s(t,[{key:"init",value:function(e){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this,e),this.connection.rawInput=this.logIncoming.bind(this),this.connection.rawOutput=this.logOutgoing.bind(this)}},{key:"logIncoming",value:function(e){this.log.push([(new Date).getTime(),"incoming",e])}},{key:"logOutgoing",value:function(e){this.log.push([(new Date).getTime(),"outgoing",e])}}]),t}(l.default)},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};t.default=function(e){Strophe.addConnectionPlugin("ping",new y(e))};var u=n(1),l=n(18),d=r(l),f=n(3),p=r(f),h=(0,u.getLogger)(e),m=1e4,v=15e3,g=3,y=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.failedPings=0,n.xmpp=e,n}return a(t,e),s(t,[{key:"init",value:function(e){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this,e),Strophe.addNamespace("PING","urn:xmpp:ping")}},{key:"ping",value:function(e,t,n,r){var i=$iq({type:"get",to:e});i.c("ping",{xmlns:Strophe.NS.PING}),this.connection.sendIQ(i,t,n,r)}},{key:"hasPingSupport",value:function(e,t){this.xmpp.caps.getFeatures(e).then(function(e){return t(e.has("urn:xmpp:ping"))},function(e){var n="Ping feature discovery error";p.default.callErrorHandler(new Error(n+": "+e)),h.error(n,e),t(!1)})}},{key:"startInterval",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;if(this.intervalId){var r="Ping task scheduled already";return p.default.callErrorHandler(new Error(r)),void h.error(r)}this.intervalId=window.setInterval(function(){t.ping(e,function(){t.failedPings=0},function(e){t.failedPings+=1;var n="Ping "+(e?"error":"timeout");t.failedPings>=g?(p.default.callErrorHandler(new Error(n)),h.error(n,e)):h.warn(n,e)},v)},n),h.info("XMPP pings will be sent every "+n+" ms")}},{key:"stopInterval",value:function(){this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=null,this.failedPings=0,h.info("Ping interval cleared"))}}]),t}(d.default)}).call(t,"modules/xmpp/strophe.ping.js")},function(e,t,n){(function(e,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};t.default=function(){Strophe.addConnectionPlugin("rayo",new m)};var l=n(1),d=n(18),f=i(d),p=(0,l.getLogger)(e),h="urn:xmpp:rayo:1",m=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),c(t,[{key:"init",value:function(e){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this,e),this.connection.addHandler(this.onRayo.bind(this),h,"iq","set",null,null)}},{key:"onRayo",value:function(e){p.info("Rayo IQ",e)}},{key:"dial",value:function(e,t,n,i,o){var a=this;return new Promise(function(s,c){if(!o)return void c(new Error("Internal error!"));var u=$iq({type:"set",to:o});u.c("dial",{xmlns:h,to:e,from:t}),u.c("header",{name:"JvbRoomName",value:n}).up(),i&&i.length&&u.c("header",{name:"JvbRoomPassword",value:i}).up(),a.connection.sendIQ(u,function(e){p.info("Dial result ",e);var t=r(e).find("ref").attr("uri");a.callResource=t.substr("xmpp:".length),p.info("Received call resource: "+a.callResource),s()},function(e){p.info("Dial error ",e),c(e)})})}},{key:"hangup",value:function(){var e=this;return new Promise(function(t,n){if(!e.callResource)return n(new Error("No call in progress")),void p.warn("No call in progress");var r=$iq({type:"set",to:e.callResource});r.c("hangup",{xmlns:h}),e.connection.sendIQ(r,function(n){p.info("Hangup result ",n),e.callResource=null,t()},function(t){p.info("Hangup error ",t),e.callResource=null,n(new Error("Hangup error "))})})}}]),t}(f.default)}).call(t,"modules/xmpp/strophe.rayo.js",n(4))},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){Strophe.log=function(e,t){switch(s.trace("Strophe",e,t),"string"==typeof t&&t.indexOf("Request ")!==-1&&t.indexOf("timed out (secondary), restarting")!==-1&&(e=Strophe.LogLevel.WARN),e){case Strophe.LogLevel.DEBUG:c!==-1&&u.test(t)&&(s.debug("Reset lastErrorStatus"),c=-1);break;case Strophe.LogLevel.WARN:s.warn("Strophe: "+t);var n=l.exec(t);n&&2===n.length&&(c=parseInt(n[1],10),s.debug("lastErrorStatus set to: "+c));break;case Strophe.LogLevel.ERROR:case Strophe.LogLevel.FATAL:t="Strophe: "+t,a.default.callErrorHandler(new Error(t)),s.error(t)}},Strophe.getLastErrorStatus=function(){return c},Strophe.getStatusString=function(e){switch(e){case Strophe.Status.ERROR:return"ERROR";case Strophe.Status.CONNECTING:return"CONNECTING";case Strophe.Status.CONNFAIL:return"CONNFAIL";case Strophe.Status.AUTHENTICATING:return"AUTHENTICATING";case Strophe.Status.AUTHFAIL:return"AUTHFAIL";case Strophe.Status.CONNECTED:return"CONNECTED";case Strophe.Status.DISCONNECTED:return"DISCONNECTED";case Strophe.Status.DISCONNECTING:return"DISCONNECTING";case Strophe.Status.ATTACHED:return"ATTACHED";default:return"unknown"}}};var i=n(1),o=n(3),a=r(o),s=(0,i.getLogger)(e),c=-1,u=/request id \d+.\d+ got 200/,l=/request errored, status: (\d+), number of errors: \d+/}).call(t,"modules/xmpp/strophe.util.js")},function(e,t,n){(function(e,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/http-bind";return e&&(t+=(t.indexOf("?")===-1?"?":"&")+"token="+e),new Strophe.Connection(t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),f=n(22),p=o(f),h=n(41),m=i(h),v=n(29),g=i(v),y=n(2),b=o(y),E=n(117),S=o(E),T=n(118),C=o(T),w=n(122),_=o(w),R=n(120),A=o(R),k=n(121),O=o(k),I=n(119),P=o(I),D=n(11),N=o(D),x=n(107),L=o(x),M=(0,d.getLogger)(e),j=function(e){function t(e,n){a(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.connection=null,i.disconnectInProgress=!1,i.connectionTimes={},i.forceMuted=!1,i.options=e,i.connectParams={},i.token=n,i.authenticatedUser=!1,i._initStrophePlugins(i),i.connection=u(n,e.bosh),i.caps=new L.default(i.connection,i.options.clientNode),i.initFeaturesList(),r(window).on("beforeunload unload",i.disconnect.bind(i)),i}return c(t,e),l(t,[{key:"initFeaturesList",value:function(){this.caps.addFeature("urn:xmpp:jingle:1"),this.caps.addFeature("urn:xmpp:jingle:apps:rtp:1"),this.caps.addFeature("urn:xmpp:jingle:transports:ice-udp:1"),this.caps.addFeature("urn:xmpp:jingle:apps:dtls:0"),this.caps.addFeature("urn:xmpp:jingle:transports:dtls-sctp:1"),this.caps.addFeature("urn:xmpp:jingle:apps:rtp:audio"),this.caps.addFeature("urn:xmpp:jingle:apps:rtp:video"),!this.options.disableRtx&&b.default.supportsRtx()&&this.caps.addFeature("urn:ietf:rfc:4588"),this.caps.addFeature("urn:ietf:rfc:5761"),this.caps.addFeature("urn:ietf:rfc:5888"),b.default.isChrome()&&this.options.enableLipSync!==!1&&(M.info("Lip-sync enabled !"),this.caps.addFeature("http://jitsi.org/meet/lipsync")),this.connection.rayo&&this.caps.addFeature("urn:xmpp:rayo:client:1")}},{key:"getConnection",value:function(){return this.connection}},{key:"connectionHandler",value:function(e,t,n){var r=this,i=window.performance.now(),o=Strophe.getStatusString(t).toLowerCase();if(this.connectionTimes[o]=i,M.log("(TIME) Strophe "+o+(n?"["+n+"]":"")+":\t",i),t===Strophe.Status.CONNECTED||t===Strophe.Status.ATTACHED){this.options.useStunTurn&&this.connection.jingle.getStunAndTurnCredentials(),M.info("My Jabber ID: "+this.connection.jid);var a=this.connection.domain;this.connection.ping.hasPingSupport(a,function(e){e?r.connection.ping.startInterval(a):M.warn("Ping NOT supported by "+a)}),e&&(this.authenticatedUser=!0),this.connection&&this.connection.connected&&Strophe.getResourceFromJid(this.connection.jid)&&this.eventEmitter.emit(g.CONNECTION_ESTABLISHED,Strophe.getResourceFromJid(this.connection.jid))}else if(t===Strophe.Status.CONNFAIL)"x-strophe-bad-non-anon-jid"===n?this.anonymousConnectionFailed=!0:this.connectionFailed=!0,this.lastErrorMsg=n;else if(t===Strophe.Status.DISCONNECTED){this.connection.ping.stopInterval();var s=this.disconnectInProgress,c=n?n:this.lastErrorMsg;if(this.disconnectInProgress=!1,this.anonymousConnectionFailed)this.eventEmitter.emit(g.CONNECTION_FAILED,m.PASSWORD_REQUIRED);else if(this.connectionFailed)this.eventEmitter.emit(g.CONNECTION_FAILED,m.OTHER_ERROR,c);else if(s)this.eventEmitter.emit(g.CONNECTION_DISCONNECTED,c);else{
M.error("XMPP connection dropped!");var u=Strophe.getLastErrorStatus();u>=500&&u<600?this.eventEmitter.emit(g.CONNECTION_FAILED,m.SERVER_ERROR,c?c:"server-error"):this.eventEmitter.emit(g.CONNECTION_FAILED,m.CONNECTION_DROPPED_ERROR,c?c:"connection-dropped-error")}}else t===Strophe.Status.AUTHFAIL&&this.eventEmitter.emit(g.CONNECTION_FAILED,m.PASSWORD_REQUIRED)}},{key:"_connect",value:function(e,t){this.anonymousConnectionFailed=!1,this.connectionFailed=!1,this.lastErrorMsg=void 0,this.connection.connect(e,t,this.connectionHandler.bind(this,t))}},{key:"attach",value:function(e){var t=this.connectionTimes.attaching=window.performance.now();M.log("(TIME) Strophe Attaching\t:"+t),this.connection.attach(e.jid,e.sid,parseInt(e.rid,10)+1,this.connectionHandler.bind(this,e.password))}},{key:"connect",value:function(e,t){if(this.connectParams={jid:e,password:t},!e){var n=this.options.hosts.anonymousdomain||this.options.hosts.domain;this.options.hosts.anonymousdomain&&(window.location.search.indexOf("login=true")!==-1||this.token)&&(n=this.options.hosts.domain),e=n||window.location.hostname}return this._connect(e,t)}},{key:"createRoom",value:function(e,t){var n=Strophe.getNodeFromJid(this.connection.jid),r=e+"@"+this.options.hosts.muc+"/",i=t.useNicks&&t.nick?t.nick:null;return i?n=t.nick:this.authenticatedUser||(n=n.substr(0,8)),(this.authenticatedUser||null!==i)&&(n+="-"+p.default.randomHexString(6)),r+=n,this.connection.emuc.createRoom(r,null,t)}},{key:"getJingleLog",value:function(){var e=this.connection.jingle;return e?e.getLog():{}}},{key:"getXmppLog",value:function(){return(this.connection.logger||{}).log||null}},{key:"dial",value:function(){var e;(e=this.connection.rayo).dial.apply(e,arguments)}},{key:"setMute",value:function(e,t){this.connection.moderate.setMute(e,t)}},{key:"eject",value:function(e){this.connection.moderate.eject(e)}},{key:"getSessions",value:function(){return this.connection.jingle.sessions}},{key:"disconnect",value:function(e){if(this.disconnectInProgress||!this.connection||!this.connection.connected)return void this.eventEmitter.emit(g.WRONG_STATE);if(this.disconnectInProgress=!0,this.connection.flush(),null!==e&&"undefined"!=typeof e){var t=e.type;"beforeunload"!==t&&"unload"!==t||(this.connection.options.sync=!0)}this.connection.disconnect(),this.connection.options.sync!==!0&&this.connection.flush()}},{key:"_initStrophePlugins",value:function(){(0,S.default)(this),(0,C.default)(this,this.eventEmitter,this.options.p2pStunServers),(0,_.default)(),(0,A.default)(this),(0,O.default)(),(0,P.default)()}}]),t}(N.default);t.default=j}).call(t,"modules/xmpp/xmpp.js",n(4))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(11),u=r(c),l=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"getSSRCOwner",value:function(e){throw new Error("not implemented")}},{key:"getPeerMediaInfo",value:function(e,t){throw new Error("not implemented")}}]),t}(u.default);t.default=l},function(e,t){"use strict";var n={LOCAL_JID:"local"};e.exports=n},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},function(e,t){!function(e){"use strict";t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,o="";for(n=0;n<i;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return i%3===2?o=o.substring(0,o.length-1)+"=":i%3===1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(t){var n,r,i,o,a,s=.75*t.length,c=t.length,u=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var l=new ArrayBuffer(s),d=new Uint8Array(l);for(n=0;n<c;n+=4)r=e.indexOf(t[n]),i=e.indexOf(t[n+1]),o=e.indexOf(t[n+2]),a=e.indexOf(t[n+3]),d[u++]=r<<2|i>>4,d[u++]=(15&i)<<4|o>>2,d[u++]=(3&o)<<6|63&a;return l}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},function(e,t){(function(t){function n(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var i=new Uint8Array(n.byteLength);i.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=i.buffer}e[t]=r}}}function r(e,t){t=t||{};var r=new o;n(e);for(var i=0;i<e.length;i++)r.append(e[i]);return t.type?r.getBlob(t.type):r.getBlob()}function i(e,t){return n(e),new Blob(e,t||{})}var o=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,a=function(){try{var e=new Blob(["hi"]);return 2===e.size}catch(e){return!1}}(),s=a&&function(){try{var e=new Blob([new Uint8Array([1,2])]);return 2===e.size}catch(e){return!1}}(),c=o&&o.prototype.append&&o.prototype.getBlob;e.exports=function(){return a?s?t.Blob:i:c?r:void 0}()}).call(t,function(){return this}())},function(e,t,n){var r,i,o;/*!
	 * currentExecutingScript
	 * Get the currently executing script, regardless of its source/trigger/synchronicity. Similar to HTML5's `document.currentScript` but arguably much more useful!
	 * Copyright (c) 2015 James M. Greene
	 * Licensed MIT
	 * https://github.com/JamesMGreene/currentExecutingScript
	 * v0.1.3
	 */
!function(n,a){i=[],r=a,o="function"==typeof r?r.apply(t,i):r,!(void 0!==o&&(e.exports=o))}(this||window,function(){function e(e){return e?e.replace(/^\s+$|\s+$/g,"").replace(/\s\s+/g," "):""}function t(e,t){var n,r=null;if(t=t||f,"string"==typeof e&&e)for(n=t.length;n--;)if(t[n].src===e){r=t[n];break}return r}function n(t,n){var r,i,o=null,a=e(t);if(n=n||f,t&&a)for(r=n.length;r--;)if(!n[r].hasAttribute("src")&&(i=e(n[r].text),i.indexOf(a)!==-1)){if(o){o=null;break}o=n[r]}return o}function r(e){var t,n,r=null;for(e=e||f,t=0,n=e.length;t<n;t++)if(!e[t].hasAttribute("src")){if(r){r=null;break}r=e[t]}return r}function i(e,t){var n,r,o=null,a="number"==typeof t;return t=a?Math.round(t):0,"string"==typeof e&&e&&(a?n=e.match(/(data:text\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/):(n=e.match(/^(?:|[^:@]*@|.+\)@(?=data:text\/javascript|blob|http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)(data:text\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),n&&n[1]||(n=e.match(/\)@(data:text\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))),n&&n[1]&&(t>0?(r=e.slice(e.indexOf(n[0])+n[0].length),o=i(r,t-1)):o=n[1])),o}function o(){return null}function a(){return null}function s(){if(0===f.length)return null;var e,o,a,c,l,y=[],b=s.skipStackDepth||1,E=null;for(e=0;e<f.length;e++)h&&p?u.test(f[e].readyState)&&y.push(f[e]):y.push(f[e]);if(o=new Error,v&&(a=o.stack),!a&&g)try{throw o}catch(e){a=e.stack}if(a&&(c=i(a,b),l=t(c,y),!l&&d&&c===d&&(l=E?n(E,y):r(y))),l||1===y.length&&(l=y[0]),l||m&&(l=document.currentScript),!l&&h&&p)for(e=y.length;e--;)if("interactive"===y[e].readyState){l=y[e];break}return l||(l=y[y.length-1]||null),l}var c,u=/^(interactive|loaded|complete)$/,l=window.location?window.location.href:null,d=l?l.replace(/#.*$/,"").replace(/\?.*$/,"")||null:null,f=document.getElementsByTagName("script"),p="readyState"in(f[0]||document.createElement("script")),h=!window.opera||"[object Opera]"!==window.opera.toString(),m="currentScript"in document;"stackTraceLimit"in Error&&Error.stackTraceLimit!==1/0&&(c=Error.stackTraceLimit,Error.stackTraceLimit=1/0);var v=!1,g=!1;!function(){try{var e=new Error;throw v="string"==typeof e.stack&&!!e.stack,e}catch(e){g="string"==typeof e.stack&&!!e.stack}}(),s.skipStackDepth=1;var y=s;return y.near=s,y.far=o,y.origin=a,y})},function(e,t,n){function r(){return t.colors[l++%t.colors.length]}function i(e){function n(){}function i(){var e=i,n=+new Date,o=n-(u||n);e.diff=o,e.prev=u,e.curr=n,u=n,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=r());var a=Array.prototype.slice.call(arguments);a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var s=0;a[0]=a[0].replace(/%([a-z%])/g,function(n,r){if("%%"===n)return n;s++;var i=t.formatters[r];if("function"==typeof i){var o=a[s];n=i.call(e,o),a.splice(s,1),s--}return n}),"function"==typeof t.formatArgs&&(a=t.formatArgs.apply(e,a));var c=i.log||t.log||console.log.bind(console);c.apply(e,a)}n.enabled=!1,i.enabled=!0;var o=t.enabled(e)?i:n;return o.namespace=e,o}function o(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&(e=n[i].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function a(){t.enable("")}function s(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=i,t.coerce=c,t.disable=a,t.enable=o,t.enabled=s,t.humanize=n(144),t.names=[],t.skips=[],t.formatters={};var u,l=0},function(e,t,n){e.exports=n(132)},function(e,t,n){e.exports=n(133),e.exports.parser=n(16)},function(e,t,n){(function(t){function r(e,n){if(!(this instanceof r))return new r(e,n);n=n||{},e&&"object"==typeof e&&(n=e,e=null),e?(e=l(e),n.hostname=e.host,n.secure="https"==e.protocol||"wss"==e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=l(n.host).host),this.secure=null!=n.secure?n.secure:t.location&&"https:"==location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.agent=n.agent||!1,this.hostname=n.hostname||(t.location?location.hostname:"localhost"),this.port=n.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=f.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.perMessageDeflate=!1!==n.perMessageDeflate&&(n.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=void 0===n.rejectUnauthorized?null:n.rejectUnauthorized;var i="object"==typeof t&&t;i.global===i&&n.extraHeaders&&Object.keys(n.extraHeaders).length>0&&(this.extraHeaders=n.extraHeaders),this.open()}function i(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var o=n(55),a=n(37),s=n(10)("engine.io-client:socket"),c=n(57),u=n(16),l=n(59),d=n(145),f=n(38);e.exports=r,r.priorWebsocketSuccess=!1,a(r.prototype),r.protocol=u.protocol,r.Socket=r,r.Transport=n(35),r.transports=n(55),r.parser=n(16),r.prototype.createTransport=function(e){s('creating transport "%s"',e);var t=i(this.query);t.EIO=u.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=new o[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders});return n},r.prototype.open=function(){var e;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1)e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},r.prototype.setTransport=function(e){s("setting transport %s",e.name);var t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},r.prototype.probe=function(e){function t(){if(f.onlyBinaryUpgrades){var t=!this.supportsBinary&&f.transport.supportsBinary;d=d||t}d||(s('probe transport "%s" opened',e),l.send([{type:"ping",data:"probe"}]),l.once("packet",function(t){if(!d)if("pong"==t.type&&"probe"==t.data){if(s('probe transport "%s" pong',e),f.upgrading=!0,f.emit("upgrading",l),!l)return;r.priorWebsocketSuccess="websocket"==l.name,s('pausing current transport "%s"',f.transport.name),f.transport.pause(function(){d||"closed"!=f.readyState&&(s("changing transport and sending upgrade packet"),u(),f.setTransport(l),l.send([{type:"upgrade"}]),f.emit("upgrade",l),l=null,f.upgrading=!1,f.flush())})}else{s('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=l.name,f.emit("upgradeError",n)}}))}function n(){d||(d=!0,u(),l.close(),l=null)}function i(t){var r=new Error("probe error: "+t);r.transport=l.name,n(),s('probe transport "%s" failed because of error: %s',e,t),f.emit("upgradeError",r)}function o(){i("transport closed")}function a(){i("socket closed")}function c(e){l&&e.name!=l.name&&(s('"%s" works - aborting "%s"',e.name,l.name),n())}function u(){l.removeListener("open",t),l.removeListener("error",i),l.removeListener("close",o),f.removeListener("close",a),f.removeListener("upgrading",c)}s('probing transport "%s"',e);var l=this.createTransport(e,{probe:1}),d=!1,f=this;r.priorWebsocketSuccess=!1,l.once("open",t),l.once("error",i),l.once("close",o),this.once("close",a),this.once("upgrading",c),l.open()},r.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},r.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(d(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else s('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},r.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){s("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},r.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},r.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!=this.readyState&&"closed"!=this.readyState){n=n||{},n.compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function e(){r.onClose("forced close"),s("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function n(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},r.prototype.onError=function(e){s("socket error %j",e),r.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},r.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){s('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),n.writeBuffer=[],n.prevBufferLen=0}},r.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~c(this.transports,e[n])&&t.push(e[n]);return t}}).call(t,function(){return this}())},function(e,t,n){(function(t){function r(){}function i(e){o.call(this,e),this.query=this.query||{},s||(t.___eio||(t.___eio=[]),s=t.___eio),this.index=s.length;var n=this;s.push(function(e){n.onData(e)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){n.script&&(n.script.onerror=r)},!1)}var o=n(56),a=n(25);e.exports=i;var s,c=/\n/g,u=/\\n/g;a(i,o),i.prototype.supportsBinary=!1,i.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},i.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},i.prototype.doWrite=function(e,t){function n(){r(),t()}function r(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(e){i.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+i.iframeId+'">';o=document.createElement(e)}catch(e){o=document.createElement("iframe"),o.name=i.iframeId,o.src="javascript:0"}o.id=i.iframeId,i.form.appendChild(o),i.iframe=o}var i=this;if(!this.form){var o,a=document.createElement("form"),s=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=l,a.method="POST",a.setAttribute("accept-charset","utf-8"),s.name="d",a.appendChild(s),document.body.appendChild(a),this.form=a,this.area=s}this.form.action=this.uri(),r(),e=e.replace(u,"\\\n"),this.area.value=e.replace(c,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==i.iframe.readyState&&n()}:this.iframe.onload=n}}).call(t,function(){return this}())},function(e,t,n){(function(t){function r(){}function i(e){if(c.call(this,e),t.location){var n="https:"==location.protocol,r=location.port;r||(r=n?443:80),this.xd=e.hostname!=t.location.hostname||r!=e.port,this.xs=e.secure!=n}else this.extraHeaders=e.extraHeaders}function o(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function a(){for(var e in o.requests)o.requests.hasOwnProperty(e)&&o.requests[e].abort()}var s=n(36),c=n(56),u=n(37),l=n(25),d=n(10)("engine.io-client:polling-xhr");e.exports=i,e.exports.Request=o,l(i,c),i.prototype.supportsBinary=!0,i.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.extraHeaders=this.extraHeaders,new o(e)},i.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=r},i.prototype.doPoll=function(){d("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},u(o.prototype),o.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new s(e),r=this;try{d("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async);try{if(this.extraHeaders){n.setDisableHeaderCheck(!0);for(var i in this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this.extraHeaders[i])}}catch(e){}if(this.supportsBinary&&(n.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}"withCredentials"in n&&(n.withCredentials=!0),this.hasXDR()?(n.onload=function(){r.onLoad()},n.onerror=function(){r.onError(n.responseText)}):n.onreadystatechange=function(){4==n.readyState&&(200==n.status||1223==n.status?r.onLoad():setTimeout(function(){r.onError(n.status)},0))},d("xhr data %s",this.data),n.send(this.data)}catch(e){return void setTimeout(function(){r.onError(e)},0)}t.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},o.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},o.prototype.cleanup=function(e){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(e){}t.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}if("application/octet-stream"===t)e=this.xhr.response;else if(this.supportsBinary)try{e=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(t){for(var n=new Uint8Array(this.xhr.response),r=[],i=0,o=n.length;i<o;i++)r.push(n[i]);e=String.fromCharCode.apply(null,r)}else e=this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},o.prototype.hasXDR=function(){return"undefined"!=typeof t.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},t.document&&(o.requestsCount=0,o.requests={},t.attachEvent?t.attachEvent("onunload",a):t.addEventListener&&t.addEventListener("beforeunload",a,!1))}).call(t,function(){return this}())},function(e,t,n){(function(t){function r(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,i.call(this,e)}var i=n(35),o=n(16),a=n(38),s=n(25),c=n(69),u=n(10)("engine.io-client:websocket"),l=t.WebSocket||t.MozWebSocket,d=l;if(!d&&"undefined"==typeof window)try{d=n(173)}catch(e){}e.exports=r,s(r,i),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=void 0,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.ws=l?new d(e):new d(e,t,n),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="buffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(r.prototype.onData=function(e){var t=this;setTimeout(function(){i.prototype.onData.call(t,e)},0)}),r.prototype.write=function(e){function n(){r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0)}var r=this;this.writable=!1;for(var i=e.length,a=0,s=i;a<s;a++)!function(e){o.encodePacket(e,r.supportsBinary,function(o){if(!l){var a={};if(e.options&&(a.compress=e.options.compress),r.perMessageDeflate){var s="string"==typeof o?t.Buffer.byteLength(o):o.length;s<r.perMessageDeflate.threshold&&(a.compress=!1)}}try{l?r.ws.send(o):r.ws.send(o,a)}catch(e){u("websocket closed before onclose event")}--i||n()})}(e[a])},r.prototype.onClose=function(){i.prototype.onClose.call(this)},r.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||(e.b64=1),e=a.encode(e),e.length&&(e="?"+e);var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e},r.prototype.check=function(){return!(!d||"__initialize"in d&&this.name===r.prototype.name)}}).call(t,function(){return this}())},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t,n){(function(t){function r(e){function n(e){if(!e)return!1;if(t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer||t.Blob&&e instanceof Blob||t.File&&e instanceof File)return!0;if(i(e)){for(var r=0;r<e.length;r++)if(n(e[r]))return!0}else if(e&&"object"==typeof e){e.toJSON&&(e=e.toJSON());for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&n(e[o]))return!0}return!1}return n(e)}var i=n(26);e.exports=r}).call(t,function(){return this}())},function(e,t,n){(function(t){function r(e){function n(e){if(!e)return!1;if(t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer||t.Blob&&e instanceof Blob||t.File&&e instanceof File)return!0;if(i(e)){for(var r=0;r<e.length;r++)if(n(e[r]))return!0}else if(e&&"object"==typeof e){e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON());for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&n(e[o]))return!0}return!1}return n(e)}var i=n(26);e.exports=r}).call(t,function(){return this}())},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){function r(e,t){this.logStorage=e,this.stringifyObjects=!(!t||!t.stringifyObjects)&&t.stringifyObjects,this.storeInterval=t&&t.storeInterval?t.storeInterval:3e4,this.maxEntryLength=t&&t.maxEntryLength?t.maxEntryLength:1e4,Object.keys(i.levels).forEach(function(e){var t=i.levels[e];this[t]=function(e){this._log.apply(this,arguments)}.bind(this,e)}.bind(this)),this.storeLogsIntervalID=null,this.queue=[],this.totalLen=0,this.outputCache=[]}var i=n(58);r.prototype.stringify=function(e){try{return JSON.stringify(e)}catch(e){return"[object with circular refs?]"}},r.prototype.formatLogMessage=function(e){for(var t="",n=1,r=arguments.length;n<r;n++){var o=arguments[n];!this.stringifyObjects&&e!==i.levels.ERROR||"object"!=typeof o||(o=this.stringify(o)),t+=o,n!=r-1&&(t+=" ")}return t.length?t:null},r.prototype._log=function(){var e=this.formatLogMessage.apply(this,arguments);if(e){var t=this.queue.length?this.queue[this.queue.length-1]:void 0,n="object"==typeof t?t.text:t;n==e?"object"==typeof t?t.count+=1:this.queue[this.queue.length-1]={text:e,count:2}:(this.queue.push(e),this.totalLen+=e.length)}this.totalLen>=this.maxEntryLength&&this._flush(!0,!0)},r.prototype.start=function(){this._reschedulePublishInterval()},r.prototype._reschedulePublishInterval=function(){this.storeLogsIntervalID&&(window.clearTimeout(this.storeLogsIntervalID),this.storeLogsIntervalID=null),this.storeLogsIntervalID=window.setTimeout(this._flush.bind(this,!1,!0),this.storeInterval)},r.prototype.flush=function(){this._flush(!1,!0)},r.prototype._flush=function(e,t){this.totalLen>0&&(this.logStorage.isReady()||e)&&(this.logStorage.isReady()?(this.outputCache.length&&(this.outputCache.forEach(function(e){this.logStorage.storeLogs(e)}.bind(this)),this.outputCache=[]),this.logStorage.storeLogs(this.queue)):this.outputCache.push(this.queue),this.queue=[],this.totalLen=0),t&&this._reschedulePublishInterval()},r.prototype.stop=function(){this._flush(!1,!1)},e.exports=r},function(e,t,n){var r;(function(e,i){(function(){function o(e,t){function n(e){if(n[e]!==v)return n[e];var o;if("bug-string-char-index"==e)o="a"!="a"[0];else if("json"==e)o=n("json-stringify")&&n("json-parse");else{var a,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var u=t.stringify,l="function"==typeof u&&b;if(l){(a=function(){return 1}).toJSON=a;try{l="0"===u(0)&&"0"===u(new r)&&'""'==u(new i)&&u(y)===v&&u(v)===v&&u()===v&&"1"===u(a)&&"[1]"==u([a])&&"[null]"==u([v])&&"null"==u(null)&&"[null,null,null]"==u([v,y,null])&&u({a:[a,!0,!1,null,"\0\b\n\f\r\t"]})==s&&"1"===u(null,a)&&"[\n 1,\n 2\n]"==u([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==u(new c(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==u(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==u(new c(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==u(new c(-1))}catch(e){l=!1}}o=l}if("json-parse"==e){var d=t.parse;if("function"==typeof d)try{if(0===d("0")&&!d(!1)){a=d(s);var f=5==a.a.length&&1===a.a[0];if(f){try{f=!d('"\t"')}catch(e){}if(f)try{f=1!==d("01")}catch(e){}if(f)try{f=1!==d("1.")}catch(e){}}}}catch(e){f=!1}o=f}}return n[e]=!!o}e||(e=u.Object()),t||(t=u.Object());var r=e.Number||u.Number,i=e.String||u.String,a=e.Object||u.Object,c=e.Date||u.Date,l=e.SyntaxError||u.SyntaxError,d=e.TypeError||u.TypeError,f=e.Math||u.Math,p=e.JSON||u.JSON;"object"==typeof p&&p&&(t.stringify=p.stringify,t.parse=p.parse);var h,m,v,g=a.prototype,y=g.toString,b=new c(-0xc782b5b800cec);try{b=b.getUTCFullYear()==-109252&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds()}catch(e){}if(!n("json")){var E="[object Function]",S="[object Date]",T="[object Number]",C="[object String]",w="[object Array]",_="[object Boolean]",R=n("bug-string-char-index");if(!b)var A=f.floor,k=[0,31,59,90,120,151,181,212,243,273,304,334],O=function(e,t){return k[t]+365*(e-1970)+A((e-1969+(t=+(t>1)))/4)-A((e-1901+t)/100)+A((e-1601+t)/400)};if((h=g.hasOwnProperty)||(h=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=y?h=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,h=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,h.call(this,e)}),m=function(e,t){var n,r,i,o=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,r=new n;for(i in r)h.call(r,i)&&o++;return n=r=null,o?m=2==o?function(e,t){var n,r={},i=y.call(e)==E;for(n in e)i&&"prototype"==n||h.call(r,n)||!(r[n]=1)||!h.call(e,n)||t(n)}:function(e,t){var n,r,i=y.call(e)==E;for(n in e)i&&"prototype"==n||!h.call(e,n)||(r="constructor"===n)||t(n);(r||h.call(e,n="constructor"))&&t(n)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],m=function(e,t){var n,i,o=y.call(e)==E,a=!o&&"function"!=typeof e.constructor&&s[typeof e.hasOwnProperty]&&e.hasOwnProperty||h;for(n in e)o&&"prototype"==n||!a.call(e,n)||t(n);for(i=r.length;n=r[--i];a.call(e,n)&&t(n));}),m(e,t)},!n("json-stringify")){var I={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},P="000000",D=function(e,t){return(P+(t||0)).slice(-e)},N="\\u00",x=function(e){for(var t='"',n=0,r=e.length,i=!R||r>10,o=i&&(R?e.split(""):e);n<r;n++){var a=e.charCodeAt(n);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=I[a];break;default:if(a<32){t+=N+D(2,a.toString(16));break}t+=i?o[n]:e.charAt(n)}}return t+'"'},L=function(e,t,n,r,i,o,a){var s,c,u,l,f,p,g,b,E,R,k,I,P,N,M,j;try{s=t[e]}catch(e){}if("object"==typeof s&&s)if(c=y.call(s),c!=S||h.call(s,"toJSON"))"function"==typeof s.toJSON&&(c!=T&&c!=C&&c!=w||h.call(s,"toJSON"))&&(s=s.toJSON(e));else if(s>-1/0&&s<1/0){if(O){for(f=A(s/864e5),u=A(f/365.2425)+1970-1;O(u+1,0)<=f;u++);for(l=A((f-O(u,0))/30.42);O(u,l+1)<=f;l++);f=1+f-O(u,l),p=(s%864e5+864e5)%864e5,g=A(p/36e5)%24,b=A(p/6e4)%60,E=A(p/1e3)%60,R=p%1e3}else u=s.getUTCFullYear(),l=s.getUTCMonth(),f=s.getUTCDate(),g=s.getUTCHours(),b=s.getUTCMinutes(),E=s.getUTCSeconds(),R=s.getUTCMilliseconds();s=(u<=0||u>=1e4?(u<0?"-":"+")+D(6,u<0?-u:u):D(4,u))+"-"+D(2,l+1)+"-"+D(2,f)+"T"+D(2,g)+":"+D(2,b)+":"+D(2,E)+"."+D(3,R)+"Z"}else s=null;if(n&&(s=n.call(t,e,s)),null===s)return"null";if(c=y.call(s),c==_)return""+s;if(c==T)return s>-1/0&&s<1/0?""+s:"null";if(c==C)return x(""+s);if("object"==typeof s){for(N=a.length;N--;)if(a[N]===s)throw d();if(a.push(s),k=[],M=o,o+=i,c==w){for(P=0,N=s.length;P<N;P++)I=L(P,s,n,r,i,o,a),k.push(I===v?"null":I);j=k.length?i?"[\n"+o+k.join(",\n"+o)+"\n"+M+"]":"["+k.join(",")+"]":"[]"}else m(r||s,function(e){var t=L(e,s,n,r,i,o,a);t!==v&&k.push(x(e)+":"+(i?" ":"")+t)}),j=k.length?i?"{\n"+o+k.join(",\n"+o)+"\n"+M+"}":"{"+k.join(",")+"}":"{}";return a.pop(),j}};t.stringify=function(e,t,n){var r,i,o,a;if(s[typeof t]&&t)if((a=y.call(t))==E)i=t;else if(a==w){o={};for(var c,u=0,l=t.length;u<l;c=t[u++],a=y.call(c),(a==C||a==T)&&(o[c]=1));}if(n)if((a=y.call(n))==T){if((n-=n%1)>0)for(r="",n>10&&(n=10);r.length<n;r+=" ");}else a==C&&(r=n.length<=10?n:n.slice(0,10));return L("",(c={},c[""]=e,c),i,o,r,"",[])}}if(!n("json-parse")){var M,j,F=i.fromCharCode,U={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},B=function(){throw M=j=null,l()},J=function(){for(var e,t,n,r,i,o=j,a=o.length;M<a;)switch(i=o.charCodeAt(M)){case 9:case 10:case 13:case 32:M++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=R?o.charAt(M):o[M],M++,e;case 34:for(e="@",M++;M<a;)if(i=o.charCodeAt(M),i<32)B();else if(92==i)switch(i=o.charCodeAt(++M)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=U[i],M++;break;case 117:for(t=++M,n=M+4;M<n;M++)i=o.charCodeAt(M),i>=48&&i<=57||i>=97&&i<=102||i>=65&&i<=70||B();e+=F("0x"+o.slice(t,M));break;default:B()}else{if(34==i)break;for(i=o.charCodeAt(M),t=M;i>=32&&92!=i&&34!=i;)i=o.charCodeAt(++M);e+=o.slice(t,M)}if(34==o.charCodeAt(M))return M++,e;B();default:if(t=M,45==i&&(r=!0,i=o.charCodeAt(++M)),i>=48&&i<=57){for(48==i&&(i=o.charCodeAt(M+1),i>=48&&i<=57)&&B(),r=!1;M<a&&(i=o.charCodeAt(M),i>=48&&i<=57);M++);if(46==o.charCodeAt(M)){for(n=++M;n<a&&(i=o.charCodeAt(n),i>=48&&i<=57);n++);n==M&&B(),M=n}if(i=o.charCodeAt(M),101==i||69==i){for(i=o.charCodeAt(++M),43!=i&&45!=i||M++,n=M;n<a&&(i=o.charCodeAt(n),i>=48&&i<=57);n++);n==M&&B(),M=n}return+o.slice(t,M)}if(r&&B(),"true"==o.slice(M,M+4))return M+=4,!0;if("false"==o.slice(M,M+5))return M+=5,!1;if("null"==o.slice(M,M+4))return M+=4,null;B()}return"$"},H=function(e){var t,n;if("$"==e&&B(),"string"==typeof e){if("@"==(R?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=J(),"]"!=e;n||(n=!0))n&&(","==e?(e=J(),"]"==e&&B()):B()),","==e&&B(),t.push(H(e));return t;
}if("{"==e){for(t={};e=J(),"}"!=e;n||(n=!0))n&&(","==e?(e=J(),"}"==e&&B()):B()),","!=e&&"string"==typeof e&&"@"==(R?e.charAt(0):e[0])&&":"==J()||B(),t[e.slice(1)]=H(J());return t}B()}return e},G=function(e,t,n){var r=V(e,t,n);r===v?delete e[t]:e[t]=r},V=function(e,t,n){var r,i=e[t];if("object"==typeof i&&i)if(y.call(i)==w)for(r=i.length;r--;)G(i,r,n);else m(i,function(e){G(i,e,n)});return n.call(e,t,i)};t.parse=function(e,t){var n,r;return M=0,j=""+e,n=H(J()),"$"!=J()&&B(),M=j=null,t&&y.call(t)==E?V((r={},r[""]=n,r),"",t):n}}}return t.runInContext=o,t}var a=n(169),s={function:!0,object:!0},c=s[typeof t]&&t&&!t.nodeType&&t,u=s[typeof window]&&window||this,l=c&&s[typeof e]&&e&&!e.nodeType&&"object"==typeof i&&i;if(!l||l.global!==l&&l.window!==l&&l.self!==l||(u=l),c&&!a)o(u,c);else{var d=u.JSON,f=u.JSON3,p=!1,h=o(u,u.JSON3={noConflict:function(){return p||(p=!0,u.JSON=d,u.JSON3=f,d=f=null),h}});u.JSON={parse:h.parse,stringify:h.stringify}}a&&(r=function(){return h}.call(t,n,t,e),!(void 0!==r&&(e.exports=r)))}).call(this)}).call(t,n(68)(e),function(){return this}())},function(e,t,n){var r;!function(i){function o(e,t,n){var r=0,i=[0],o="",a=null,o=n||"UTF8";if("UTF8"!==o&&"UTF16"!==o)throw"encoding must be UTF8 or UTF16";if("HEX"===t){if(0!==e.length%2)throw"srcString of HEX type must be in byte increments";a=c(e),r=a.binLen,i=a.value}else if("ASCII"===t||"TEXT"===t)a=s(e,o),r=a.binLen,i=a.value;else{if("B64"!==t)throw"inputFormat must be HEX, TEXT, ASCII, or B64";a=u(e),r=a.binLen,i=a.value}this.getHash=function(e,t,n,o){var a,s=null,c=i.slice(),u=r;if(3===arguments.length?"number"!=typeof n&&(o=n,n=1):2===arguments.length&&(n=1),n!==parseInt(n,10)||1>n)throw"numRounds must a integer >= 1";switch(t){case"HEX":s=l;break;case"B64":s=d;break;default:throw"format must be HEX or B64"}if("SHA-1"===e)for(a=0;a<n;a++)c=M(c,u),u=160;else if("SHA-224"===e)for(a=0;a<n;a++)c=j(c,u,e),u=224;else if("SHA-256"===e)for(a=0;a<n;a++)c=j(c,u,e),u=256;else if("SHA-384"===e)for(a=0;a<n;a++)c=j(c,u,e),u=384;else{if("SHA-512"!==e)throw"Chosen SHA variant is not supported";for(a=0;a<n;a++)c=j(c,u,e),u=512}return s(c,f(o))},this.getHMAC=function(e,t,n,a,p){var h,m,v,g,y=[],b=[];switch(h=null,a){case"HEX":a=l;break;case"B64":a=d;break;default:throw"outputFormat must be HEX or B64"}if("SHA-1"===n)m=64,g=160;else if("SHA-224"===n)m=64,g=224;else if("SHA-256"===n)m=64,g=256;else if("SHA-384"===n)m=128,g=384;else{if("SHA-512"!==n)throw"Chosen SHA variant is not supported";m=128,g=512}if("HEX"===t)h=c(e),v=h.binLen,h=h.value;else if("ASCII"===t||"TEXT"===t)h=s(e,o),v=h.binLen,h=h.value;else{if("B64"!==t)throw"inputFormat must be HEX, TEXT, ASCII, or B64";h=u(e),v=h.binLen,h=h.value}for(e=8*m,t=m/4-1,m<v/8?(h="SHA-1"===n?M(h,v):j(h,v,n),h[t]&=4294967040):m>v/8&&(h[t]&=4294967040),m=0;m<=t;m+=1)y[m]=909522486^h[m],b[m]=1549556828^h[m];return n="SHA-1"===n?M(b.concat(M(y.concat(i),e+r)),e+g):j(b.concat(j(y.concat(i),e+r,n)),e+g,n),a(n,f(p))}}function a(e,t){this.a=e,this.b=t}function s(e,t){var n,r,i=[],o=[],a=0;if("UTF8"===t)for(r=0;r<e.length;r+=1)for(n=e.charCodeAt(r),o=[],2048<n?(o[0]=224|(61440&n)>>>12,o[1]=128|(4032&n)>>>6,o[2]=128|63&n):128<n?(o[0]=192|(1984&n)>>>6,o[1]=128|63&n):o[0]=n,n=0;n<o.length;n+=1)i[a>>>2]|=o[n]<<24-a%4*8,a+=1;else if("UTF16"===t)for(r=0;r<e.length;r+=1)i[a>>>2]|=e.charCodeAt(r)<<16-a%4*8,a+=2;return{value:i,binLen:8*a}}function c(e){var t,n,r=[],i=e.length;if(0!==i%2)throw"String of HEX type must be in byte increments";for(t=0;t<i;t+=2){if(n=parseInt(e.substr(t,2),16),isNaN(n))throw"String of HEX type contains invalid characters";r[t>>>3]|=n<<24-t%8*4}return{value:r,binLen:4*i}}function u(e){var t,n,r,i,o,a=[],s=0;if(-1===e.search(/^[a-zA-Z0-9=+\/]+$/))throw"Invalid character in base-64 string";if(t=e.indexOf("="),e=e.replace(/\=/g,""),-1!==t&&t<e.length)throw"Invalid '=' found in base-64 string";for(n=0;n<e.length;n+=4){for(o=e.substr(n,4),r=i=0;r<o.length;r+=1)t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(o[r]),i|=t<<18-6*r;for(r=0;r<o.length-1;r+=1)a[s>>2]|=(i>>>16-8*r&255)<<24-s%4*8,s+=1}return{value:a,binLen:8*s}}function l(e,t){var n,r,i="",o=4*e.length;for(n=0;n<o;n+=1)r=e[n>>>2]>>>8*(3-n%4),i+="0123456789abcdef".charAt(r>>>4&15)+"0123456789abcdef".charAt(15&r);return t.outputUpper?i.toUpperCase():i}function d(e,t){var n,r,i,o="",a=4*e.length;for(n=0;n<a;n+=3)for(i=(e[n>>>2]>>>8*(3-n%4)&255)<<16|(e[n+1>>>2]>>>8*(3-(n+1)%4)&255)<<8|e[n+2>>>2]>>>8*(3-(n+2)%4)&255,r=0;4>r;r+=1)o=8*n+6*r<=32*e.length?o+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>>6*(3-r)&63):o+t.b64Pad;return o}function f(e){var t={outputUpper:!1,b64Pad:"="};try{e.hasOwnProperty("outputUpper")&&(t.outputUpper=e.outputUpper),e.hasOwnProperty("b64Pad")&&(t.b64Pad=e.b64Pad)}catch(e){}if("boolean"!=typeof t.outputUpper)throw"Invalid outputUpper formatting option";if("string"!=typeof t.b64Pad)throw"Invalid b64Pad formatting option";return t}function p(e,t){return e<<t|e>>>32-t}function h(e,t){return e>>>t|e<<32-t}function m(e,t){var n=null,n=new a(e.a,e.b);return n=32>=t?new a(n.a>>>t|n.b<<32-t&4294967295,n.b>>>t|n.a<<32-t&4294967295):new a(n.b>>>t-32|n.a<<64-t&4294967295,n.a>>>t-32|n.b<<64-t&4294967295)}function v(e,t){var n=null;return n=32>=t?new a(e.a>>>t,e.b>>>t|e.a<<32-t&4294967295):new a(0,e.a>>>t-32)}function g(e,t,n){return e^t^n}function y(e,t,n){return e&t^~e&n}function b(e,t,n){return new a(e.a&t.a^~e.a&n.a,e.b&t.b^~e.b&n.b)}function E(e,t,n){return e&t^e&n^t&n}function S(e,t,n){return new a(e.a&t.a^e.a&n.a^t.a&n.a,e.b&t.b^e.b&n.b^t.b&n.b)}function T(e){return h(e,2)^h(e,13)^h(e,22)}function C(e){var t=m(e,28),n=m(e,34);return e=m(e,39),new a(t.a^n.a^e.a,t.b^n.b^e.b)}function w(e){return h(e,6)^h(e,11)^h(e,25)}function _(e){var t=m(e,14),n=m(e,18);return e=m(e,41),new a(t.a^n.a^e.a,t.b^n.b^e.b)}function R(e){return h(e,7)^h(e,18)^e>>>3}function A(e){var t=m(e,1),n=m(e,8);return e=v(e,7),new a(t.a^n.a^e.a,t.b^n.b^e.b)}function k(e){return h(e,17)^h(e,19)^e>>>10}function O(e){var t=m(e,19),n=m(e,61);return e=v(e,6),new a(t.a^n.a^e.a,t.b^n.b^e.b)}function I(e,t){var n=(65535&e)+(65535&t);return((e>>>16)+(t>>>16)+(n>>>16)&65535)<<16|65535&n}function P(e,t,n,r){var i=(65535&e)+(65535&t)+(65535&n)+(65535&r);return((e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(i>>>16)&65535)<<16|65535&i}function D(e,t,n,r,i){var o=(65535&e)+(65535&t)+(65535&n)+(65535&r)+(65535&i);return((e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(i>>>16)+(o>>>16)&65535)<<16|65535&o}function N(e,t){var n,r,i;return n=(65535&e.b)+(65535&t.b),r=(e.b>>>16)+(t.b>>>16)+(n>>>16),i=(65535&r)<<16|65535&n,n=(65535&e.a)+(65535&t.a)+(r>>>16),r=(e.a>>>16)+(t.a>>>16)+(n>>>16),new a((65535&r)<<16|65535&n,i)}function x(e,t,n,r){var i,o,s;return i=(65535&e.b)+(65535&t.b)+(65535&n.b)+(65535&r.b),o=(e.b>>>16)+(t.b>>>16)+(n.b>>>16)+(r.b>>>16)+(i>>>16),s=(65535&o)<<16|65535&i,i=(65535&e.a)+(65535&t.a)+(65535&n.a)+(65535&r.a)+(o>>>16),o=(e.a>>>16)+(t.a>>>16)+(n.a>>>16)+(r.a>>>16)+(i>>>16),new a((65535&o)<<16|65535&i,s)}function L(e,t,n,r,i){var o,s,c;return o=(65535&e.b)+(65535&t.b)+(65535&n.b)+(65535&r.b)+(65535&i.b),s=(e.b>>>16)+(t.b>>>16)+(n.b>>>16)+(r.b>>>16)+(i.b>>>16)+(o>>>16),c=(65535&s)<<16|65535&o,o=(65535&e.a)+(65535&t.a)+(65535&n.a)+(65535&r.a)+(65535&i.a)+(s>>>16),s=(e.a>>>16)+(t.a>>>16)+(n.a>>>16)+(r.a>>>16)+(i.a>>>16)+(o>>>16),new a((65535&s)<<16|65535&o,c)}function M(e,t){var n,r,i,o,a,s,c,u,l,d=[],f=y,h=g,m=E,v=p,b=I,S=D,T=[1732584193,4023233417,2562383102,271733878,3285377520];for(e[t>>>5]|=128<<24-t%32,e[(t+65>>>9<<4)+15]=t,l=e.length,c=0;c<l;c+=16){for(n=T[0],r=T[1],i=T[2],o=T[3],a=T[4],u=0;80>u;u+=1)d[u]=16>u?e[u+c]:v(d[u-3]^d[u-8]^d[u-14]^d[u-16],1),s=20>u?S(v(n,5),f(r,i,o),a,1518500249,d[u]):40>u?S(v(n,5),h(r,i,o),a,1859775393,d[u]):60>u?S(v(n,5),m(r,i,o),a,2400959708,d[u]):S(v(n,5),h(r,i,o),a,3395469782,d[u]),a=o,o=i,i=v(r,30),r=n,n=s;T[0]=b(n,T[0]),T[1]=b(r,T[1]),T[2]=b(i,T[2]),T[3]=b(o,T[3]),T[4]=b(a,T[4])}return T}function j(e,t,n){var r,i,o,s,c,u,l,d,f,p,h,m,v,g,M,j,F,U,B,J,H,G,V,W,K,q,z=[],X=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];if(p=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],i=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],"SHA-224"===n||"SHA-256"===n)h=64,r=(t+65>>>9<<4)+15,g=16,M=1,K=Number,j=I,F=P,U=D,B=R,J=k,H=T,G=w,W=E,V=y,p="SHA-224"===n?p:i;else{if("SHA-384"!==n&&"SHA-512"!==n)throw"Unexpected error in SHA-2 implementation";h=80,r=(t+128>>>10<<5)+31,g=32,M=2,K=a,j=N,F=x,U=L,B=A,J=O,H=C,G=_,W=S,V=b,X=[new K(X[0],3609767458),new K(X[1],602891725),new K(X[2],3964484399),new K(X[3],2173295548),new K(X[4],4081628472),new K(X[5],3053834265),new K(X[6],2937671579),new K(X[7],3664609560),new K(X[8],2734883394),new K(X[9],1164996542),new K(X[10],1323610764),new K(X[11],3590304994),new K(X[12],4068182383),new K(X[13],991336113),new K(X[14],633803317),new K(X[15],3479774868),new K(X[16],2666613458),new K(X[17],944711139),new K(X[18],2341262773),new K(X[19],2007800933),new K(X[20],1495990901),new K(X[21],1856431235),new K(X[22],3175218132),new K(X[23],2198950837),new K(X[24],3999719339),new K(X[25],766784016),new K(X[26],2566594879),new K(X[27],3203337956),new K(X[28],1034457026),new K(X[29],2466948901),new K(X[30],3758326383),new K(X[31],168717936),new K(X[32],1188179964),new K(X[33],1546045734),new K(X[34],1522805485),new K(X[35],2643833823),new K(X[36],2343527390),new K(X[37],1014477480),new K(X[38],1206759142),new K(X[39],344077627),new K(X[40],1290863460),new K(X[41],3158454273),new K(X[42],3505952657),new K(X[43],106217008),new K(X[44],3606008344),new K(X[45],1432725776),new K(X[46],1467031594),new K(X[47],851169720),new K(X[48],3100823752),new K(X[49],1363258195),new K(X[50],3750685593),new K(X[51],3785050280),new K(X[52],3318307427),new K(X[53],3812723403),new K(X[54],2003034995),new K(X[55],3602036899),new K(X[56],1575990012),new K(X[57],1125592928),new K(X[58],2716904306),new K(X[59],442776044),new K(X[60],593698344),new K(X[61],3733110249),new K(X[62],2999351573),new K(X[63],3815920427),new K(3391569614,3928383900),new K(3515267271,566280711),new K(3940187606,3454069534),new K(4118630271,4000239992),new K(116418474,1914138554),new K(174292421,2731055270),new K(289380356,3203993006),new K(460393269,320620315),new K(685471733,587496836),new K(852142971,1086792851),new K(1017036298,365543100),new K(1126000580,2618297676),new K(1288033470,3409855158),new K(1501505948,4234509866),new K(1607167915,987167468),new K(1816402316,1246189591)],p="SHA-384"===n?[new K(3418070365,p[0]),new K(1654270250,p[1]),new K(2438529370,p[2]),new K(355462360,p[3]),new K(1731405415,p[4]),new K(41048885895,p[5]),new K(3675008525,p[6]),new K(1203062813,p[7])]:[new K(i[0],4089235720),new K(i[1],2227873595),new K(i[2],4271175723),new K(i[3],1595750129),new K(i[4],2917565137),new K(i[5],725511199),new K(i[6],4215389547),new K(i[7],327033209)]}for(e[t>>>5]|=128<<24-t%32,e[r]=t,q=e.length,m=0;m<q;m+=g){for(t=p[0],r=p[1],i=p[2],o=p[3],s=p[4],c=p[5],u=p[6],l=p[7],v=0;v<h;v+=1)z[v]=16>v?new K(e[v*M+m],e[v*M+m+1]):F(J(z[v-2]),z[v-7],B(z[v-15]),z[v-16]),d=U(l,G(s),V(s,c,u),X[v],z[v]),f=j(H(t),W(t,r,i)),l=u,u=c,c=s,s=j(o,d),o=i,i=r,r=t,t=j(d,f);p[0]=j(t,p[0]),p[1]=j(r,p[1]),p[2]=j(i,p[2]),p[3]=j(o,p[3]),p[4]=j(s,p[4]),p[5]=j(c,p[5]),p[6]=j(u,p[6]),p[7]=j(l,p[7])}if("SHA-224"===n)e=[p[0],p[1],p[2],p[3],p[4],p[5],p[6]];else if("SHA-256"===n)e=p;else if("SHA-384"===n)e=[p[0].a,p[0].b,p[1].a,p[1].b,p[2].a,p[2].b,p[3].a,p[3].b,p[4].a,p[4].b,p[5].a,p[5].b];else{if("SHA-512"!==n)throw"Unexpected error in SHA-2 implementation";e=[p[0].a,p[0].b,p[1].a,p[1].b,p[2].a,p[2].b,p[3].a,p[3].b,p[4].a,p[4].b,p[5].a,p[5].b,p[6].a,p[6].b,p[7].a,p[7].b]}return e}r=function(){return o}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))}(this)},function(e,t){function n(e){if(e=""+e,!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*l;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function r(e){return e>=u?Math.round(e/u)+"d":e>=c?Math.round(e/c)+"h":e>=s?Math.round(e/s)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function i(e){return o(e,u,"day")||o(e,c,"hour")||o(e,s,"minute")||o(e,a,"second")||e+" ms"}function o(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,s=60*a,c=60*s,u=24*c,l=365.25*u;e.exports=function(e,t){return t=t||{},"string"==typeof e?n(e):t.long?i(e):r(e)}},function(e,t){(function(t){var n=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,a=/^\s+/,s=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(a,"").replace(s,""),t.JSON&&JSON.parse?JSON.parse(e):n.test(e.replace(r,"@").replace(i,"]").replace(o,""))?new Function("return "+e)():void 0):null}}).call(t,function(){return this}())},function(e,t){e.exports=function e(t){if(!t)return!1;if(this.length!=t.length)return!1;for(var n=0,r=this.length;n<r;n++)if(this[n]instanceof Array&&t[n]instanceof Array){if(!e.apply(this[n],[t[n]]))return!1}else if(this[n]!=t[n])return!1;return!0}},function(e,t,n){t.Interop=n(148)},function(e,t,n){"use strict";function r(){this.cache={}}var i=n(149),o=n(146);e.exports=r,r.prototype.getFirstSendingIndexFromAnswer=function(e){if(!this.cache.answer)return null;var t=i.parse(this.cache.answer);if(t&&t.media&&Array.isArray(t.media))for(var n=0;n<t.media.length;n++)if(t.media[n].type==e&&(!t.media[n].direction||"sendrecv"===t.media[n].direction||"sendonly"===t.media[n].direction))return n;return null},r.prototype.toPlanB=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var n=i.parse(e.sdp);if("undefined"==typeof n.media||!Array.isArray(n.media)||0===n.media.length)return console.warn("The description has no media."),e;if(n.media.length<=3&&n.media.every(function(e){return["video","audio","data"].indexOf(e.mid)!==-1}))return console.warn("This description does not look like Unified Plan."),e;for(var r=e.sdp,o=!1,a=0;a<n.media.length;a++){var s=n.media[a];s.rtp.forEach(function(e){if("NULL"===e.codec){o=!0;var n=i.parse(t.cache.offer);e.codec=n.media[a].rtp[0].codec}})}o&&(r=i.write(n)),this.cache[e.type]=r;var c=n.media;n.media=[];var u={},l=[];c.forEach(function(e){if(("string"!=typeof e.rtcpMux||"rtcp-mux"!==e.rtcpMux)&&"inactive"!==e.direction)throw new Error("Cannot convert to Plan B because m-lines without the rtcp-mux attribute were found.");return"application"===e.type?(n.media.push(e),void l.push(e.mid)):("undefined"==typeof u[e.type]&&(u[e.type]=e),"object"==typeof e.sources&&Object.keys(e.sources).forEach(function(t){"object"!=typeof u[e.type].sources&&(u[e.type].sources={}),u[e.type].sources[t]=e.sources[t],"undefined"!=typeof e.msid&&(u[e.type].sources[t].msid=e.msid)}),"undefined"!=typeof e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&("undefined"!=typeof u[e.type].ssrcGroups&&Array.isArray(u[e.type].ssrcGroups)||(u[e.type].ssrcGroups=[]),u[e.type].ssrcGroups=u[e.type].ssrcGroups.concat(e.ssrcGroups)),void(u[e.type]===e&&(e.candidates=c[0].candidates,e.iceUfrag=c[0].iceUfrag,e.icePwd=c[0].icePwd,e.fingerprint=c[0].fingerprint,e.mid=e.type,delete e.bundleOnly,delete e.msid,l.push(e.type),n.media.push(e))))}),n.groups.some(function(e){if("BUNDLE"===e.type)return e.mids=l.join(" "),!0}),n.msidSemantic={semantic:"WMS",token:"*"};var d=i.write(n);return new RTCSessionDescription({type:e.type,sdp:d})},r.prototype.toUnifiedPlan=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var n=i.parse(e.sdp);if("undefined"==typeof n.media||!Array.isArray(n.media)||0===n.media.length)return console.warn("The description has no media."),e;if(n.media.length>3||!n.media.every(function(e){return["video","audio","data"].indexOf(e.mid)!==-1}))return console.warn("This description does not look like Plan B."),e;var r=[];n.media.forEach(function(e){r.push(e.mid)});var a=!1;if("undefined"!=typeof n.groups&&Array.isArray(n.groups)&&(a=n.groups.every(function(e){return"BUNDLE"!==e.type||o.apply(e.mids.sort(),[r.sort()])})),!a)throw new Error("Cannot convert to Unified Plan because m-lines that are not bundled were found.");var s;"undefined"!=typeof this.cache[e.type]&&(s=i.parse(this.cache[e.type]));var c={audio:{},video:{}},u={};if(n.media.forEach(function(t){if(("string"!=typeof t.rtcpMux||"rtcp-mux"!==t.rtcpMux)&&"inactive"!==t.direction)throw new Error("Cannot convert to Unified Plan because m-lines without the rtcp-mux attribute were found.");if("application"===t.type)return void(u[t.mid]=t);var n=t.sources,r=t.ssrcGroups,i=t.candidates,o=t.iceUfrag,a=t.icePwd,l=t.fingerprint,d=t.port;delete t.sources,delete t.ssrcGroups,delete t.candidates,delete t.iceUfrag,delete t.icePwd,delete t.fingerprint,delete t.port,delete t.mid;var f={};"undefined"!=typeof r&&Array.isArray(r)&&r.forEach(function(e){"SIM"!==e.semantics&&"undefined"!=typeof e.ssrcs&&Array.isArray(e.ssrcs)&&e.ssrcs.forEach(function(t){"undefined"==typeof f[t]&&(f[t]=[]),f[t].push(e)})});var p={};"object"==typeof n&&Object.keys(n).forEach(function(r){var h;if("offer"===e.type&&!n[r].msid)return void(c[t.type][r]=n[r]);if("undefined"!=typeof f[r]&&Array.isArray(f[r])&&f[r].some(function(e){return e.ssrcs.some(function(e){if("object"==typeof p[e])return h=p[e],!0})}),"object"==typeof h)h.sources[r]=n[r],delete n[r].msid;else{if(h=Object.create(t),p[r]=h,"undefined"!=typeof n[r].msid&&(h.msid=n[r].msid,h.direction="sendrecv",delete n[r].msid),h.sources={},h.sources[r]=n[r],h.ssrcGroups=f[r],"undefined"!=typeof s&&"undefined"!=typeof s.media&&Array.isArray(s.media)&&s.media.forEach(function(e){"object"==typeof e.sources&&Object.keys(e.sources).forEach(function(t){t===r&&(h.mid=e.mid)})}),"undefined"==typeof h.mid){if("answer"===e.type)throw new Error("An unmapped SSRC was found.");h.mid=[t.type,"-",r].join("")}h.candidates=i,h.iceUfrag=o,h.icePwd=a,h.fingerprint=l,h.port=d,u[h.mid]=h}})}),n.media=[],r=[],"answer"===e.type)for(var l=0;l<s.media.length;l++){var d=s.media[l];"undefined"==typeof u[d.mid]&&(delete d.msid,delete d.sources,delete d.ssrcGroups,d.direction&&"sendrecv"!==d.direction?"sendonly"===d.direction&&(d.direction="inactive"):d.direction="recvonly"),n.media.push(d),"string"==typeof d.mid&&r.push(d.mid)}else"undefined"!=typeof s&&"undefined"!=typeof s.media&&Array.isArray(s.media)&&s.media.forEach(function(e){r.push(e.mid),"undefined"!=typeof u[e.mid]?n.media.push(u[e.mid]):(delete e.msid,delete e.sources,delete e.ssrcGroups,e.direction&&"sendrecv"!==e.direction||(e.direction="recvonly"),e.direction&&"sendonly"!==e.direction||(e.direction="inactive"),n.media.push(e))}),Object.keys(u).forEach(function(e){r.indexOf(e)===-1&&(r.push(e),"recvonly"===u[e].direction?n.media.some(function(t){if(("sendrecv"===t.direction||"sendonly"===t.direction)&&t.type===u[e].type)return Object.keys(u[e].sources).forEach(function(n){t.sources[n]=u[e].sources[n]}),!0}):n.media.push(u[e]))});["audio","video"].forEach(function(e){if(n&&n.media&&Array.isArray(n.media)){var r=null;if(Object.keys(c[e]).length>0&&(r=t.getFirstSendingIndexFromAnswer(e),null===r))for(var i=0;i<n.media.length;i++)if(n.media[i].type===e){r=i;break}if(r&&n.media.length>r){var o=n.media[r];Object.keys(c[e]).forEach(function(t){o.sources&&o.sources[t]&&console.warn("Replacing an existing SSRC."),o.sources||(o.sources={}),o.sources[t]=c[e][t]})}}}),n.groups.some(function(e){if("BUNDLE"===e.type)return e.mids=r.join(" "),!0}),n.msidSemantic={semantic:"WMS",token:"*"};var f=i.write(n);return this.cache[e.type]=f,new RTCSessionDescription({type:e.type,sdp:f})}},function(e,t,n){var r=n(150);t.write=function(e,t){return"undefined"!=typeof e&&"undefined"!=typeof e.media&&Array.isArray(e.media)&&e.media.forEach(function(e){"undefined"!=typeof e.sources&&0!==Object.keys(e.sources).length&&(e.ssrcs=[],Object.keys(e.sources).forEach(function(t){var n=e.sources[t];Object.keys(n).forEach(function(r){e.ssrcs.push({id:t,attribute:r,value:n[r]})})}),delete e.sources),"undefined"!=typeof e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach(function(e){"undefined"!=typeof e.ssrcs&&Array.isArray(e.ssrcs)&&(e.ssrcs=e.ssrcs.join(" "))})}),"undefined"!=typeof e&&"undefined"!=typeof e.groups&&Array.isArray(e.groups)&&e.groups.forEach(function(e){"undefined"!=typeof e.mids&&Array.isArray(e.mids)&&(e.mids=e.mids.join(" "))}),r.write(e,t)},t.parse=function(e){var t=r.parse(e);return"undefined"!=typeof t&&"undefined"!=typeof t.media&&Array.isArray(t.media)&&t.media.forEach(function(e){"undefined"!=typeof e.ssrcs&&Array.isArray(e.ssrcs)&&(e.sources={},e.ssrcs.forEach(function(t){e.sources[t.id]||(e.sources[t.id]={}),e.sources[t.id][t.attribute]=t.value}),delete e.ssrcs),"undefined"!=typeof e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach(function(e){"string"==typeof e.ssrcs&&(e.ssrcs=e.ssrcs.split(" "))})}),"undefined"!=typeof t&&"undefined"!=typeof t.groups&&Array.isArray(t.groups)&&t.groups.forEach(function(e){"string"==typeof e.mids&&(e.mids=e.mids.split(" "))}),t}},function(e,t,n){var r=n(151),i=n(152);t.write=i,t.parse=r.parse,t.parseFmtpConfig=r.parseFmtpConfig,t.parsePayloads=r.parsePayloads,t.parseRemoteCandidates=r.parseRemoteCandidates},function(e,t,n){var r=function(e){return String(Number(e))===e?Number(e):e},i=function(e,t,n,i){if(i&&!n)t[i]=r(e[1]);else for(var o=0;o<n.length;o+=1)null!=e[o+1]&&(t[n[o]]=r(e[o+1]))},o=function(e,t,n){var r=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:r&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:r?t[e.name]:t;i(n.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},a=n(61),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],r=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach(function(e){var t=e[0],i=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),r=n[n.length-1]);for(var s=0;s<(a[t]||[]).length;s+=1){var c=a[t][s];if(c.reg.test(i))return o(c,r,i)}}),t.media=n,t};var c=function(e,t){var n=t.split("=");return 2===n.length&&(e[n[0]]=r(n[1])),e};t.parseFmtpConfig=function(e){return e.split(/\;\s?/).reduce(c,{})},t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),i=0;i<n.length;i+=3)t.push({component:n[i],ip:n[i+1],port:n[i+2]});return t}},function(e,t,n){var r=n(61),i=/%[sdv%]/g,o=function(e){var t=1,n=arguments,r=n.length;return e.replace(i,function(e){if(t>=r)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})},a=function(e,t,n){var r=t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format,i=[e+"="+r];if(t.names)for(var a=0;a<t.names.length;a+=1){var s=t.names[a];t.name?i.push(n[t.name][s]):i.push(n[t.names[a]])}else i.push(n[t.name]);return o.apply(null,i)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var n=t.outerOrder||s,i=t.innerOrder||c,o=[];return n.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?o.push(a(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){o.push(a(t,n,e))})})}),e.media.forEach(function(e){o.push(a("m",r.m[0],e)),i.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?o.push(a(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){o.push(a(t,n,e))})})})}),o.join("\r\n")+"\r\n"}},function(e,t,n){function r(e,t,n){return e.ssrcs.filter(function(e){return e.id===t}).filter(function(e){return e.attribute===n}).map(function(e){return e.value})[0]}function i(e){this.options=e?e:{},this.options.numOfLayers||(this.options.numOfLayers=v),console.log("SdpSimulcast: using "+this.options.numOfLayers+" layers"),this.ssrcCache=[]}function o(){var e=0,t=4294967295;return Math.floor(Math.random()*(t-e))+e}function a(e,t){null!=e&&Array.isArray(e.media)&&e.media.forEach(function(e){"video"===e.type&&t(e)})}function s(e){return e&&null!=e&&e.type&&""!=e.type&&e.sdp&&""!=e.sdp}function c(e){if(e&&Array.isArray(e.ssrcGroups))for(var t=h(e),n=[],r=e.ssrcGroups.length;r--;)if("SIM"===e.ssrcGroups[r].semantics){for(var i=e.ssrcGroups[r].ssrcs.split(" "),o=0;o<i.length;o++){var a=i[o];n.push(a);var s=t[a].msid.split(" ");t[a].msid=[s[0],"/",o," ",s[1],"/",o].join(""),t[a].cname=[t[a].cname,"/",o].join(""),e.ssrcGroups.forEach(function(e){if("SIM"!==e.semantics){var r=e.ssrcs.split(" ");r.indexOf(a)!==-1&&r.forEach(function(e){t[e].msid=t[a].msid,t[e].cname=t[a].cname,e!==a&&n.push(e)})}})}e.ssrcs=m(t,n),e.ssrcGroups.splice(r,1)}}function u(e){if(!e||!Array.isArray(e.ssrcGroups))return void console.info("Halt: There are no SSRC groups in the remote description.");var t=h(e);e.ssrcGroups.forEach(function(n){if("SIM"===n.semantics){console.info("Imploding SIM group: "+n.ssrcs),n.nuke=!0;for(var r=n.ssrcs.split(" "),i=1;i<r.length;i++){var o=r[i];delete t[o],e.ssrcGroups.forEach(function(e){if("SIM"!==e.semantics){var n=e.ssrcs.split(" ");n.indexOf(o)!==-1&&(n.forEach(function(e){delete t[e]}),e.nuke=!0)}})}}}),e.ssrcs=m(t);for(var n=e.ssrcGroups.length;n--;)e.ssrcGroups[n].nuke&&e.ssrcGroups.splice(n,1)}function l(e){if(e&&Array.isArray(e.invalid))for(var t=e.invalid.length;t--;)"x-google-flag:conference"==e.invalid[t].value&&e.invalid.splice(t,1)}function d(e){e&&(Array.isArray(e.invalid)||(e.invalid=[]),e.invalid.some(function(e){return"x-google-flag:conference"===e.value})||e.invalid.push({value:"x-google-flag:conference"}))}var f=n(155),p=n(154),h=p.parseSsrcs,m=p.writeSsrcs,v=3;i.prototype.clearSsrcCache=function(){this.ssrcCache=[]},i.prototype.setSsrcCache=function(e){this.ssrcCache=e},i.prototype._parseSimLayers=function(e){var t=e.ssrcGroups&&e.ssrcGroups.find(function(e){return"SIM"===e.semantics});return t?t.ssrcs.split(" ").map(function(e){return parseInt(e)}):[e.ssrcs[0].id]},i.prototype._buildNewToOldSsrcMap=function(e,t){for(var n={},r=0;r<e.length;++r){var i=e[r],o=t[r]||null;n[i]=o}return n},i.prototype._fillInSourceDataFromCache=function(e){console.log("SdpSimulcast restoring from cache: ",this.ssrcCache);var t=this._parseSimLayers(e);console.log("SdpSimulcast Parsed new sim ssrcs: ",t);var n=r(e,t[0],"msid"),i=r(e,t[0],"cname"),o=this._buildNewToOldSsrcMap(t,this.ssrcCache);console.log("SdpSimulcast built replacement map: ",o);var a=this.ssrcCache.filter(function(e){return Object.values(o).indexOf(e)===-1});return console.log("SdpSimulcast built ssrcs to add: ",a),e.ssrcs.forEach(function(e){o[e.id]&&(e.id=o[e.id])}),a.forEach(function(t){e.ssrcs.push({id:t,attribute:"msid",value:n}),e.ssrcs.push({id:t,attribute:"cname",value:i})}),e.ssrcGroups=e.ssrcGroups||[],e.ssrcGroups.push({semantics:"SIM",ssrcs:this.ssrcCache.join(" ")}),e},i.prototype._generateSourceData=function(e,t){for(var n=function(e,t){e.ssrcs.push({id:t,attribute:"cname",value:a}),e.ssrcs.push({id:t,attribute:"msid",value:i})},i=r(e,t,"msid"),a=r(e,t,"cname"),s=[],c=0;c<this.options.numOfLayers-1;++c){var u=o();n(e,u),s.push(u)}return e.ssrcGroups=e.ssrcGroups||[],e.ssrcGroups.push({semantics:"SIM",ssrcs:t+" "+s.join(" ")}),e},i.prototype._restoreSimulcast=function(e){var t,n=e.ssrcs&&e.ssrcs.map(function(e){return e.id}).filter(function(e,t,n){return n.indexOf(e)===t}).length||0,r=e.ssrcGroups&&e.ssrcGroups.length||0;if(0===n||n>2)return e;if(2==n&&0===r)return e;if(1===n)t=e.ssrcs[0].id;else{var i=e.ssrcGroups.filter(function(e){return"FID"===e.semantics})[0];if(!i)return e;t=parseInt(i.ssrcs.split(" ")[0])}console.log("SdpSimulcast: current ssrc cache: ",this.ssrcCache),console.log("SdpSimulcast: parsed primary ssrc "+t);var o=this.ssrcCache.indexOf(t)!==-1;return o?(console.log("SdpSimulcast: Have seen primary ssrc before, filling in data from cache"),e=this._fillInSourceDataFromCache(e)):(console.log("SdpSimulcast: Have not seen primary ssrc before, generating source data"),e=this._generateSourceData(e,t)),this.ssrcCache=this._parseSimLayers(e),e},i.prototype.mungeRemoteDescription=function(e){if(!s(e))return e;var t=f.parse(e.sdp),n=this;return a(t,function(e){n.options.explodeRemoteSimulcast?c(e):u(e),n.ssrcCache.length<1?l(e):d(e)}),new RTCSessionDescription({type:e.type,sdp:f.write(t)})},i.prototype.mungeLocalDescription=function(e){if(!s(e))return e;var t=f.parse(e.sdp),n=this;return a(t,function(e){"recvonly"!=e.direction&&"inactive"!=e.direction&&n._restoreSimulcast(e)}),new RTCSessionDescription({type:e.type,sdp:f.write(t)})},e.exports=i},function(e,t){t.writeSsrcs=function(e,t){var n=[];if("undefined"!=typeof e&&0!==Object.keys(e).length){Array.isArray(t)||(t=[]);for(var r=0;r<t.length;r++){var i=t[r],o=e[i];Object.keys(o).forEach(function(e){n.push({id:i,attribute:e,value:o[e]})})}Object.keys(e).forEach(function(r){if(r=parseInt(r),!(t.indexOf(r)>=0)){var i=e[r];Object.keys(i).forEach(function(e){n.push({id:r,attribute:e,value:i[e]})})}})}return n},t.parseSsrcs=function(e){var t={};return"undefined"!=typeof e.ssrcs&&Array.isArray(e.ssrcs)&&e.ssrcs.forEach(function(e){t[e.id]||(t[e.id]={}),t[e.id][e.attribute]=e.value}),t}},function(e,t,n){var r=n(156),i=n(157);t.write=i,t.parse=r.parse,t.parseFmtpConfig=r.parseFmtpConfig,t.parsePayloads=r.parsePayloads,t.parseRemoteCandidates=r.parseRemoteCandidates},function(e,t,n){var r=function(e){return String(Number(e))===e?Number(e):e},i=function(e,t,n,i){if(i&&!n)t[i]=r(e[1]);else for(var o=0;o<n.length;o+=1)null!=e[o+1]&&(t[n[o]]=r(e[o+1]))},o=function(e,t,n){var r=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:r&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:r?t[e.name]:t;i(n.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},a=n(62),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],r=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach(function(e){var t=e[0],i=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),r=n[n.length-1]);for(var s=0;s<(a[t]||[]).length;s+=1){var c=a[t][s];if(c.reg.test(i))return o(c,r,i)}}),t.media=n,t};var c=function(e,t){var n=t.split("=");return 2===n.length&&(e[n[0]]=r(n[1])),e};t.parseFmtpConfig=function(e){return e.split(/\;\s?/).reduce(c,{})},t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),i=0;i<n.length;i+=3)t.push({component:n[i],ip:n[i+1],port:n[i+2]});return t}},function(e,t,n){var r=n(62),i=/%[sdv%]/g,o=function(e){var t=1,n=arguments,r=n.length;return e.replace(i,function(e){if(t>=r)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})},a=function(e,t,n){var r=t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format,i=[e+"="+r];if(t.names)for(var a=0;a<t.names.length;a+=1){
var s=t.names[a];t.name?i.push(n[t.name][s]):i.push(n[t.names[a]])}else i.push(n[t.name]);return o.apply(null,i)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var n=t.outerOrder||s,i=t.innerOrder||c,o=[];return n.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?o.push(a(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){o.push(a(t,n,e))})})}),e.media.forEach(function(e){o.push(a("m",r.m[0],e)),i.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?o.push(a(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){o.push(a(t,n,e))})})})}),o.join("\r\n")+"\r\n"}},function(e,t,n){var r=function(e){return String(Number(e))===e?Number(e):e},i=function(e,t,n,i){if(i&&!n)t[i]=r(e[1]);else for(var o=0;o<n.length;o+=1)null!=e[o+1]&&(t[n[o]]=r(e[o+1]))},o=function(e,t,n){var r=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:r&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:r?t[e.name]:t;i(n.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},a=n(63),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],r=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach(function(e){var t=e[0],i=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),r=n[n.length-1]);for(var s=0;s<(a[t]||[]).length;s+=1){var c=a[t][s];if(c.reg.test(i))return o(c,r,i)}}),t.media=n,t};var c=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length&&(e[n[0]]=r(n[1])),e};t.parseParams=function(e){return e.split(/\;\s?/).reduce(c,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),i=0;i<n.length;i+=3)t.push({component:n[i],ip:n[i+1],port:n[i+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(c,{})})},t.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t,n=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),n=!0),{scid:t,paused:n}})})}},function(e,t,n){var r=n(63),i=/%[sdv%]/g,o=function(e){var t=1,n=arguments,r=n.length;return e.replace(i,function(e){if(t>=r)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})},a=function(e,t,n){var r=t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format,i=[e+"="+r];if(t.names)for(var a=0;a<t.names.length;a+=1){var s=t.names[a];t.name?i.push(n[t.name][s]):i.push(n[t.names[a]])}else i.push(n[t.name]);return o.apply(null,i)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var n=t.outerOrder||s,i=t.innerOrder||c,o=[];return n.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?o.push(a(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){o.push(a(t,n,e))})})}),e.media.forEach(function(e){o.push(a("m",r.m[0],e)),i.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?o.push(a(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){o.push(a(t,n,e))})})})}),o.join("\r\n")+"\r\n"}},function(e,t,n){(function(e,t){!function(e,n){"use strict";function r(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return m[h]=r,p(h),h++}function i(e){delete m[e]}function o(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function a(e){if(v)setTimeout(a,0,e);else{var t=m[e];if(t){v=!0;try{o(t)}finally{i(e),v=!1}}}}function s(){p=function(e){t.nextTick(function(){a(e)})}}function c(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function u(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),p=function(n){e.postMessage(t+n,"*")}}function l(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;a(t)},p=function(t){e.port2.postMessage(t)}}function d(){var e=g.documentElement;p=function(t){var n=g.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}function f(){p=function(e){setTimeout(a,0,e)}}if(!e.setImmediate){var p,h=1,m={},v=!1,g=e.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(e);y=y&&y.setTimeout?y:e,"[object process]"==={}.toString.call(e.process)?s():c()?u():e.MessageChannel?l():g&&"onreadystatechange"in g.createElement("script")?d():f(),y.setImmediate=r,y.clearImmediate=i}}("undefined"==typeof self?"undefined"==typeof e?this:e:self)}).call(t,function(){return this}(),n(60))},function(e,t,n){function r(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r=i(e),o=r.source,u=r.id,l=r.path,d=c[u]&&l in c[u].nsps,f=t.forceNew||t["force new connection"]||!1===t.multiplex||d;return f?(s("ignoring socket cache for %s",o),n=a(o,t)):(c[u]||(s("new io instance for %s",o),c[u]=a(o,t)),n=c[u]),n.socket(r.path)}var i=n(162),o=n(40),a=n(64),s=n(10)("socket.io-client");e.exports=t=r;var c=t.managers={};t.protocol=o.protocol,t.connect=r,t.Manager=n(64),t.Socket=n(66)},function(e,t,n){(function(t){function r(e,n){var r=e,n=n||t.location;null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e="undefined"!=typeof n?n.protocol+"//"+e:"https://"+e),o("parse %s",e),r=i(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var a=r.host.indexOf(":")!==-1,s=a?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+s+":"+r.port,r.href=r.protocol+"://"+s+(n&&n.port==r.port?"":":"+r.port),r}var i=n(59),o=n(10)("socket.io-client:url");e.exports=r}).call(t,function(){return this}())},function(e,t,n){(function(e){var r=n(26),i=n(67);t.deconstructPacket=function(e){function t(e){if(!e)return e;if(i(e)){var o={_placeholder:!0,num:n.length};return n.push(e),o}if(r(e)){for(var a=new Array(e.length),s=0;s<e.length;s++)a[s]=t(e[s]);return a}if("object"==typeof e&&!(e instanceof Date)){var a={};for(var c in e)a[c]=t(e[c]);return a}return e}var n=[],o=e.data,a=e;return a.data=t(o),a.attachments=n.length,{packet:a,buffers:n}},t.reconstructPacket=function(e,t){function n(e){if(e&&e._placeholder){var i=t[e.num];return i}if(r(e)){for(var o=0;o<e.length;o++)e[o]=n(e[o]);return e}if(e&&"object"==typeof e){for(var a in e)e[a]=n(e[a]);return e}return e}return e.data=n(e.data),e.attachments=void 0,e},t.removeBlobs=function(t,n){function o(t,c,u){if(!t)return t;if(e.Blob&&t instanceof Blob||e.File&&t instanceof File){a++;var l=new FileReader;l.onload=function(){u?u[c]=this.result:s=this.result,--a||n(s)},l.readAsArrayBuffer(t)}else if(r(t))for(var d=0;d<t.length;d++)o(t[d],d,t);else if(t&&"object"==typeof t&&!i(t))for(var f in t)o(t[f],f,t)}var a=0,s=t;o(s),a||n(s)}}).call(t,function(){return this}())},function(e,t){function n(e){if(e)return r(e)}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){r.off(e,n),t.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e){if(!H.default[e])return null;var t=H.default[e].order,n=null,r=null;return Object.keys(H.default).forEach(function(e){var i=H.default[e];(!n||n.order<i.order&&i.order<t)&&(r=e,n=i)}),r}function a(e,t){var n=e;return t.devices.indexOf("audio")!==-1&&(n+=".audio"),t.devices.indexOf("desktop")!==-1&&(n+=".desktop"),t.devices.indexOf("video")!==-1&&(n+=".video."+t.resolution),n}Object.defineProperty(t,"__esModule",{value:!0});var s=n(101),c=i(s),u=n(34),l=r(u),d=n(3),f=i(d),p=n(28),h=r(p),m=n(8),v=r(m),g=n(75),y=i(g),b=n(41),E=r(b),S=n(29),T=r(S),C=n(76),w=i(C),_=n(42),R=r(_),A=n(43),k=i(A),O=n(12),I=i(O),P=n(13),D=r(P),N=n(14),x=r(N),L=n(45),M=i(L),j=n(1),F=i(j),U=n(5),B=r(U),J=n(33),H=i(J),G=n(30),V=n(20),W=i(V),K=n(2),q=i(K),z=n(83),X=i(z),$=n(47),Q=i($),Y=n(31),Z=i(Y),ee=n(6),te=i(ee),ne=n(32),re=r(ne),ie=F.default.getLogger(e),oe=500;t.default={version:"development",JitsiConnection:y.default,constants:{participantConnectionStatus:G.ParticipantConnectionStatus,sipVideoGW:re},events:{conference:v,connection:T,track:x,mediaDevices:R,connectionQuality:l},errors:{conference:h,connection:E,recorder:k.default,track:D},errorTypes:{JitsiTrackError:I.default},logLevels:F.default.levels,mediaDevices:w.default,analytics:null,init:function(e){if(te.default.init(e),this.analytics=te.default.analytics,e.enableAnalyticsLogging===!0&&this.analytics.init(q.default.getBrowserName()),e.enableWindowOnErrorHandler&&f.default.addHandler(this.getGlobalOnErrorHandler.bind(this)),window.jitsiRegionInfo&&Object.keys(window.jitsiRegionInfo).length>0){var t={};for(var n in window.jitsiRegionInfo)window.jitsiRegionInfo.hasOwnProperty(n)&&(t[n]=window.jitsiRegionInfo[n]);t.id="deployment_info",te.default.sendLog(JSON.stringify(t))}if(this.version){var r={id:"component_version",component:"lib-jitsi-meet",version:this.version};te.default.sendLog(JSON.stringify(r))}return W.default.init(e||{})},isDesktopSharingEnabled:function(){return W.default.isDesktopSharingEnabled()},setLogLevel:function(e){F.default.setLogLevel(e)},setLogLevelById:function(e,t){F.default.setLogLevelById(e,t)},addGlobalLogTransport:function(e){F.default.addGlobalTransport(e)},removeGlobalLogTransport:function(e){F.default.removeGlobalTransport(e)},createLocalTracks:function(e,t){var n=this,r=!1;return t===!0&&window.setTimeout(function(){r||w.default.emitEvent(R.PERMISSION_PROMPT_IS_SHOWN,q.default.getBrowserName())},oe),window.connectionTimes||(window.connectionTimes={}),window.connectionTimes["obtainPermissions.start"]=window.performance.now(),W.default.obtainAudioAndVideoPermissions(e||{}).then(function(t){if(r=!0,window.connectionTimes["obtainPermissions.end"]=window.performance.now(),te.default.analytics.sendEvent(a("getUserMedia.success",e),{value:e}),!W.default.options.disableAudioLevels)for(var n=function(e){var n=t[e],r=n.getOriginalStream();n.getType()===B.AUDIO&&(te.default.startLocalStats(r,n.setAudioLevel.bind(n)),n.addEventListener(x.LOCAL_TRACK_STOPPED,function(){te.default.stopLocalStats(r)}))},i=0;i<t.length;i++)n(i);var o=W.default.getCurrentlyAvailableMediaDevices();if(o)for(var i=0;i<t.length;i++){var s=t[i];s._setRealDeviceIdFromDeviceList(o)}return t}).catch(function(t){if(r=!0,t.name===D.UNSUPPORTED_RESOLUTION){var i=e.resolution||"360",s=o(i);if(null!==s)return e.resolution=s,ie.debug("Retry createLocalTracks with resolution",s),te.default.analytics.sendEvent("getUserMedia.fail.resolution."+i),n.createLocalTracks(e)}if(D.CHROME_EXTENSION_USER_CANCELED===t.name){var c={id:"chrome_extension_user_canceled",message:t.message};te.default.sendLog(JSON.stringify(c)),te.default.analytics.sendEvent("getUserMedia.userCancel.extensionInstall")}else if(D.NOT_FOUND===t.name){var u={id:"usermedia_missing_device",status:t.gum.devices};te.default.sendLog(JSON.stringify(u)),te.default.analytics.sendEvent("getUserMedia.deviceNotFound."+t.gum.devices.join("."))}else{te.default.sendGetUserMediaFailed(t);var l=a("getUserMedia.failed",e);te.default.analytics.sendEvent(l+"."+t.name,{value:e})}return window.connectionTimes["obtainPermissions.end"]=window.performance.now(),Promise.reject(t)})},isDeviceListAvailable:function(){return ie.warn("This method is deprecated, use JitsiMeetJS.mediaDevices.isDeviceListAvailable instead"),this.mediaDevices.isDeviceListAvailable()},isDeviceChangeAvailable:function(e){return ie.warn("This method is deprecated, use JitsiMeetJS.mediaDevices.isDeviceChangeAvailable instead"),this.mediaDevices.isDeviceChangeAvailable(e)},isMultipleAudioInputSupported:function(){return this.mediaDevices.isMultipleAudioInputSupported()},isCollectingLocalStats:function(){return te.default.audioLevelsEnabled&&M.default.isLocalStatsSupported()},enumerateDevices:function(e){ie.warn("This method is deprecated, use JitsiMeetJS.mediaDevices.enumerateDevices instead"),this.mediaDevices.enumerateDevices(e)},getGlobalOnErrorHandler:function(e,t,n,r,i){ie.error("UnhandledError: "+e,"Script: "+t,"Line: "+n,"Column: "+r,"StackTrace: ",i),te.default.reportGlobalError(i)},getMachineId:function(){return Z.default.getMachineId()},util:{AuthUtil:c.default,RTCUIHelper:X.default,ScriptUtil:Q.default}}}).call(t,"JitsiMeetJS.js")},function(e,t,n){function r(e,t){this._id=e,this._clearFn=t}var i=Function.prototype.apply;t.setTimeout=function(){return new r(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(160),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t){function n(e,t){var n=[];t=t||0;for(var r=t||0;r<e.length;r++)n[r-t]=e[r];return n}e.exports=n},function(e,t,n){var r;(function(e,i){!function(o){function a(e){for(var t,n,r=[],i=0,o=e.length;i<o;)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<o?(n=e.charCodeAt(i++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--)):r.push(t);return r}function s(e){for(var t,n=e.length,r=-1,i="";++r<n;)t=e[r],t>65535&&(t-=65536,i+=E(t>>>10&1023|55296),t=56320|1023&t),i+=E(t);return i}function c(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function u(e,t){return E(e>>t&63|128)}function l(e){if(0==(4294967168&e))return E(e);var t="";return 0==(4294965248&e)?t=E(e>>6&31|192):0==(4294901760&e)?(c(e),t=E(e>>12&15|224),t+=u(e,6)):0==(4292870144&e)&&(t=E(e>>18&7|240),t+=u(e,12),t+=u(e,6)),t+=E(63&e|128)}function d(e){for(var t,n=a(e),r=n.length,i=-1,o="";++i<r;)t=n[i],o+=l(t);return o}function f(){if(b>=y)throw Error("Invalid byte index");var e=255&g[b];if(b++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function p(){var e,t,n,r,i;if(b>y)throw Error("Invalid byte index");if(b==y)return!1;if(e=255&g[b],b++,0==(128&e))return e;if(192==(224&e)){var t=f();if(i=(31&e)<<6|t,i>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&e)){if(t=f(),n=f(),i=(15&e)<<12|t<<6|n,i>=2048)return c(i),i;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=f(),n=f(),r=f(),i=(15&e)<<18|t<<12|n<<6|r,i>=65536&&i<=1114111))return i;throw Error("Invalid UTF-8 detected")}function h(e){g=a(e),y=g.length,b=0;for(var t,n=[];(t=p())!==!1;)n.push(t);return s(n)}var m="object"==typeof t&&t,v=("object"==typeof e&&e&&e.exports==m&&e,"object"==typeof i&&i);v.global!==v&&v.window!==v||(o=v);var g,y,b,E=String.fromCharCode,S={version:"2.0.0",encode:d,decode:h};r=function(){return S}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))}(this)}).call(t,n(68)(e),function(){return this}())},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,n){e.exports={EventTarget:n(172),Event:n(171)}},function(e,t){(function(t){e.exports=t.Event}).call(t,function(){return this}())},function(e,t){function n(){"function"!=typeof this.addEventListener&&(this._listeners={})}Object.defineProperties(n.prototype,{listeners:{get:function(){return this._listeners}}}),n.prototype.addEventListener=function(e,t){var n,r,i;if(e&&t){for(n=this._listeners[e],void 0===n&&(this._listeners[e]=n=[]),r=0;i=n[r];r++)if(i===t)return;n.push(t)}},n.prototype.removeEventListener=function(e,t){var n,r,i;if(e&&t&&(n=this._listeners[e],void 0!==n)){for(r=0;i=n[r];r++)if(i===t){n.splice(r,1);break}0===n.length&&delete this._listeners[e]}},n.prototype.dispatchEvent=function(e){var t,n,r,i,o,a=!1;if(!e||"string"!=typeof e.type)throw new Error("`event` must have a valid `type` property");e._yaeti&&(e.target=this,e.cancelable=!0);try{e.stopImmediatePropagation=function(){a=!0}}catch(e){}if(t=e.type,n=this._listeners[t]||[],r=this["on"+t],"function"==typeof r)try{r.call(this,e)}catch(e){console.error(e)}for(i=0;(o=n[i])&&!a;i++)try{o.call(this,e)}catch(e){console.error(e)}return!e.defaultPrevented},e.exports=n},function(e,t){}])});
//# sourceMappingURL=lib-jitsi-meet.min.map